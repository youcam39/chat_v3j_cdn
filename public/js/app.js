!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=108)}([function(e,t,n){"use strict";n.d(t,"i",(function(){return M})),n.d(t,"s",(function(){return k})),n.d(t,"d",(function(){return P})),n.d(t,"b",(function(){return A})),n.d(t,"p",(function(){return u})),n.d(t,"w",(function(){return c})),n.d(t,"o",(function(){return d})),n.d(t,"k",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"y",(function(){return m})),n.d(t,"h",(function(){return p})),n.d(t,"u",(function(){return h})),n.d(t,"v",(function(){return _})),n.d(t,"c",(function(){return g})),n.d(t,"x",(function(){return v})),n.d(t,"q",(function(){return y})),n.d(t,"z",(function(){return b})),n.d(t,"l",(function(){return w})),n.d(t,"a",(function(){return S})),n.d(t,"e",(function(){return C})),n.d(t,"r",(function(){return E})),n.d(t,"j",(function(){return T})),n.d(t,"t",(function(){return O})),n.d(t,"f",(function(){return R})),n.d(t,"n",(function(){return x})),n.d(t,"m",(function(){return U}));var r=n(31);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=n(109),a=n(133);function s(){return"undefined"!=typeof Storage}function c(e,t){s()?localStorage.setItem(e,t):function(e,t,n){var r=new Date;r.setTime(r.getTime()+287712e5);var o="expires="+r.toUTCString();document.cookie=e+"="+(i=t,encodeURIComponent(i).split("'").join("%27")+"; ")+o;var i}(e,t)}function u(e){if(s()){var t=localStorage.getItem(e);return"null"!=t&&null!=t||(t=""),t}return function(e){for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var o=n[r];" "==o.charAt(0);)o=o.substring(1);if(-1!=o.indexOf(t))return i=o.substring(t.length,o.length),decodeURIComponent(i)}var i;return""}(e)}function d(e){try{if("string"==typeof e&&(e=e.split("?si=")[0]),e.includes("youtube")){var t=e.split("v=")[1];if(!t)return null;var n=t.indexOf("&");return-1!=n?t.substring(0,n):t}if(!e.includes("youtu.be/"))return null;var r=e.split("youtu.be/"),o=r[0],i=r[1];if(o&&11==o.length)return o;if(i&&11==i.length)return i}catch(e){return null}}function l(e,t){if(!t)return e;try{return i.AES.encrypt(JSON.stringify(e),a.aes_secret).toString()}catch(e){return null}}function f(e,t){if(!t){try{e=JSON.stringify(e).replaceAll("آِ","ا")}catch(t){e=JSON.stringify(e).replace("آِ","ا").replace("آِ","ا").replace("آِ","ا").replace("آِ","ا").replace("آِ","ا")}return e=JSON.parse(e)}try{var n=i.AES.decrypt(e,a.aes_secret).toString(i.enc.Utf8);return JSON.parse(n)}catch(e){return""}}function p(e){var t=atob(e);t=JSON.parse(t);var n=i.enc.Base64.parse(t.iv),r=t.value,o=i.enc.Base64.parse(a.APP_KEY.replace("base64:","")),s=i.AES.decrypt(r,o,{iv:n});return(s=s.toString(i.enc.Utf8))?JSON.parse(s):null}function m(e){var t=Math.round(Math.abs(Date.now()-e)/1e3);return t<59?"الآن":t/60<60?parseInt(t/60)+"د":t/3600<24?parseInt(t/3600)+"س":t/86400<30?parseInt(t/86400)+"ي":t/2592e3<12?parseInt(t/2592e3)+"ش":parseInt(t/31104e3)+"ع"}function h(e,t){return t?e&&e.show_chat_background_on_windows?e.chat_background?e.window_color+" url(/uploads/"+e.chat_background+")":e.window_color+" url(/images/main_background.png)":e.window_color:e&&e.show_chat_background?e.chat_background?e.background_color+" url(/uploads/"+e.chat_background+")":e.background_color+" url(/images/main_background.png)":e.background_color}function _(e){return e&&e.show_interface_background?e.interface_background?" url(/uploads/"+e.interface_background+")":" url(/images/interface_background.png)":"none"}function g(e,t){if(t){for(var n=document.getElementsByTagName("style"),r=0;r<n.length;r++);var o=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style"),a=".btn-primary { background-color: "+t.btn_color+"; }.btn-primary:hover, .btn-primary:disabled, .btn-primary:active { background-color: "+t.btn_color+"AA !important; }.border-color { border-color: "+t.border_color+" !important; }.react-tabs__tab { color: "+t.btn_color+" !important; }.color-primary { color: "+t.btn_color+" !important; }.users-count-label__right__arrow-left { border-right-color: "+t.btn_color+" !important; }.users-count-label__left__arrow-right { border-left-color: "+t.btn_color+" !important; }.users-count-label { background-color: "+v(t.btn_color,15)+" !important; }.label-primary { background-color: "+t.btn_color+"; }";i.type="text/css",i.styleSheet?i.styleSheet.cssText=a:i.appendChild(document.createTextNode(a)),o.appendChild(i)}}function v(e,t){var n=parseInt(e.substring(1,3),16),r=parseInt(e.substring(3,5),16),o=parseInt(e.substring(5,7),16);return n=parseInt(n*(100+t)/100),r=(r=parseInt(r*(100+t)/100))<255?r:255,o=(o=parseInt(o*(100+t)/100))<255?o:255,"#"+(1==(n=n<255?n:255).toString(16).length?"0"+n.toString(16):n.toString(16))+(1==r.toString(16).length?"0"+r.toString(16):r.toString(16))+(1==o.toString(16).length?"0"+o.toString(16):o.toString(16))}function y(){document.body.style.zoom="0.975";var e=document.documentElement.clientHeight/document.body.style.zoom,t=document.getElementById("mic-speakers"),n=t?t.clientHeight:0,o=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style"),a="#chat__body { height: calc("+e+"px - 38px); }#chat, #app { height: "+e+"px; }#user_profile { max-height: "+e+"px; }#chat__body__messages_container { height: calc("+e+"px - 32px - 40px - "+n+"px); }.user_profile__scroll_area { max-height: "+91*e/100+"px; }.reveal_names_body { height: "+65*e/100+"px; }";i.type="text/css",i.styleSheet?i.styleSheet.cssText=a:i.appendChild(document.createTextNode(a)),o.appendChild(i),r.a.scrollToBottom();var s=document.getElementById("chat_box__body");s&&(s.scrollTop=s.scrollHeight-s.clientHeight);var c=$(".winner-home").prop("clientHeight"),u=Math.round(O(50,c)),d=Math.round(O(40,c)),l=Math.round(O(28,c));if($(".winner-home .stack").css("border-width",u),$("#red-dice, #green-dice, #yellow-dice, #blue-dice").css("width",d).css("height",d),$(".player-room").css("gap",l),document.body.clientWidth<750){$(".ludo-board").css("width","100vw").css("height","100vw");var f=Math.round(O(17,c));$(".player").css("width",f).css("height",f)}else{$(".ludo-board").css("width","80vh").css("height","80vh");var p=Math.round(O(20,c));$(".player").css("width",p).css("height",p)}document.body.clientWidth>900?$("main").css("padding-top","10vh"):$("main").css("padding-top","0"),window.removeEventListener("resize",y),window.addEventListener("resize",y)}function b(e){try{var t=Intl.DateTimeFormat().resolvedOptions().timeZone;e=parseInt(e);var n=new Date(new Date((new Date).toLocaleString("en-US",{timeZone:t})).getTime()-e),r=n.getHours()>9?n.getHours():"0"+n.getHours(),o=n.getMinutes()>9?n.getMinutes():"0"+n.getMinutes(),i=n.getSeconds()>9?n.getSeconds():"0"+n.getSeconds();return!e||e<=0||n.getMinutes()<0||n.getSeconds()<0?null:r+":"+o+":"+i}catch(e){return null}}function w(){return location.host.replace("www.","")}function S(e,t){$.ajax({url:e,dataType:"text",type:"GET",complete:function(e){"function"==typeof t&&t.apply(this,[e.status])}})}function k(e,t){if(e<=1e4)return e;var n,r=[{value:1,symbol:""},{value:1e3,symbol:"k"},{value:1e6,symbol:"M"},{value:1e9,symbol:"G"},{value:1e12,symbol:"T"},{value:1e15,symbol:"P"},{value:1e18,symbol:"E"}];for(n=r.length-1;n>0&&!(e>=r[n].value);n--);return(e/r[n].value).toFixed(t).replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+r[n].symbol}function C(){return""}function E(e){var t=0;return function(e){return window.consumedData+=e,e<1024?e+" bytes":e<1048576?(e/1024).toFixed(3)+" KiB":e<1073741824?(e/1048576).toFixed(3)+" MiB":(e/1073741824).toFixed(3)+" GiB"}(function e(n){if(null!=n)switch(o(n)){case"number":t+=8;break;case"string":t+=2*n.length;break;case"boolean":t+=4;break;case"object":var r=Object.prototype.toString.call(n).slice(8,-1);if("Object"===r||"Array"===r)for(var i in n)n.hasOwnProperty(i)&&e(n[i]);else t+=2*n.toString().length}return t}(e))}function T(e){if(!e)return 0;var t=new Date,n=new Date(e),r=Math.abs(n-t),o=Math.ceil(r/864e5);return o>0&&(o-=1),o}function O(e,t){return(e/100*t).toFixed(2)}function P(e,t){e="string"==typeof e?e:"";var n=document.createElement("script");n.setAttribute("type","text/javascript"),t&&(n.id=t),n.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(n)}function A(e,t){e="string"==typeof e?e:"";var n=document.createElement("style");n.setAttribute("type","text/css"),t&&(n.id=t),n.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(n)}function R(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];clearTimeout(t),t=setTimeout((function(){e.apply(void 0,o)}),n)}}function M(e,t){if(e===t)return!0;if("object"!==o(e)||null===e||"object"!==o(t)||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var i=0,a=n;i<a.length;i++){var s=a[i];if(!r.includes(s)||!M(e[s],t[s]))return!1}return!0}function x(e){return e&&"number"==typeof e?Math.floor(e/2):-1}function U(e){var t=e.getBoundingClientRect(),n=document.body,r=document.documentElement,o=window.pageYOffset||r.scrollTop||n.scrollTop,i=window.pageXOffset||r.scrollLeft||n.scrollLeft,a=r.clientTop||n.clientTop||0,s=r.clientLeft||n.clientLeft||0,c=t.top+o-a,u=t.left+i-s;return{top:Math.round(c),left:Math.round(u)}}},function(e,t,n){"use strict";var r=n(7),o=n(25),i=n(42),a=n(6),s=n(15),c=n(22),u=n(70),d=n(35),l=n(39),f=n(2);function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var m=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,m;return t=e,m=[{key:"registerEvents",value:function(t){e.updateUsersCout(t),window.chatFooter.find("#chat__footer__menu__users_item").on("click",(function(n){"users"!=t.getState().currentPane&&(t.dispatch(Object(r.a)("users")),e.togglePane(t))})),window.chatFooter.find("#chat__footer__menu__conversations_item").on("click",(function(n){"conversations"!=t.getState().currentPane&&(t.dispatch(Object(r.a)("conversations")),e.togglePane(t))})),window.chatFooter.find("#chat__footer__menu__rooms_item").on("click",(function(n){"rooms"!=t.getState().currentPane&&(t.dispatch(Object(r.a)("rooms")),e.togglePane(t))})),window.chatFooter.find("#chat__footer__menu__wall_item").on("click",(function(n){"wall"!=t.getState().currentPane&&(t.dispatch(Object(r.a)("wall")),t.dispatch(Object(o.g)()),e.updateWallCout(t),e.togglePane(t))})),window.chatFooter.find("#chat__footer__menu__settings_item").on("click",(function(n){"settings"!=t.getState().currentPane&&(t.dispatch(Object(r.a)("settings")),e.togglePane(t))})),window.chatFooter.find("#chat__footer__menu__others").on("click",(function(n){"others"!=t.getState().currentPane&&(t.dispatch(Object(r.a)("others")),e.togglePane(t))}))}},{key:"togglePane",value:function(e,t,n){return n&&n.target&&"mic-speakers--item__modal--audio-gallery"==n.target.id?f.a.closeModals():(n&&n.target&&$(n.target).closest(".mic-speakers--item").length||f.a.closeModals(),$(".chat_pane").hide(),t?void 0:"users"==e.getState().currentPane?(window.usersPane.show(),Promise.resolve().then((function(){return s.a.setUsers(e)}))):"conversations"==e.getState().currentPane?(window.conversationsPane.show(),d.a.renderConversations(e)):"rooms"==e.getState().currentPane?(window.roomsPane.show(),a.a.setRooms(e)):"wall"==e.getState().currentPane?(window.wallPane.show(),c.a.setPosts(e)):"settings"==e.getState().currentPane?window.settingsPane.show():"ignored_users"==e.getState().currentPane?(window.ignoredUsersPane.show(),l.a.setUsers(e)):"live"==e.getState().currentPane?$("#chat__body__live-pane").show():"wall-creator"==e.getState().currentPane?(window.wallCreatorPane.show(),u.a.setPosts(e)):"audio-gallery"==e.getState().currentPane?window.audioGalleryPane.show():"others"==e.getState().currentPane?window.othersPane.show():void 0)}},{key:"updateUsersCout",value:function(e){window.chatFooter.find("#chat__footer__menu__users_item .count").text(e.getState().users.length-e.getState().ignoredUsers.length)}},{key:"updateConversationsCount",value:function(e){var t=e.getState().conversations.filter((function(e){return 0==e.seen})).length;t>0?(window.chatFooter.find("#chat__footer__menu__conversations_item").addClass("unread"),window.chatFooter.find("#chat__footer__menu__conversations_item .count").text(t)):(window.chatFooter.find("#chat__footer__menu__conversations_item").removeClass("unread"),window.chatFooter.find("#chat__footer__menu__conversations_item .count").text(0))}},{key:"updateRoomsCount",value:function(e){$("#chat__footer__menu__rooms_item .count").text(e.getState().rooms.length)}},{key:"updateWallCout",value:function(e){var t=e.getState().newPostsCount;t?window.chatFooter.find("#chat__footer__menu__wall_item").addClass("unread"):window.chatFooter.find("#chat__footer__menu__wall_item").removeClass("unread"),window.chatFooter.find("#chat__footer__menu__wall_item .count").text(t)}},{key:"updateNotificationsCount",value:function(e){if(window.chatFooter){var t=e.getState().newNotificationsCount;t?window.chatFooter.find("#chat__footer__menu__notifications_item").addClass("unread"):window.chatFooter.find("#chat__footer__menu__notifications_item").removeClass("unread"),window.chatFooter.find("#chat__footer__menu__notifications_item .count").text(t)}}},{key:"toggleTV",value:function(e){e.getState().settings.tv_box_enabled?window.chatFooter.find("#chat__footer__menu__tv_item").show():(window.chatFooter.find("#chat__footer__menu__tv_item").hide(),i.a.close(e))}},{key:"render",value:function(e){var t="<div id='chat__footer' style='background-color: "+e.getState().settings.btn_color+"'>";return t+="<ul id='chat__footer__menu'>",t+="<li id='chat__footer__menu__users_item' class='border border-color btn-primary chat__footer__menu__item' style='width: 12%;' >",t+="<span class='fa fa-user'></span><span class='count'>0</span>",t+="</li>",t+="<li id='chat__footer__menu__conversations_item' class='border border-color btn-primary chat__footer__menu__item' style='width: 21%;' >",t+="<span class='fa fa-comment'></span><span class='count'>0</span><span>خاص</span>",t+="</li>",t+="<li id='chat__footer__menu__rooms_item' class='border border-color btn-primary chat__footer__menu__item' style='width: 16%;' >",t+="<span class='fa fa-users'></span><span>الغرف</span>",t+="</li>",t+="<li id='chat__footer__menu__wall_item' class='border border-color btn-primary chat__footer__menu__item' style='width: 20%;' >",t+="<span class='fa fa-commenting'></span><span class='count'>0</span><span>الحائط</span>",t+="</li>",t+="<li id='chat__footer__menu__settings_item' class='border border-color btn-primary chat__footer__menu__item' style='width: 17%;' >",t+="<span class='fa fa-gear'></span><span>الضبط</span>",t+="</li>",t+="<li id='chat__footer__menu__others' class='border border-color btn-primary chat__footer__menu__item'>",t+="<span class='fa fa-star'></span>",t+="</li>",t+="</ul>",t+="</div>"}}],(n=null)&&p(t.prototype,n),m&&p(t,m),e}();t.a=m},function(e,t,n){"use strict";var r=n(12),o=n.n(r),i=n(52),a=n(0),s=n(24),c=n(37);function u(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){u(i,r,o,a,s,"next",e)}function s(e){u(i,r,o,a,s,"throw",e)}a(void 0)}))}}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,u,p,m,h,_,g,v,y,b;return t=e,n=null,r=[{key:"registerEvents",value:function(t){e.onMicButtonClicked(t),e.onMuteClicked(t),e.onMusicInputChange(t),e.playAudiosWhenDocuemntClicked(t),$(document).trigger("click")}},{key:"getConstraints",value:function(){return{echoCancellation:!0,noiseSuppression:!0}}},{key:"getIceServers",value:function(){return[{url:"stun:stun.chat-host.net:5349"},{url:"stun:stun.chat-host.net"},{url:"turn:turn.chat-host.net:5349",username:"gN3yO0cF0uM6mQ2yU4tY3lR9vQ3qA9uA",credential:"fE7lY5-oR5tU0-fE5qY1-oE1oL5-pA5pU0"},{url:"turn:turn.chat-host.net",username:"gN3yO0cF0uM6mQ2yU4tY3lR9vQ3qA9uA",credential:"fE7lY5-oR5tU0-fE5qY1-oE1oL5-pA5pU0"}]}},{key:"init",value:function(e){window.isMicSoundMuted=!1,window.isMicMuted=!1,window.musicProducerAudio=new Audio,window.MSProducers=[],window.MSConsumers=[]}},{key:"removeCurrentUserFromMic",value:function(t){var n=t.getState().mUser.room?t.getState().rooms.find((function(e){return e.id==t.getState().mUser.room.id})):null;if(n){var r=n.micUsers.find((function(e){return e.user_id==t.getState().mUser.id}));r&&e.leaveMic(t,r.micId,t.getState().mUser)}}},{key:"onMicButtonClicked",value:function(t){window.micSpeakers.find(".mic-speakers--item").unbind("click").on("click",(function(n){if(!$(this).hasClass("disabled")&&t.getState().mUser.room){var r=$(this).data("id"),o=t.getState().mUser.room?t.getState().rooms.find((function(e){return e.id==t.getState().mUser.room.id})):null;o&&(o.micUsers.find((function(e){return e.micId==r}))?e.openMicControls(t,r):e.requestMic(t,r))}}))}},{key:"setModalButtons",value:function(t,n){window.micSpeakers.find(".mic-speakers--item__modal").html("").hide();var r=!1,o=t.getState().mUser.room?t.getState().rooms.find((function(e){return e.id==t.getState().mUser.room.id})):null;if(o){var i=o.micUsers.find((function(e){return e.micId==n}));i&&i.user_id==t.getState().mUser.id&&(r=!0);var s=t.getState().users.find((function(e){return e.id==i.user_id})),u=window.micSpeakers.find(".mic-speakers--item[data-id='"+n+"'] .mic-speakers--item__modal");u.css("background",Object(a.u)(t.getState().settings,!1));var d=u.closest(".mic-speakers--item").attr("user-id");r?(u.append("<button id='mic-speakers--item__modal--leave-mic' class='border btn btn-primary'>ترك المايك</button>"),window.micSpeakers.find("#mic-speakers--item__modal--leave-mic").unbind("click").on("click",(function(r){e.leaveMic(t,n,d)}))):s&&t.getState().grantedSettings.stop_radio&&t.getState().mUser.power>s.power&&(u.append("<button id='mic-speakers--item__modal--pull-mic' class='border btn btn-primary'>سحب المايك</button>"),window.micSpeakers.find("#mic-speakers--item__modal--pull-mic").unbind("click").on("click",(function(r){e.pullMic(t,n,s.id)}))),r?(window.isMicMuted?u.append("<button id='mic-speakers--item__modal--mute-mic' class='border btn btn-primary'>تشغيل المايك</button>"):u.append("<button id='mic-speakers--item__modal--mute-mic' class='border btn btn-primary'>كتم المايك</button>"),window.micSpeakers.find("#mic-speakers--item__modal--mute-mic").unbind("click").on("click",(function(r){e.muteMic(t,n,d)}))):e.isMicMuted(n)?(u.append("<button id='mic-speakers--item__modal--mute' class='border btn btn-primary'>تشغيل الصوت</button>"),window.micSpeakers.find("#mic-speakers--item__modal--mute").unbind("click").on("click",(function(r){e.unmuteUser(t,n,!0)}))):(u.append("<button id='mic-speakers--item__modal--mute' class='border btn btn-primary'>كتم الصوت</button>"),window.micSpeakers.find("#mic-speakers--item__modal--mute").unbind("click").on("click",(function(r){e.muteUser(t,n,!0)}))),u.append("<button id='mic-speakers--item__modal--show-profile' class='border btn btn-primary'>فتح البروفايل</button>"),window.micSpeakers.find("#mic-speakers--item__modal--show-profile").unbind("click").on("click",(function(r){e.showProfile(t,n,d)})),r&&t.getState().mUser.reg_id&&t.getState().mUser.reg_id&&t.getState().features.FT_IS_AUDIO_GALLERY_ENABLED&&(u.append("<button id='mic-speakers--item__modal--audio-gallery' class='border btn btn-primary'>مكتبة الصوتيات</button>"),window.micSpeakers.find("#mic-speakers--item__modal--audio-gallery").unbind("click").on("click",(function(e){c.a.open(t)}))),r||(u.append('<div id="mic-speakers--item__modal--range"><input type="range" min="0" max="100" value="'+e.getVolume(t,n)+'" class="slider" id="mic-speakers--item__modal--range-input"></div>'),document.getElementById("mic-speakers--item__modal--range-input").oninput=function(){e.setVolume(t,n,this.value)}),u.show()}}},{key:"isMicMuted",value:function(e){var t=!1,n=window.MSConsumers.find((function(t){return t.micId==e}));return n&&(t=n.paused),t}},{key:"leaveMic",value:function(t,n,r){t.getState().socket.emit("req",Object(a.k)({type:"mic:leave",data:{micId:n}}),(function(e){"object"==l(e)&&!1===e.error&&i.a.leave(t,{user:t.getState().mUser.id,micId:n})})),e.closeModals()}},{key:"pullMic",value:function(t,n,r){t.getState().socket.emit("req",Object(a.k)({type:"mic:pull",data:{micId:n,userId:r}}),(function(e){if("string"==typeof e)return alert(e);"object"==l(e)&&!1===e.error&&i.a.pull(t,{by:t.getState().mUser.id,user:r,micId:n})})),e.closeModals()}},{key:"muteMic",value:function(t,n,r){window.isMicMuted=!window.isMicMuted,window.MSProducers.forEach((function(e){e.isMusical||(window.isMicMuted?e.pause():e.resume())})),e.setModalButtons(t,n)}},{key:"muteUser",value:function(t,n,r){window.MSConsumers.forEach((function(e){e.micId==n&&e.pause()})),r&&e.setModalButtons(t,n),e.updateMicMutedStyle(!0,n)}},{key:"unmuteUser",value:function(t,n,r){window.MSConsumers.forEach((function(e){e.micId==n&&e.resume()})),r&&e.setModalButtons(t,n),e.updateMicMutedStyle(!1,n)}},{key:"muteAllUsers",value:function(){window.MSConsumers.forEach((function(e){e.pause()})),e.updateMicMutedStyle(!0)}},{key:"unmuteAllUsers",value:function(){window.MSConsumers.forEach((function(e){e.resume()})),e.updateMicMutedStyle(!1)}},{key:"getVolume",value:function(e,t){return window["micAudio"+t]?100*window["micAudio"+t].volume:100}},{key:"setVolume",value:function(e,t,n){window["micAudio"+t]&&(window["micAudio"+t].volume=n/100)}},{key:"updateMicMutedStyle",value:function(e,t){if(t){var n=window.micSpeakers.find(".mic-speakers--item[data-id='"+t+"']");n&&(e?n.addClass("muted"):n.removeClass("muted"))}else window.micSpeakers.find(".mic-speakers--item").each((function(t,n){n&&(e?n.classList.add("muted"):n.classList.remove("muted"))}))}},{key:"showProfile",value:function(e,t,n){s.a.show(n,e)}},{key:"closeModals",value:function(){window.micSpeakers&&window.micSpeakers.find(".mic-speakers--item__modal").html("").hide()}},{key:"openMicControls",value:function(t,n){var r=window.micSpeakers.find(".mic-speakers--item[data-id='"+n+"'] .mic-speakers--item__modal");"block"!=r.css("display")&&(r.show(),e.setModalButtons(t,n))}},{key:"requestMic",value:function(t,n){t.getState().socket.emit("req",Object(a.k)({type:"mic:req",data:{micId:n,rtpCapabilities:MS.getRtpCapabilities()}}),(function(r){if("string"==typeof r)return alert(r);"object"==l(r)&&!1===r.error&&i.a.newSpeaker(t,{user:t.getState().mUser.id,micId:n,room:t.getState().mUser.room.id}),e.closeModals()}))}},{key:"setUserOnMic",value:function(e,t,n){t&&(window.micSpeakers.find(".mic-speakers--item[data-id='"+n+"']").addClass("is_speaking").attr("user-id",t.id),window.micSpeakers.find(".mic-speakers--item[data-id='"+n+"'] .mic-speakers--item__mic-wrapper").hide(),window.micSpeakers.find(".mic-speakers--item[data-id='"+n+"'] img").attr("src",t.avatar).show(),window.micSpeakers.find(".mic-speakers--item[data-id='"+n+"'] .mic-speakers--item__name").html(t.name).show(),t.id==e.getState().mUser.id&&window.micSpeakers.find(".mic-speakers--item[data-id='"+n+"']").removeClass("muted"))}},{key:"refreshMics",value:function(t){t.getState().mUser.room&&window.micSpeakers.find(".mic-speakers--item.is_speaking").each((function(n,r){var o=$(r).data("id"),i=t.getState().rooms.find((function(e){return e.id==t.getState().mUser.room.id}));if(i&&!i.micUsers.find((function(e){return e.micId==o}))){window.micSpeakers.find(".mic-speakers--item[data-id='"+o+"']").removeClass("is_speaking").removeAttr("user-id"),window.micSpeakers.find(".mic-speakers--item[data-id='"+o+"'] img").hide(),window.micSpeakers.find(".mic-speakers--item[data-id='"+o+"'] img, .mic-speakers--item[data-id='"+o+"'] .mic-speakers--item__name, .mic-speakers--item[data-id='"+o+"'] .mic-speakers--item__modal").hide(),window.micSpeakers.find(".mic-speakers--item[data-id='"+o+"'] .mic-speakers--item__mic-wrapper").show(),window.isMicSoundMuted||e.updateMicMutedStyle(!1,o),window.MSConsumers.forEach((function(e){e.micId==o&&e.close()})),window.MSConsumers=window.MSConsumers.filter((function(e){return e.micId!=o}));try{window["micAudio"+o].srcObject&&(delete window["micAudio"+o].srcObject,window["micAudio"+o].volume=1),window["playerMicAudio"+o].srcObject&&delete window["playerMicAudio"+o].srcObject}catch(e){}}}))}},{key:"removeUnoUserFromMic",value:function(e,t,n){t.id==e.getState().mUser.id?window.MSProducerTransport&&window.MSProducerTransport.close():(window.MSConsumers.forEach((function(e){e.micId==n&&e.close()})),window.MSConsumers=window.MSConsumers.filter((function(e){return e.micId!=n})));try{window["unoMicAudio"+n].srcObject&&delete window["unoMicAudio"+n].srcObject}catch(e){}}},{key:"removeUserFromMic",value:function(t,n,r){if(n.room){var o=t.getState().rooms.find((function(e){return e.id==n.room.id}));if(o){var i=o.micUsers.find((function(e){return e.user_id==n.id}));if(i){o.micUsers=o.micUsers.filter((function(e){return e.user_id!=n.id})),window.micSpeakers.find(".mic-speakers--item[data-id='"+i.micId+"']").removeClass("is_speaking").removeAttr("user-id"),window.micSpeakers.find(".mic-speakers--item[data-id='"+i.micId+"'] img").attr("src",n.avatar).hide(),window.micSpeakers.find(".mic-speakers--item[data-id='"+i.micId+"'] img, .mic-speakers--item[data-id='"+i.micId+"'] .mic-speakers--item__name, .mic-speakers--item[data-id='"+i.micId+"'] .mic-speakers--item__modal").hide(),window.micSpeakers.find(".mic-speakers--item[data-id='"+i.micId+"'] .mic-speakers--item__mic-wrapper").show(),window.isMicSoundMuted||e.updateMicMutedStyle(!1,i.micId),n.id==t.getState().mUser.id?(window.musicProducerAudio&&window.musicProducerAudio.pause(),window.MSProducerTransport&&window.MSProducerTransport.close()):(window.MSConsumers.forEach((function(e){e.micId==i.micId&&e.close()})),window.MSConsumers=window.MSConsumers.filter((function(e){return e.micId!=i.micId})));try{window["micAudio"+i.micId].srcObject&&(delete window["micAudio"+i.micId].srcObject,window["micAudio"+i.micId].volume=1),window["playerMicAudio"+i.micId].srcObject&&delete window["playerMicAudio"+i.micId].srcObject}catch(e){}}}}}},{key:"closeCallAndStream",value:function(e){}},{key:"resetAllMics",value:function(){window.micSpeakers.find(".mic-speakers--item").removeClass("is_speaking"),window.micSpeakers.find(".mic-speakers--item img, .mic-speakers--item__name, .mic-speakers--item__modal").hide(),window.micSpeakers.find(".mic-speakers--item .mic-speakers--item__mic-wrapper").show(),e.updateMicMutedStyle(!1,void 0)}},{key:"askForPlayingAudio",value:function(e,t){}},{key:"destroySession",value:function(){window.MSProducerTransport&&window.MSProducerTransport.close(),window.MSProducers.forEach((function(e){e.close()}))}},{key:"disableMicButtons",value:function(){window.micSpeakers.find(".mic-speakers--item").addClass("disabled")}},{key:"enableMicButtons",value:function(){window.micSpeakers.find(".mic-speakers--item").removeClass("disabled")}},{key:"getMicIDFromUserID",value:function(e,t){var n=e.getState().mUser.room?e.getState().rooms.find((function(t){return t.id==e.getState().mUser.room.id})):null;if(n){var r=n.micUsers.find((function(e){return e.user_id==t}));return r?r.micId:null}}},{key:"playStream",value:function(t,n,r){if(r){var o=window["micAudio"+r];if(t.unoGame&&((o=t["unoMicAudio"+r]).muted=!1),o||(o=new Audio),"srcObject"in o)try{o.srcObject=n}catch(e){if("TypeError"!=e.name)throw e;o.src=URL.createObjectURL(n)}else o.src=URL.createObjectURL(n);o.onloadedmetadata=function(t){e.playAudio(r,o),e.isSafari()&&(o.muted=!1),o.muted=!1},e.playAudio(r,o)}}},{key:"playAudio",value:function(t,n){if(t&&n&&n.paused){var r=n.play();r&&r.then((function(){})).catch((function(n){e.askForPlayingAudio(store,t)}))}}},{key:"playPlayerStream",value:function(t,n,r){if(r){var o=window["playerMicAudio"+r];if(o||(o=new Audio),o||(o=new Audio),"srcObject"in o)try{o.srcObject=n}catch(e){if("TypeError"!=e.name)throw e;o.src=URL.createObjectURL(n)}else o.src=URL.createObjectURL(n);o.onloadedmetadata=function(n){e.playPlayerAudio(t,r,o),e.isSafari()&&(o.muted=!1),o.muted=!1},e.playPlayerAudio(t,r,o)}}},{key:"playPlayerAudio",value:function(t,n,r){if(n&&r&&r.paused){var o=r.play();o&&o.then((function(){})).catch((function(r){e.askForPlayingAudio(t,n)}))}}},{key:"playVisualizer",value:function(e,t){var n=window.AudioContext||window.webkitAudioContext||!1;if(n){var r,o=window.micSpeakers.find("#mic-speakers--item-"+t),i=new n,a=i.createAnalyser(),s=i.createMediaStreamSource(e),c=i.createGain();c.connect(i.destination),c.gain.setValueAtTime(0,i.currentTime),s.connect(a),a.connect(i.destination),r=new Uint8Array(a.frequencyBinCount),requestAnimationFrame((function e(){a.getByteFrequencyData(r),r[2]&&r[2]>=20?o.addClass("ripple"):o.removeClass("ripple"),requestAnimationFrame(e)}))}}},{key:"addMicAudios",value:function(e){if(e.getState().mUser.room){var t=e.getState().rooms.find((function(t){return t.id==e.getState().mUser.room.id}));t&&t.mics.forEach((function(e){e.is_locked||(window["micAudio"+e.id]=new Audio,window["playerMicAudio"+e.id]=new Audio)}))}}},{key:"addMicItem",value:function(t,n){var r=window.micSpeakers.find("#mic-speakers--mute").hasClass("muted")?"muted":"";window.micSpeakers.append("<span id='mic-speakers--item-"+n+"' class='mic-speakers--item "+r+"' data-id='"+n+"'><img class='mic-speakers--item__avatar' /><span class='mic-speakers--item__name ellipsis'></span><div class='mic-speakers--item__modal'></div><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-microphone'></span></span></span>").show(),window["micAudio"+n]=new Audio,window["playerMicAudio"+n]=new Audio,e.registerEvents(t)}},{key:"removeMicItem",value:function(t,n,r){window.micSpeakers.find("#mic-speakers--item-"+n).remove(),delete window["micAudio"+n],delete window["playerMicAudio"+n];var o=r.micUsers.find((function(e){return e.micId==n}));o&&o.user_id==t.getState().mUser.id&&e.leaveMic(t,n,t.getState().mUser)}},{key:"isSafari",value:function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}},{key:"onMuteClicked",value:function(t){var n=window.micSpeakers.find("#mic-speakers--mute");n&&n.unbind("click").on("click",(function(t){n.toggleClass("muted"),window.isMicSoundMuted?(e.unmuteAllUsers(),window.isMicSoundMuted=!1,n.removeClass("muted")):(window.isMicSoundMuted=!0,e.muteAllUsers(),n.addClass("muted"))}))}},{key:"getRndInteger",value:function(e,t){return Math.floor(Math.random()*(t-e+1))+e}},{key:"removeNoiseFromStream",value:function(e){try{var t=new AudioContext,n=t.createGain(),r=t.createMediaStreamSource(e),o=t.createMediaStreamDestination();r.connect(n),n.connect(o),n.gain.value=1}catch(e){}}},{key:"removeNoiseFromStream2",value:function(e){try{var t=new AudioContext,n=t.createMediaStreamSource(e),r=t.createScriptProcessor(2048,1,1),o=t.createBiquadFilter();o.type="highpass",o.frequency.value=500,n.connect(o),o.connect(r),r.connect(t.destination),r.onaudioprocess=function(e){for(var t=e.inputBuffer,n=e.outputBuffer,r=0;r<t.numberOfChannels;r++)for(var o=t.getChannelData(r),i=n.getChannelData(r),a=0;a<t.length;a++)i[a]=o[a]}}catch(e){}}},{key:"getUserMediaStream",value:(b=d(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(window.MSDevice.canProduce("audio")){t.next=2;break}return t.abrupt("return",null);case 2:return n=null,t.prev=3,t.next=6,navigator.mediaDevices.getUserMedia({audio:e.getConstraints()});case 6:n=t.sent,t.next=11;break;case 9:t.prev=9,t.t0=t.catch(3);case 11:return t.abrupt("return",n);case 12:case"end":return t.stop()}}),t,null,[[3,9]])}))),function(){return b.apply(this,arguments)})},{key:"msOnConnect",value:function(e,t,n,r){e.getState().socket.emit("req",Object(a.k)({type:"mic:connect",data:{dtlsParameters:t,transportId:n,isSender:r}}),(function(e){}))}},{key:"msOnProduce",value:function(e,t,n,r,o){e.getState().socket.emit("req",Object(a.k)({type:"mic:produce",data:{kind:t,rtpParameters:n,transportId:r,micId:o}}),(function(e){}))}},{key:"msSubscribe",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.getState().socket.emit("req",Object(a.k)({type:"mic:subscribe",data:{micId:t,forceClose:n}}),(function(e){}))}},{key:"msResume",value:function(e){e.getState().socket.emit("req",Object(a.k)({type:"mic:resume",data:{}}),(function(e){}))}},{key:"msCloseProducer",value:function(e){e.getState().socket.emit("req",Object(a.k)({type:"mic:close",data:{}}),(function(e){}))}},{key:"msProduce",value:(y=d(o.a.mark((function t(n,r){var i,a,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getUserMediaStream();case 2:if(i=t.sent){t.next=5;break}return t.abrupt("return");case 5:if(a=i.getAudioTracks()[0]){t.next=8;break}return t.abrupt("return");case 8:return t.next=10,window.MSProducerTransport.produce({track:a});case 10:(s=t.sent).isMusical=!1,s.on("transportclose",(function(){window.MSProducers=window.MSProducers.filter((function(e){return e.id!=s.id})),delete window.MSProducerTransport})),s.on("close",(function(){window.MSProducers=window.MSProducers.filter((function(e){return e.id!=s.id}))})),window.MSProducers.push(s);case 15:case"end":return t.stop()}}),t)}))),function(e,t){return y.apply(this,arguments)})},{key:"triggerMusicInput",value:function(){window.micSpeakers.find("#mic-speakers--input").trigger("click")}},{key:"onMusicInputChange",value:function(t){window.micSpeakers.find("#mic-speakers--input").unbind("change").on("change",(function(n){e.msProduceMediaFromLocalStorage(t,e.getMicIDFromUserID(t,t.getState().mUser.id),n.target.files[0])}))}},{key:"playAudiosWhenDocuemntClicked",value:function(e){document.addEventListener("click",(function(t){if(e.getState().mUser.room){var n=e.getState().rooms.find((function(t){return t.id==e.getState().mUser.room.id}));n&&n.mics.forEach((function(e){window["micAudio"+e.id]&&window["micAudio"+e.id].paused&&window["micAudio"+e.id].play(),window["playerMicAudio"+e.id]&&window["playerMicAudio"+e.id].paused&&window["playerMicAudio"+e.id].play()}))}}))}},{key:"msProduceMediaFromLocalStorage",value:(v=d(o.a.mark((function t(n,r,i){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(window.MSProducerTransport){t.next=2;break}return t.abrupt("return");case 2:window.musicProducerAudio.src=URL.createObjectURL(i),window.musicProducerAudio.micId||window.musicProducerAudio.addEventListener("loadeddata",e.musicProducerAudioLoadedDataListener),window.musicProducerAudio.play(),window.musicProducerAudio.micId=r,window.micSpeakers.find("#mic-speakers--item__modal--play-music").attr("disabled","disabled");case 7:case"end":return t.stop()}}),t)}))),function(e,t,n){return v.apply(this,arguments)})},{key:"msStopProduceMediaFromLocalStorage",value:function(t,n){var r=null;window.MSProducers.forEach((function(e){e.isMusical&&(r=e.id,e.close())})),window.musicProducerAudio.pause(),e.setModalButtons(t,n),r&&t.getState().socket.emit("req",Object(a.k)({type:"mic:producer:close",data:{producerId:r}}),(function(e){}))}},{key:"msProduceMediaFromGallery",value:(g=d(o.a.mark((function t(n,r){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(window.MSProducerTransport){t.next=2;break}return t.abrupt("return",r.play());case 2:r.micId||r.addEventListener("loadeddata",e.musicProducerAudioLoadedDataListener),r.play(),r.micId=e.getMicIDFromUserID(n,n.getState().mUser.id);case 5:case"end":return t.stop()}}),t)}))),function(e,t){return g.apply(this,arguments)})},{key:"musicProducerAudioLoadedDataListener",value:(_=d(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(window.audioGalleryElement.readyState>=2)){e.next=9;break}return t=window.audioGalleryElement.captureStream().getAudioTracks()[0],e.next=4,window.MSProducerTransport.produce({track:t});case 4:(n=e.sent).isMusical=!0,n.on("transportclose",(function(){window.MSProducers=window.MSProducers.filter((function(e){return e.id!=n.id}))})),n.observer.on("close",(function(){window.MSProducers=window.MSProducers.filter((function(e){return e.id!=n.id}))})),window.MSProducers.push(n);case 9:case"end":return e.stop()}}),e)}))),function(){return _.apply(this,arguments)})},{key:"isProducingMedia",value:function(e){return window.MSProducers.find((function(e){return e.isMusical}))}},{key:"updateMediaVolume",value:function(t,n){if(!(!window.MSProducers||n>1||n<0)){var r=window.MSProducers.find((function(e){return e.isMusical}));r&&t.getState().socket.emit("req",Object(a.k)({type:"mic:media:volume",data:{volume:n,micId:e.getMicIDFromUserID(t,t.getState().mUser.id),producerId:r.id}}),(function(e){}))}}},{key:"setMediaVolume",value:(h=d(o.a.mark((function e(t,n,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window["playerMicAudio"+r]&&(window["playerMicAudio"+r].volume=n);case 1:case"end":return e.stop()}}),e)}))),function(e,t,n){return h.apply(this,arguments)})},{key:"msConsume",value:(m=d(o.a.mark((function t(n,r){var i,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.MSConsumers||!window.MSConsumers.find((function(e){return e.producerId==r.producerId}))){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,window.MSConsumerTransport.consume({producerId:r.producerId,id:r.id,kind:r.kind,rtpParameters:r.rtpParameters,codecOptions:{}});case 4:(i=t.sent).micId=r.micId,i.on("transportclose",(function(){delete window.MSConsumerTransport,window.MSConsumers=window.MSConsumers.filter((function(e){return e.id!=i.id}))})),i.observer.on("close",(function(){window.MSConsumers=window.MSConsumers.filter((function(e){return e.id!=i.id}))})),(window.isMicSoundMuted||e.isMicMuted(r.micId))&&i.pause(),window.MSConsumers.push(i),(a=new MediaStream).addTrack(i.track),window["micAudio"+r.micId]&&window["micAudio"+r.micId].srcObject&&window["micAudio"+r.micId].srcObject.active?e.playPlayerStream(n,a,r.micId):e.playStream(n,a,r.micId);case 13:case"end":return t.stop()}}),t)}))),function(e,t){return m.apply(this,arguments)})},{key:"consumeProducer",value:(p=d(o.a.mark((function t(n,r,i){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.getMicIDFromUserID(n,n.getState().mUser.id)!=i){t.next=2;break}return t.abrupt("return");case 2:n.getState().socket.emit("req",Object(a.k)({type:"mic:consume",data:{producerId:r,micId:i,rtpCapabilities:MS.getRtpCapabilities()}}),(function(e){}));case 3:case"end":return t.stop()}}),t)}))),function(e,t,n){return p.apply(this,arguments)})},{key:"msCreateTransport",value:(u=d(o.a.mark((function t(n,r){var i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r.isSender?(r.params.codecOptions={opusStereo:!0,opusDtx:!0,opusFec:!0,opusNack:!0},(i=window.MSDevice.createSendTransport(r.params)).on("produce",(function(t,o,a){var s=t.kind,c=t.rtpParameters;e.msOnProduce(n,s,c,i.id,r.micId),window.transportProduceCallback=o})),window.MSProducerTransport=i):(r.params.iceServers=e.getIceServers(),i=window.MSDevice.createRecvTransport(r.params),window.MSConsumerTransport=i),i.on("connect",(function(t,o,a){var s=t.dtlsParameters;r.dtlsParameters=s,e.msOnConnect(n,s,i.id,r.isSender),window.transportConnectCallback=o})),i.on("connectionstatechange",(function(t){switch(t){case"connecting":break;case"connected":r.isSender;break;case"disconnected":n.getState().socket.emit("req",Object(a.k)({type:"mic:transport:close",data:{}}),(function(e){})),e.onTransportDisconnected(n,r);case"failed":i.close()}})),i.observer.on("close",(function(){})),r.isSender?e.msProduce(n,i):n.getState().socket.emit("req",Object(a.k)({type:"mic:consume",data:{rtpCapabilities:MS.getRtpCapabilities()}}),(function(e){}));case 5:case"end":return t.stop()}}),t)}))),function(e,t){return u.apply(this,arguments)})},{key:"onTransportDisconnected",value:function(t,n){var r=!1,o=setInterval((function(){t.getState().socket.emit("req",Object(a.k)({type:"ping",data:{}}),(function(i){r||(e.reSubscribeAfterConnectionRestored(t,n),r=!0,clearInterval(o))}))}),2e3)}},{key:"reSubscribeAfterConnectionRestored",value:function(t,n){var r=null;r=n.isSender?setInterval(d(o.a.mark((function n(){var i;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:window.MSProducerTransport&&window.MSProducerTransport.connectionState?clearInterval(r):(i=e.getMicIDFromUserID(t,t.getState().mUser.id),t.getState().socket.connected&&i&&(e.msSubscribe(t,i,!0),e.msSubscribe(t,null,!0),clearInterval(r)));case 2:case"end":return n.stop()}}),n)}))),2e3):setInterval((function(){window.MSConsumerTransport&&window.MSConsumerTransport.connectionState?clearInterval(r):t.getState().socket.connected&&(setTimeout((function(){e.msSubscribe(t,null,!0)}),2e3),clearInterval(r))}),2e3)}},{key:"closeMusicalProducer",value:function(e){var t=window.MSProducers.find((function(e){return e.isMusical}));t&&t.close()}},{key:"closeAllProducers",value:function(e){window.MSProducers.forEach((function(e){e.close()}))}},{key:"closeConsumerTransport",value:function(e){window.MSConsumerTransport&&(window.MSConsumerTransport.close(),delete window.MSConsumerTransport)}},{key:"resetMS",value:function(e){window.MSConsumerTransport&&window.MSConsumerTransport.close(),window.MSProducerTransport&&window.MSProducerTransport.close()}},{key:"setMics",value:function(t){if(e.resetMS(t),e.removeCurrentUserFromMic(t),!t.getState().mUser.room)return e.closeConsumerTransport(t),window.micSpeakers.find(".mic-speakers--item").remove(),window.micSpeakers.hide(),Object(a.q)();var n=t.getState().rooms.find((function(e){return e.id==t.getState().mUser.room.id}));if(!n||!n.mics||!n.mics.length)return e.closeConsumerTransport(t),window.micSpeakers.find(".mic-speakers--item").remove(),window.micSpeakers.hide(),Object(a.q)();window.micSpeakers.find(".mic-speakers--item").remove();var r=t.getState().settings.mic_icon?"has-bg":"",o=t.getState().settings.mic_icon?"style='background: url(/uploads/"+t.getState().settings.mic_icon+") no-repeat center center / cover;'":"";n.mics.forEach((function(e){window.micSpeakers.append("<span "+o+" id='mic-speakers--item-"+e.id+"' class='mic-speakers--item "+r+"' data-id='"+e.id+"'><img class='mic-speakers--item__avatar' /><span class='mic-speakers--item__name ellipsis'></span><div class='mic-speakers--item__modal'></div><span class='mic-speakers--item__mic-wrapper'><span class='fa fa-microphone'></span></span></span>")})),e.addMicAudios(t),window.micSpeakers.show(),e.msSubscribe(t),n.micUsers.forEach((function(n){var r=t.getState().users.find((function(e){return e.id==n.user_id}));e.setUserOnMic(t,r,n.micId)})),e.registerEvents(t),Object(a.q)()}},{key:"initMic",value:function(e){null!=window.MS&&e&&(window.MSDevice?window.routerRtpCapabilities=JSON.parse(e):MS.init(JSON.parse(e)))}},{key:"render",value:function(t){t.getState().features.FT_IS_STORIES_ENABLED&&(e.init(t),$("#chat__body").prepend("<div id='mic-speakers'><span id='mic-speakers--mute'><span class='fa fa-volume-up'></span><span class='fa fa-volume-off'></span></span><input id='mic-speakers--input' accept='audio/*' type='file' style='display: none; left: -500000px; position: absolute' /></div>"),window.micSpeakers=$("#mic-speakers"),e.setMics(t),e.addMicAudios(t),e.registerEvents(t))}}],n&&f(t.prototype,n),r&&f(t,r),e}();t.a=p},function(e,t,n){"use strict";var r=n(5),o=n(21),i=n(4),a=n(9),s=n(0),c=n(28);function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,d;return t=e,d=[{key:"registerEvents",value:function(t){e.close(t),e.acceptLudo(t),e.refuseLudo(t),e.acceptUno(t),e.refuseUno(t),e.trustUser(t)}},{key:"close",value:function(e){$(".popup").unbind("click").on("click",(function(t){var n=$(this).data("id"),r=e.getState().popups.filter((function(e){return e.id=n}));e.dispatch(Object(i.b)(r)),$(this).remove()}))}},{key:"trustUser",value:function(e){$(".popup__message__body__trust_user").unbind("click").on("click",(function(t){var n=this;t.stopPropagation(),e.getState().socket.emit("req",Object(s.k)({type:"TRUST_USER",data:{id:$(this).data("user-id"),name:$(this).data("user-name"),decoration:$(this).data("user-decoration")}}),(function(t){if(t=Object(s.g)(t),$(n).closest(".popup").click(),"string"==typeof t)return alert(t);if(t&&t.message&&alert(t.message),!t.error){var r=$(n).data("user-id");e.dispatch(Object(i.c)(r))}}))}))}},{key:"acceptLudo",value:function(e){$(".popup__request_ludo_accept").unbind("click").on("click",(function(t){var n=this;t.stopPropagation(),e.getState().socket.emit("req",Object(s.k)({type:"YOUCAM_LUDO_REQUEST_ACCEPT",data:{id:$(this).data("user-id"),color:$(this).data("color")}}),(function(e){if(e=Object(s.g)(e),$(n).closest(".popup").click(),"string"==typeof e)return alert(e);e&&e.message&&alert(e.message)}))}))}},{key:"refuseLudo",value:function(e){$(".popup__request_ludo_refuse").unbind("click").on("click",(function(t){var n=this;t.stopPropagation(),e.getState().socket.emit("req",Object(s.k)({type:"YOUCAM_LUDO_REQUEST_REFUSE",data:{id:$(this).data("user-id"),color:$(this).data("color")}}),(function(e){if(e=Object(s.g)(e),$(n).closest(".popup").click(),"string"==typeof e)return alert(e);e&&e.message&&alert(e.message)}))}))}},{key:"acceptUno",value:function(e){$(".popup__request_uno_accept").unbind("click").on("click",(function(t){var n=this;t.stopPropagation(),c.a.initSounds(e),e.getState().socket.emit("req",Object(s.k)({type:"YOUCAM_UNO_REQUEST_ACCEPT",data:{id:$(this).data("user-id"),number:$(this).data("number")}}),(function(e){if(e=Object(s.g)(e),$(n).closest(".popup").click(),"string"==typeof e)return alert(e);e&&e.message&&alert(e.message)}))}))}},{key:"refuseUno",value:function(e){$(".popup__request_uno_refuse").unbind("click").on("click",(function(t){var n=this;t.stopPropagation(),e.getState().socket.emit("req",Object(s.k)({type:"YOUCAM_UNO_REQUEST_REFUSE",data:{id:$(this).data("user-id"),number:$(this).data("number")}}),(function(e){if(e=Object(s.g)(e),$(n).closest(".popup").click(),"string"==typeof e)return alert(e);e&&e.message&&alert(e.message)}))}))}},{key:"getMarginLeft",value:function(e){return 2*e.getState().popups.length+30+"px"}},{key:"renderMessage",value:function(e,t){switch(e.type){case"like":return"<span>حصلت على إعجاب<span style='color: red' class='fa fa-heart'></span></span>";case"gift":return"<span>حصلت على هدية<img src='"+e.message+"' class='gifts_picker__contianer__img' alt=''/></span>";case"remove_gift":return"<span>تم سحب هديتك<img src='"+e.message+"' class='gifts_picker__contianer__img' alt=''/></span>";case"room_excpel":case"change_room":return"<p dir='rtl'>"+e.message+" <span>"+o.a.render(e.room,!0,t)+"</span></p>";case"post_comment_like":case"post_commented":return"<p dir='rtl'>"+e.message+" <span><p class='popup__message__body'>"+e.comment+"</p></span></p>";case"login_banned":var n="<p>"+e.data.name+" ---- "+e.data.decoration+"</p>";return n+="<p>"+e.data.role+"</p>",n+="<p>"+e.data.ip+" <img src='/images/flags/"+e.data.country.toLowerCase()+".png' /></p>",n+="<p dir='rtl'>"+e.data.device+"</p>",e.data.isGuest||e.data.is_trusted||(n+="<p style='text-align: center'><button data-user-name='"+e.data.name+"' data-user-decoration='"+e.data.decoration+"' data-user-id='"+e.data.user_id+"' class='popup__message__body__trust_user btn btn-success'>توثيق العضوية</button></p>"),n;case"world_filter_notification":return"<p dir='rtl'>"+e.word.word+" <span><p class='popup__message__body'>"+e.word.text+"</p></span></p>";case"ludo_request":var r="<span>هذا المستخدم طلب منك المشاركة في لعبة اللودو</span>";return r+="<p style='text-align: center'><button data-color='"+e.color+"' data-user-id='"+e.user.id+"' class='popup__request_ludo_accept btn btn-success'>موافقة</button><button data-color='"+e.color+"' data-user-id='"+e.user.id+"' class='popup__request_ludo_refuse btn btn-danger'>رفض</button></p>";case"ludo_request_accepted":return"<span>قام بقبول طلب اللعب</span>";case"ludo_request_refused":return"<span>قام برفض طلب اللعب</span>";case"ludo_ended":return"<span>قام بإنهاء اللعبة</span>";case"uno_request":var i="<span>هذا المستخدم طلب منك المشاركة في لعبة أونو</span>";return i+="<p style='text-align: center'><button data-number='"+e.number+"' data-user-id='"+e.user.id+"' class='popup__request_uno_accept btn btn-success'>موافقة</button><button data-number='"+e.number+"' data-user-id='"+e.user.id+"' class='popup__request_uno_refuse btn btn-danger'>رفض</button></p>";case"uno_request_accepted":return"<span>قام بقبول طلب اللعب</span>";case"uno_request_refused":return"<span>قام برفض طلب اللعب</span>";case"uno_ended":return"<span>قام بإنهاء اللعبة</span>";case"photo_like":return;default:return"<span>"+a.a.render(e.message,t)+"</span>"}}},{key:"render",value:function(t,n,o){var i="<div style='marginLeft: "+e.getMarginLeft(n)+"' data-id='"+t.id+"' class='popup'>";i+="<p class='popup__title label label-primary'>"+t.title+"</p>",t.user&&(i+="<div class='popup__sender fl'>",i+="<img src='"+t.user.avatar+"' width='24' height='24' class='popup__sender__avatar fl' />",i+="<p class='popup__sender__name'>"+r.a.render(t.user)+"</p>",i+="</div>"),i+="<div class='popup__message fl'>",i+=e.renderMessage(t,n),i+="</div>",i+="</div>",$("#popup_container").append(i),n.getState().features.FT_AUTO_HIDE_POPUPS&&!o&&setTimeout((function(){$("#popup_container .popup[data-id='"+t.id+"']").remove()}),5e3),e.registerEvents(n)}}],(n=null)&&u(t.prototype,n),d&&u(t,d),e}();t.a=d},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i}));var r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"REMOVE_POPUP",popup:e}},o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"ADD_POPUP",popup:e}},i=function(e){return{type:"TRUST_USER_POPUP",user_id:e}}},function(e,t,n){"use strict";var r=n(0);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"render",value:function(e){var t="<span class='username'>";return t+=e.icon?"<img src='"+Object(r.e)()+e.icon+"?v=1' class='username__icon fl' alt='' style='max-height: 16px' />":"",t+="<span class='username__wrapper' style='background-color: "+e.nameBgColor+"; color: "+e.nameColor+"'>"+e.name+"</span>",t+="</span>"}}],(n=null)&&o(t.prototype,n),i&&o(t,i),e}();t.a=i},function(e,t,n){"use strict";var r=n(0),o=n(14),i=n(21),a=n(1);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"registerEvents",value:function(t){e.createRoom(t),e.onPermanentRoomToggle(t)}},{key:"onPermanentRoomToggle",value:function(e){$("#room_modal__body__checkbox").unbind("change").on("change",(function(e){e.target.checked?$("#mics_count_holder").show():$("#mics_count_holder").hide()}))}},{key:"createRoom",value:function(t){$("#createRomModal form").on("submit",(function(n){n.preventDefault();var o=n.target.name.value.trim(),i=n.target.description.value.trim(),a=n.target.welcome.value.trim(),c=isNaN(parseInt(n.target.required_likes.value))?0:parseInt(n.target.required_likes.value),u=isNaN(parseInt(n.target.mics_count.value))?0:parseInt(n.target.mics_count.value),d=n.target.password.value.trim(),l=isNaN(parseInt(n.target.capacity.value))?0:parseInt(n.target.capacity.value),f=n.target.permanent.checked;return o.length?o.length<2?e.showErrorMessage("إسم الغرفة لا يجب أن يقل عن حرفين"):t.getState().rooms.filter((function(e){return e.name==o})).length?e.showErrorMessage("هذه الغرفة موجودة, الرجاء إختيار إسم آخر"):l<2||l>50?e.showErrorMessage("حجم الغرفة يجب أن يتراوح بين 2 إلى 50"):void t.getState().socket.emit("req",Object(r.k)({type:"CREATE_ROOM",data:{room:{name:o,description:i,welcome:a,password:d,required_likes:c,mics_count:u,capacity:l,isPermanent:f,is_voice_room:!1}}}),(function(t){if("string"==typeof(t=Object(r.g)(t)))return alert(t);t&&"object"==s(t)&&(!1===t.error?e.showSuccessMessage("تم إنشاء الغرفة بنجاح"):!0===t.error&&e.showErrorMessage(t.message))})):e.showErrorMessage("الرجاء إعطاء إسم للغرفة")}))}},{key:"showErrorMessage",value:function(e){$("#createRomModal .alert-success").hide(),$("#createRomModal .alert-danger").text(e).show()}},{key:"showSuccessMessage",value:function(e){$("#createRomModal .alert-success").text(e).show(),$("#createRomModal .alert-danger").hide()}},{key:"render",value:function(t){$("#createRomModal form").unbind("submit"),$("#create_room_container").html("<div class='modal fade room_modal' id='createRomModal' tabindex='-1' role='dialog' aria-hidden='true'><div class='modal-dialog' role='document'><div class='modal-content'><div class='room_modal__header modal-header label label-primary'><div class='modal-title'><p class='room_modal__header__name ellipsis'>إنشاء غرفة جديدة</p><button data-dismiss='modal' class='btn btn-danger room_modal__header__close fa fa-times'></button></div></div><div class='room_modal__body modal-body'><p class='alert alert-danger' style='display: none'></p><p class='alert alert-success' style='display: none'></p><form id='room_modal__body__form'><div><div><input type='text' name='name' placeholder='عنوان الغرفة' /></div><div><input type='text' name='description' placeholder='الوصف' /></div><div><input type='text' name='welcome' placeholder='رسالة الترحيب' /></div><div><input type='text' name='password' placeholder='كلمة المرور' /></div><div><input type='number' name='required_likes' placeholder='لايكات الدخول' /></div><div id='mics_count_holder' style='display: none;'><input autocomplete='off' type='number' min='0' max='7' name='mics_count' placeholder='عدد المايكات' /></div><div><input type='number' name='capacity' value='50' placeholder='حجم الغرفة من 2 إلى 50' /></div><div><input type='checkbox' name='permanent' id='room_modal__body__checkbox' /><label for='room_modal__body__checkbox'>تثبيت الغرفة</label></div><button class='btn btn-success'><span class='fa fa-plus'></span>إنشاء الغرفة&nbsp;</button></div></form></div></div></div></div>"),e.registerEvents(t)}}],(n=null)&&c(t.prototype,n),o&&c(t,o),e}();function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,s;return t=e,s=[{key:"registerEvents",value:function(t){e.showCreateRoomDialog(t),e.setRooms(t)}},{key:"checkForWaitingRoom",value:function(e){return!(!e.getState().settings.waiting_room||!e.getState().mUser.room||e.getState().settings.waiting_room!=e.getState().mUser.room.id||(alert("لا يمكنك القيام بهذه العملية على هذه الغرفة"),0))}},{key:"showCreateRoomDialog",value:function(e){$("#chat__body__rooms_pane__create_room").on("click",(function(t){u.render(e)}))}},{key:"setCurrentRoomActive",value:function(e){$("#chat__body__rooms_pane .chat_pane__room_item").removeClass("active"),e.getState().mUser.room&&$("#chat__body__rooms_pane .chat_pane__room_item[data-id='"+e.getState().mUser.room.id+"']").addClass("active")}},{key:"setRooms",value:function(t){if(a.a.updateRoomsCount(t),"rooms"==t.getState().currentPane){$(".chat_pane__room_item").unbind("click");var n=$("#chat__body__rooms_pane .chat_pane__container");n.html(""),t.getState().rooms.forEach((function(e){n.append(i.a.render(e,!1,t))})),i.a.registerEvents(t),e.setRoomsCount(t)}}},{key:"setRoomsCount",value:function(t){$("#chat__body__rooms_pane .chat_pane__header__title").text(t.getState().rooms.length+e.getTitle())}},{key:"scrollToTop",value:function(){document.querySelector("#chat__body__rooms_pane .chat_pane__container").scrollTo({top:0})}},{key:"getTitle",value:function(){return" :غرف الدردشة"}},{key:"render",value:function(t){var n="<div id='chat__body__rooms_pane' class='chat_pane' style='background: "+Object(r.u)(t.getState().settings,!0)+"'>";return n+=o.a.render(e.getTitle()),n+="<div class='label-primary' style='padding: 0.042rem 0.083rem;'><button id='chat__body__rooms_pane__create_room' data-toggle='modal' data-target='#createRomModal' class='border btn btn-success fa fa-plus'>غرفه جديدة</button></div>",n+="<div class='chat_pane__container border'></div>",n+="</div>"}}],(n=null)&&d(t.prototype,n),s&&d(t,s),e}();t.a=l},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){return{type:"SET_CURRENT_PANE",currentPane:e}}},function(e,t,n){var r;e.exports=(r=r||function(e,t){var n=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),r={},o=r.lib={},i=o.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=o.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,o=e.sigBytes;if(this.clamp(),r%4)for(var i=0;i<o;i++){var a=n[i>>>2]>>>24-i%4*8&255;t[r+i>>>2]|=a<<24-(r+i)%4*8}else for(i=0;i<o;i+=4)t[r+i>>>2]=n[i>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,r=[],o=function(t){t=t;var n=987654321,r=4294967295;return function(){var o=((n=36969*(65535&n)+(n>>16)&r)<<16)+(t=18e3*(65535&t)+(t>>16)&r)&r;return o/=4294967296,(o+=.5)*(e.random()>.5?1:-1)}},i=0;i<t;i+=4){var s=o(4294967296*(n||e.random()));n=987654071*s(),r.push(4294967296*s()|0)}return new a.init(r,t)}}),s=r.enc={},c=s.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new a.init(n,t/2)}},u=s.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push(String.fromCharCode(i))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new a.init(n,t)}},d=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},l=o.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,s=o/(4*i),c=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*i,u=e.min(4*c,o);if(c){for(var d=0;d<c;d+=i)this._doProcessBlock(r,d);var l=r.splice(0,c);n.sigBytes-=u}return new a.init(l,u)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),f=(o.Hasher=l.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}}),r.algo={});return r}(Math),r)},function(e,t,n){"use strict";var r=n(102),o=n.n(r),i=n(0);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"keys",value:function(e){var t=e.getState().faces,n=[];for(var r in t)n.push(t[r].key);return n}},{key:"icons",value:function(e){var t=e.getState().faces,n=[];for(var r in t)n.push(t[r].icon);return n}},{key:"findKeys",value:function(t,n){for(var r=[],i=e.keys(n).map((function(e){return"("+e+")"})).sort((function(e,t){return e.length>t.length?-1:1})).toString().replace(/,/g,"|"),a=new RegExp("("+i+")"),s=null,c=0;c<10;c++){var u=a.exec(t);u&&(s=o.a.generate(),r.push({id:s,key:u[0]}),t=t.replace(a,s))}return{data:t,detectedFaces:r}}},{key:"renderImage",value:function(t,n,r){var o=r?50:22,a=e.keys(n).indexOf(t);if(a>=0){var s=e.icons(n)[a];return"<img src='"+Object(i.e)()+"/uploads/faces/"+s+"?v=1' height='"+o+"' alt='' />"}}},{key:"render",value:function(t,n){if(!t)return"";if(!e.keys(n).length)return"<span>"+t+"</span>";var r=e.findKeys(t,n);if(!r.detectedFaces.length)return"<span>"+r.data+"</span>";var o=r.data,i="",a=n.getState().features.FT_FIRST_FACE_FULL_HEIGHT&&1==r.detectedFaces.length;for(var s in r.detectedFaces){var c=r.detectedFaces[s];if(void 0!==o){var u=o.split(c.id);void 0!==(o=u[1])&&(u[0]?i+="<span><span>"+u[0]+"</span>"+e.renderImage(c.key,n,!1)+"</span>":i+="<span>"+e.renderImage(c.key,n,a)+"</span>")}}return"<span>"+i+"<span>"+(o=o||"")+"</span></span>"}}],(n=null)&&a(t.prototype,n),r&&a(t,r),e}();t.a=s},function(e,t,n){"use strict";var r=n(9),o=n(0),i=n(5),a=n(21),s=n(24),c=n(31);function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,d;return t=e,d=[{key:"registerEvents",value:function(e){}},{key:"updateUser",value:function(e,t){var n=t.getState().users.filter((function(t){return t.id==e}))[0];if(n){var r=$(".public_message:not(.linen)[data-user='"+e+"']");r&&(r.find(".public_message__avatar img").attr("src",n.avatar),r.find(".public_message__title").html(i.a.render(n)),r.find(".public_message__content").css("color",n.fontColor)),(r=$(".public_message.linen[data-user='"+e+"']"))&&(r.find(".public_message__avatar img").attr("src",n.avatar),r.find(".public_message__title").html(i.a.render(n)))}}},{key:"remove",value:function(e){window.publicMessagesContainer.find(".public_message[data-id='"+e+"']").remove()}},{key:"clearSelfMessages",value:function(){return window.publicMessagesContainer.find(".public_self_message").remove()}},{key:"renderGreetUserMessage",value:function(e,t){var n=Date.now(),i=e.icon?"/uploads/greeting-messages/"+e.icon:t.getState().mUser.room.flag,a="<div class='public_message' style='background-color: "+e.backgroundColor+"' >";return a+="<p class='public_message__avatar'>",a+="<img width='36' height='38' src='"+Object(o.e)()+i+"' />",a+="</p>",a+="<div>",a+="<h5 class='public_message__title' style='color: "+e.titleColor+"'>",a+=e.title,a+="</h5>",a+="<h5 class='public_message__content' style='color: "+e.contentColor+"'>",a+=r.a.render(e.content,t),a+="</h5>",a+="</div>",a+="<span class='public_message__time fr time' data-time='"+n+"' style='color: "+e.titleColor+"'>"+Object(o.y)(n)+"</span>",a+="<div class='clear'></div>",a+="</div>"}},{key:"renderJoinLeaveMessage",value:function(e,t){var n=Date.now(),s="<div class='public_message linen' data-user='"+e.user.id+"' >";return s+="<p class='public_message__avatar' data-id='"+e.user.id+"'>",s+="<img width='36' height='38' src='"+Object(o.e)()+e.icon+"' />",s+="</p>",s+="<div>",s+="<h5 class='public_message__title'>",e.user?s+=i.a.render(e.user):s+=e.title,s+="</h5>",s+="<h5 class='public_message__content'>",s+=r.a.render(e.content,t),e.room&&(s+=a.a.render(e.room,!0,t)),s+="</h5>",s+="</div>",s+="<span class='public_message__time fr time' data-time='"+n+"'>"+Object(o.y)(n)+"</span>",s+="<div class='clear'></div>",s+="</div>"}},{key:"renderRoomGreeting",value:function(e,t){var n=Date.now(),i="<div class='public_message greeting' style='background: "+t.getState().settings.self_message_bg_color+"' >";return i+="<p class='public_message__avatar'>",i+="<img width='36' height='38' src='"+Object(o.e)()+e.icon+"' />",i+="</p>",i+="<div>",i+="<h5 class='public_message__title' style='color: "+t.getState().settings.self_message_title_color+"'>"+t.getState().settings.rooms_greeting_title+"</h5>",i+="<h5 class='public_message__content' style='color: "+t.getState().settings.self_message_content_color+"' >",i+=r.a.render(e.content,t),i+="</h5>",i+="</div>",i+="<span class='public_message__time fr time' data-time='"+n+"'>"+Object(o.y)(n)+"</span>",i+="<div class='clear'></div>",i+="</div>"}},{key:"renderPublicMessage",value:function(e,t){var n="";e.reply&&(n="style='background-color: #d7def6 !important'");var a="<div class='public_message' data-id='"+e.id+"' "+n+" data-user='"+e.user.id+"'>";return e.reply&&(a+="<div class='public_message--reply'>",a+="<p class='public_message--reply-name'>"+e.reply.username+"</p>",a+="<p class='public_message--reply-message'>"+e.reply.message+"</p>",a+="</div>"),a+="<p class='public_message__avatar' data-id='"+e.user.id+"'>","?test"==location.search?a+="<img width='36' height='38' src='/images/floating_rose2.png' />":a+="<img width='36' height='38' src='"+Object(o.e)()+e.icon+"' />",a+="</p>",a+="<div>",a+="<h5 class='public_message__title'>",e.user?a+=i.a.render(e.user):a+=e.title,a+="</h5>",e.user&&(a+="<h5 class='public_message__content' style='color: "+(e.user?e.user.fontColor:"#000000")+"' >",a+=r.a.render(e.content,t),a+="</h5>"),a+="</div>",a+="<span class='public_message__time fr time' data-time='"+e.id+"'>"+Object(o.y)(e.id)+"</span>",a+="<div class='public_message__buttons'>",t.getState().features.FT_IS_PUBLIC_MESSAGE_REPLY_ENABLED&&(a+="<button data-id='"+e.id+"' class='btn btn-info fa fa-reply public_message__reply'></button>"),t.getState().mUser.canRemovePublicMessages&&(a+="<button data-id='"+e.id+"' class='btn btn-danger fa fa-times public_message__remove'></button>"),a+="</div>",a+="<div class='clear'></div>",a+="</div>"}},{key:"renderAd",value:function(e,t){var n="<div class='public_message public_message_ad' data-id='"+e.id+"' data-user='"+e.user.id+"' style='background: "+t.getState().settings.self_message_bg_color+"' >";return n+="<p class='public_message__avatar' data-id='"+e.user.id+"'>",n+="<img width='36' height='38' src='"+Object(o.e)()+e.user.avatar+"' />",n+="</p>",n+="<div>",n+="<h5 class='public_message__title'>",e.user?n+=i.a.render(e.user):n+=e.title,n+="</h5>",n+="<h5 class='public_message__content' style='color: "+(e.user?e.user.fontColor:"#000000")+"' >",n+=r.a.render(e.content,t),n+="<span class='public_message__content_title' style='color: blue; margin-right: 0.4rem'>إعلان<span class='fa fa-comment'></span></span>",n+="</h5>",n+="</div>",n+="<span class='public_message__time fr time' data-time='"+e.id+"'>"+Object(o.y)(e.id)+"</span>",t.getState().mUser.canRemovePublicMessages&&(n+="<button data-id='"+e.id+"' class='btn btn-danger fa fa-times public_message__remove'></button>"),n+="<div class='clear'></div>",n+="</div>"}},{key:"renderSelfMessage",value:function(t,n){var i=Date.now(),a="<div class='public_message public_self_message public_message_ad' style='background: "+n.getState().settings.self_message_bg_color+"' >";return a+="<p class='public_message__avatar'>",a+="<img width='36' height='38' src='"+e.getSelfMessageIcon(n)+"' />",a+="</p>",a+="<div>",a+="<h5 class='public_message__title' style='color: "+n.getState().settings.self_message_title_color+"'>"+t.title+"</h5>",a+="<h5 class='public_message__content' style='color: "+n.getState().settings.self_message_content_color+"' >",a+=r.a.render(t.content,n),a+="</h5>",a+="</div>",a+="<span class='public_message__time fr time' data-time='"+i+"'>"+Object(o.y)(i)+"</span>",a+="<div class='clear'></div>",a+="</div>"}},{key:"renderBotBrbMessage",value:function(t,n){var a=Date.now(),s="<div class='public_message public_bot_brb_message' >";return s+="<p class='public_message__avatar'>",s+="<img width='36' height='38' src='"+e.getBotBrbAvatar(n)+"' />",s+="</p>",s+="<h5 class='public_message__bot_brb_title' style='color: "+n.getState().settings.self_message_title_color+"'>بوت مسابقات برب</h5>",s+="<div>",s+="<h5 class='public_message__title' style='color: "+n.getState().settings.self_message_title_color+"'>",t.user?s+=i.a.render(t.user):s+=t.title,s+="</h5>",s+="<h5 class='public_message__content' style='color: "+n.getState().settings.self_message_content_color+"' >",s+=r.a.render(t.content,n),s+="</h5>",s+="</div>",s+="<span class='public_message__time fr time' data-time='"+a+"'>"+Object(o.y)(a)+"</span>",s+="<div class='clear'></div>",s+="</div>"}},{key:"getSelfMessageIcon",value:function(e){return e.getState().settings.self_messages_icon?Object(o.e)()+"/uploads/"+e.getState().settings.self_messages_icon:Object(o.e)()+"/images/default_room.png"}},{key:"getBotBrbAvatar",value:function(e){return e.getState().settings.self_messages_icon?Object(o.e)()+"/uploads/"+e.getState().settings.self_messages_icon:Object(o.e)()+"/images/bot_brb.png"}},{key:"render",value:function(t,n){switch(t.type){case"GREET_USER":return e.renderGreetUserMessage(t,n);case"JOIN_LEAVE":return e.renderJoinLeaveMessage(t,n);case"ROOM_GREETING":return e.renderRoomGreeting(t,n);case"PUBLIC_MESSAGE":return e.renderPublicMessage(t,n);case"AD":return e.renderAd(t,n);case"SELF_MESSAGE":return e.renderSelfMessage(t,n);case"BOT_BRB_MESSAGE":return e.renderBotBrbMessage(t,n);default:return null}}},{key:"insertReplyView",value:function(e,t){if(!$("#chat__body__message-reply").length){var n=$(".public_message[data-id='"+e+"']");if(n){var r="<div id='chat__body__message-reply' >";r+="<button id='chat__body__message-reply--undo'>X</button>",r+="<span style='width: 100%; text-align: right'>",r+="<span id='chat__body__message-reply--username'>"+n.find(".username__wrapper").text()+"</span>",r+="<span id='chat__body__message-reply--message'>"+n.find(".public_message__content").text()+"</span>",r+="</span>",r+="</div>",$("#chat__body__message-input").append(r),$("#chat__body__message-reply--undo").unbind("click").on("click",(function(e){$("#chat__body__message-reply").remove()}))}}}},{key:"insert",value:function(t,n){window.publicMessagesContainer.find(".public_message").length>=20&&window.publicMessagesContainer.find(".public_message:first-child").remove();var r=e.render(t,n),i=window.publicMessagesContainer.append(r);i.find(".public_message__avatar").unbind("click").on("click",(function(e){s.a.show($(this).data("id"),n)})),i.find(".public_message__remove").unbind("click").on("click",(function(e){var r=e.target.dataset.id;"AD"==t.type?n.getState().socket.emit("req",Object(o.k)({type:"REMOVE_PUBLIC_MESSAGE",data:{user:t.user.id,id:r,is_ad:!0,message:t.content}}),(function(e){})):n.getState().socket.emit("req",Object(o.k)({type:"REMOVE_PUBLIC_MESSAGE",data:{id:r}}),(function(e){}))})),i.find(".public_message__reply").unbind("click").on("click",(function(t){$("#chat__body__message-input #chat__body__message-input__input").trigger("focus"),e.insertReplyView(t.target.dataset.id,n)})),c.a.scrollToBottom(),"JOIN_LEAVE"==t.type&&a.a.registerEvents(n),i.find("img").on("contextmenu",(function(){return!1}))}}],(n=null)&&u(t.prototype,n),d&&u(t,d),e}();t.a=d},function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return l}));var r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"SET_USERS",users:e}},o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"SET_USER",user:e}},i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_CURRENT_USER",updates:e}},a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"SET_REQUESTED_USER",user:e}},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_REQUESTED_USER",user:e}},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_USER",user:e}},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_USER_ATTRIBUTE",user:e}},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"REMOVE_USER",user:e}},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"ADD_USER",user:e}}},function(e,t,n){e.exports=n(160)},function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"h",(function(){return o})),n.d(t,"g",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return l}));var r=function(e){return{type:"SET_CURRENT_CONVERSATION",user:e}},o=function(e){return{type:"UPDATE_CURRENT_CONVERSATION",user:e}},i=function(e,t,n){return{type:"UPDATE_CONVERSATION_ID",oldID:e,newID:t,him:n}},a=function(e){return{type:"REMOVE_CONVERSATION",id:e}},s=function(e){return{type:"READ_CONVERSATION",id:e}},c=function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return{type:"ADD_MESSAGE_TO_CONVERSATION",conversation_id:e,me:t,him:n,seen:r,message:o}},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_PRIVATE_MESSAGE_USER",user:e}},d=function(e){return{type:"REMOVE_CONVERSATION_BY_USER",him_id:e}},l=function(e,t,n){return{type:"REC_READ_CONVERSATION_MESSAGE",conversation_id:e,me:t,him:n}}},function(e,t,n){"use strict";var r=n(7),o=n(1);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,a=[{key:"registerEvents",value:function(t){e.onClose(t)}},{key:"onClose",value:function(e){$(".chat_pane__header button").on("click",(function(t){e.dispatch(Object(r.a)(null)),o.a.togglePane(e,!0,t)}))}},{key:"render",value:function(e,t){var n="<div class='chat_pane__header label label-primary '>";return n+="<h3 "+(t?"style='text-align: center;'":"")+" class='label label-primary chat_pane__header__title'>"+e+"</h3>",n+="<button class='btn btn-danger fa fa-times chat_pane__header__close'></button>",n+="</div>"}}],(n=null)&&i(t.prototype,n),a&&i(t,a),e}();t.a=a},function(e,t,n){"use strict";var r=n(0),o=n(14),i=n(26),a=n(5),s=n(9),c=n(16);function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,d;return t=e,d=[{key:"registerEvents",value:function(t){e.filterUsersByName(t)}},{key:"setUserBackground",value:function(e,t,n){$("#chat__body__users-pane #user-"+e).addClass("has-bg").css("background-image","url(/uploads/user-bg/"+t+")")}},{key:"updateUser",value:function(e,t){var n=$("#chat__body__users-pane #user-"+e);if(n){var r=t.getState().users.filter((function(t){return t.id==e}))[0];r&&(r.active?n.addClass("active"):n.removeClass("active"),r.isHidden?n.addClass("hidden"):n.removeClass("hidden"),r.background?n.addClass("has-bg"):n.removeClass("has-bg"),n.find(".chat_pane__user_item__avatar img:not(.avatar_bg)").attr("src",r.avatar).removeClass("state_active").removeClass("state_no_private").removeClass("state_idle").addClass(r.state),r.avatar_background?n.find(".chat_pane__user_item__avatar img.avatar_bg").attr("src","/uploads/user-avatar-bg/"+r.avatar_background):n.find(".chat_pane__user_item__avatar img.avatar_bg").remove(),n.find(".chat_pane__user_item__avatar .status").removeClass("state_active").removeClass("state_no_private").removeClass("state_idle").addClass(r.state),n.find(".chat_pane__user_item__name").html(a.a.render(r)),n.find(".chat_pane__user_item__status .status_content").html(s.a.render(r.status,t)).css("color",r.statusColor))}}},{key:"filterUsersByName",value:function(t){$("#chat__body__users-pane input.chat_pane__search").on("keyup",(function(n){var r,o;0==n.target.value.trim().indexOf("#")?t.dispatch({type:"FILTER_USERS_BY_HASH_TAG",hashTag:(o=n.target.value.trim().replaceAll("#","")).trim()?o:null}):t.dispatch({type:"FILTER_USERS_BY_NAME",name:(r=n.target.value.trim()).trim()?r:null}),e.setUsers(t)}))}},{key:"updateCurrentRoomName",value:function(e){$(".chat_pane__container .chat_pane__container__room_name").text(e.getState().mUser.room?e.getState().mUser.room.name:"")}},{key:"setUsers",value:function(t){"users"==t.getState().currentPane&&(e.setUsersOnCurrentRoom(t),e.setUsersOnOtherRooms(t),e.updateCurrentRoomName(t),window.usersPane.find("img").on("contextmenu",(function(){return!1})))}},{key:"setUsersOnCurrentRoom",value:function(e){window.usersPane.find("#chat__body__users-pane__current_room .chat_pane__user_item").unbind("click");var t=window.usersPane.find("#chat__body__users-pane__current_room");t.html(""),e.getState().usersFilter?isNaN(e.getState().usersFilter)?e.getState().users.filter((function(t){return t.room&&e.getState().mUser.room&&t.room.id==e.getState().mUser.room.id&&t.name.toLowerCase().includes(e.getState().usersFilter.toLowerCase())})).forEach((function(n){t.append(i.a.render(n,!0,e))})):e.getState().users.filter((function(t){return t.room&&e.getState().mUser.room&&t.room.id==e.getState().mUser.room.id&&t.hashTag==e.getState().usersFilter})).forEach((function(n){t.append(i.a.render(n,!0,e))})):e.getState().users.filter((function(t){return t.room&&e.getState().mUser.room&&t.room.id==e.getState().mUser.room.id&&!e.getState().ignoredUsers.includes(t.id)})).forEach((function(n){t.append(i.a.render(n,!0,e))})),i.a.registerEvents(e)}},{key:"setUsersOnOtherRooms",value:function(e){window.usersPane.find("#chat__body__users-pane__other_rooms .chat_pane__user_item").unbind("click");var t=window.usersPane.find("#chat__body__users-pane__other_rooms");t.html(""),e.getState().usersFilter?e.getState().users.filter((function(t){return(!t.room||!e.getState().mUser.room||t.room.id!=e.getState().mUser.room.id)&&t.name.toLowerCase().includes(e.getState().usersFilter.toLowerCase())})).forEach((function(n){t.append(i.a.render(n,!0,e))})):e.getState().users.filter((function(t){return!t.room||!e.getState().mUser.room||t.room.id!=e.getState().mUser.room.id&&!e.getState().ignoredUsers.includes(t.id)})).forEach((function(n){t.append(i.a.render(n,!0,e))})),i.a.registerEvents(e)}},{key:"scrollToTop",value:function(){window.usersPane.find(".chat_pane__container").scrollTop(0)}},{key:"toggleStories",value:function(t){if(t.getState().settings.enabled_stories){if($("#story-board").length)return;$("#chat__body__users-pane .chat_pane__container").before(c.a.render(t)),window.storyBoard=$("#story-board"),c.a.registerEvents(t),c.a.getStories(t)}else $("#story-board").remove();e.setContainerHeight(t)}},{key:"setContainerHeight",value:function(e){var t=window.storyBoard.height()?window.storyBoard.height()+9:0;$("#chat__body__users-pane .chat_pane__container").css("height","calc(100% - 2.4rem - "+t+"px)")}},{key:"render",value:function(e){var t=" <div id='chat__body__users-pane' class='chat_pane' style='background: "+Object(r.u)(e.getState().settings,!0)+"'>";return t+=o.a.render("المتواجدين"),t+="<input type='text' name='user-name' class='form-control label-primary chat_pane__search' placeholder='البحث...' />",e.getState().settings.enabled_stories&&(t+=c.a.render(e)),t+="<div class='chat_pane__container border'>",t+="<h4 class='chat_pane__label label label-primary right'>المتواجدون في <span class='chat_pane__container__room_name'></span></h4>",t+="<div id='chat__body__users-pane__current_room'></div>",t+="<h4 class='chat_pane__label label label-primary'>المتواجدون في غرف أخرى</h4>",t+="<div id='chat__body__users-pane__other_rooms'></div>",t+="</div>",t+="</div>"}}],(n=null)&&u(t.prototype,n),d&&u(t,d),e}();t.a=d},function(e,t,n){"use strict";var r=n(0),o=n(46),i=n(23),a=n(32);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.openStory(t)}},{key:"openStory",value:function(e){window.storyBoard.find(".story-board--item:not(.add)").unbind("click").on("click",(function(t){a.a.render(e,t.target.parentElement.dataset.user)}))}},{key:"update",value:function(e,t){var n=window.storyBoard.find('.story-board--item[data-user="'+t+'"]');if(n&&n.length){var r=e.getState().stories.find((function(e){return e.user_id==t}));if(r){var o=e.getState().users.find((function(e){return e.reg_id==t}));o||(o=r.user);var i=o.avatar;"photo"==r.type?i="/uploads/story/photos/"+r.file:"video"==r.type&&(i="/uploads/story/videos/"+r.file);var a="";"video"==r.type?a+='<video class="img_bg" src="'+i+'" ></video>':a+='<img class="img_bg" src="'+i+'" >',a+='<img class="img_user" src="'+o.avatar+'" >',a+='<span class="user_name ellipsis" >'+o.name+"</span>",n.html(a)}}}},{key:"render",value:function(e,t){if(!window.storyBoard.find('.story-board--item[data-user="'+t.user_id+'"]').length){var n=e.getState().users.find((function(e){return e.reg_id==t.user_id}));n||(n=t.user);var r=n.avatar;"photo"==t.type?r="/uploads/story/photos/"+t.file:"video"==t.type?(r="/uploads/story/videos/"+t.file,document.createElement("video").src=r):"audio"==t.type&&(document.createElement("audio").src=r);var o='<div class="story-board--item" data-user="'+t.user_id+'">';return"video"==t.type?o+='<video class="img_bg" preload="auto" src="'+r+'" ></video>':("audio"==t.type&&(o+='<audio style="display: none;" preload="auto" src="'+r+'" ></audio>'),o+='<img class="img_bg" src="'+r+'" >'),o+='<img class="img_user" src="'+n.avatar+'" >',o+='<span class="user_name ellipsis" >'+n.name+"</span>",o+="</div>"}}}],(n=null)&&s(t.prototype,n),r&&s(t,r),e}(),u=n(29),d=n.n(u),l=n(6);function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,s;return t=e,s=[{key:"registerEvents",value:function(t){e.addStory(t),e.onAddStory(t),window.storyBoard.unbind("mousedown").on("mousedown",e.mouseDownHandler)}},{key:"mouseDownHandler",value:function(t){window.storyScrollPos={left:window.storyBoard[0].scrollLeft,x:t.clientX},window.storyBoard.unbind("mousemove").on("mousemove",e.mouseMoveHandler),window.storyBoard.unbind("mouseup").on("mouseup",e.mouseUpHandler)}},{key:"mouseMoveHandler",value:function(e){var t=e.clientX-window.storyScrollPos.x;window.storyBoard[0].scrollLeft=window.storyScrollPos.left-t}},{key:"mouseUpHandler",value:function(e){window.storyBoard.unbind("mousemove"),window.storyBoard.unbind("mouseup")}},{key:"addStory",value:function(e){window.storyBoard.find(".story-board--item.add").unbind("click").on("click",(function(t){if(t.stopPropagation(),!l.a.checkForWaitingRoom(e))return e.getState().settings.required_likes_stories>e.getState().mUser.likes?alert("يجب أن تتوفر على "+e.getState().settings.required_likes_stories+" إعجاب حتى تتمكن من رفع الستوري"):void(window.isStoryUploading||window.storyBoard.find("#story-board--item--input").trigger("click"))}))}},{key:"onAddStory",value:function(t){window.storyBoard.find("#story-board--item--input").unbind("change").on("change",(function(n){var o=new FormData;o.append("token",t.getState().mUser.ajax_token),o.append("file",n.target.files[0]);var i=null,a=n.target.files[0].type.split("/")[0];"image"==a&&(i="/story_upload_photo"),"audio"==a&&(i="/story_upload_audio"),"video"==a&&(i="/story_upload_video"),i&&(window.isStoryUploading=!0,d.a.post(i,o).then((function(n){if(window.storyBoard.find("#story-board--item--input")[0].value="",delete window.isStoryUploading,!1!==n.data.error)return alert(n.data.message);var o={id:n.data.id,user_id:t.getState().mUser.reg_id,type:n.data.type,file:n.data.file,likes:0,created_at:n.data.created_at};e.onNewStory(t,o),t.getState().socket.emit("req",Object(r.k)({type:"story:add",data:{id:n.data.id}}),(function(e){}))})).catch((function(e){window.storyBoard.find("#story-board--item--input")[0].value="",delete window.isStoryUploading})))}))}},{key:"getStories",value:function(t){t.getState().features.FT_IS_STORIES_ENABLED&&t.getState().socket.emit("req",Object(r.k)({type:"story:get",data:{}}),(function(n){n&&n.length&&e.setStories(t,n)}))}},{key:"setStories",value:function(e,t){if(t&&t.length){e.dispatch(Object(i.k)(t));var n=[];t.forEach((function(t){n.indexOf(t.user_id)>=0||(t.user_id==e.getState().mUser.reg_id?window.storyBoard.find(".story-board--item.add").after(c.render(e,t)):window.storyBoard.append(c.render(e,t)),n.push(t.user_id))})),c.registerEvents(e)}}},{key:"onNewStory",value:function(e,t){(t.user||(t.user=e.getState().users.find((function(e){return e.reg_id==t.user_id})),t.user))&&(e.dispatch(Object(i.a)(t)),t.user_id==e.getState().mUser.reg_id?window.storyBoard.find(".story-board--item.add").after(c.render(e,t)):window.storyBoard.append(c.render(e,t)),c.registerEvents(e))}},{key:"onRemoveStory",value:function(e,t){a.a.onRemoveStory(e,t);var n=e.getState().stories.find((function(e){return e.id==t}));n&&(e.dispatch(Object(i.i)(n.id)),e.dispatch(Object(o.b)(n.id)),e.getState().stories.filter((function(e){return e.user_id==n.user_id})).length?c.update(e,n.user_id):window.storyBoard.find('.story-board--item[data-user="'+n.user_id+'"]').remove())}},{key:"getCurrentUserStoryBoardItem",value:function(e){if(!window.storyBoard)return null;var t=window.storyBoard.find(".story-board--item[data-user='"+e.getState().mUser.reg_id+"']");return t&&t.length?t:null}},{key:"render",value:function(e){if(!e.getState().features.FT_IS_MIC_ENABLED)return"";var t='<div id="story-board">';return t+='<div class="story-board--item add">',t+='<img class="img_bg" src="'+e.getState().mUser.avatar+'" >',t+='<div class="plus">',t+='<svg xmlns="https://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">',t+='<path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />',t+="</svg>",t+="</div>",t+="</div>",t+="<input id='story-board--item--input' type='file' accept='image/*, video/*, audio/*' style='display: none; position: absolute; left: 9999px' />",t+="</div>"}}],(n=null)&&f(t.prototype,n),s&&f(t,s),e}();t.a=p},function(e,t,n){"use strict";var r=n(12),o=n.n(r),i=n(7),a=n(4),s=n(0),c=n(1),u=n(3),d=n(5);function l(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onPlayerClicked(t),e.onDiceClicked(t),e.onClose(t),e.onHide(t)}},{key:"startGame",value:function(t,n,r){for(var o in window.ludoPlayers=[],window.isLudoWaitingForMove=!1,n){var i=n[o];i.user_id&&window.ludoPlayers.push(i)}t.getState().socket.emit("req",Object(s.k)({type:"YOUCAM_LUDO_START_GAME",data:{players:window.ludoPlayers,turn:window.ludoPlayers[0].color,isPublic:r}}),(function(n){if("string"==typeof(n=Object(s.g)(n)))return alert(n);window.ludoCurrentTurn=window.ludoPlayers[0].color,$(".pre_youcam_ludo_modal__header__close").trigger("click"),setTimeout((function(){$("#youcam_ludo_container").html(""),e.render(t,t.getState().mUser.id)}),500)}))}},{key:"onPlayerClicked",value:function(t){$(".player").unbind("click").on("click",(function(n){window.isLudoWaitingForMove=!1,e.movePlayer($(this),window.currentDiceValue,t,window.mUserLudoColor)}))}},{key:"parseGameState",value:function(){var e=[];return window.ludoPlayers.forEach((function(t){e.push({color:t.color,user_id:t.user_id,coin1:$("#"+t.color+"-player-1").data("cp"),coin2:$("#"+t.color+"-player-2").data("cp"),coin3:$("#"+t.color+"-player-3").data("cp"),coin4:$("#"+t.color+"-player-4").data("cp")})})),e}},{key:"onDiceClicked",value:function(t){$("#"+window.mUserLudoColor+"-dice").unbind("click").on("click",(function(n){var r=this;if(window.ludoCurrentTurn==window.mUserLudoColor&&!window.isLudoPlayerMoving&&!window.isDiceRolling&&!window.isLudoWaitingForMove&&window.ludoPlayers&&!(window.ludoPlayers.filter((function(e){return!e.winner})).length<2)){window.currentDiceValue=1+Math.floor(6*Math.random()),window.numberOfNonSixTries||(window.numberOfNonSixTries=0),window.numberOfNonSixTries>=10+Math.floor(6*Math.random())&&(window.currentDiceValue=6),6!=window.currentDiceValue?++window.numberOfNonSixTries:window.numberOfNonSixTries=0,window.hackedDiceValue&&(window.currentDiceValue=window.hackedDiceValue),t.getState().socket.emit("req",Object(s.k)({type:"YOUCAM_LUDO_DICE_CLICKED",data:{value:window.currentDiceValue,players:window.ludoPlayers,color:window.mUserLudoColor}}),(function(e){})),$(this).attr("disabled","disabled"),e.isLudoMinimized()||(e.stopAllSounds(),window.dice_sound.play());var o=setInterval((function(){var e=1+Math.floor(6*Math.random());$(r).css("background-image","url(/images/dice"+e+".png)")}),50);window.isDiceRolling=!0,setTimeout((function(){$(r).css("background-image","url(/images/dice"+window.currentDiceValue+".png)"),$(r).removeAttr("disabled"),clearInterval(o),window.isDiceRolling=!1,window.isLudoWaitingForMove=!0;var n=e.autoMovePlayer(t);if(6!=window.currentDiceValue&&0==$(".bg-"+window.mUserLudoColor+"[data-status='active']").length)e.updateTurn(window.currentDiceValue,t),t.getState().socket.emit("req",Object(s.k)({type:"YOUCAM_LUDO_UPDATE_TURN",data:{currentTurn:window.ludoCurrentTurn,value:window.currentDiceValue,players:window.ludoPlayers,color:window.mUserLudoColor}}),(function(e){}));else if(6!=window.currentDiceValue&&$(".bg-"+window.mUserLudoColor+"[data-status='active']").length>0){var i=!1;$(".bg-"+window.mUserLudoColor+"[data-status='active']").each((function(t,n){e.getRedPath().length-n.dataset.cp>=window.currentDiceValue&&(i=!0)})),i||n||(e.updateTurn(window.currentDiceValue,t),t.getState().socket.emit("req",Object(s.k)({type:"YOUCAM_LUDO_UPDATE_TURN",data:{currentTurn:window.ludoCurrentTurn,value:window.currentDiceValue,players:window.ludoPlayers,color:window.mUserLudoColor}}),(function(e){})))}}),2e3)}}))}},{key:"rollDice",value:function(t,n){e.isLudoMinimized()||(e.stopAllSounds(),window.dice_sound.play());var r=$("#"+t+"-dice"),o=setInterval((function(){var e=1+Math.floor(6*Math.random());r.css("background-image","url(/images/dice"+e+".png)")}),50);setTimeout((function(){r.css("background-image","url(/images/dice"+n+".png)"),clearInterval(o)}),2e3)}},{key:"autoMovePlayer",value:function(t){var n=!1;if(6==window.currentDiceValue)if(0==$(".player.bg-"+window.mUserLudoColor+"[data-status='active']").length)$(".player.bg-"+window.mUserLudoColor+"[data-status='home']").first().trigger("click");else{var r=$(".player.bg-"+window.mUserLudoColor+"[data-status='active']"),o=$(".player.bg-"+window.mUserLudoColor+"[data-status='home']");if(r.length&&!o.length){var i=[];if(r.each((function(t,n){e.getRedPath().length-n.dataset.cp>=window.currentDiceValue&&i.push(n)})),1==i.length)e.getRedPath().length==window.currentDiceValue+parseInt(i[0].dataset.cp)&&(n=!0),$("#"+i[0].id).trigger("click");else if(i.length>1){var a=i[0].dataset.cp,s=0;i.forEach((function(e){e.dataset.cp==a&&s++})),i.length==s&&(e.getRedPath().length==window.currentDiceValue+parseInt(i[0].dataset.cp)&&(n=!0),$("#"+i[0].id).trigger("click"))}else i.length||(window.isLudoWaitingForMove=!1)}else if(o.length){var c=[];r.each((function(t,n){e.getRedPath().length-n.dataset.cp>=window.currentDiceValue&&c.push(n)})),c.length||o.first().trigger("click")}}else{var u=$(".player.bg-"+window.mUserLudoColor+"[data-status='active']");if(u.length){var d=[];if(u.each((function(t,n){e.getRedPath().length-n.dataset.cp>=window.currentDiceValue&&d.push(n)})),1==d.length)e.getRedPath().length==window.currentDiceValue+parseInt(d[0].dataset.cp)&&(n=!0),$("#"+d[0].id).trigger("click");else if(d.length>1){var l=d[0].dataset.cp,f=0;d.forEach((function(e){e.dataset.cp==l&&f++})),d.length==f&&(e.getRedPath().length==window.currentDiceValue+parseInt(d[0].dataset.cp)&&(n=!0),$("#"+d[0].id).trigger("click"))}}}return e.focusCurrentTurn(t),n}},{key:"getWinPlayers",value:function(t){return $(".player.bg-"+t+"[data-status='win'][data-cp='"+e.getRedPath().length+"']").length}},{key:"updateTurn",value:function(t,n){if(6!=t)if(window.isLudoWaitingForMove=!1,"red"==window.ludoCurrentTurn){if(window.ludoPlayers.filter((function(e){return"green"==e.color}))[0]&&e.getWinPlayers("green")<4)return window.ludoCurrentTurn="green",void e.focusCurrentTurn(n);if(window.ludoPlayers.filter((function(e){return"yellow"==e.color}))[0]&&e.getWinPlayers("yellow")<4)return window.ludoCurrentTurn="yellow",void e.focusCurrentTurn(n);if(window.ludoPlayers.filter((function(e){return"blue"==e.color}))[0]&&e.getWinPlayers("blue")<4)return window.ludoCurrentTurn="blue",void e.focusCurrentTurn(n);if(window.ludoPlayers.filter((function(e){return"red"==e.color}))[0]&&e.getWinPlayers("red")<4)return window.ludoCurrentTurn="red",void e.focusCurrentTurn(n)}else if("green"==window.ludoCurrentTurn){if(window.ludoPlayers.filter((function(e){return"yellow"==e.color}))[0]&&e.getWinPlayers("yellow")<4)return window.ludoCurrentTurn="yellow",void e.focusCurrentTurn(n);if(window.ludoPlayers.filter((function(e){return"blue"==e.color}))[0]&&e.getWinPlayers("blue")<4)return window.ludoCurrentTurn="blue",void e.focusCurrentTurn(n);if(window.ludoPlayers.filter((function(e){return"red"==e.color}))[0]&&e.getWinPlayers("red")<4)return window.ludoCurrentTurn="red",void e.focusCurrentTurn(n);if(window.ludoPlayers.filter((function(e){return"green"==e.color}))[0]&&e.getWinPlayers("green")<4)return window.ludoCurrentTurn="green",void e.focusCurrentTurn(n)}else if("yellow"==window.ludoCurrentTurn){if(window.ludoPlayers.filter((function(e){return"blue"==e.color}))[0]&&e.getWinPlayers("blue")<4)return window.ludoCurrentTurn="blue",void e.focusCurrentTurn(n);if(window.ludoPlayers.filter((function(e){return"red"==e.color}))[0]&&e.getWinPlayers("red")<4)return window.ludoCurrentTurn="red",void e.focusCurrentTurn(n);if(window.ludoPlayers.filter((function(e){return"green"==e.color}))[0]&&e.getWinPlayers("green")<4)return window.ludoCurrentTurn="green",void e.focusCurrentTurn(n);if(window.ludoPlayers.filter((function(e){return"yellow"==e.color}))[0]&&e.getWinPlayers("yellow")<4)return window.ludoCurrentTurn="yellow",void e.focusCurrentTurn(n)}else if("blue"==window.ludoCurrentTurn){if(window.ludoPlayers.filter((function(e){return"red"==e.color}))[0]&&e.getWinPlayers("red")<4)return window.ludoCurrentTurn="red",void e.focusCurrentTurn(n);if(window.ludoPlayers.filter((function(e){return"green"==e.color}))[0]&&e.getWinPlayers("green")<4)return window.ludoCurrentTurn="green",void e.focusCurrentTurn(n);if(window.ludoPlayers.filter((function(e){return"yellow"==e.color}))[0]&&e.getWinPlayers("yellow")<4)return window.ludoCurrentTurn="yellow",void e.focusCurrentTurn(n);if(window.ludoPlayers.filter((function(e){return"blue"==e.color}))[0]&&e.getWinPlayers("blue")<4)return window.ludoCurrentTurn="blue",void e.focusCurrentTurn(n)}}},{key:"movePlayer",value:function(t,n,r,i){if(n>6&&(n=6),n<0&&(n=1),!window.isLudoPlayerMoving&&!window.isDiceRolling&&n&&window.ludoCurrentTurn==i&&t.hasClass("bg-"+i)&&!(6!=n&&"home"==t.data("status")||"win"==t.data("status")||e.getRedPath().length-t.data("cp")<n)){i==window.mUserLudoColor&&r.getState().socket.emit("req",Object(s.k)({type:"YOUCAM_LUDO_PLAYER_CLICKED",data:{value:n,players:window.ludoPlayers,color:window.mUserLudoColor,id:t.attr("id")}}),(function(e){}));var a=t.attr("data-cp"),c=n;if(6==n&&"home"==t.data("status")){t.attr("data-status","active");var u=$("."+i+"-home .white-box .player-room").html();$("."+i+"-home .white-box .player-room").html(u.replace(t.get(0).outerHTML,"")),c=1}for(var d=[],f=0;f<c;f++)d.push(1);(function(){var n,c=(n=o.a.mark((function n(){var c,u,f,p,m,h,_,g,v,y,b;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:window.isLudoPlayerMoving=!0,c=l(d),n.prev=2,c.s();case 4:if((u=c.n()).done){n.next=32;break}if(u.value,"win"!=e.getPath(i)[a]){n.next=25;break}return e.isLudoMinimized()||window.winner_sound.play(),f=t.get(0).outerHTML,(p=window.ludoSteps[e.getPath(i)[a-1]]).innerHTML=p.innerHTML.replace(f,""),t.attr("data-status","win"),t.attr("data-cp",++a),m="","red"==i&&(m=".rwh"),"green"==i&&(m=".gwh"),"yellow"==i&&(m=".ywh"),"blue"==i&&(m=".bwh"),$(".winner-home "+m).html($(".winner-home "+m).html()+t.get(0).outerHTML),e.getWinPlayers(i)>3&&((h=$("."+i+"-home")).addClass("home-win"),h.find(".white-box").css("background-image","url(/images/crown"+$(".home-win").length+".png)"),h.css("opacity","1"),window.ludoPlayers=window.ludoPlayers.map((function(e){return e.color==i&&(e.winner=!0),e})),i==window.mUserLudoColor&&(_=window.ludoPlayers.filter((function(e){return e.winner})).length<2,r.getState().socket.emit("req",Object(s.k)({type:"YOUCAM_LUDO_WIN_GAME",data:{players:window.ludoPlayers,color:window.mUserLudoColor,gameEnded:_}}),(function(e){})),_&&e.resetData(!1))),n.next=22,e.sleep(150);case 22:return n.abrupt("return",0);case 25:g=window.ludoSteps[e.getPath(i)[a]],0!=a?(v=t.get(0).outerHTML,(y=window.ludoSteps[e.getPath(i)[a-1]]).innerHTML=y.innerHTML.replace(v,""),a++,t.attr("data-cp",a),v=t.get(0).outerHTML,g.innerHTML=g.innerHTML+v):(a++,t.attr("data-cp",a),b=t.get(0).outerHTML,g.innerHTML=g.innerHTML+b),e.isLudoMinimized()||(e.stopAllSounds(),window.step_sound.play());case 28:return n.next=30,e.sleep(150);case 30:n.next=4;break;case 32:n.next=37;break;case 34:n.prev=34,n.t0=n.catch(2),c.e(n.t0);case 37:return n.prev=37,c.f(),n.finish(37);case 40:case"end":return n.stop()}}),n,null,[[2,34,37,40]])})),function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function a(e){p(i,r,o,a,s,"next",e)}function s(e){p(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(){return c.apply(this,arguments)}})()().then((function(){if(a<e.getPath(i).length){var t=[],o=0,c=window.ludoSteps[e.getPath(i)[a-1]];if(c.children.length>1&&!e.getSafeStops().includes(e.getPath(i)[a-1])){for(f=0;f<c.children.length;f++){var u=c.children[f],d="red";u.classList.contains("bg-green")&&(d="green"),u.classList.contains("bg-yellow")&&(d="yellow"),u.classList.contains("bg-blue")&&(d="blue"),u&&u.classList.contains("player")&&d!=i&&(u.dataset.cp="0",u.dataset.status="home",$("."+d+"-home .white-box .player-room").append(u.outerHTML),t.push(u),e.isLudoMinimized()||window.dead_sound.play(),window.isLudoPlayerMoving=!1,window.currentDiceValue=0,e.onPlayerClicked(r))}if(t.forEach((function(e){e.remove(),o++})),o>0)return 0}}window.isLudoPlayerMoving=!1,window.currentDiceValue=0,i==window.mUserLudoColor&&r.getState().socket.emit("req",Object(s.k)({type:"YOUCAM_LUDO_UPDATE_GAME_STATE",data:{players:window.ludoPlayers,currentTurn:window.ludoCurrentTurn,color:window.mUserLudoColor,state:e.parseGameState()}}),(function(e){})),e.onPlayerClicked(r),e.updateTurn(n,r)}))}}},{key:"focusCurrentTurn",value:function(t){$(".step").css("z-index","0"),$(".super-center").removeClass("active"),$(".super-center."+window.ludoCurrentTurn+"-home").addClass("active"),e.getSafeStops().forEach((function(e){if(e){var t=window.ludoSteps[e];if(t.children.length>1){var n,r=l(t.children);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.classList.contains("bg-"+window.ludoCurrentTurn)?o.style.zIndex="1":o.style.zIndex="0"}}catch(e){r.e(e)}finally{r.f()}}else 1==t.children.length&&(t.children[0].style.zIndex="1")}})),window.ludoCurrentTurn==window.mUserLudoColor&&$("#show_ludo").addClass("active"),t&&window.ludoCurrentTurn==window.mUserLudoColor&&t.getState().socket.emit("req",Object(s.k)({type:"YOUCAM_LUDO_SET_TURN",data:{currentTurn:window.ludoCurrentTurn}}),(function(e){}))}},{key:"getSafeStops",value:function(){return[19,6,5,27,52,65,66,44]}},{key:"sleep",value:function(e){return new Promise((function(t){return setTimeout(t,e)}))}},{key:"stopAllSounds",value:function(){window.step_sound.pause(),window.step_sound.currentTime=0,window.dead_sound.pause(),window.dead_sound.currentTime=0,window.inout_sound.pause(),window.inout_sound.currentTime=0,window.dice_sound.pause(),window.dice_sound.currentTime=0}},{key:"getPath",value:function(e){return"red"==e?[19,20,21,22,23,15,12,9,6,3,0,1,2,5,8,11,14,17,24,25,26,27,28,29,41,53,52,51,50,49,48,56,59,62,65,68,71,70,69,66,63,60,57,54,47,46,45,44,43,42,30,31,32,33,34,35,"win"]:"green"==e?[5,8,11,14,17,24,25,26,27,28,29,41,53,52,51,50,49,48,56,59,62,65,68,71,70,69,66,63,60,57,54,47,46,45,44,43,42,30,18,19,20,21,22,23,15,12,9,6,3,0,1,4,7,10,13,16,"win"]:"yellow"==e?[52,51,50,49,48,56,59,62,65,68,71,70,69,66,63,60,57,54,47,46,45,44,43,42,30,18,19,20,21,22,23,15,12,9,6,3,0,1,2,5,8,11,14,17,24,25,26,27,28,29,41,40,39,38,37,36,"win"]:"blue"==e?[66,63,60,57,54,47,46,45,44,43,42,30,18,19,20,21,22,23,15,12,9,6,3,0,1,2,5,8,11,14,17,24,25,26,27,28,29,41,53,52,51,50,49,48,56,59,62,65,68,71,70,67,64,61,58,55,"win"]:void 0}},{key:"getRedPath",value:function(){return[19,20,21,22,23,15,12,9,6,3,0,1,2,5,8,11,14,17,24,25,26,27,28,29,41,53,52,51,50,49,48,56,59,62,65,68,71,70,69,66,63,60,57,54,47,46,45,44,43,42,30,31,32,33,34,35,"win"]}},{key:"getGreenPath",value:function(){return[5,8,11,14,17,24,25,26,27,28,29,41,53,52,51,50,49,48,56,59,62,65,68,71,70,69,66,63,60,57,54,47,46,45,44,43,42,30,18,19,20,21,22,23,15,12,9,6,3,0,1,4,7,10,13,16,"win"]}},{key:"getYellowPath",value:function(){return[52,51,50,49,48,56,59,62,65,68,71,70,69,66,63,60,57,54,47,46,45,44,43,42,30,18,19,20,21,22,23,15,12,9,6,3,0,1,2,5,8,11,14,17,24,25,26,27,28,29,41,40,39,38,37,36,"win"]}},{key:"getBluePath",value:function(){return[66,63,60,57,54,47,46,45,44,43,42,30,18,19,20,21,22,23,15,12,9,6,3,0,1,2,5,8,11,14,17,24,25,26,27,28,29,41,53,52,51,50,49,48,56,59,62,65,68,71,70,67,64,61,58,55,"win"]}},{key:"setSizes",value:function(){var e=$(".winner-home").prop("clientHeight"),t=Math.round(Object(s.t)(50,e)),n=Math.round(Object(s.t)(40,e)),r=Math.round(Object(s.t)(28,e));if($(".winner-home .stack").css("border-width",t),$("#red-dice, #green-dice, #yellow-dice, #blue-dice").css("width",n).css("height",n),$(".player-room").css("gap",r),document.body.clientWidth<750){$(".ludo-board").css("width","100vw").css("height","100vw");var o=Math.round(Object(s.t)(17,e));$(".player").css("width",o).css("height",o)}else{$(".ludo-board").css("width","80vh").css("height","80vh");var i=Math.round(Object(s.t)(20,e));$(".player").css("width",i).css("height",i)}document.body.clientWidth>900?$("main").css("padding-top","10vh"):$("main").css("padding-top","0"),e=$(".winner-home").prop("clientHeight"),t=Math.round(Object(s.t)(50,e)),$(".winner-home .stack").css("border-width",t)}},{key:"onClose",value:function(t){$("#ludo-board__close").unbind("click").on("click",(function(n){$(this).closest(".ludo-board").data("u")==t.getState().mUser.id?e.endGame(t):e.exit(t)}))}},{key:"onHide",value:function(t){$("#ludo-board__hide").unbind("click").on("click",(function(n){$("#youcam_ludo_container main").hide(),$("#youcam_ludo_container").append("<div id='show_ludo'><img src='/images/ludo_icon.jpeg' /></div>"),e.onShowLudo(t)}))}},{key:"onShowLudo",value:function(e){$("#show_ludo").unbind("click").on("click",(function(t){$("#show_ludo").remove(),$("#youcam_ludo_container main").show(),e.dispatch(Object(i.a)(null)),c.a.togglePane(e,!0,t)}))}},{key:"exit",value:function(t){t.getState().socket.emit("req",Object(s.k)({type:"YOUCAM_LUDO_EXIT_GAME",data:{players:window.ludoPlayers,color:window.mUserLudoColor}}),(function(e){})),e.resetData(!0)}},{key:"endGame",value:function(e){e.getState().socket.emit("req",Object(s.k)({type:"YOUCAM_LUDO_END_GAME",data:{players:window.ludoPlayers,color:window.mUserLudoColor}}),(function(e){}))}},{key:"userOut",value:function(t,n){window.ludoPlayers=window.ludoPlayers.filter((function(e){return e.color!=n})),window.ludoCurrentTurn==n&&e.updateTurn(void 0,t),$(".ludo_user."+n).remove(),window.ludoPlayers.filter((function(e){return!e.winner})).length<2&&(window.mUserLudoColor&&t.getState().socket.emit("req",Object(s.k)({type:"YOUCAM_LUDO_END_PUBLIC_GAME",data:{players:window.ludoPlayers,color:window.mUserLudoColor}}),(function(e){})),e.resetData(!window.mUserLudoColor))}},{key:"gameEnded",value:function(t,n){var r=window.ludoPlayers.filter((function(e){return e.color==n}))[0],o=t.getState().users.filter((function(e){return e.id==r.user_id}))[0];if(o){var i={id:Date.now(),user:o,data:o,type:"ludo_ended",title:"إنهاء اللعبة"};t.dispatch(Object(a.a)(i)),u.a.render(i,t)}e.resetData(!0)}},{key:"resetData",value:function(e){e&&$("#youcam_ludo_container").html(""),window.ludoCurrentTurn=void 0,window.mUserLudoColor=void 0,window.ludoPlayers=[],window.isLudoPlayerMoving=!1,window.isLudoWaitingForMove=!1,window.currentDiceValue=0}},{key:"renderUser",value:function(e){if(!e)return"";var t="<div class='ludo_user "+e.color+"' >";return t+="<img class='ludo_user--avatar' src='"+e.avatar+"' />",t+=d.a.render(e),t+="</div>"}},{key:"isLudoMinimized",value:function(){return!!$("#show_ludo").length}},{key:"setState",value:function(t,n){t.players.forEach((function(t){for(var n=1;n<=4;n++){var r=t["coin"+n];if(r>0){var o=window.ludoSteps[e.getPath(t.color)[r-1]],i=$("#"+t.color+"-player-"+n);if(i.attr("data-cp",r),r==e.getRedPath().length){i.attr("data-status","win");var a=i.get(0).outerHTML,s="";"red"==t.color&&(s=".rwh"),"green"==t.color&&(s=".gwh"),"yellow"==t.color&&(s=".ywh"),"blue"==t.color&&(s=".bwh"),$(".winner-home "+s).html($(".winner-home "+s).html()+a)}else{i.attr("data-status","active");var c=i.get(0).outerHTML;o.innerHTML=o.innerHTML+c}i.remove()}}})),e.onPlayerClicked(n)}},{key:"render",value:function(t,n,r){if(t.getState().mUser.room){n||(n="");var o=t.getState().users.filter((function(e){return e.room&&e.room.id==t.getState().mUser.room.id})),a=null,s=null,u=null,d=null,l=window.ludoPlayers.filter((function(e){return"red"==e.color}))[0];l&&((a=o.filter((function(e){return e.id==l.user_id}))[0]).color="red");var f=window.ludoPlayers.filter((function(e){return"green"==e.color}))[0];f&&((s=o.filter((function(e){return e.id==f.user_id}))[0]).color="green");var p=window.ludoPlayers.filter((function(e){return"yellow"==e.color}))[0];p&&((u=o.filter((function(e){return e.id==p.user_id}))[0]).color="yellow");var m=window.ludoPlayers.filter((function(e){return"blue"==e.color}))[0];m&&((d=o.filter((function(e){return e.id==m.user_id}))[0]).color="blue");var h='<main class="container">';h+='<span id="ludo-board__top_buttons">',window.mUserLudoColor&&(h+="<button class='btn btn-danger fa fa-times' id='ludo-board__close'></button>"),h+="<button class='btn btn-warning fa fa-minus' id='ludo-board__hide'></button>",h+="</span>",h+='<div class="ludo-board" data-u="'+n+'">',h+='<div class="red-home red-home-bg bg-red super-center">',h+='<button id="red-dice" class="d0"></button>',h+='<div class="white-box super-center">',h+='<div class="player-room">',h+='<div data-status="home" data-cp="0" class="player bg-red movered1" id="red-player-1"></div>',h+='<div data-status="home" data-cp="0" class="player bg-red movered2" id="red-player-2"></div>',h+='<div data-status="home" data-cp="0" class="player bg-red movered3" id="red-player-3"></div>',h+='<div data-status="home" data-cp="0" class="player bg-red movered4" id="red-player-4"></div>',h+="</div>",h+="</div>",h+=e.renderUser(a),h+="</div>",h+='<div class="step"></div>',h+='<div class="step"><span class="fa fa-arrow-down green"><span></div>',h+='<div class="step"></div>',h+='<div class="green-home green-home-bg bg-green super-center">',h+='<button id="green-dice" class="d0"></button>',h+='<div class="white-box super-center">',h+='<div class="player-room">',h+='<div data-status="home" data-cp="0" class="player bg-green movegreen1" id="green-player-1"></div>',h+='<div data-status="home" data-cp="0" class="player bg-green movegreen2" id="green-player-2"></div>',h+='<div data-status="home" data-cp="0" class="player bg-green movegreen3" id="green-player-3"></div>',h+='<div data-status="home" data-cp="0" class="player bg-green movegreen4" id="green-player-4"></div>',h+="</div>",h+="</div>",h+=e.renderUser(s),h+="</div>",h+='<div class="step"></div>',h+='<div class="step bg-green"></div>',h+='<div class="step bg-green"></div>',h+='<div class="step red-stop"></div>',h+='<div class="step bg-green"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step bg-green"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step bg-green"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step bg-green"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step bg-red">',h+="</div>",h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="winner-home">',h+='<div class="rwh stack"></div>',h+='<div class="gwh stack"></div>',h+='<div class="bwh stack"></div>',h+='<div class="ywh stack"></div>',h+="</div>",h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step green-stop"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step"><span class="fa fa-arrow-right red"></span></div>',h+='<div class="step bg-red"></div>',h+='<div class="step bg-red"></div>',h+='<div class="step bg-red"></div>',h+='<div class="step bg-red"></div>',h+='<div class="step bg-red"></div>',h+='<div class="step bg-yellow"></div>',h+='<div class="step bg-yellow"></div>',h+='<div class="step bg-yellow"></div>',h+='<div class="step bg-yellow"></div>',h+='<div class="step bg-yellow"></div>',h+='<div class="step"><span class="fa fa-arrow-left yellow"></span></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step blue-stop"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step bg-yellow"></div>',h+='<div class="step"></div>',h+='<div class="blue-home bg-blue blue-home-bg super-center">',h+='<button id="blue-dice" class="d0"></button>',h+='<div class="white-box super-center">',h+='<div class="player-room">',h+='<div data-status="home" data-cp="0" class="player bg-blue moveblue1" id="blue-player-1"></div>',h+='<div data-status="home" data-cp="0" class="player bg-blue moveblue2" id="blue-player-2"></div>',h+='<div data-status="home" data-cp="0" class="player bg-blue moveblue3" id="blue-player-3"></div>',h+='<div data-status="home" data-cp="0" class="player bg-blue moveblue4" id="blue-player-4"></div>',h+="</div>",h+="</div>",h+=e.renderUser(d),h+="</div>",h+='<div class="step"></div>',h+='<div class="step bg-blue"></div>',h+='<div class="step"></div>',h+='<div class="yellow-home yellow-home-bg bg-yellow super-center">',h+='<button id="yellow-dice" class="d0"></button>',h+='<div class="white-box super-center">',h+='<div class="player-room">',h+='<div data-status="home" data-cp="0" class="player bg-yellow moveyellow1" id="yellow-player-1"></div>',h+='<div data-status="home" data-cp="0" class="player bg-yellow moveyellow2" id="yellow-player-2"></div>',h+='<div data-status="home" data-cp="0" class="player bg-yellow moveyellow3" id="yellow-player-3"></div>',h+='<div data-status="home" data-cp="0" class="player bg-yellow moveyellow4" id="yellow-player-4"></div>',h+="</div>",h+="</div>",h+=e.renderUser(u),h+="</div>",h+='<div class="step"></div>',h+='<div class="step bg-blue"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step bg-blue"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step bg-blue"></div>',h+='<div class="step yellow-stop"></div>',h+='<div class="step bg-blue"></div>',h+='<div class="step bg-blue"></div>',h+='<div class="step"></div>',h+='<div class="step"></div>',h+='<div class="step"><span class="fa fa-arrow-up blue"></span></div>',h+='<div class="step"></div>',h+="</div>",h+="</main>",$("#youcam_ludo_container").html(h),t.dispatch(Object(i.a)(null)),c.a.togglePane(t,!0),window.ludoSteps=document.getElementsByClassName("step"),window.step_sound=new Audio("/step.mp3"),window.dead_sound=new Audio("/dead.mp3"),window.inout_sound=new Audio("/inout.mp3"),window.dice_sound=new Audio("/dice3.mp3"),window.winner_sound=new Audio("/winner.mp3"),window.ludoPlayers&&window.ludoPlayers.length&&window.ludoPlayers.forEach((function(e){e&&$("#"+e.color+"-dice").show()})),r&&e.setState(r,t),e.setSizes(),e.focusCurrentTurn(t),e.registerEvents(t)}}}],(n=null)&&m(t.prototype,n),r&&m(t,r),e}();t.a=h},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"registerEvents",value:function(t){e.onSelect()}},{key:"onSelect",value:function(){$(".emoji_picker img.emoji_picker__item").unbind("click").on("click",(function(e){var t=e.target.dataset.key,n=document.querySelector($(this).parent().data("input"));n&&(n.value=n.value.trim()+" "+t+" ",n.focus())}))}},{key:"toggle",value:function(e){e&&(e.getState().isPublicMessagesFacePickerOpen?$(".emoji_picker.public_messages").show():$(".emoji_picker.public_messages").hide(),e.getState().isPrivateMessagesFacePickerOpen?$(".emoji_picker.private_messages").show():$(".emoji_picker.private_messages").hide(),e.getState().isWallFacePickerOpen?$(".emoji_picker.wall").show():$(".emoji_picker.wall").hide(),e.getState().isWallCommentsFacePickerOpen?$(".emoji_picker.wall-comments").show():$(".emoji_picker.wall-comments").hide())}},{key:"render",value:function(e,t,n){var r="<div class='emoji_picker "+e+"' data-input='"+t+"' style='display: none'>";return n.getState().faces.map((function(e){r+="<img src='/uploads/faces/"+e.icon+"' height='22' data-key='"+e.key+"' class='emoji_picker__item' alt='emoji' />"})),r+="</div>"}}],(n=null)&&r(t.prototype,n),o&&r(t,o),e}();t.a=o},function(e,t,n){var r,o,i,a,s,c,u,d,l,f,p,m,h,_,g,v,y,b,w;e.exports=(r=n(8),n(45),void(r.lib.Cipher||(o=r,i=o.lib,a=i.Base,s=i.WordArray,c=i.BufferedBlockAlgorithm,u=o.enc,u.Utf8,d=u.Base64,l=o.algo.EvpKDF,f=i.Cipher=c.extend({cfg:a.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){c.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?w:y}return function(t){return{encrypt:function(n,r,o){return e(r).encrypt(t,n,r,o)},decrypt:function(n,r,o){return e(r).decrypt(t,n,r,o)}}}}()}),i.StreamCipher=f.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),p=o.mode={},m=i.BlockCipherMode=a.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),h=p.CBC=function(){var e=m.extend();function t(e,t,n){var r=this._iv;if(r){var o=r;this._iv=void 0}else o=this._prevBlock;for(var i=0;i<n;i++)e[t+i]^=o[i]}return e.Encryptor=e.extend({processBlock:function(e,n){var r=this._cipher,o=r.blockSize;t.call(this,e,n,o),r.encryptBlock(e,n),this._prevBlock=e.slice(n,n+o)}}),e.Decryptor=e.extend({processBlock:function(e,n){var r=this._cipher,o=r.blockSize,i=e.slice(n,n+o);r.decryptBlock(e,n),t.call(this,e,n,o),this._prevBlock=i}}),e}(),_=(o.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,r=n-e.sigBytes%n,o=r<<24|r<<16|r<<8|r,i=[],a=0;a<r;a+=4)i.push(o);var c=s.create(i,r);e.concat(c)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},i.BlockCipher=f.extend({cfg:f.cfg.extend({mode:h,padding:_}),reset:function(){f.reset.call(this);var e=this.cfg,t=e.iv,n=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var r=n.createEncryptor;else r=n.createDecryptor,this._minBufferSize=1;this._mode&&this._mode.__creator==r?this._mode.init(this,t&&t.words):(this._mode=r.call(n,this,t&&t.words),this._mode.__creator=r)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4}),g=i.CipherParams=a.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),v=(o.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;if(n)var r=s.create([1398893684,1701076831]).concat(n).concat(t);else r=t;return r.toString(d)},parse:function(e){var t=d.parse(e),n=t.words;if(1398893684==n[0]&&1701076831==n[1]){var r=s.create(n.slice(2,4));n.splice(0,4),t.sigBytes-=16}return g.create({ciphertext:t,salt:r})}},y=i.SerializableCipher=a.extend({cfg:a.extend({format:v}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r),i=o.finalize(t),a=o.cfg;return g.create({ciphertext:i,key:n,iv:a.iv,algorithm:e,mode:a.mode,padding:a.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),b=(o.kdf={}).OpenSSL={execute:function(e,t,n,r){r||(r=s.random(8));var o=l.create({keySize:t+n}).compute(e,r),i=s.create(o.words.slice(t),4*n);return o.sigBytes=4*t,g.create({key:o,iv:i,salt:r})}},w=i.PasswordBasedCipher=y.extend({cfg:y.cfg.extend({kdf:b}),encrypt:function(e,t,n,r){var o=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize);r.iv=o.iv;var i=y.encrypt.call(this,e,t,o.key,r);return i.mixIn(o),i},decrypt:function(e,t,n,r){r=this.cfg.extend(r),t=this._parse(t,r.format);var o=r.kdf.execute(n,e.keySize,e.ivSize,t.salt);return r.iv=o.iv,y.decrypt.call(this,e,t,o.key,r)}}))))},function(e,t,n){"use strict";var r=n(5),o=n(0),i=n(18),a=n(13),s=n(7),c=n(1),u=n(47),d=n(66),l=n(36),f=n(3),p=n(29),m=n.n(p),h=n(103),_=n.n(h),g=n(40),v=n(53),y=n(54),b=n(24),w=n(6);function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,p;return t=e,p=[{key:"registerEvents",value:function(t){e.close(t),e.mute(t),e.onCall(t),e.expand(),e.compress(),e.onWriting(t),e.onSubmit(t),e.sendMedia(t),e.openProfile(t),e.onInputSubmit(t),e.stopRecording(t),e.startRecording(t),e.openFacePicker(t),e.onChatBoxClicked(t),e.triggerSendMediaInput(t)}},{key:"onInputSubmit",value:function(e){$("#chat_box__footer__input").unbind("keydown").on("keydown",(function(e){if(13===e.which){if(!e.repeat){var t=new Event("submit",{cancelable:!0});e.target.form.dispatchEvent(t)}e.preventDefault()}}))}},{key:"peerOnCall",value:function(t){window.peer.on("call",(function(t){console.log("mPeer.call"),window.incomingCall=t,window.incomingCall.on("close",(function(){window.incomingCall=null})),navigator.mediaDevices.getUserMedia({audio:!0}).then((function(n){window.incomingStream=n,t.answer(n),t.on("stream",(function(t){e.playStream(t)})),t.on("close",(function(){if(window.incomingStream){try{window.incomingStream.stop(),console.log("window.incomingStream.stop()")}catch(e){window.incomingStream.getTracks().forEach((function(e){e.stop()})),console.log("window.incomingStream.getTracks()")}window.incomingStream=null,window.callsAudio.src=null}}))})).catch((function(e){console.log("peerOnCall.mediaDevices.getUserMedia.error",e),alert("هذا المتصفح لا يدعم هذه الخاصية, الرجاء إستعمال كروم أو فايرفوكس")}))}))}},{key:"onCall",value:function(t){$("#chat_box__footer__call").unbind("click").on("click",(function(n){if(!w.a.checkForWaitingRoom(t))return navigator.mediaDevices?$("#call_container").html()?$("#call-dialog").show():void t.getState().socket.emit("req",Object(o.k)({type:"CALL_REQUEST",data:{id:t.getState().currentConversation.id}}),(function(n){if("rigning"==n.message){e.makeCall(t),t.dispatch(Object(g.a)(!0));var r={user:n.user,dialogType:"call-sent",statusClass:"warning",status:"يتم الإتصال الآن..."};t.dispatch(Object(v.a)(r)),y.a.render(t,r)}else"not ready"==n.message?t.dispatch(Object(g.a)(!0)):alert(n.message)})):alert("هذا المتصفح أو الجهاز لا يدعم هذه الخصاية")}))}},{key:"makeCall",value:function(t){navigator.mediaDevices.getUserMedia({audio:!0}).then((function(n){var r=window.peer.call(t.getState().currentConversation.id,n);window.outgoinCall=r,window.outgoinStream=n,r.on("stream",(function(t){e.playStream(t)}))})).catch((function(e){alert(e.stack),console.log("makeCall.mediaDevices.getUserMedia.error",e)}))}},{key:"playStream",value:function(e){try{window.callsAudio.srcObject=e}catch(t){window.callsAudio.src=window.URL.createObjectURL(e)}window.callsAudio.onloadedmetadata=function(e){window.callsAudio.play()}}},{key:"updateUser",value:function(e,t){if(t.getState().currentConversation&&e==t.getState().currentConversation.id){var n=t.getState().users.filter((function(t){return t.id==e}))[0];if(n){var o=$("#chat_box");o&&(o.find(".chat_box__header__avatar").attr("src",n.avatar),o.find(".chat_box__header__name").html(r.a.render(n)))}}}},{key:"openFacePicker",value:function(e){$("#chat_box #chat_box__footer__smile").unbind("click").on("click",(function(t){e.dispatch(Object(d.a)(!0)),i.a.registerEvents(e)}))}},{key:"onSubmit",value:function(t){$("#chat_box form").unbind("submit").on("submit",(function(n){if(n.preventDefault(),!w.a.checkForWaitingRoom(t)){var r=t.getState().currentConversation.id,o=n.target.message,i=o.value.trim();i&&(e.sendMessage({message:i,id:r,type:"text"},o,t),o&&(o.value=""))}}))}},{key:"sendMessage",value:function(t,n,r){var i=t.message,s=t.id,c=t.type;!n||"text"!=c&&"youtube"!=c||n.focus(),r||(r=window.store),s||(s=r.getState().currentConversation.id),r.getState().socket.emit("req",Object(o.k)({type:"NEW_PRIVATE_MESSAGE",data:{id:s,message:i,type:c}}),(function(t){if("string"==typeof(t=Object(o.g)(t)))return f.a.render({id:Date.now(),user:r.getState().users.filter((function(e){return e.id==s}))[0],type:null,message:t,title:"تنبيه"},r);if("object"==S(t)){var n=s,i=r.getState().mUser,c=r.getState().currentConversation,u=t,d=r.getState().currentConversation.id==n;r.dispatch(Object(a.a)(n,i,c,d,u)),e.insert(u,i,r)}}))}},{key:"triggerSendMediaInput",value:function(e){$("#chat_box__footer__share").unbind("click").on("click",(function(t){if(!w.a.checkForWaitingRoom(e)&&!$(this).closest("form").hasClass("loading")){var n=document.getElementById("chat_box__footer_attach");n&&n.click()}}))}},{key:"sendMedia",value:function(t){$("#chat_box__footer_attach").unbind("change").on("change",(function(n){var r=this,i=new FormData;i.append("file",n.target.files[0]),t.getState().socket.emit("req",Object(o.k)({type:"BEFORE_SEND_MEDIA",data:{id:t.getState().currentConversation.id}}),(function(n){if("string"==typeof(n=Object(o.g)(n)))return alert(n);if(!0===n){$(r).closest("form").addClass("loading");var a=$("#chat_box__footer__loading_percent"),s=t.getState().currentConversation.id;m.a.post("/send_private_media",i,{onUploadProgress:function(e){var t=Math.round(100*e.loaded/e.total);a.text(t<10?"0"+t:t)}}).then((function(n){!1===n.data.error&&e.sendMessage({message:n.data.file,id:s,type:n.data.type},void 0,t),$(r).closest("form").removeClass("loading"),a.text("00")})).catch((function(e){$(r).closest("form").removeClass("loading"),a.text("00")}))}}))}))}},{key:"openProfile",value:function(e){$("#chat_box__header__profile").unbind("click").on("click",(function(t){b.a.show(e.getState().currentConversation.id,e)}))}},{key:"insert",value:function(t,n,r){$("#chat_box_container #chat_box__body").append(u.a.render(t,n,r)),e.scrollToBottom(),u.a.registerEvents(r)}},{key:"insertIsWriting",value:function(t,n){$("#chat_box__body__is_writing").remove(),$("#chat_box_container #chat_box__body").append("<img src='/images/is_writing.gif' id='chat_box__body__is_writing' height='90' />"),setTimeout((function(){$("#chat_box__body__is_writing").remove()}),2e3),e.scrollToBottom()}},{key:"onChatBoxClicked",value:function(e){$("#chat_box").unbind("click").on("click",(function(t){e.dispatch(Object(s.a)(null)),c.a.togglePane(e,!0,t)}))}},{key:"close",value:function(e){$("#chat_box__header__close").unbind("click").on("click",(function(t){$("#chat_box_container").html(""),e.dispatch(Object(a.f)(null))}))}},{key:"expand",value:function(){$("#chat_box__header__expand").unbind("click").on("click",(function(e){$("#chat_box").addClass("expanded")}))}},{key:"compress",value:function(){$("#chat_box__header__compress").unbind("click").on("click",(function(e){$("#chat_box").removeClass("expanded")}))}},{key:"onWriting",value:function(t){$("#chat_box__footer__input").unbind("input").on("input",(function(n){window.lastPrivateInputTime?Date.now()-window.lastPrivateInputTime>=1e3&&(window.lastPrivateInputTime=Date.now(),e.sendIsWriting(t)):(window.lastPrivateInputTime=Date.now(),e.sendIsWriting(t))}))}},{key:"sendIsWriting",value:function(e){var t=e.getState().currentConversation;t&&e.getState().socket.emit("req",Object(o.k)({type:"IS_WRITING",data:{user:t.id}}),(function(){}))}},{key:"mute",value:function(e){$("#chat_box__header__mute, #chat_box__header__unmute").unbind("click").on("click",(function(t){e.getState().socket.emit("req",Object(o.k)({type:"TOGGLE_PRIVATE_BIP",data:{}}),(function(t){t=Object(o.g)(t),l.a.updateUserAttribute("isPrivateBipEnabled",t,e),e.getState().mUser.reg_id||Object(o.w)("isPrivateBipEnabled",Object(o.k)(t,!0)),t?$("#chat_box").removeClass("muted"):$("#chat_box").addClass("muted")}))}))}},{key:"playNotification",value:function(e){if(e.getState().mUser.isPrivateBipEnabled){var t=document.getElementById("private-bip");t&&t.play()}}},{key:"renderMessages",value:function(e){var t=e.getState().currentConversation,n=e.getState().conversations.filter((function(e){return e.id==t.id}))[0],r="";return n&&n.messages.forEach((function(t){var o=n.me.id==t.by?n.me:n.him;r+=u.a.render(t,o,e)})),r}},{key:"scrollToBottom",value:function(){var e=document.getElementById("chat_box__body");e&&(e.scrollTop=e.scrollHeight-e.clientHeight)}},{key:"startRecording",value:function(t){$("#chat_box__footer__start_recording").unbind("click").on("click",(function(n){w.a.checkForWaitingRoom(t)||($("#chat_box__footer__start_recording").hide(),$("#chat_box__footer__stop_recording").show(),window.isRecordingSound||(window.isRecordingSound=!0,window.store=t,navigator.mediaDevices.getUserMedia({audio:!0}).then(e.onMediaStreamSuccess.bind(null,t.getState().currentConversation.id)).catch(e.onMediaStreamError)))}))}},{key:"stopRecording",value:function(e){$("#chat_box__footer__stop_recording").unbind("click").on("click",(function(e){$("#chat_box__footer__stop_recording").hide(),$("#chat_box__footer__start_recording").show(),window.isRecordingSound=!1,null!=window.mediaRecorder&&(window.mediaRecorder.stop(),null!=window.mediaRecorder.stream&&window.mediaRecorder.stream.stop())}))}},{key:"uploadblob",value:function(e,t){if(e){var n=new FormData;n.append("file",e),n.append("_token",$("meta[name='csrf-token']").attr("content")),$.ajax({url:"/private_upload_blob",type:"POST",data:n,cache:!1,processData:!1,contentType:!1,success:function(e){(e=JSON.parse(e))&&!e.error&&e.src?t(e.src):alert("حدث خطأ أثناء حفظ التسجيل")},error:function(e){alert("حدث خطأ أثناء حفظ التسجيل")}})}}},{key:"onMediaStreamSuccess",value:function(t,n){try{window.mediaRecorder=new _.a(n);var r=null;window.mediaRecorder.bufferSize=8192,window.mediaRecorder.stream=n,window.mediaRecorder.mimeType="audio/webm",window.mediaRecorder.dur=Date.now(),window.mediaRecorder.ondataavailable=function(n){if(!((Date.now()-window.mediaRecorder.dur)/1e3<1)){var o=$('<div class="audio-recorder"><audio type="audio/webm" controls></audio><button class="btn btn-success">إرسال</button>&nbsp;<button class="btn btn-danger">إلغاء</button></div>');o.find("audio").attr("src",window.URL.createObjectURL(n)),e.uploadblob(n,(function(e){o.find("audio").attr("src","/uploads/private/"+e),r=e})),o.find(".btn-success").click((function(){r&&e.sendMessage({message:r,id:t,type:"sound"}),o.remove()})),o.find(".btn-danger").click((function(){o.remove(),e.removeBlob(r)})),$("#chat_box__body").append(o)}},window.mediaRecorder.start(3e4)}catch(e){console.log("onMediaStreamSuccess.error",e)}}},{key:"onMediaStreamError",value:function(e){window.isRecordingSound=!1,window.store=void 0,alert("هذا المتصفح لا يدعم ميزة التسجيل, الرجاء إستخدام جوجل كروم")}},{key:"removeBlob",value:function(e){window.store=void 0;var t=new FormData;t.append("file",e),t.append("_token",$("meta[name='csrf-token']").attr("content")),$.ajax({url:"/private_remove_blob",type:"POST",data:t,cache:!1,processData:!1,contentType:!1,success:function(e){},error:function(e){}})}},{key:"render",value:function(t){var n="#FAFAFA";t.getState().settings.show_chat_background_on_windows&&(n=t.getState().settings.chat_background?t.getState().settings.window_color+" url(/uploads/"+t.getState().settings.chat_background+")":t.getState().settings.window_color+" url(/images/main_background.png)");var o=t.getState().currentConversation;if(!o)return $("#chat_box_container").html("");var s="<div id='chat_box' class='"+(t.getState().mUser.isPrivateBipEnabled?"":"muted")+"'>";s+="<header class='chat_box__header label-primary'>",s+="<button id='chat_box__header__profile' class='border btn btn-default fa fa-user'></button>",s+="<img class='chat_box__header__avatar' width='25' height='25' src='"+o.avatar+"' alt='' />",s+="<p class='chat_box__header__name ellipsis'>"+r.a.render(o)+"</p>",s+="<button id='chat_box__header__mute' class='btn btn-success fa fa-bell-o pull-right'></button>",s+="<button id='chat_box__header__unmute' class='btn btn-success fa fa-bell-slash-o pull-right'></button>",s+="<button id='chat_box__header__expand' class='btn btn-info fa fa-expand pull-right'></button>",s+="<button id='chat_box__header__compress'class='btn btn-info fa fa-compress pull-right'></button>",s+="<button id='chat_box__header__close' class='btn btn-danger fa fa-minus pull-right'></button>",s+="</header><div class='clear'></div>",s+="<div class='chat_box__body' id='chat_box__body' style='background: "+n+"'>",s+=e.renderMessages(t),s+="</div>",s+="<footer class='chat_box__footer'>",s+=i.a.render("private_messages","#chat_box__footer__input",t),s+="<form>",t.getState().features.FT_IS_PRIVATE_RECORD_AUDIO_ENABLED&&(s+="<button id='chat_box__footer__start_recording' type='button' class='btn btn-success fa fa-microphone'></button>",s+="<button id='chat_box__footer__stop_recording' type='button' class='btn btn-danger fa fa-stop'></button>"),t.getState().features.FT_IS_CALLS_ENABLED&&t.getState().currentConversation.id!=t.getState().mUser.id&&(s+="<button type='button' id='chat_box__footer__call' class='btn btn-success fa fa-phone'></button>"),s+="<span style='position: relative'><span id='chat_box__footer__loading_percent'>00</span><img id='chat_box__footer__loader' src='/images/loader.gif' width='30' height='30' alt=''/></span>",s+="<button id='chat_box__footer__share' type='button' class='btn btn-primary fa fa-share-alt'></button>",s+="<img style='cursor: pointer' src='/images/smile.gif' alt='فيس' id='chat_box__footer__smile' class='chat_box__footer__smile' width='22' height='22' />",s+="<textarea class='chat_box__footer__input' id='chat_box__footer__input' dir='rtl' name='message' placeholder='أكتب رسالتك هنا...' autoComplete='off' ></textarea>",s+="<button id='chat_box__footer__submit' class='btn btn-primary fa fa-send'></button>",s+="<input id='chat_box__footer_attach' type='file' accept='image/*, video/*, audio/*' style='display: none; position: absolute; left: 9999px' />",s+="</form>",s+="</footer>",s+="</div>",$("#chat_box_container").html(s),t.dispatch(Object(a.b)(o.id)),e.registerEvents(t),e.scrollToBottom(),c.a.updateConversationsCount(t),u.a.registerEvents(t)}}],(n=null)&&k(t.prototype,n),p&&k(t,p),e}();t.a=C},function(e,t,n){"use strict";var r=n(0),o=n(9),i=n(6),a=n(34),s=n(2),c=n(17);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,l;return t=e,l=[{key:"registerEvents",value:function(t){e.joinRoom(t)}},{key:"joinRoom",value:function(t){$(".chat_pane__room_item, .chat_pane__room_item--inline").unbind("click").on("click",(function(n){if("object"==u(window.ludoPlayers)&&window.ludoPlayers.filter((function(e){return e.user_id==t.getState().mUser.id}))[0])return alert("لايمكنك القيام بهذه العملية حتى تخرج من اللودو");var o=$(this).data("id"),d=null;if((!t.getState().mUser.room||t.getState().mUser.room.id!=o)&&(!$(this).data("password")||t.getState().mUser.canOpenLockedRooms||(d=prompt("الرجاء إدخال كلمة المرور")))){var l={type:"JOIN_ROOM",data:{id:o,password:d}};t.getState().socket.emit("req",Object(r.k)(l),(function(n){!1===(n=Object(r.g)(n)).error?(s.a.removeUserFromMic(t,t.getState().mUser),i.a.setRooms(t),i.a.setCurrentRoomActive(t),e.registerEvents(t),a.a.toggleInput(t),t.getState().mUser.room&&t.getState().mUser.room.micUsers.forEach((function(e){})),s.a.setMics(t),$("body").attr("id","room-"+t.getState().mUser.room.id),t.getState().mUser.room.ludoGameState.players?(window.ludoPlayers=t.getState().mUser.room.ludoGameState.players,window.ludoCurrentTurn=t.getState().mUser.room.ludoGameState.currentTurn,c.a.render(t,null,t.getState().mUser.room.ludoGameState),$("#youcam_ludo_container main").hide(),$("#youcam_ludo_container").append("<div id='show_ludo'><img src='/images/ludo_icon.jpeg' /></div>"),c.a.onShowLudo(t)):c.a.resetData(!0)):n.message&&alert(n.message)}))}}))}},{key:"renderRoom",value:function(e,t){var n=t.getState().mUser.room&&t.getState().mUser.room.id==e.id?"active":"",i=e.password?"locked":"",a=e.mics&&e.mics.length?"has-mic":"",s=a?"fa-microphone":"fa-user",c="<div data-id='"+e.id+"' data-password='"+e.password+"' class='chat_pane__room_item "+n+" "+i+" "+a+"' >";return"?test"==location.search?c+="<p class='chat_pane__room_item__flag'><img class='radius' width='36' height='36' alt='' src='/images/floating_rose3.png' /></p>":c+="<p class='chat_pane__room_item__flag'><img class='radius' width='36' height='36' alt='' src='"+Object(r.e)()+e.flag+"' /></p>",c+="<div>",c+="<h5 class='chat_pane__room_item__name'>",c+=e.name,c+="<img class='chat_pane__room_item--lock' alt='' src='"+Object(r.e)()+"/images/lock.png' />",c+="</h5>",c+="<h5 class='chat_pane__room_item__description'>",c+=o.a.render(e.description,t),c+="</h5>",c+="</div>",c+="<span class='chat_pane__room_item__users corner fa "+s+" label label-primary fr'>"+e.users.length+"/"+e.capacity+"</span>",c+="<div class='clear'></div>",c+="</div>"}},{key:"renderInlineRoom",value:function(e,t){var n="<span data-id='"+e.id+"' data-password='"+e.password+"' class='chat_pane__room_item--inline label label-primary'>";return n+=e.name,n+=t?"<img src='"+Object(r.e)()+e.flag+"' width='20' alt=''/>":"<span class='fa fa-sign-in'></span>",n+="</span>"}},{key:"render",value:function(t,n,r,o){return t?n&&t?e.renderInlineRoom(t,o):e.renderRoom(t,r):""}}],(n=null)&&d(t.prototype,n),l&&d(t,l),e}();t.a=l},function(e,t,n){"use strict";var r=n(0),o=n(14),i=n(18),a=n(25),s=n(1),c=n(33),u=n(69),d=n(29),l=n.n(d),f=n(6);function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var m=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,d;return t=e,d=[{key:"registerEvents",value:function(t){e.publish(t),e.fetchPosts(t),e.attachFile(t),e.onInputSubmit(t),e.openFacePicker(t),e.searchYoutube(t),e.onYoutubeInputSubmit(t),e.triggerAttachFileInput(t),e.clear(t),window.wallPane.hide()}},{key:"onYoutubeInputSubmit",value:function(e){$("#chat_pane_youtube__input").unbind("keydown").on("keydown",(function(e){if(13===e.which){if(!e.repeat){var t=new Event("submit",{cancelable:!0});e.target.form.dispatchEvent(t)}e.preventDefault()}}))}},{key:"searchYoutube",value:function(t){$("#chat__body__wall_pane #chat_pane_youtube form").on("submit",(function(n){var o=this;if(n.preventDefault(),!f.a.checkForWaitingRoom(t)){var i=n.target.query.value.trim();if(i){if(navigator.youtubeCache&&navigator.youtubeCache[i])return e.renderYoutubeResults(t,navigator.youtubeCache[i]);if($(this).find("textarea").attr("disabled","disabled").addClass("loading"),$(this).find("button").attr("disabled","disabled"),t.getState().mUser.youtubeAPIKey)return e.makeYoutubeRequest(t,i,this);t.getState().socket.emit("req",Object(r.k)({type:"WALL_YOUTUBE_SEARCH",data:{query:i}}),(function(n){if($(o).find("textarea").removeAttr("disabled").removeClass("loading"),$(o).find("button").removeAttr("disabled"),$("#chat_pane_youtube__input").val(""),"string"==typeof(n=Object(r.g)(n)))return alert(n);n.items&&n.items.length&&(navigator.youtubeCache||(navigator.youtubeCache={}),navigator.youtubeCache[i]=n.items,e.renderYoutubeResults(t,n.items))}))}}}))}},{key:"makeYoutubeRequest",value:function(t,n,o){if(n&&t.getState().mUser.youtubeAPIKey){var i="https://www.googleapis.com/youtube/v3/search?part=snippet&key="+t.getState().mUser.youtubeAPIKey+"&type=video&q="+encodeURI(n);l.a.get(i).then((function(r){if(!r.data||!r.data.items||!r.data.items.length)return[];var i=[];r.data.items.forEach((function(e){var t=e.id.videoId,n=e.snippet.title,r=e.snippet.thumbnails.medium;i.push({videoId:t,title:n,thumbnail:r})})),navigator.youtubeCache||(navigator.youtubeCache={}),navigator.youtubeCache[n]=i,e.renderYoutubeResults(t,i),e.enableYoutubeInput(o)})).catch((function(n){t.getState().socket.emit("req",Object(r.k)({type:"WALL_YOUTUBE_RESET",data:{}}),(function(e){t.getState().mUser.youtubeAPIKey=e})),e.enableYoutubeInput(o),alert("حدث خطأ أثناء القيام بالعملية, الرجاء إعادة المحاولة")}))}}},{key:"enableYoutubeInput",value:function(e){$(e).find("textarea").removeAttr("disabled").removeClass("loading"),$(e).find("button").removeAttr("disabled"),$("#chat_pane_youtube__input").val("")}},{key:"onInputSubmit",value:function(e){$("#chat__body__wall_pane__form__input").unbind("keydown").on("keydown",(function(e){if(13===e.which){if(!e.repeat){var t=new Event("submit",{cancelable:!0});e.target.form.dispatchEvent(t)}e.preventDefault()}}))}},{key:"publish",value:function(t){$("#chat__body__wall_pane .chat__body__wall_pane__form").on("submit",(function(n){if(n.preventDefault(),!f.a.checkForWaitingRoom(t)){var r=n.target.message,o=r.value.trim();if(o){var i={type:"text",body:o};e.send(i,r,t)}}}))}},{key:"send",value:function(e,t,n){t&&(t.value=""),n.getState().socket.emit("req",Object(r.k)({type:"WALL_ADD_POST",data:e}),(function(e){if($("#chat__body__wall_pane__form__input").val(""),"string"==typeof(e=Object(r.g)(e)))return alert(e)}))}},{key:"fetchPosts",value:function(t){t.dispatch(Object(a.g)()),s.a.updateWallCout(t),t.getState().isPostsFetched||t.getState().socket.emit("req",Object(r.k)({type:"WALL_GET_POSTS",data:{}}),(function(n){t.dispatch(Object(a.i)(Object(r.g)(n))),t.dispatch(Object(a.h)(!0)),e.renderPosts(t)}))}},{key:"renderPosts",value:function(e){var t=$("#chat__body__wall_pane .chat_pane__container__posts");t.html(""),e.getState().posts.forEach((function(n){t.append(c.a.render(n,e))})),c.a.registerEvents(e)}},{key:"openFacePicker",value:function(e){$("#chat__body__wall_pane__form__attach__face").on("click",(function(t){e.dispatch(Object(u.a)(!0))}))}},{key:"updatePost",value:function(e,t){var n=t.getState().posts.filter((function(t){return t.id==e}))[0];if(n){var r=window.wallPane.find("#wall-post-"+n.id);r.find(".wall_post__body__heart").text(n.likes),r.find(".wall_post__body__comments").text(n.comments)}}},{key:"removePost",value:function(e){$("#wall-post-"+e).remove()}},{key:"addPost",value:function(e,t){e&&(window.wallPane.find(".chat_pane__container__posts").prepend(c.a.render(e,t)),c.a.registerEvents(t),window.wallPane.find(".wall_post").length>t.getState().settings.wall_msg_count&&window.wallPane.find(".wall_post:nth-child("+(t.getState().settings.wall_msg_count+1)+")").remove())}},{key:"setPosts",value:function(e){if(s.a.updateWallCout(e),"wall"==e.getState().currentPane&&!window.wallPane.find(".chat_pane__container__posts").length){$(".wall_post").unbind("click");var t=window.wallPane.find(".chat_pane__container__posts");t.html(""),e.getState().posts.forEach((function(n){t.append(c.a.render(n,e))})),c.a.registerEvents(e),document.querySelector("#chat__body__wall_pane .chat_pane__container").scrollTo({top:0}),window.wallPane.find("img").on("contextmenu",(function(){return!1}))}}},{key:"triggerAttachFileInput",value:function(e){window.wallPane.find(".chat__body__wall_pane__form__attach").unbind("click").on("click",(function(t){if(!f.a.checkForWaitingRoom(e)){var n=document.getElementById("chat__body__wall_pane__form__file");n&&n.click()}}))}},{key:"clear",value:function(e){window.wallPane.find(".chat__body__wall_pane__form__clear").unbind("click").on("click",(function(t){confirm("هل أنت متأكد من تفريغ الحائط؟")&&e.getState().socket.emit("req",Object(r.k)({type:"WALL_CLEAR",data:{}}),(function(e){}))}))}},{key:"removeAllPosts",value:function(e){window.wallPane.find(".wall_post").remove()}},{key:"attachFile",value:function(t){window.wallPane.find("#chat__body__wall_pane__form__file").unbind("change").on("change",(function(n){var o=n.target.files[0],i=new FormData;i.append("file",o),t.getState().socket.emit("req",Object(r.k)({type:"WALL_BEFORE_SEND_MEDIA",data:{}}),(function(n){if("string"==typeof(n=Object(r.g)(n)))return alert(n);if(!1===n.error){i.append("hash",n.hash),i.append("id",n.user_id);var a=null,s=o.type.split("/")[0];if("image"==s&&(a="/wall_upload_photo_post"),"audio"==s&&(a="/wall_upload_sound_post"),"video"==s&&(a="/wall_upload_video_post"),!a)return;window.wallPane.find(".chat__body__wall_pane__form__attach").hide(),window.wallPane.find(".chat__body__wall_pane__form__loader, .chat__body__wall_pane__form__loading_percent").show();var c=$(".chat__body__wall_pane__form__loading_percent");l.a.post(a,i,{onUploadProgress:function(e){var t=Math.round(100*e.loaded/e.total);c.text(t<10?"0"+t:t)}}).then((function(n){!1===n.data.error&&e.send({type:n.data.type,text:$("#chat__body__wall_pane__form__input").val(),body:n.data.body},null,t),window.wallPane.find(".chat__body__wall_pane__form__attach").show(),window.wallPane.find(".chat__body__wall_pane__form__loader, .chat__body__wall_pane__form__loading_percent").hide(),c.text("00")})).catch((function(e){window.wallPane.find(".chat__body__wall_pane__form__attach").show(),window.wallPane.find(".chat__body__wall_pane__form__loader, .chat__body__wall_pane__form__loading_percent").hide(),c.text("00")}))}}))}))}},{key:"update",value:function(e){var t=e.getState().settings.wall_banner_msg?e.getState().settings.wall_banner_msg:"";window.wallPane.find(".chat_pane__container__banner").css("background",e.getState().settings.wall_banner_background_color),window.wallPane.find(".chat_pane__container__banner").css("color",e.getState().settings.wall_banner_font_color),window.wallPane.find(".chat_pane__container__banner p").text(t),e.getState().settings.show_wall_banner?window.wallPane.find(".chat_pane__container__banner").show():window.wallPane.find(".chat_pane__container__banner").hide()}},{key:"registerYoutubeResultsEvents",value:function(t){e.onYoutubeResultClicked(t),e.onYoutubeResultClosed(t)}},{key:"renderYoutube",value:function(e){return"<div id='chat_pane_youtube'><form><button id='chat_pane_youtube__submit' class='fa fa-search btn btn-primary'></button><textarea id='chat_pane_youtube__input' name='query' placeholder='البحث في اليوتيوب' autoComplete='off' dir='rtl'></textarea><span id='chat_pane_youtube__icon' class='fa fa-youtube' /></form></div>"}},{key:"renderYoutubeResults",value:function(t,n){var r="<div id='chat_pane_youtube_items'>";n.forEach((function(e){r+="<img src='"+e.thumbnail.url+"' data-id='"+e.videoId+"' height='100' />"})),r+="<button id='chat_pane_youtube_items--close' class='fa fa-times btn btn-danger' ></button>",r+="</div>",$("#chat_pane_youtube_items").remove(),$("#chat_pane_youtube").append(r),e.registerYoutubeResultsEvents(t)}},{key:"onYoutubeResultClicked",value:function(e){$("#chat_pane_youtube_items img").unbind("click").on("click",(function(e){$("#chat__body__wall_pane #chat__body__wall_pane__form__input").val("https://www.youtube.com/watch?v="+$(this).data("id")).closest("form").trigger("submit"),$(this).closest("#chat_pane_youtube_items").remove(),$("#chat_pane_youtube__input").focus()}))}},{key:"onYoutubeResultClosed",value:function(e){$("#chat_pane_youtube_items #chat_pane_youtube_items--close").unbind("click").on("click",(function(e){$(this).closest("#chat_pane_youtube_items").remove()}))}},{key:"render",value:function(t){var n=t.getState().settings.wall_banner_msg?t.getState().settings.wall_banner_msg:"",a="<div id='chat__body__wall_pane' class='chat_pane' style='background: "+Object(r.u)(t.getState().settings,!0)+"'>";return a+=o.a.render("الحائط",!1),t.getState().features.FT_IS_WALL_YOUTUBE_ENABLED&&(a+=e.renderYoutube(t)),a+="<div class='chat_pane__container border'>",a+="<div class='chat_pane__container__banner' style='background: "+t.getState().settings.wall_banner_background_color+"; color: "+t.getState().settings.wall_banner_font_color+"'>",a+="<p>"+n+"</p>",a+="</div>",a+="<div class='chat_pane__container__posts'></div>",a+="</div>",a+="<form class='chat__body__wall_pane__form'>",a+="<button class='border-color btn btn-primary fa fa-share-alt chat__body__wall_pane__form__attach'></button>",t.getState().grantedSettings.wall_clear&&(a+="<button class='border-color btn btn-primary fa fa-trash chat__body__wall_pane__form__clear'></button>"),a+="<span><span class='chat__body__wall_pane__form__loading_percent'>00</span><img class='chat__body__wall_pane__form__loader' style='display: none' src='/images/loader.gif' width='24' height='24' alt='' /></span>",a+="<img class='chat__body__wall_pane__form__face' src='/images/smile.gif' alt='smile' id='chat__body__wall_pane__form__attach__face' width='22' height='22' />",a+="<textarea id='chat__body__wall_pane__form__input' class='border-color chat__body__wall_pane__form__input' name='message' placeholder='أكتب رسالتك هنا' autoComplete='off' dir='rtl'></textarea>",a+="<button class='border-color fa fa-send btn btn-primary chat__body__wall_pane__form__send'>إرسال</button>",a+="<input id='chat__body__wall_pane__form__file' type='file' accept='image/*, video/*, audio/*' style='display: none; position: absolute; left: 9999px' />",a+=i.a.render("wall","#chat__body__wall_pane__form__input",t),a+="</form>",a+="</div>"}}],(n=null)&&p(t.prototype,n),d&&p(t,d),e}();t.a=m},function(e,t,n){"use strict";n.d(t,"k",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"i",(function(){return i})),n.d(t,"h",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"j",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"g",(function(){return p}));var r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"SET_STORIES",stories:e}},o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"ADD_STORY",story:e}},i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:"REMOVE_STORY",id:e}},a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"LIKE_STORY",data:e}},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:"ADD_STORY_COMMENT",comment:e,force:t}},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:"REMOVE_STORY_COMMENT",id:e,story_id:t}},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:"INC_STORY_COMMENT_LIKES",comment_id:e,story_id:t}},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:"INC_STORY_COMMENTS_COUNT",id:e}},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:"DEC_STORY_COMMENTS_COUNT",id:e}},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:"ADD_STORY_VIEW",view:e,force:t}},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:"INC_STORY_VIEWS_COUNT",id:e}}},function(e,t,n){"use strict";var r=n(5),o=n(9),i=n(21),a=n(0);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.clearGift(t),e.onSelect(t),e.close(t)}},{key:"clearGift",value:function(e){$(".gifts_picker__contianer__clear").unbind("click").on("click",(function(t){var n=e.getState().requestedUser.id;e.getState().socket.emit("req",Object(a.k)({type:"PROFILE_ACTION_REMOVE_GIFT",data:{userID:n}}),(function(e){"string"==typeof(e=Object(a.g)(e))&&alert(e)}))}))}},{key:"onSelect",value:function(e){$(".gifts_picker__contianer__img").unbind("click").on("click",(function(t){var n=e.getState().requestedUser,r=$(this).data("id"),o=n.id;n.icon!=$(this).attr("src")&&e.getState().socket.emit("req",Object(a.k)({type:"PROFILE_ACTION_GIFT",data:{userID:o,giftID:r}}),(function(e){"string"==typeof(e=Object(a.g)(e))&&alert(e)}))}))}},{key:"close",value:function(e){$(".gifts_picker__contianer__close").unbind("click").on("click",(function(e){$("#user_profile .gifts_picker").hide(),$("#user_profile .user_profile__body__avatar").show()}))}},{key:"render",value:function(e){var t="<div class='gifts_picker' style='display: none'>";return t+="<div class='gifts_picker__contianer'>",e.getState().gifts.forEach((function(e){t+="<img data-id='"+e.id+"' src='"+e.icon+"' class='gifts_picker__contianer__img' />"})),t+="</div>",t+="<button class='gifts_picker__contianer__clear btn btn-primary fa fa-times fl'>سحب الهدية</button>",t+="<button class='gifts_picker__contianer__close btn btn-danger fa fa-times fr'>إخفاء الهدايا</button>",t+="<div class='clear'></div>",t+="</div>"}}],(n=null)&&s(t.prototype,n),r&&s(t,r),e}(),u=n(13),d=n(20),l=n(7),f=n(1);function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var m=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--private").unbind("click").click("click",(function(t){e.dispatch(Object(u.f)(e.getState().requestedUser)),e.dispatch(e.dispatch(Object(l.a)(null))),f.a.togglePane(e,!0,t),$("#user_profile").modal("hide"),d.a.render(e)}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--private' class='btn btn-default fa fa-comment'>محادثه خاصه</button></span>"}}],(n=null)&&p(t.prototype,n),r&&p(t,r),e}();function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--notify").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id,r=prompt("الرجاء إدخال الرسالة التنبيهية");(r=r?r.trim():null)&&(r=r.substring(0,100),e.getState().socket.emit("req",Object(a.k)({type:"PROFILE_ACTION_NOTIFY",data:{id:n,message:r}}),(function(e){alert(Object(a.g)(e))})))}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--notify' class='btn btn-default fa fa-envelope-o'>تنبيه</button></span>"}}],(n=null)&&h(t.prototype,n),r&&h(t,r),e}();function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var v=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--like").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().socket.emit("req",Object(a.k)({type:"PROFILE_ACTION_LIKE",data:{id:n}}),(function(t){!0===(t=Object(a.g)(t))&&($("#user_profile__footer__actions__item--like").parent().addClass("active"),$("#user_profile__footer__actions__item--like").find("span").text(Object(a.s)(e.getState().requestedUser.likes+1,1)))}))}))}},{key:"render",value:function(e){var t="<span class='user_profile__footer__actions__item "+(e.getState().requestedUser.liked?"active":"")+"'>";return t+="<button id='user_profile__footer__actions__item--like' class='btn btn-default fa fa-heart red'><span>"+Object(a.s)(e.getState().requestedUser.likes,1)+"</span></button>",t+="</span>"}}],(n=null)&&g(t.prototype,n),r&&g(t,r),e}();function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var b=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--album").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().socket.emit("req",Object(a.k)({type:"PROFILE_ACTION_GET_ALBUM",data:{id:n}}),(function(t){if("string"==typeof(t=Object(a.g)(t)))return alert(t);e.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:"SET_ALBUM",album:e}}(t))}))}))}},{key:"render",value:function(e){var t="<span class='user_profile__footer__actions__item'>";return t+="<button id='user_profile__footer__actions__item--album' class='btn btn-default fa fa-image purple'><span dir='rtl'> ("+e.getState().requestedUser.albumLength+") </span><span>الألبوم</span></button>",t+="</span>"}}],(n=null)&&y(t.prototype,n),r&&y(t,r),e}();function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var S=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(){e.onAction()}},{key:"onAction",value:function(){$("#user_profile__footer__actions__item--gift").unbind("click").click("click",(function(e){$("#user_profile .gifts_picker").show(),$("#user_profile .user_profile__body__avatar").hide()}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--gift' class='btn btn-default fa fa-diamond blue'>إرسال هدية</button></span>"}}],(n=null)&&w(t.prototype,n),r&&w(t,r),e}(),k=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"TOGGLE_REVEAL_NAMES",isRevealNamesOpen:e}};function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var E=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.back(t)}},{key:"back",value:function(t){$("#reveal_names__header__back").unbind("click").on("click",(function(n){t.dispatch(k(!1)),e.close()}))}},{key:"renderName",value:function(e){if(!e)return"";var t="<div class='reveal_names__item'>";return t+="<p><span class='reveal_names__item__key'>العضو</span><span className='reveal_names__item__value'>"+e.username+"</span></p>",t+="<p><span class='reveal_names__item__key'>الزخرفة</span><span className='reveal_names__item__value'>"+e.decoration+"</span></p>",t+="<p><span class='reveal_names__item__key'>الدولة</span><span className='reveal_names__item__value'><img src='images/flags/"+e.country+".png' /></span></p>",t+="<p><span class='reveal_names__item__key'>الأيبي</span><span className='reveal_names__item__value'>"+e.ip+"</span></p>",t+="<p><span class='reveal_names__item__key'>الجهاز</span><span className='reveal_names__item__value'>"+e.device+"</span></p>",t+="</div>"}},{key:"renderNames",value:function(t){var n=$("#user_profile .reveal_names_body");n.html(""),t.getState().revealNames.forEach((function(t){n.append(e.renderName(t))}))}},{key:"open",value:function(t){$("#reveal_names__container").show(),$("#user_profile__body__user_details").hide(),$("#user_profile .user_profile__footer").hide(),e.renderNames(t),e.back(t)}},{key:"close",value:function(){$("#reveal_names__container").hide(),$("#user_profile__body__user_details").show(),$("#user_profile .user_profile__footer").show()}},{key:"render",value:function(t){var n="<div id='reveal_names__container' class='reveal_names' style='display: none;'>";return n+="<p class='reveal_names__header'>",n+="<button id='reveal_names__header__back' class='btn btn-success fa fa-arrow-left'>عودة</button>",n+="<span class='fr'>كشف النكات</span>",n+="</p>",n+="<div class='reveal_names_body'>"+e.renderNames(t)+"</div>",n+="</div>"}}],(n=null)&&C(t.prototype,n),r&&C(t,r),e}();function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var O=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--reveal-names").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().socket.emit("req",Object(a.k)({type:"PROFILE_ACTION_REVEAL_NAMES",data:{id:n}}),(function(t){if("string"==typeof(t=Object(a.g)(t)))return alert(t);Array.isArray(t)&&(e.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"SET_REVEAL_NAMES",names:e}}(t)),e.dispatch(k(!0)),E.open(e))}))}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--reveal-names' class='btn btn-default fa fa-search'>كشف النكات</button></span>"}}],(n=null)&&T(t.prototype,n),r&&T(t,r),e}(),P=n(11);function A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var R=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--remove-avatar").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().socket.emit("req",Object(a.k)({type:"PROFILE_ACTION_REMOVE_AVATAR",data:{id:n}}),(function(t){"string"==typeof(t=Object(a.g)(t))?alert(t):(e.dispatch(Object(P.g)(t)),fe.clearAvatar(e))}))}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--remove-avatar' class='btn btn-default fa fa-ban maroon'>حذف الصورة</button></span>"}}],(n=null)&&A(t.prototype,n),r&&A(t,r),e}();function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var x=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--room-excpel").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().socket.emit("req",Object(a.k)({type:"PROFILE_ACTION_ROOM_EXCPEL",data:{id:n}}),(function(e){"string"==typeof(e=Object(a.g)(e))&&alert(e)}))}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--room-excpel' class='btn btn-default fa fa-sign-out magenta'>طرد من الغرفة</button></span>"}}],(n=null)&&M(t.prototype,n),r&&M(t,r),e}();function U(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var I=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--excpel").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().socket.emit("req",Object(a.k)({type:"PROFILE_ACTION_EXCPEL",data:{id:n}}),(function(e){"string"==typeof(e=Object(a.g)(e))&&alert(e)}))}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--excpel' class='btn btn-default fa fa-ban'>طرد</button></span>"}}],(n=null)&&U(t.prototype,n),r&&U(t,r),e}();function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var j=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--ban").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().socket.emit("req",Object(a.k)({type:"PROFILE_ACTION_BAN",data:{id:n}}),(function(e){"string"==typeof(e=Object(a.g)(e))&&alert(e)}))}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--ban' class='btn btn-default fa fa-ban'>باند</button></span>"}}],(n=null)&&D(t.prototype,n),r&&D(t,r),e}(),B=n(44);function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var F=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--reg-user-events").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().socket.emit("req",Object(a.k)({type:"PROFILE_ACTION_REG_USER_EVENTS",data:{id:n}}),(function(t){"string"==typeof(t=Object(a.g)(t))&&alert(t),!0===t&&(e.getState().requestedUser.regEvents?$("#user_profile__footer__actions__item--reg-user-events").text("إيقاف المراقبة"):$("#user_profile__footer__actions__item--reg-user-events").text("مراقبة العضو"))}))}))}},{key:"render",value:function(e){var t="<span class='user_profile__footer__actions__item'>";return e.getState().requestedUser.regEvents?t+="<button id='user_profile__footer__actions__item--reg-user-events' class='btn btn-default fa fa-dot-circle'>إيقاف المراقبة</button>":t+="<button id='user_profile__footer__actions__item--reg-user-events' class='btn btn-default fa fa-dot-circle'>مراقبة العضو</button>",t+="</span>"}}],(n=null)&&L(t.prototype,n),r&&L(t,r),e}();function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var q=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--chat-app").unbind("click").click("click",(function(t){window.open(e.getState().settings.app_url)}))}},{key:"render",value:function(e){return e.getState().settings.app_url?"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--chat-app' class='btn btn-default fa fa-android green'>تطبيق الشات</button></span>":""}}],(n=null)&&N(t.prototype,n),r&&N(t,r),e}();function G(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var V=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item--cancel-radio").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().socket.emit("req",Object(a.k)({type:"PROFILE_ACTION_CANCEL_RADIO",data:{id:n}}),(function(e){"string"==typeof(e=Object(a.g)(e))&&alert(e)}))}))}},{key:"render",value:function(){return"<span class='user_profile__footer__actions__item'><button id='user_profile__footer__actions__item--cancel-radio' class='btn btn-default fa fa-ban'>سحب المايك</button></span>"}}],(n=null)&&G(t.prototype,n),r&&G(t,r),e}();function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var H=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.mute(t),e.unmute(t)}},{key:"mute",value:function(e){$("#user_profile__footer__actions__item--mute").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().socket.emit("req",Object(a.k)({type:"PROFILE_ACTION_MUTE",data:{id:n}}),(function(e){if("string"==typeof(e=Object(a.g)(e)))return alert(e);$("#user_profile__footer__actions__item--mute").closest(".user_profile__footer__actions__item").addClass("muted")}))}))}},{key:"unmute",value:function(e){$("#user_profile__footer__actions__item--unmute").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().socket.emit("req",Object(a.k)({type:"PROFILE_ACTION_UNMUTE",data:{id:n}}),(function(e){if("string"==typeof(e=Object(a.g)(e)))return alert(e);$("#user_profile__footer__actions__item--mute").closest(".user_profile__footer__actions__item").removeClass("muted")}))}))}},{key:"render",value:function(e){var t="<span class='user_profile__footer__actions__item "+(e.getState().requestedUser.isMuted?"muted":"")+"'>";return t+="<button id='user_profile__footer__actions__item--mute' class='btn btn-default fa fa-microphone'>كتم</button>",t+="<button id='user_profile__footer__actions__item--unmute' class='btn btn-default fa fa-microphone-slash'>إلغاء الكتم</button>",t+="</span>"}}],(n=null)&&W(t.prototype,n),r&&W(t,r),e}();function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item_group--change-decoration").unbind("submit").on("submit",(function(t){t.preventDefault();var n=e.getState().requestedUser.id,r=t.target.decoration.value;e.getState().socket.emit("req",Object(a.k)({type:"PROFILE_ACTION_CHANGE_DECORATION",data:{id:n,decoration:r}}),(function(e){"string"==typeof(e=Object(a.g)(e))&&alert(e)}))}))}},{key:"render",value:function(e){var t="<form class='user_profile__footer__actions__item_group' id='user_profile__footer__actions__item_group--change-decoration' >";return t+="<label for='user_profile__footer__actions__change_decoration' class='label label-primary user_profile__footer__actions__item_group__label'>الزخرفة</label>",t+="<input type='text' id='user_profile__footer__actions__change_decoration' name='decoration' class='user_profile__footer__actions__item_group__input' value='"+e.getState().requestedUser.name+"'/>",t+="<button class='btn btn-primary user_profile__footer__actions__item_group__submit btn btn-default fa fa-save'>حفظ</button>",t+="</form>"}}],(n=null)&&z(t.prototype,n),r&&z(t,r),e}();function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var X=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item_group--control-likes").unbind("submit").on("submit",(function(t){t.preventDefault();var n=e.getState().requestedUser.id,r=parseInt(t.target.likes.value);isNaN(r)||e.getState().socket.emit("req",Object(a.k)({type:"PROFILE_ACTION_CONTROL_LIKES",data:{id:n,likes:r}}),(function(e){if("string"==typeof(e=Object(a.g)(e)))return alert(e);$("#user_profile__footer__actions__item--like").find("span").text(Object(a.s)(r,1))}))}))}},{key:"render",value:function(e){var t="<form class='user_profile__footer__actions__item_group' id='user_profile__footer__actions__item_group--control-likes' >";return t+="<label for='user_profile__footer__actions__control_likes' class='label label-primary user_profile__footer__actions__item_group__label'>لايكات</label>",t+="<input type='number' id='user_profile__footer__actions__control_likes' name='likes' class='user_profile__footer__actions__item_group__input' value='"+e.getState().requestedUser.likes+"'/>",t+="<button class='btn btn-primary user_profile__footer__actions__item_group__submit btn btn-default fa fa-save'>حفظ</button>",t+="</form>"}}],(n=null)&&J(t.prototype,n),r&&J(t,r),e}();function K(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Q=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item_group--change-room").unbind("submit").on("submit",(function(t){t.preventDefault();var n=e.getState().requestedUser,r=n.id,o=t.target.room.value;n.room&&n.room.id==o||e.getState().socket.emit("req",Object(a.k)({type:"PROFILE_ACTION_CHANGE_ROOM",data:{id:r,roomId:o}}),(function(e){alert(Object(a.g)(e))}))}))}},{key:"render",value:function(e){var t=e.getState().requestedUser.room?e.getState().requestedUser.room.id:null,n="<form class='user_profile__footer__actions__item_group' id='user_profile__footer__actions__item_group--change-room' >";return n+="<label for='user_profile__footer__actions__change_room' class='label label-primary user_profile__footer__actions__item_group__label'>الغرفة</label>",n+="<select id='user_profile__footer__actions__change_room' name='room' class='user_profile__footer__actions__item_group__input'>",e.getState().rooms.forEach((function(e){var r=e.id==t?"selected":"";n+="<option dir='rtl' "+r+" value='"+e.id+"'>"+e.name+"</option>"})),n+="</select>",n+="<button class='btn btn-primary user_profile__footer__actions__item_group__submit btn btn-default fa fa-save'>تغيير</button>",n+="</form>"}}],(n=null)&&K(t.prototype,n),r&&K(t,r),e}();function Z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ee=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item_group--change-subscription-end").unbind("submit").on("submit",(function(t){t.preventDefault();var n=e.getState().requestedUser.id,r=parseInt(t.target.subscription_end.value);e.getState().socket.emit("req",Object(a.k)({type:"PROFILE_ACTION_CHANGE_SUBSCRIPTION_END",data:{id:n,end:r}}),(function(e){Object(a.g)(e)&&alert(Object(a.g)(e))}))}))}},{key:"toggle",value:function(e){e.getState().requestedUser&&(e.getState().requestedUser.isSuper&&!e.getState().requestedUser.isOwner?$("#user_profile__footer__actions__item_group--change-subscription-end").show():$("#user_profile__footer__actions__item_group--change-subscription-end").hide(),$("#user_profile__footer__actions__change_subscription_end").val(Object(a.j)(e.getState().requestedUser.subscription_end)))}},{key:"render",value:function(e){var t="<form class='user_profile__footer__actions__item_group' id='user_profile__footer__actions__item_group--change-subscription-end' >";return t+="<label for='user_profile__footer__actions__change_subscription_end' class='label label-primary user_profile__footer__actions__item_group__label' style='width: 25%'>ينتهي بعد</label>",t+="<input type='number' id='user_profile__footer__actions__change_subscription_end' name='subscription_end' class='user_profile__footer__actions__item_group__input' style='width: 55%' value='"+Object(a.j)(e.getState().requestedUser.subscription_end)+"'/>",t+="<button class='btn btn-primary user_profile__footer__actions__item_group__submit btn btn-default fa fa-save'>تغيير</button>",t+="</form>"}}],(n=null)&&Z(t.prototype,n),r&&Z(t,r),e}();function te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ne=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item_group--change-role").unbind("submit").on("submit",(function(t){t.preventDefault();var n=e.getState().requestedUser,r=n.id,o=t.target.role.value;n.role!=o&&e.getState().socket.emit("req",Object(a.k)({type:"PROFILE_ACTION_CHANGE_ROLE",data:{id:r,roleId:o}}),(function(t){Object(a.g)(t)&&alert(Object(a.g)(t)),ee.toggle(e)}))}))}},{key:"render",value:function(e){var t="<form class='user_profile__footer__actions__item_group' id='user_profile__footer__actions__item_group--change-role' >";return t+="<label for='user_profile__footer__actions__change_role' class='label label-primary user_profile__footer__actions__item_group__label'>الرتبة</label>",t+="<select id='user_profile__footer__actions__change_role' name='role' class='user_profile__footer__actions__item_group__input'>",e.getState().roles.forEach((function(n){var r=n.id==e.getState().requestedUser.role?"selected":"";t+="<option dir='rtl' "+r+" value='"+n.id+"'>"+n.name+"</option>"})),t+="</select>",t+="<button class='btn btn-primary user_profile__footer__actions__item_group__submit btn btn-default fa fa-save'>تغيير</button>",t+="</form>"}}],(n=null)&&te(t.prototype,n),r&&te(t,r),e}(),re=n(4),oe=n(3);function ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ae=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onAction(t)}},{key:"onAction",value:function(e){$("#user_profile__footer__actions__item_group--wall-points").unbind("submit").on("submit",(function(t){t.preventDefault();var n=e.getState().requestedUser.id,r=parseInt(t.target.wall_points.value);isNaN(r)||e.getState().socket.emit("req",Object(a.k)({type:"PROFILE_ACTION_WALL_POINTS",data:{id:n,wall_points:r}}),(function(t){if("string"==typeof(t=Object(a.g)(t))){var n={id:Date.now(),message:t,title:"تنبيه",type:"notify"};return e.dispatch(Object(re.a)(n)),oe.a.render(n,e)}}))}))}},{key:"render",value:function(e){var t="<form class='user_profile__footer__actions__item_group' id='user_profile__footer__actions__item_group--wall-points' >";return t+="<label for='user_profile__footer__actions__wall_points' class='label label-primary user_profile__footer__actions__item_group__label'>الحائط</label>",t+="<input type='number' id='user_profile__footer__actions__wall_points' name='wall_points' class='user_profile__footer__actions__item_group__input' value='"+e.getState().requestedUser.wallPoints+"'/>",t+="<button class='btn btn-primary user_profile__footer__actions__item_group__submit btn btn-default fa fa-save'>حفظ</button>",t+="</form>"}}],(n=null)&&ie(t.prototype,n),r&&ie(t,r),e}();function se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?se(Object(n),!0).forEach((function(t){ue(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ue(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function de(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var le=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,s;return t=e,s=[{key:"registerEvents",value:function(e){}},{key:"registerActionEvents",value:function(e){m.registerEvents(e),_.registerEvents(e),v.registerEvents(e),b.registerEvents(e),S.registerEvents(),O.registerEvents(e),R.registerEvents(e),x.registerEvents(e),I.registerEvents(e),j.registerEvents(e),B.a.registerEvents(e),q.registerEvents(e),V.registerEvents(e),H.registerEvents(e),Y.registerEvents(e),X.registerEvents(e),ae.registerEvents(e),Q.registerEvents(e),ne.registerEvents(e),ee.registerEvents(e),F.registerEvents(e)}},{key:"show",value:function(t,n){if(!n.getState().isRequestingProfile){var r=n.getState().users.filter((function(e){return e.id==t}))[0];if(!r)return n.getState().socket.emit("req",Object(a.k)({type:"PROFILE_SHOW",data:{id:t,force:!0}}),(function(t){n.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"SET_IS_REQUESTING_PROFILE",isRequestingProfile:e}}(!1)),(t=Object(a.g)(t)).user&&(n.dispatch(Object(P.c)(ce(ce({},t.user),{},{liked:t.liked}))),e.render(n),$("#user_profile").modal("show"))}));n.dispatch(Object(P.c)(ce(ce({},r),{},{liked:!1}))),e.render(n),$("#user_profile").modal("show"),n.getState().socket.emit("req",Object(a.k)({type:"PROFILE_SHOW",data:{id:t}}),(function(t){t=Object(a.g)(t),e.setLikes(t.likes,t.liked),ee.toggle(n)}))}}},{key:"setLikes",value:function(e,t){t?$("#user_profile__footer__actions__item--like").parent().addClass("active").find("span").text(Object(a.s)(e,1)):$("#user_profile__footer__actions__item--like").parent().removeClass("active").find("span").text(Object(a.s)(e,1)),$("#user_profile__footer__actions__item_group--control-likes").find("input").val(e)}},{key:"clearAvatar",value:function(e){var t=e.getState().requestedUser.avatar;$("#user_profile .user_profile__body__avatar").attr("src",t)}},{key:"render",value:function(t){var n=t.getState().requestedUser;if(!n)return $("#user_profile_container").html("");$("#user_profile_container").html("");var s="<div class='modal fade' id='user_profile' tabindex='-1' role='dialog' aria-hidden='true'>";s+="<div class='modal-dialog' role='document' style='max-width: 345px'>",s+="<div class='modal-content'>",s+="<div class='user_profile__header modal-header label label-primary'>",s+="<div class='modal-title'>",s+="<img class='user_profile__header__avatar' width='25' height='25' src='"+Object(a.e)()+n.avatar+"' alt=''/>",s+="<p class='user_profile__header__name ellipsis'>",s+=r.a.render(n),s+="</p>",s+="<button data-dismiss='modal' class='btn btn-danger user_profile__header__close'>&times;</button>",s+="</div><div class='clear'></div>",s+="</div>",s+="<div class='user_profile__scroll_area' id='user_profile__scroll_area'>",s+="<div class='user_profile__body modal-body'>",t.getState().actions.reveal_names&&(s+=E.render(t),E.registerEvents(t)),s+="<div id='user_profile__body__user_details'>";var u=Object(a.e)()+n.avatar.replace("/sm/","/lg/");s+="<div id='user_profile__body__avatar' style='background-image: url("+u+");' class='fl u-pic fitimg'>",s+="<div style='background-image: url("+u+");' class='bgf fl u-pic fitimg'></div>",s+="</div>",s+=c.render(t),s+=t.getState().actions.ip?"<p class='user_profile__body__ip label label-success'>"+n.ip+"</p>":"",s+="<p style='color: "+n.statusColor+"' class='user_profile__body__status'>",s+=o.a.render(n.status,t),s+="</p>",s+="<div dir='rtl' style='padding: 0 0.2rem;'>",s+="<div class='user_profile__body__room'>",s+=i.a.render(n.room,!0,t,!0),s+="</div>",s+="<span class='user_profile__body__country_flag'>",s+="<span class='user_profile__body__country_name'>"+n.countryName+"</span>",s+="<img width='18' src='"+Object(a.e)()+n.countryFlag+"' alt='' />",s+="</span>",s+="</div>",s+="<div class='clear'></div>",s+="</div>",s+="<div class='user_profile__body__stats'>",s+="<span class='user_profile__body__stats--points'>",s+="<span>النقاط: </span>",s+="<span>"+Object(a.s)(n.wallPoints,1)+"</span>",s+="</span>",s+="<span class='user_profile__body__stats--stars'>";var d="",l="",f="",p="",h="",g="",y="",b="",w="",k="";n.wallPoints>=500&&n.wallPoints<1e3?d="<span class='fa fa-star checked'></span>":l=n.wallPoints>=1e3?"<span class='fa fa-star checked'></span>":"<span class='fa fa-star'></span>",n.wallPoints>=2e3&&n.wallPoints<4e3?f="<span class='fa fa-star checked'></span>":p=n.wallPoints>=4e3?"<span class='fa fa-star checked'></span>":"<span class='fa fa-star'></span>",n.wallPoints>=4e3&&n.wallPoints<6e3?h="<span class='fa fa-star checked'></span>":g=n.wallPoints>=6e3?"<span class='fa fa-star checked'></span>":"<span class='fa fa-star'></span>",n.wallPoints>=6e3&&n.wallPoints<8e3?y="<span class='fa fa-star checked'></span>":b=n.wallPoints>=8e3?"<span class='fa fa-star checked'></span>":"<span class='fa fa-star'></span>",n.wallPoints>=8e3&&n.wallPoints<1e4?w="<span class='fa fa-star checked'></span>":k=n.wallPoints>=1e4?"<span class='fa fa-star checked'></span>":"<span class='fa fa-star'></span>",s+=d,s+=l,s+=f,s+=p,s+=h,s+=g,s+=y,s+=b,s+=w,s+=k,s+="</span>",s+="<span class='user_profile__body__stats--time'>",s+="<span>التواجد: </span>",s+="<span>"+Object(a.z)(n.loggedInAt)+"</span>",s+="</span>",s+="</div>",s+="<div class='user_profile__body__tags'>",s+=n.wallPoints>=1e3?"<img src='/images/tag_1_active.png' />":"<img src='/images/tag_1.png' />",s+=n.wallPoints>=4e3?"<img src='/images/tag_2_active.png' />":"<img src='/images/tag_2.png' />",s+=n.wallPoints>=6e3?"<img src='/images/tag_3_active.png' />":"<img src='/images/tag_3.png' />",s+=n.wallPoints>=8e3?"<img src='/images/tag_4_active.png' />":"<img src='/images/tag_4.png' />",s+=n.wallPoints>=1e4?"<img src='/images/tag_5_active.png' />":"<img src='/images/tag_5.png' />",s+=n.wallPoints>=2e4?"<img src='/images/tag_6_active.png' />":"<img src='/images/tag_6.png' />",s+="</div>",s+="</div>",s+="</div>",s+="<div class='user_profile__footer modal-footer'>",s+="<div class='user_profile__footer__actions'>",s+=m.render(t),s+=t.getState().actions.notify?_.render(t):"",s+=v.render(t),s+=t.getState().actions.gift?S.render():"",s+=t.getState().actions.reveal_names?O.render(t):"",s+=t.getState().actions.remove_avatar?R.render(t):"",s+=t.getState().actions.room_excpel?x.render(t):"",s+=t.getState().actions.excpel?I.render(t):"",s+=t.getState().actions.ban?j.render(t):"",s+=B.a.render(t),s+=q.render(t),s+=t.getState().actions.admin_mute?H.render(t):"",s+=t.getState().actions.change_decoration?Y.render(t):"",s+=t.getState().actions.control_likes?X.render(t):"",s+=t.getState().mUser.isOwner?ae.render(t):"",s+=t.getState().actions.change_room?Q.render(t):"",s+=t.getState().actions.change_role?ne.render(t):"",s+=t.getState().actions.change_role?ee.render(t):"",s+="</div>",s+="</div>",s+="</div>",s+="</div>",s+="</div>",s+="</div>",$("#user_profile_container").html(s),e.registerEvents(t),e.registerActionEvents(t),c.registerEvents(t),i.a.registerEvents(t),ee.toggle(t),$("#user_profile").find("img").on("contextmenu",(function(){return!1}))}}],(n=null)&&de(t.prototype,n),s&&de(t,s),e}(),fe=t.a=le},function(e,t,n){"use strict";n.d(t,"i",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"k",(function(){return a})),n.d(t,"j",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return f})),n.d(t,"b",(function(){return p}));var r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"SET_POSTS",posts:e}},o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return{type:"ADD_POST",post:e,wallMsgCount:t}},i=function(e){return{type:"REMOVE_POST",id:e}},a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_POSTS_USER",user:e}},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_POST_ATTRIBUTE",post:e}},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"INC_POST_COMMENTS_COUNT",post:e}},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"DEC_POST_COMMENTS_COUNT",post:e}},d=function(){return{type:"INC_NEW_POSTS_COUNT"}},l=function(){return{type:"RESET_NEW_POSTS_COUNT"}},f=function(e){return{type:"IS_POSTS_FETCHED",isPostsFetched:e}},p=function(){return{type:"WALL_CLEAR"}}},function(e,t,n){"use strict";var r=n(5),o=n(9),i=n(24);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,s;return t=e,s=[{key:"registerEvents",value:function(t){e.getProfile(t)}},{key:"getProfile",value:function(e){$(".chat_pane__user_item").unbind("click").on("click",(function(t){var n=$(this).closest(".chat_pane__user_item").data("id");i.a.show(n,e)}))}},{key:"formatHashTag",value:function(e){return!e||isNaN(e)?"":e<10?"#0"+e:"#"+e}},{key:"render",value:function(t,n,i){var a=t.background?"has-bg":"",s=t.background?"style='background-image: url(/uploads/user-bg/"+t.background+");'":"",c=t.active?"active":"",u=t.isHidden?"hidden":"",d=t.avatar_background?"has-avatar-bg":"",l="<div "+(t.reg_id?"data-reg='"+t.reg_id+"'":"")+" "+s+" id='user-"+t.id+"' data-id='"+t.id+"' class='chat_pane__user_item "+a+" "+c+" "+u+" '>";if(l+="<p class='chat_pane__user_item__avatar "+d+"'>",t.avatar_background&&(l+="<img class='avatar_bg' width='66' height='66' alt='' src='/uploads/user-avatar-bg/"+t.avatar_background+"?v=1' />"),l+="<img class='u-avatar "+t.state+"'width='56' height='56' alt='' src='"+t.avatar+"?v=1' />",l+=n?"<span class='status "+t.state+"'></span>":"",l+="</p>",l+="<div>",l+="<h5 class='chat_pane__user_item__name'>",l+=r.a.render(t),l+="</h5>",l+="<h5 class='chat_pane__user_item__status'>",!n&&i.getState().features.FT_SHOW_STARS_ON_USER_ITEM){l+="<span class='chat_pane__user_item--stars'>";var f=t.wallPoints>=1e3?"checked":"",p=t.wallPoints>=4e3?"checked":"",m=t.wallPoints>=6e3?"checked":"",h=t.wallPoints>=8e3?"checked":"";l+="<span class='fa fa-star "+(t.wallPoints>=1e4?"checked":"")+"'></span>",l+="<span class='fa fa-star "+h+"'></span>",l+="<span class='fa fa-star "+m+"'></span>",l+="<span class='fa fa-star "+p+"'></span>",l+="<span class='fa fa-star "+f+"'></span>",l+="</span>"}return l+="<span class='status_content' style='color: "+t.statusColor+"' >"+o.a.render(t.status,i)+"</span>",t.hashTag&&n&&(l+="<span class='chat_pane__user_item__status__hash'>"+e.formatHashTag(t.hashTag)+"</span>"),l+="</h5>",l+="</div>",l+="<img class='chat_pane__user_item__flag' alt='' width='16' height='16' src='"+t.countryFlag+"' />",l+="<div class='clear'></div>",l+="</div>"}}],(n=null)&&a(t.prototype,n),s&&a(t,s),e}();t.a=s},function(e,t){function n(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw a}}}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}a.sessions={},a.isExtensionEnabled=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return!0;if(window.navigator.userAgent.match("Chrome")){var e=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),t=33;return window.navigator.userAgent.match("Linux")&&(t=35),e>=26&&e<=t||a.extension.isInstalled()}return!0};var i={extensionId:"hapfgfdkleiggjjpfpenajgdnfckjpaj",isInstalled:function(){return null!==document.querySelector("#janus-extension-installed")},getScreen:function(e){var t=window.setTimeout((function(){var t=new Error("NavigatorUserMediaError");return t.name='The required Chrome extension is not installed: click <a href="#">here</a> to install it. (NOTE: this will need you to refresh the page)',e(t)}),1e3);this.cache[t]=e,window.postMessage({type:"janusGetScreen",id:t},"*")},init:function(){var e={};this.cache=e,window.addEventListener("message",(function(t){if(t.origin==window.location.origin)if("janusGotScreen"==t.data.type&&e[t.data.id]){var n=e[t.data.id];if(delete e[t.data.id],""===t.data.sourceId){var r=new Error("NavigatorUserMediaError");r.name="You cancelled the request for permission, giving up...",n(r)}else n(null,t.data.sourceId)}else"janusGetScreenPending"==t.data.type&&(console.log("clearing ",t.data.id),window.clearTimeout(t.data.id))}))}};function a(e){if((e=e||{}).success="function"==typeof e.success?e.success:a.noop,e.error="function"==typeof e.error?e.error:a.noop,e.destroyed="function"==typeof e.destroyed?e.destroyed:a.noop,!a.initDone)return e.error("Library not initialized"),{};if(!a.isWebrtcSupported())return e.error("WebRTC not supported by this browser"),{};if(a.log("Library initialized: "+a.initDone),!e.server)return e.error("Invalid server url"),{};var t=!1,r=null,i={},s=null,c=null,u=0,d=e.server;a.isArray(d)?(a.log("Multiple servers provided ("+d.length+"), will use the first that works"),d=null,c=e.server,a.debug(c)):0===d.indexOf("ws")?(t=!0,a.log("Using WebSockets to contact Janus: "+d)):(t=!1,a.log("Using REST API to contact Janus: "+d));var l=e.iceServers||[{urls:"stun:stun.l.google.com:19302"}],f=e.iceTransportPolicy,p=e.bundlePolicy,m=!0===e.ipv6,h=!1;void 0!==e.withCredentials&&null!==e.withCredentials&&(h=!0===e.withCredentials);var _=10;void 0!==e.max_poll_events&&null!==e.max_poll_events&&(_=e.max_poll_events),_<1&&(_=1);var g=null;void 0!==e.token&&null!==e.token&&(g=e.token);var v=null;void 0!==e.apisecret&&null!==e.apisecret&&(v=e.apisecret),this.destroyOnUnload=!0,void 0!==e.destroyOnUnload&&null!==e.destroyOnUnload&&(this.destroyOnUnload=!0===e.destroyOnUnload);var y=25e3;void 0!==e.keepAlivePeriod&&null!==e.keepAlivePeriod&&(y=e.keepAlivePeriod),isNaN(y)&&(y=25e3);var b=6e4;function w(e){var t={high:9e5,medium:3e5,low:1e5};return null!=e&&(e.high&&(t.high=e.high),e.medium&&(t.medium=e.medium),e.low&&(t.low=e.low)),t}void 0!==e.longPollTimeout&&null!==e.longPollTimeout&&(b=e.longPollTimeout),isNaN(b)&&(b=6e4);var S=!1,k=null,C={},E=this,T=0,O={};function P(){if(null!=k)if(a.debug("Long poll..."),S){var t=d+"/"+k+"?rid="+(new Date).getTime();_&&(t=t+"&maxev="+_),g&&(t=t+"&token="+encodeURIComponent(g)),v&&(t=t+"&apisecret="+encodeURIComponent(v)),a.httpAPICall(t,{verb:"GET",withCredentials:h,success:A,timeout:b,error:function(t,n){if(a.error(t+":",n),++T>3)return S=!1,void e.error("Lost connection to the server (is it down?)");P()}})}else a.warn("Is the server down? (connected=false)")}function A(e,n){if(T=0,t||null==k||!0===n||P(),t||!a.isArray(e))if("keepalive"!==e.janus)if("server_info"!==e.janus)if("ack"!==e.janus)if("success"!==e.janus)if("trickle"===e.janus){if(!(u=e.sender))return void a.warn("Missing sender...");if(!(l=C[u]))return void a.debug("This handle is not attached to this session");var o=e.candidate;a.debug("Got a trickled candidate on session "+k),a.debug(o);var i=l.webrtcStuff;i.pc&&i.remoteSdp?(a.debug("Adding remote candidate:",o),o&&!0!==o.completed?i.pc.addIceCandidate(o):i.pc.addIceCandidate(a.endOfCandidates)):(a.debug("We didn't do setRemoteDescription (trickle got here before the offer?), caching candidate"),i.candidates||(i.candidates=[]),i.candidates.push(o),a.debug(i.candidates))}else{if("webrtcup"===e.janus)return a.debug("Got a webrtcup event on session "+k),a.debug(e),(u=e.sender)?(l=C[u])?void l.webrtcState(!0):void a.debug("This handle is not attached to this session"):void a.warn("Missing sender...");if("hangup"===e.janus){if(a.debug("Got a hangup event on session "+k),a.debug(e),!(u=e.sender))return void a.warn("Missing sender...");if(!(l=C[u]))return void a.debug("This handle is not attached to this session");l.webrtcState(!1,e.reason),l.hangup()}else if("detached"===e.janus){if(a.debug("Got a detached event on session "+k),a.debug(e),!(u=e.sender))return void a.warn("Missing sender...");if(!(l=C[u]))return;l.detached=!0,l.ondetached(),l.detach()}else if("media"===e.janus){if(a.debug("Got a media event on session "+k),a.debug(e),!(u=e.sender))return void a.warn("Missing sender...");if(!(l=C[u]))return void a.debug("This handle is not attached to this session");l.mediaState(e.type,e.receiving)}else if("slowlink"===e.janus){if(a.debug("Got a slowlink event on session "+k),a.debug(e),!(u=e.sender))return void a.warn("Missing sender...");if(!(l=C[u]))return void a.debug("This handle is not attached to this session");l.slowLink(e.uplink,e.lost)}else{if("error"===e.janus){var s,c;if(a.error("Ooops: "+e.error.code+" "+e.error.reason),a.debug(e),s=e.transaction)(c=O[s])&&c(e),delete O[s];return}if("event"===e.janus){var u;if(a.debug("Got a plugin event on session "+k),a.debug(e),!(u=e.sender))return void a.warn("Missing sender...");var d=e.plugindata;if(!d)return void a.warn("Missing plugindata...");a.debug("  -- Event is coming from "+u+" ("+d.plugin+")");var l,f=d.data;if(a.debug(f),!(l=C[u]))return void a.warn("This handle is not attached to this session");var p=e.jsep;p&&(a.debug("Handling SDP as well..."),a.debug(p));var m=l.onmessage;m?(a.debug("Notifying application..."),m(f,p)):a.debug("No provided notification callback")}else{if("timeout"===e.janus)return a.error("Timeout on session "+k),a.debug(e),void(t&&r.close(3504,"Gateway timeout"));a.warn("Unknown message/event  '"+e.janus+"' on session "+k),a.debug(e)}}}else a.debug("Got a success on session "+k),a.debug(e),(s=e.transaction)&&((c=O[s])&&c(e),delete O[s]);else a.debug("Got an ack on session "+k),a.debug(e),(s=e.transaction)&&((c=O[s])&&c(e),delete O[s]);else a.debug("Got info on the Janus instance"),a.debug(e),(s=e.transaction)&&((c=O[s])&&c(e),delete O[s]);else a.vdebug("Got a keepalive on session "+k);else for(var h=0;h<e.length;h++)A(e[h],!0)}function R(){if(d&&t&&S){s=setTimeout(R,y);var e={janus:"keepalive",session_id:k,transaction:a.randomString(12)};g&&(e.token=g),v&&(e.apisecret=v),r.send(JSON.stringify(e))}}function M(n){var o=a.randomString(12),l={janus:"create",transaction:o};if(n.reconnect&&(S=!1,l.janus="claim",l.session_id=k,r&&(r.onopen=null,r.onerror=null,r.onclose=null,s&&(clearTimeout(s),s=null))),g&&(l.token=g),v&&(l.apisecret=v),!d&&a.isArray(c)&&(0===(d=c[u]).indexOf("ws")?(t=!0,a.log("Server #"+(u+1)+": trying WebSockets to contact Janus ("+d+")")):(t=!1,a.log("Server #"+(u+1)+": trying REST API to contact Janus ("+d+")"))),t)for(var f in r=a.newWebSocket(d,"janus-protocol"),i={error:function(){if(a.error("Error connecting to the Janus WebSockets server... "+d),a.isArray(c)&&!n.reconnect)return++u===c.length?void n.error("Error connecting to any of the provided Janus servers: Is the server down?"):(d=null,void setTimeout((function(){M(n)}),200));n.error("Error connecting to the Janus WebSockets server: Is the server down?")},open:function(){O[o]=function(e){if(a.debug(e),"success"!==e.janus)return a.error("Ooops: "+e.error.code+" "+e.error.reason),void n.error(e.error.reason);s=setTimeout(R,y),S=!0,k=e.session_id?e.session_id:e.data.id,n.reconnect?a.log("Claimed session: "+k):a.log("Created session: "+k),a.sessions[k]=E,n.success()},r.send(JSON.stringify(l))},message:function(e){A(JSON.parse(e.data))},close:function(){d&&S&&(S=!1,e.error("Lost connection to the server (is it down?)"))}})r.addEventListener(f,i[f]);else a.httpAPICall(d,{verb:"POST",withCredentials:h,body:l,success:function(e){if(a.debug(e),"success"!==e.janus)return a.error("Ooops: "+e.error.code+" "+e.error.reason),void n.error(e.error.reason);S=!0,k=e.session_id?e.session_id:e.data.id,n.reconnect?a.log("Claimed session: "+k):a.log("Created session: "+k),a.sessions[k]=E,P(),n.success()},error:function(e,t){if(a.error(e+":",t),a.isArray(c)&&!n.reconnect)return++u===c.length?void n.error("Error connecting to any of the provided Janus servers: Is the server down?"):(d=null,void setTimeout((function(){M(n)}),200));""===t?n.error(e+": Is the server down?"):n.error(e+": "+t)}})}function x(e,n){if((n=n||{}).success="function"==typeof n.success?n.success:a.noop,n.error="function"==typeof n.error?n.error:a.noop,!S)return a.warn("Is the server down? (connected=false)"),void n.error("Is the server down? (connected=false)");var o=C[e];if(!o||!o.webrtcStuff)return a.warn("Invalid handle"),void n.error("Invalid handle");var i=n.message,s=n.jsep,c=a.randomString(12),u={janus:"message",body:i,transaction:c};if(o.token&&(u.token=o.token),v&&(u.apisecret=v),s&&(u.jsep={type:s.type,sdp:s.sdp},s.e2ee&&(u.jsep.e2ee=!0),"hml"!==s.rid_order&&"lmh"!==s.rid_order||(u.jsep.rid_order=s.rid_order)),a.debug("Sending message to plugin (handle="+e+"):"),a.debug(u),t)return u.session_id=k,u.handle_id=e,O[c]=function(e){if(a.debug("Message sent!"),a.debug(e),"success"===e.janus){var t=e.plugindata;if(!t)return a.warn("Request succeeded, but missing plugindata..."),void n.success();a.log("Synchronous transaction successful ("+t.plugin+")");var r=t.data;return a.debug(r),void n.success(r)}"ack"===e.janus?n.success():e.error?(a.error("Ooops: "+e.error.code+" "+e.error.reason),n.error(e.error.code+" "+e.error.reason)):(a.error("Unknown error"),n.error("Unknown error"))},void r.send(JSON.stringify(u));a.httpAPICall(d+"/"+k+"/"+e,{verb:"POST",withCredentials:h,body:u,success:function(e){if(a.debug("Message sent!"),a.debug(e),"success"===e.janus){var t=e.plugindata;if(!t)return a.warn("Request succeeded, but missing plugindata..."),void n.success();a.log("Synchronous transaction successful ("+t.plugin+")");var r=t.data;return a.debug(r),void n.success(r)}"ack"===e.janus?n.success():e.error?(a.error("Ooops: "+e.error.code+" "+e.error.reason),n.error(e.error.code+" "+e.error.reason)):(a.error("Unknown error"),n.error("Unknown error"))},error:function(e,t){a.error(e+":",t),n.error(e+": "+t)}})}function U(e,n){if(S){var o=C[e];if(o&&o.webrtcStuff){var i={janus:"trickle",candidate:n,transaction:a.randomString(12)};if(o.token&&(i.token=o.token),v&&(i.apisecret=v),a.vdebug("Sending trickle candidate (handle="+e+"):"),a.vdebug(i),t)return i.session_id=k,i.handle_id=e,void r.send(JSON.stringify(i));a.httpAPICall(d+"/"+k+"/"+e,{verb:"POST",withCredentials:h,body:i,success:function(e){a.vdebug("Candidate sent!"),a.vdebug(e),"ack"===e.janus||a.error("Ooops: "+e.error.code+" "+e.error.reason)},error:function(e,t){a.error(e+":",t)}})}else a.warn("Invalid handle")}else a.warn("Is the server down? (connected=false)")}function I(e,t,r,o,i){var s=C[e];if(s&&s.webrtcStuff){var c=s.webrtcStuff;if(c.pc){var u=function(e){a.log("Received state change on data channel:",e);var t=e.target.label,r=e.target.protocol,o=c.dataChannel[t]?c.dataChannel[t].readyState:"null";if(a.log("State change on <"+t+"> data channel: "+o),"open"===o){if(c.dataChannel[t].pending&&c.dataChannel[t].pending.length>0){a.log("Sending pending messages on <"+t+">:",c.dataChannel[t].pending.length);var i,u=n(c.dataChannel[t].pending);try{for(u.s();!(i=u.n()).done;){var d=i.value;a.log("Sending data on data channel <"+t+">"),a.debug(d),c.dataChannel[t].send(d)}}catch(e){u.e(e)}finally{u.f()}c.dataChannel[t].pending=[]}s.ondataopen(t,r)}};if(o)c.dataChannel[t]=o;else{var d={ordered:!0};r&&(d.protocol=r),c.dataChannel[t]=c.pc.createDataChannel(t,d)}c.dataChannel[t].onmessage=function(e){a.log("Received message on data channel:",e);var t=e.target.label;s.ondata(e.data,t)},c.dataChannel[t].onopen=u,c.dataChannel[t].onclose=u,c.dataChannel[t].onerror=function(e){a.error("Got error on data channel:",e)},c.dataChannel[t].pending=[],i&&c.dataChannel[t].pending.push(i)}else a.warn("Invalid PeerConnection")}else a.warn("Invalid handle")}function D(e,t){(t=t||{}).success="function"==typeof t.success?t.success:a.noop,t.error="function"==typeof t.error?t.error:a.noop;var n=C[e];if(!n||!n.webrtcStuff)return a.warn("Invalid handle"),void t.error("Invalid handle");var r=n.webrtcStuff,o=t.text||t.data;if(!o)return a.warn("Invalid data"),void t.error("Invalid data");var i=t.label?t.label:a.dataChanDefaultLabel;return r.dataChannel[i]?"open"!==r.dataChannel[i].readyState?(r.dataChannel[i].pending.push(o),void t.success()):(a.log("Sending data on data channel <"+i+">"),a.debug(o),r.dataChannel[i].send(o),void t.success()):(I(e,i,t.protocol,!1,o,t.protocol),void t.success())}function j(e,t){(t=t||{}).success="function"==typeof t.success?t.success:a.noop,t.error="function"==typeof t.error?t.error:a.noop;var n=C[e];if(!n||!n.webrtcStuff)return a.warn("Invalid handle"),void t.error("Invalid handle");var r=n.webrtcStuff;if(!r.dtmfSender){if(r.pc){var o=r.pc.getSenders().find((function(e){return e.track&&"audio"===e.track.kind}));if(!o)return a.warn("Invalid DTMF configuration (no audio track)"),void t.error("Invalid DTMF configuration (no audio track)");r.dtmfSender=o.dtmf,r.dtmfSender&&(a.log("Created DTMF Sender"),r.dtmfSender.ontonechange=function(e){a.debug("Sent DTMF tone: "+e.tone)})}if(!r.dtmfSender)return a.warn("Invalid DTMF configuration"),void t.error("Invalid DTMF configuration")}var i=t.dtmf;if(!i)return a.warn("Invalid DTMF parameters"),void t.error("Invalid DTMF parameters");var s=i.tones;if(!s)return a.warn("Invalid DTMF string"),void t.error("Invalid DTMF string");var c="number"==typeof i.duration?i.duration:500,u="number"==typeof i.gap?i.gap:50;a.debug("Sending DTMF string "+s+" (duration "+c+"ms, gap "+u+"ms)"),r.dtmfSender.insertDTMF(s,c,u),t.success()}function B(e,n){(n=n||{}).success="function"==typeof n.success?n.success:a.noop,n.error="function"==typeof n.error?n.error:a.noop;var o=!0===n.noRequest;a.log("Destroying handle "+e+" (only-locally="+o+")"),H(e);var i=C[e];if(!i||i.detached)return delete C[e],void n.success();if(o)return delete C[e],void n.success();if(!S)return a.warn("Is the server down? (connected=false)"),void n.error("Is the server down? (connected=false)");var s={janus:"detach",transaction:a.randomString(12)};if(i.token&&(s.token=i.token),v&&(s.apisecret=v),t)return s.session_id=k,s.handle_id=e,r.send(JSON.stringify(s)),delete C[e],void n.success();a.httpAPICall(d+"/"+k+"/"+e,{verb:"POST",withCredentials:h,body:s,success:function(t){a.log("Destroyed handle:"),a.debug(t),"success"!==t.janus&&a.error("Ooops: "+t.error.code+" "+t.error.reason),delete C[e],n.success()},error:function(t,r){a.error(t+":",r),delete C[e],n.success()}})}function L(e,t,r,i,s){var c=C[e];if(!c||!c.webrtcStuff)return a.warn("Invalid handle"),i.stream||a.stopAllTracks(s),void i.error("Invalid handle");var u=c.webrtcStuff;a.debug("streamsDone:",s),s&&(a.debug("  -- Audio tracks:",s.getAudioTracks()),a.debug("  -- Video tracks:",s.getVideoTracks()));var d=!1;if(u.myStream&&r.update&&!u.streamExternal){if((!r.update&&z(r)||r.update&&(r.addAudio||r.replaceAudio))&&s.getAudioTracks()&&s.getAudioTracks().length)if(u.myStream.addTrack(s.getAudioTracks()[0]),a.unifiedPlan){a.log((r.replaceAudio?"Replacing":"Adding")+" audio track:",s.getAudioTracks()[0]);var h=null;if((v=u.pc.getTransceivers())&&v.length>0){var _,g=n(v);try{for(g.s();!(_=g.n()).done;){if((k=_.value).sender&&k.sender.track&&"audio"===k.sender.track.kind||k.receiver&&k.receiver.track&&"audio"===k.receiver.track.kind){h=k;break}}}catch(e){g.e(e)}finally{g.f()}}h&&h.sender?h.sender.replaceTrack(s.getAudioTracks()[0]):u.pc.addTrack(s.getAudioTracks()[0],s)}else a.log((r.replaceAudio?"Replacing":"Adding")+" audio track:",s.getAudioTracks()[0]),u.pc.addTrack(s.getAudioTracks()[0],s);if((!r.update&&J(r)||r.update&&(r.addVideo||r.replaceVideo))&&s.getVideoTracks()&&s.getVideoTracks().length)if(u.myStream.addTrack(s.getVideoTracks()[0]),a.unifiedPlan){a.log((r.replaceVideo?"Replacing":"Adding")+" video track:",s.getVideoTracks()[0]);var v,y=null;if((v=u.pc.getTransceivers())&&v.length>0){var b,S=n(v);try{for(S.s();!(b=S.n()).done;){var k;if((k=b.value).sender&&k.sender.track&&"video"===k.sender.track.kind||k.receiver&&k.receiver.track&&"video"===k.receiver.track.kind){y=k;break}}}catch(e){S.e(e)}finally{S.f()}}y&&y.sender?y.sender.replaceTrack(s.getVideoTracks()[0]):u.pc.addTrack(s.getVideoTracks()[0],s)}else a.log((r.replaceVideo?"Replacing":"Adding")+" video track:",s.getVideoTracks()[0]),u.pc.addTrack(s.getVideoTracks()[0],s)}else u.myStream=s,d=!0;if(!u.pc){var E={iceServers:l,iceTransportPolicy:f,bundlePolicy:p};"chrome"===a.webRTCAdapter.browserDetails.browser&&(E.sdpSemantics=a.webRTCAdapter.browserDetails.version<72?"plan-b":"unified-plan");var T={optional:[{DtlsSrtpKeyAgreement:!0}]};if(m&&T.optional.push({googIPv6:!0}),i.rtcConstraints&&"object"===o(i.rtcConstraints))for(var O in a.debug("Adding custom PeerConnection constraints:",i.rtcConstraints),i.rtcConstraints)T.optional.push(i.rtcConstraints[O]);"edge"===a.webRTCAdapter.browserDetails.browser&&(E.bundlePolicy="max-bundle"),RTCRtpSender&&(RTCRtpSender.prototype.createEncodedStreams||RTCRtpSender.prototype.createEncodedAudioStreams&&RTCRtpSender.prototype.createEncodedVideoStreams)&&(i.senderTransforms||i.receiverTransforms)&&(u.senderTransforms=i.senderTransforms,u.receiverTransforms=i.receiverTransforms,E.forceEncodedAudioInsertableStreams=!0,E.forceEncodedVideoInsertableStreams=!0,E.encodedInsertableStreams=!0),a.log("Creating PeerConnection"),a.debug(T),u.pc=new RTCPeerConnection(E,T),a.debug(u.pc),u.pc.getStats&&(u.volume={},u.bitrate.value="0 kbits/sec"),a.log("Preparing local SDP and gathering candidates (trickle="+u.trickle+")"),u.pc.oniceconnectionstatechange=function(e){u.pc&&c.iceState(u.pc.iceConnectionState)},u.pc.onicecandidate=function(t){if(!t.candidate||"edge"===a.webRTCAdapter.browserDetails.browser&&t.candidate.candidate.indexOf("endOfCandidates")>0)a.log("End of candidates."),u.iceDone=!0,!0===u.trickle?U(e,{completed:!0}):function(e,t){(t=t||{}).success="function"==typeof t.success?t.success:a.noop,t.error="function"==typeof t.error?t.error:a.noop;var n=C[e];if(!n||!n.webrtcStuff)return void a.warn("Invalid handle, not sending anything");var r=n.webrtcStuff;if(a.log("Sending offer/answer SDP..."),!r.mySdp)return void a.warn("Local SDP instance is invalid, not sending anything...");r.mySdp={type:r.pc.localDescription.type,sdp:r.pc.localDescription.sdp},!1===r.trickle&&(r.mySdp.trickle=!1);a.debug(t),r.sdpSent=!0,t.success(r.mySdp)}(e,i);else{var n={candidate:t.candidate.candidate,sdpMid:t.candidate.sdpMid,sdpMLineIndex:t.candidate.sdpMLineIndex};!0===u.trickle&&U(e,n)}},u.pc.ontrack=function(e){if(a.log("Handling Remote Track"),a.debug(e),e.streams&&(u.remoteStream=e.streams[0],c.onremotestream(u.remoteStream),!e.track.onended)){if(u.receiverTransforms){var t=null;RTCRtpSender.prototype.createEncodedStreams?t=e.receiver.createEncodedStreams():(RTCRtpSender.prototype.createAudioEncodedStreams||RTCRtpSender.prototype.createEncodedVideoStreams)&&("audio"===e.track.kind&&u.receiverTransforms.audio?t=e.receiver.createEncodedAudioStreams():"video"===e.track.kind&&u.receiverTransforms.video&&(t=e.receiver.createEncodedVideoStreams())),t&&(console.log(t),t.readableStream&&t.writableStream?t.readableStream.pipeThrough(u.receiverTransforms[e.track.kind]).pipeTo(t.writableStream):t.readable&&t.writable&&t.readable.pipeThrough(u.receiverTransforms[e.track.kind]).pipeTo(t.writable))}var n=null;a.log("Adding onended callback to track:",e.track),e.track.onended=function(e){a.log("Remote track removed:",e),u.remoteStream&&(clearTimeout(n),u.remoteStream.removeTrack(e.target),c.onremotestream(u.remoteStream))},e.track.onmute=function(e){a.log("Remote track muted:",e),u.remoteStream&&null==n&&(n=setTimeout((function(){a.log("Removing remote track"),u.remoteStream&&(u.remoteStream.removeTrack(e.target),c.onremotestream(u.remoteStream)),n=null}),2520))},e.track.onunmute=function(e){if(a.log("Remote track flowing again:",e),null!=n)clearTimeout(n),n=null;else try{u.remoteStream.addTrack(e.target),c.onremotestream(u.remoteStream)}catch(e){a.error(e)}}}}}if(d&&s){a.log("Adding local stream");var P=!0===i.simulcast2;s.getTracks().forEach((function(e){a.log("Adding local track:",e);var t=null;if(P&&"audio"!==e.kind){a.log("Enabling rid-based simulcasting:",e);var n=w(i.simulcastMaxBitrates),r=u.pc.addTransceiver(e,{direction:"sendrecv",streams:[s],sendEncodings:i.sendEncodings||[{rid:"h",active:!0,maxBitrate:n.high},{rid:"m",active:!0,maxBitrate:n.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:n.low,scaleResolutionDownBy:4}]});r&&(t=r.sender)}else t=u.pc.addTrack(e,s);if(t&&u.senderTransforms){var o=null;RTCRtpSender.prototype.createEncodedStreams?o=t.createEncodedStreams():(RTCRtpSender.prototype.createAudioEncodedStreams||RTCRtpSender.prototype.createEncodedVideoStreams)&&("audio"===t.track.kind&&u.senderTransforms.audio?o=t.createEncodedAudioStreams():"video"===t.track.kind&&u.senderTransforms.video&&(o=t.createEncodedVideoStreams())),o&&(console.log(o),o.readableStream&&o.writableStream?o.readableStream.pipeThrough(u.senderTransforms[t.track.kind]).pipeTo(o.writableStream):o.readable&&o.writable&&o.readable.pipeThrough(u.senderTransforms[t.track.kind]).pipeTo(o.writable))}}))}(function(e){if(a.debug("isDataEnabled:",e),"edge"===a.webRTCAdapter.browserDetails.browser)return a.warn("Edge doesn't support data channels yet"),!1;return null!=e&&!0===e.data})(r)&&!u.dataChannel[a.dataChanDefaultLabel]&&(a.log("Creating default data channel"),I(e,a.dataChanDefaultLabel,null,!1),u.pc.ondatachannel=function(t){a.log("Data channel created by Janus:",t),I(e,t.channel.label,t.channel.protocol,t.channel)}),u.myStream&&c.onlocalstream(u.myStream),t?u.pc.setRemoteDescription(t).then((function(){if(a.log("Remote description accepted!"),u.remoteSdp=t.sdp,u.candidates&&u.candidates.length>0){for(var o=0;o<u.candidates.length;o++){var s=u.candidates[o];a.debug("Adding remote candidate:",s),s&&!0!==s.completed?u.pc.addIceCandidate(s):u.pc.addIceCandidate(a.endOfCandidates)}u.candidates=[]}!function(e,t,r){(r=r||{}).success="function"==typeof r.success?r.success:a.noop,r.error="function"==typeof r.error?r.error:a.noop,r.customizeSdp="function"==typeof r.customizeSdp?r.customizeSdp:a.noop;var o=C[e];if(!o||!o.webrtcStuff)return a.warn("Invalid handle"),void r.error("Invalid handle");var i=o.webrtcStuff,s=!0===r.simulcast;s?a.log("Creating answer (iceDone="+i.iceDone+", simulcast="+s+")"):a.log("Creating answer (iceDone="+i.iceDone+")");var c=null;if(a.unifiedPlan){c={};var u=null,d=null,l=i.pc.getTransceivers();if(l&&l.length>0){var f,p=n(l);try{for(p.s();!(f=p.n()).done;){var m=f.value;m.sender&&m.sender.track&&"audio"===m.sender.track.kind||m.receiver&&m.receiver.track&&"audio"===m.receiver.track.kind?u||(u=m):(m.sender&&m.sender.track&&"video"===m.sender.track.kind||m.receiver&&m.receiver.track&&"video"===m.receiver.track.kind)&&(d||(d=m))}}catch(e){p.e(e)}finally{p.f()}}var h=z(t),_=Y(t);if(h||_){if(h&&_){if(u)try{u.setDirection?u.setDirection("sendrecv"):u.direction="sendrecv",a.log("Setting audio transceiver to sendrecv:",u)}catch(e){a.error(e)}}else if(h&&!_)try{u&&(u.setDirection?u.setDirection("sendonly"):u.direction="sendonly",a.log("Setting audio transceiver to sendonly:",u))}catch(e){a.error(e)}else if(!h&&_)if(u)try{u.setDirection?u.setDirection("recvonly"):u.direction="recvonly",a.log("Setting audio transceiver to recvonly:",u)}catch(e){a.error(e)}else u=i.pc.addTransceiver("audio",{direction:"recvonly"}),a.log("Adding recvonly audio transceiver:",u)}else if(t.removeAudio&&u)try{u.setDirection?u.setDirection("inactive"):u.direction="inactive",a.log("Setting audio transceiver to inactive:",u)}catch(e){a.error(e)}var g=J(t),v=X(t);if(g||v){if(g&&v){if(d)try{d.setDirection?d.setDirection("sendrecv"):d.direction="sendrecv",a.log("Setting video transceiver to sendrecv:",d)}catch(e){a.error(e)}}else if(g&&!v){if(d)try{d.setDirection?d.setDirection("sendonly"):d.direction="sendonly",a.log("Setting video transceiver to sendonly:",d)}catch(e){a.error(e)}}else if(!g&&v)if(d)try{d.setDirection?d.setDirection("recvonly"):d.direction="recvonly",a.log("Setting video transceiver to recvonly:",d)}catch(e){a.error(e)}else d=i.pc.addTransceiver("video",{direction:"recvonly"}),a.log("Adding recvonly video transceiver:",d)}else if(t.removeVideo&&d)try{d.setDirection?d.setDirection("inactive"):d.direction="inactive",a.log("Setting video transceiver to inactive:",d)}catch(e){a.error(e)}}else c="firefox"===a.webRTCAdapter.browserDetails.browser||"edge"===a.webRTCAdapter.browserDetails.browser?{offerToReceiveAudio:Y(t),offerToReceiveVideo:X(t)}:{mandatory:{OfferToReceiveAudio:Y(t),OfferToReceiveVideo:X(t)}};a.debug(c);var y=J(t);if(y&&s&&"firefox"===a.webRTCAdapter.browserDetails.browser){a.log("Enabling Simulcasting for Firefox (RID)");var b=i.pc.getSenders()[1];a.log(b);var S=b.getParameters();a.log(S);var k=w(r.simulcastMaxBitrates);b.setParameters({encodings:r.sendEncodings||[{rid:"h",active:!0,maxBitrate:k.high},{rid:"m",active:!0,maxBitrate:k.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:k.low,scaleResolutionDownBy:4}]})}i.pc.createAnswer(c).then((function(e){a.debug(e);var t={type:e.type,sdp:e.sdp};r.customizeSdp(t),e.sdp=t.sdp,a.log("Setting local description"),y&&s&&("chrome"===a.webRTCAdapter.browserDetails.browser?a.warn("simulcast=true, but this is an answer, and video breaks in Chrome if we enable it"):"firefox"!==a.webRTCAdapter.browserDetails.browser&&a.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),i.mySdp={type:"answer",sdp:e.sdp},i.pc.setLocalDescription(e).catch(r.error),i.mediaConstraints=c,i.iceDone||i.trickle?((i.senderTransforms||i.receiverTransforms)&&(e.e2ee=!0),r.success(e)):a.log("Waiting for all candidates...")}),r.error)}(e,r,i)}),i.error):function(e,t,r){(r=r||{}).success="function"==typeof r.success?r.success:a.noop,r.error="function"==typeof r.error?r.error:a.noop,r.customizeSdp="function"==typeof r.customizeSdp?r.customizeSdp:a.noop;var o=C[e];if(!o||!o.webrtcStuff)return a.warn("Invalid handle"),void r.error("Invalid handle");var i=o.webrtcStuff,s=!0===r.simulcast;s?a.log("Creating offer (iceDone="+i.iceDone+", simulcast="+s+")"):a.log("Creating offer (iceDone="+i.iceDone+")");var c={};if(a.unifiedPlan){var u=null,d=null,l=i.pc.getTransceivers();if(l&&l.length>0){var f,p=n(l);try{for(p.s();!(f=p.n()).done;){var m=f.value;m.sender&&m.sender.track&&"audio"===m.sender.track.kind||m.receiver&&m.receiver.track&&"audio"===m.receiver.track.kind?u||(u=m):(m.sender&&m.sender.track&&"video"===m.sender.track.kind||m.receiver&&m.receiver.track&&"video"===m.receiver.track.kind)&&(d||(d=m))}}catch(e){p.e(e)}finally{p.f()}}var h=z(t),_=Y(t);h||_?h&&_?u&&(u.setDirection?u.setDirection("sendrecv"):u.direction="sendrecv",a.log("Setting audio transceiver to sendrecv:",u)):h&&!_?u&&(u.setDirection?u.setDirection("sendonly"):u.direction="sendonly",a.log("Setting audio transceiver to sendonly:",u)):!h&&_&&(u?(u.setDirection?u.setDirection("recvonly"):u.direction="recvonly",a.log("Setting audio transceiver to recvonly:",u)):(u=i.pc.addTransceiver("audio",{direction:"recvonly"}),a.log("Adding recvonly audio transceiver:",u))):t.removeAudio&&u&&(u.setDirection?u.setDirection("inactive"):u.direction="inactive",a.log("Setting audio transceiver to inactive:",u));var g=J(t),v=X(t);g||v?g&&v?d&&(d.setDirection?d.setDirection("sendrecv"):d.direction="sendrecv",a.log("Setting video transceiver to sendrecv:",d)):g&&!v?d&&(d.setDirection?d.setDirection("sendonly"):d.direction="sendonly",a.log("Setting video transceiver to sendonly:",d)):!g&&v&&(d?(d.setDirection?d.setDirection("recvonly"):d.direction="recvonly",a.log("Setting video transceiver to recvonly:",d)):(d=i.pc.addTransceiver("video",{direction:"recvonly"}),a.log("Adding recvonly video transceiver:",d))):t.removeVideo&&d&&(d.setDirection?d.setDirection("inactive"):d.direction="inactive",a.log("Setting video transceiver to inactive:",d))}else c.offerToReceiveAudio=Y(t),c.offerToReceiveVideo=X(t);!0===r.iceRestart&&(c.iceRestart=!0);a.debug(c);var y=J(t);if(y&&s&&"firefox"===a.webRTCAdapter.browserDetails.browser){a.log("Enabling Simulcasting for Firefox (RID)");var b=i.pc.getSenders().find((function(e){return"video"===e.track.kind}));if(b){var S=b.getParameters();S||(S={});var k=w(r.simulcastMaxBitrates);S.encodings=r.sendEncodings||[{rid:"h",active:!0,maxBitrate:k.high},{rid:"m",active:!0,maxBitrate:k.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:k.low,scaleResolutionDownBy:4}],b.setParameters(S)}}i.pc.createOffer(c).then((function(e){a.debug(e);var t={type:e.type,sdp:e.sdp};r.customizeSdp(t),e.sdp=t.sdp,a.log("Setting local description"),y&&s&&("chrome"===a.webRTCAdapter.browserDetails.browser||"safari"===a.webRTCAdapter.browserDetails.browser?(a.log("Enabling Simulcasting for Chrome (SDP munging)"),e.sdp=function(e){for(var t=e.split("\r\n"),n=!1,r=[-1],o=[-1],i=null,s=null,c=null,u=null,d=-1,l=0;l<t.length;l++){if(p=t[l].match(/m=(\w+) */)){if("video"===p[1]){if(!(r[0]<0)){d=l;break}n=!0}else if(r[0]>-1){d=l;break}}else if(n){if(t[l].match(/a=ssrc-group:SIM (\d+) (\d+) (\d+)/))return a.warn("The SDP already contains a SIM attribute, munging will be skipped"),e;var f=t[l].match(/a=ssrc-group:FID (\d+) (\d+)/);if(f)r[0]=f[1],o[0]=f[2],t.splice(l,1),l--;else{if(r[0]){if((h=t[l].match("a=ssrc:"+r[0]+" cname:(.+)"))&&(i=h[1]),(h=t[l].match("a=ssrc:"+r[0]+" msid:(.+)"))&&(s=h[1]),(h=t[l].match("a=ssrc:"+r[0]+" mslabel:(.+)"))&&(c=h[1]),(h=t[l].match("a=ssrc:"+r[0]+" label:(.+)"))&&(u=h[1]),0===t[l].indexOf("a=ssrc:"+o[0])){t.splice(l,1),l--;continue}if(0===t[l].indexOf("a=ssrc:"+r[0])){t.splice(l,1),l--;continue}}0!=t[l].length||(t.splice(l,1),l--)}}}if(r[0]<0){d=-1,n=!1;for(l=0;l<t.length;l++){var p;if(p=t[l].match(/m=(\w+) */)){if("video"===p[1]){if(!(r[0]<0)){d=l;break}n=!0}else if(r[0]>-1){d=l;break}}else if(n){if(r[0]<0){var m=t[l].match(/a=ssrc:(\d+)/);if(m){r[0]=m[1],t.splice(l,1),l--;continue}}else{var h;if((h=t[l].match("a=ssrc:"+r[0]+" cname:(.+)"))&&(i=h[1]),(h=t[l].match("a=ssrc:"+r[0]+" msid:(.+)"))&&(s=h[1]),(h=t[l].match("a=ssrc:"+r[0]+" mslabel:(.+)"))&&(c=h[1]),(h=t[l].match("a=ssrc:"+r[0]+" label:(.+)"))&&(u=h[1]),0===t[l].indexOf("a=ssrc:"+o[0])){t.splice(l,1),l--;continue}if(0===t[l].indexOf("a=ssrc:"+r[0])){t.splice(l,1),l--;continue}}0!==t[l].length||(t.splice(l,1),l--)}}}if(r[0]<0)return a.warn("Couldn't find the video SSRC, simulcasting NOT enabled"),e;d<0&&(d=t.length);r[1]=Math.floor(4294967295*Math.random()),r[2]=Math.floor(4294967295*Math.random()),o[1]=Math.floor(4294967295*Math.random()),o[2]=Math.floor(4294967295*Math.random());for(l=0;l<r.length;l++)i&&(t.splice(d,0,"a=ssrc:"+r[l]+" cname:"+i),d++),s&&(t.splice(d,0,"a=ssrc:"+r[l]+" msid:"+s),d++),c&&(t.splice(d,0,"a=ssrc:"+r[l]+" mslabel:"+c),d++),u&&(t.splice(d,0,"a=ssrc:"+r[l]+" label:"+u),d++),i&&(t.splice(d,0,"a=ssrc:"+o[l]+" cname:"+i),d++),s&&(t.splice(d,0,"a=ssrc:"+o[l]+" msid:"+s),d++),c&&(t.splice(d,0,"a=ssrc:"+o[l]+" mslabel:"+c),d++),u&&(t.splice(d,0,"a=ssrc:"+o[l]+" label:"+u),d++);t.splice(d,0,"a=ssrc-group:FID "+r[2]+" "+o[2]),t.splice(d,0,"a=ssrc-group:FID "+r[1]+" "+o[1]),t.splice(d,0,"a=ssrc-group:FID "+r[0]+" "+o[0]),t.splice(d,0,"a=ssrc-group:SIM "+r[0]+" "+r[1]+" "+r[2]),(e=t.join("\r\n")).endsWith("\r\n")||(e+="\r\n");return e}(e.sdp)):"firefox"!==a.webRTCAdapter.browserDetails.browser&&a.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),i.mySdp={type:"offer",sdp:e.sdp},i.pc.setLocalDescription(e).catch(r.error),i.mediaConstraints=c,i.iceDone||i.trickle?((i.senderTransforms||i.receiverTransforms)&&(e.e2ee=!0),r.success(e)):a.log("Waiting for all candidates...")}),r.error)}(e,r,i)}function F(e,t,r){(r=r||{}).success="function"==typeof r.success?r.success:a.noop,r.error="function"==typeof r.error?r.error:W;var i=r.jsep;if(t&&i)return a.error("Provided a JSEP to a createOffer"),void r.error("Provided a JSEP to a createOffer");if(!(t||i&&i.type&&i.sdp))return a.error("A valid JSEP is required for createAnswer"),void r.error("A valid JSEP is required for createAnswer");r.media="object"===o(r.media)&&r.media?r.media:{audio:!0,video:!0};var s=r.media,c=C[e];if(!c||!c.webrtcStuff)return a.warn("Invalid handle"),void r.error("Invalid handle");var u,d=c.webrtcStuff;if(d.trickle=(u=r.trickle,a.debug("isTrickleEnabled:",u),!1!==u),d.pc){if(a.log("Updating existing media session"),s.update=!0,r.stream)r.stream!==d.myStream&&a.log("Renegotiation involves a new external stream");else{if(s.addAudio){if(s.keepAudio=!1,s.replaceAudio=!1,s.removeAudio=!1,s.audioSend=!0,d.myStream&&d.myStream.getAudioTracks()&&d.myStream.getAudioTracks().length)return a.error("Can't add audio stream, there already is one"),void r.error("Can't add audio stream, there already is one")}else s.removeAudio?(s.keepAudio=!1,s.replaceAudio=!1,s.addAudio=!1,s.audioSend=!1):s.replaceAudio&&(s.keepAudio=!1,s.addAudio=!1,s.removeAudio=!1,s.audioSend=!0);if(d.myStream&&d.myStream.getAudioTracks()&&0!==d.myStream.getAudioTracks().length?!z(s)||s.removeAudio||s.replaceAudio||(s.keepAudio=!0):(s.replaceAudio&&(s.keepAudio=!1,s.replaceAudio=!1,s.addAudio=!0,s.audioSend=!0),z(s)&&(s.keepAudio=!1,s.addAudio=!0)),s.addVideo){if(s.keepVideo=!1,s.replaceVideo=!1,s.removeVideo=!1,s.videoSend=!0,d.myStream&&d.myStream.getVideoTracks()&&d.myStream.getVideoTracks().length)return a.error("Can't add video stream, there already is one"),void r.error("Can't add video stream, there already is one")}else s.removeVideo?(s.keepVideo=!1,s.replaceVideo=!1,s.addVideo=!1,s.videoSend=!1):s.replaceVideo&&(s.keepVideo=!1,s.addVideo=!1,s.removeVideo=!1,s.videoSend=!0);d.myStream&&d.myStream.getVideoTracks()&&0!==d.myStream.getVideoTracks().length?!J(s)||s.removeVideo||s.replaceVideo||(s.keepVideo=!0):(s.replaceVideo&&(s.keepVideo=!1,s.replaceVideo=!1,s.addVideo=!0,s.videoSend=!0),J(s)&&(s.keepVideo=!1,s.addVideo=!0)),s.addData&&(s.data=!0)}if(z(s)&&s.keepAudio&&J(s)&&s.keepVideo)return c.consentDialog(!1),void L(e,i,s,r,d.myStream)}else s.update=!1,s.keepAudio=!1,s.keepVideo=!1;if(s.update&&!d.streamExternal){if(s.removeAudio||s.replaceAudio){if(d.myStream&&d.myStream.getAudioTracks()&&d.myStream.getAudioTracks().length){var l=d.myStream.getAudioTracks()[0];a.log("Removing audio track:",l),d.myStream.removeTrack(l);try{l.stop()}catch(e){}}if(d.pc.getSenders()&&d.pc.getSenders().length){var f=!0;if(s.replaceAudio&&a.unifiedPlan&&(f=!1),f){var p,m=n(d.pc.getSenders());try{for(m.s();!(p=m.n()).done;){var h=p.value;h&&h.track&&"audio"===h.track.kind&&(a.log("Removing audio sender:",h),d.pc.removeTrack(h))}}catch(e){m.e(e)}finally{m.f()}}}}if(s.removeVideo||s.replaceVideo){if(d.myStream&&d.myStream.getVideoTracks()&&d.myStream.getVideoTracks().length){var _=d.myStream.getVideoTracks()[0];a.log("Removing video track:",_),d.myStream.removeTrack(_);try{_.stop()}catch(e){}}if(d.pc.getSenders()&&d.pc.getSenders().length){var g=!0;if(s.replaceVideo&&a.unifiedPlan&&(g=!1),g){var v,y=n(d.pc.getSenders());try{for(y.s();!(v=y.n()).done;){var b=v.value;b&&b.track&&"video"===b.track.kind&&(a.log("Removing video sender:",b),d.pc.removeTrack(b))}}catch(e){y.e(e)}finally{y.f()}}}}}if(r.stream){var w=r.stream;return a.log("MediaStream provided by the application"),a.debug(w),s.update&&d.myStream&&d.myStream!==r.stream&&!d.streamExternal&&(a.stopAllTracks(d.myStream),d.myStream=null),d.streamExternal=!0,c.consentDialog(!1),void L(e,i,s,r,w)}if(z(s)||J(s)){if(!a.isGetUserMediaAvailable())return void r.error("getUserMedia not available");var S={mandatory:{},optional:[]};c.consentDialog(!0);var k=z(s);k&&s&&"object"===o(s.audio)&&(k=s.audio);var E=J(s);if(E&&s){var T=!0===r.simulcast,O=!0===r.simulcast2;if(!T&&!O||i||s.video||(s.video="hires"),s.video&&"screen"!=s.video&&"window"!=s.video)if("object"===o(s.video))E=s.video;else{var P=0,A=0;"lowres"===s.video?(A=240,P=320):"lowres-16:9"===s.video?(A=180,P=320):"hires"===s.video||"hires-16:9"===s.video||"hdres"===s.video?(A=720,P=1280):"fhdres"===s.video?(A=1080,P=1920):"4kres"===s.video?(A=2160,P=3840):"stdres"===s.video?(A=480,P=640):"stdres-16:9"===s.video?(A=360,P=640):(a.log("Default video setting is stdres 4:3"),A=480,P=640),a.log("Adding media constraint:",s.video),E={height:{ideal:A},width:{ideal:P}},a.log("Adding video constraint:",E)}else if("screen"===s.video||"window"===s.video){var R=function(t,n){c.consentDialog(!1),t?r.error(t):L(e,i,s,r,n)},M=function(e,t,n){a.log("Adding media constraint (screen capture)"),a.debug(e),navigator.mediaDevices.getUserMedia(e).then((function(e){n?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(n){e.addTrack(n.getAudioTracks()[0]),t(null,e)})):t(null,e)})).catch((function(e){c.consentDialog(!1),t(e)}))};if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return S.video={},s.screenshareFrameRate&&(S.video.frameRate=s.screenshareFrameRate),s.screenshareHeight&&(S.video.height=s.screenshareHeight),s.screenshareWidth&&(S.video.width=s.screenshareWidth),S.audio=s.captureDesktopAudio,void navigator.mediaDevices.getDisplayMedia(S).then((function(t){c.consentDialog(!1),z(s)&&!s.keepAudio?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(n){t.addTrack(n.getAudioTracks()[0]),L(e,i,s,r,t)})):L(e,i,s,r,t)}),(function(e){c.consentDialog(!1),r.error(e)}));if("chrome"===a.webRTCAdapter.browserDetails.browser){var x=a.webRTCAdapter.browserDetails.version,U=33;window.navigator.userAgent.match("Linux")&&(U=35),x>=26&&x<=U?(S={video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:s.screenshareFrameRate,maxFrameRate:s.screenshareFrameRate,chromeMediaSource:"screen"}},audio:z(s)&&!s.keepAudio},M(S,R)):a.extension.getScreen((function(e,t){if(e)return c.consentDialog(!1),r.error(e);(S={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:s.screenshareFrameRate,maxFrameRate:s.screenshareFrameRate},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}}).video.mandatory.chromeMediaSourceId=t,M(S,R,z(s)&&!s.keepAudio)}))}else if("firefox"===a.webRTCAdapter.browserDetails.browser){if(!(a.webRTCAdapter.browserDetails.version>=33)){var I=new Error("NavigatorUserMediaError");return I.name="Your version of Firefox does not support screen sharing, please install Firefox 33 (or more recent versions)",c.consentDialog(!1),void r.error(I)}S={video:{mozMediaSource:s.video,mediaSource:s.video},audio:z(s)&&!s.keepAudio},M(S,(function(e,t){if(R(e,t),!e)var n=t.currentTime,r=window.setInterval((function(){t||window.clearInterval(r),t.currentTime==n&&(window.clearInterval(r),t.onended&&t.onended()),n=t.currentTime}),500)}))}return}}s&&"screen"===s.video||navigator.mediaDevices.enumerateDevices().then((function(t){var n=t.some((function(e){return"audioinput"===e.kind})),u=function(e){if(a.debug("isScreenSendEnabled:",e),!e)return!1;if("object"!==o(e.video)||"object"!==o(e.video.mandatory))return!1;var t=e.video.mandatory;if(t.chromeMediaSource)return"desktop"===t.chromeMediaSource||"screen"===t.chromeMediaSource;if(t.mozMediaSource)return"window"===t.mozMediaSource||"screen"===t.mozMediaSource;if(t.mediaSource)return"window"===t.mediaSource||"screen"===t.mediaSource;return!1}(s)||t.some((function(e){return"videoinput"===e.kind})),d=z(s),l=J(s),f=function(e){return a.debug("isAudioSendRequired:",e),!!e&&(!1!==e.audio&&!1!==e.audioSend&&(void 0!==e.failIfNoAudio&&null!==e.failIfNoAudio&&!0===e.failIfNoAudio))}(s),p=function(e){return a.debug("isVideoSendRequired:",e),!!e&&(!1!==e.video&&!1!==e.videoSend&&(void 0!==e.failIfNoVideo&&null!==e.failIfNoVideo&&!0===e.failIfNoVideo))}(s);if(d||l||f||p){var m=!!d&&n,h=!!l&&u;if(!m&&!h)return c.consentDialog(!1),r.error("No capture device found"),!1;if(!m&&f)return c.consentDialog(!1),r.error("Audio capture is required, but no capture device found"),!1;if(!h&&p)return c.consentDialog(!1),r.error("Video capture is required, but no capture device found"),!1}var _={audio:!(!n||s.keepAudio)&&k,video:!(!u||s.keepVideo)&&E};a.debug("getUserMedia constraints",_),_.audio||_.video?navigator.mediaDevices.getUserMedia(_).then((function(t){c.consentDialog(!1),L(e,i,s,r,t)})).catch((function(e){c.consentDialog(!1),r.error({code:e.code,name:e.name,message:e.message})})):(c.consentDialog(!1),L(e,i,s,r,w))})).catch((function(e){c.consentDialog(!1),r.error(e)}))}else L(e,i,s,r)}function N(e,t){(t=t||{}).success="function"==typeof t.success?t.success:a.noop,t.error="function"==typeof t.error?t.error:W;var n=t.jsep,r=C[e];if(!r||!r.webrtcStuff)return a.warn("Invalid handle"),void t.error("Invalid handle");var o=r.webrtcStuff;if(n){if(!o.pc)return a.warn("Wait, no PeerConnection?? if this is an answer, use createAnswer and not handleRemoteJsep"),void t.error("No PeerConnection: if this is an answer, use createAnswer and not handleRemoteJsep");o.pc.setRemoteDescription(n).then((function(){if(a.log("Remote description accepted!"),o.remoteSdp=n.sdp,o.candidates&&o.candidates.length>0){for(var e=0;e<o.candidates.length;e++){var r=o.candidates[e];a.debug("Adding remote candidate:",r),r&&!0!==r.completed?o.pc.addIceCandidate(r):o.pc.addIceCandidate(a.endOfCandidates)}o.candidates=[]}t.success()}),t.error)}else t.error("Invalid JSEP")}function $(e,t){var n=C[e];if(!n||!n.webrtcStuff)return a.warn("Invalid handle"),0;var r=t?"remote":"local",o=n.webrtcStuff;return o.volume[r]||(o.volume[r]={value:0}),!o.pc.getStats||"chrome"!==a.webRTCAdapter.browserDetails.browser&&"safari"!==a.webRTCAdapter.browserDetails.browser?(a.warn("Getting the "+r+" volume unsupported by browser"),0):t&&!o.remoteStream?(a.warn("Remote stream unavailable"),0):t||o.myStream?o.volume[r].timer?o.volume[r].value:(a.log("Starting "+r+" volume monitor"),o.volume[r].timer=setInterval((function(){o.pc.getStats().then((function(e){e.forEach((function(e){e&&"audio"===e.kind&&(t&&!e.remoteSource||!t&&"media-source"!==e.type||(o.volume[r].value=e.audioLevel?e.audioLevel:0))}))}))}),200),0):(a.warn("Local stream unavailable"),0)}function q(e,t){var n=C[e];if(!n||!n.webrtcStuff)return a.warn("Invalid handle"),!0;var r=n.webrtcStuff;return r.pc?r.myStream?t?r.myStream.getVideoTracks()&&0!==r.myStream.getVideoTracks().length?!r.myStream.getVideoTracks()[0].enabled:(a.warn("No video track"),!0):r.myStream.getAudioTracks()&&0!==r.myStream.getAudioTracks().length?!r.myStream.getAudioTracks()[0].enabled:(a.warn("No audio track"),!0):(a.warn("Invalid local MediaStream"),!0):(a.warn("Invalid PeerConnection"),!0)}function G(e,t,n){var r=C[e];if(!r||!r.webrtcStuff)return a.warn("Invalid handle"),!1;var o=r.webrtcStuff;return o.pc?o.myStream?t?o.myStream.getVideoTracks()&&0!==o.myStream.getVideoTracks().length?(o.myStream.getVideoTracks()[0].enabled=!n,!0):(a.warn("No video track"),!1):o.myStream.getAudioTracks()&&0!==o.myStream.getAudioTracks().length?(o.myStream.getAudioTracks()[0].enabled=!n,!0):(a.warn("No audio track"),!1):(a.warn("Invalid local MediaStream"),!1):(a.warn("Invalid PeerConnection"),!1)}function V(e){var t=C[e];if(!t||!t.webrtcStuff)return a.warn("Invalid handle"),"Invalid handle";var n=t.webrtcStuff;return n.pc?n.pc.getStats?n.bitrate.timer?n.bitrate.value:(a.log("Starting bitrate timer (via getStats)"),n.bitrate.timer=setInterval((function(){n.pc.getStats().then((function(e){e.forEach((function(e){if(e){var t=!1;if(("video"===e.mediaType||e.id.toLowerCase().indexOf("video")>-1)&&"inbound-rtp"===e.type&&e.id.indexOf("rtcp")<0?t=!0:"ssrc"!=e.type||!e.bytesReceived||"VP8"!==e.googCodecName&&""!==e.googCodecName||(t=!0),t)if(n.bitrate.bsnow=e.bytesReceived,n.bitrate.tsnow=e.timestamp,null===n.bitrate.bsbefore||null===n.bitrate.tsbefore)n.bitrate.bsbefore=n.bitrate.bsnow,n.bitrate.tsbefore=n.bitrate.tsnow;else{var r=n.bitrate.tsnow-n.bitrate.tsbefore;"safari"===a.webRTCAdapter.browserDetails.browser&&(r/=1e3);var o=Math.round(8*(n.bitrate.bsnow-n.bitrate.bsbefore)/r);"safari"===a.webRTCAdapter.browserDetails.browser&&(o=parseInt(o/1e3)),n.bitrate.value=o+" kbits/sec",n.bitrate.bsbefore=n.bitrate.bsnow,n.bitrate.tsbefore=n.bitrate.tsnow}}}))}))}),1e3),"0 kbits/sec"):(a.warn("Getting the video bitrate unsupported by browser"),"Feature unsupported by browser"):"Invalid PeerConnection"}function W(e){a.error("WebRTC error:",e)}function H(e,n){a.log("Cleaning WebRTC stuff");var o=C[e];if(o){var i=o.webrtcStuff;if(i){if(!0===n){var s={janus:"hangup",transaction:a.randomString(12)};o.token&&(s.token=o.token),v&&(s.apisecret=v),a.debug("Sending hangup request (handle="+e+"):"),a.debug(s),t?(s.session_id=k,s.handle_id=e,r.send(JSON.stringify(s))):a.httpAPICall(d+"/"+k+"/"+e,{verb:"POST",withCredentials:h,body:s})}i.remoteStream=null,i.volume&&(i.volume.local&&i.volume.local.timer&&clearInterval(i.volume.local.timer),i.volume.remote&&i.volume.remote.timer&&clearInterval(i.volume.remote.timer)),i.volume={},i.bitrate.timer&&clearInterval(i.bitrate.timer),i.bitrate.timer=null,i.bitrate.bsnow=null,i.bitrate.bsbefore=null,i.bitrate.tsnow=null,i.bitrate.tsbefore=null,i.bitrate.value=null,!i.streamExternal&&i.myStream&&(a.log("Stopping local stream tracks"),a.stopAllTracks(i.myStream)),i.streamExternal=!1,i.myStream=null;try{i.pc.close()}catch(e){}i.pc=null,i.candidates=null,i.mySdp=null,i.remoteSdp=null,i.iceDone=!1,i.dataChannel={},i.dtmfSender=null,i.senderTransforms=null,i.receiverTransforms=null}o.oncleanup()}}function z(e){return a.debug("isAudioSendEnabled:",e),!e||!1!==e.audio&&(void 0===e.audioSend||null===e.audioSend||!0===e.audioSend)}function Y(e){return a.debug("isAudioRecvEnabled:",e),!e||!1!==e.audio&&(void 0===e.audioRecv||null===e.audioRecv||!0===e.audioRecv)}function J(e){return a.debug("isVideoSendEnabled:",e),!e||!1!==e.video&&(void 0===e.videoSend||null===e.videoSend||!0===e.videoSend)}function X(e){return a.debug("isVideoRecvEnabled:",e),!e||!1!==e.video&&(void 0===e.videoRecv||null===e.videoRecv||!0===e.videoRecv)}M(e),this.getServer=function(){return d},this.isConnected=function(){return S},this.reconnect=function(e){(e=e||{}).success="function"==typeof e.success?e.success:a.noop,e.error="function"==typeof e.error?e.error:a.noop,e.reconnect=!0,M(e)},this.getSessionId=function(){return k},this.getInfo=function(e){!function(e){if((e=e||{}).success="function"==typeof e.success?e.success:a.noop,e.error="function"==typeof e.error?e.error:a.noop,a.log("Getting info on Janus instance"),!S)return a.warn("Is the server down? (connected=false)"),void e.error("Is the server down? (connected=false)");var n=a.randomString(12),o={janus:"info",transaction:n};g&&(o.token=g);v&&(o.apisecret=v);if(t)return O[n]=function(t){a.log("Server info:"),a.debug(t),"server_info"!==t.janus&&a.error("Ooops: "+t.error.code+" "+t.error.reason),e.success(t)},void r.send(JSON.stringify(o));a.httpAPICall(d,{verb:"POST",withCredentials:h,body:o,success:function(t){a.log("Server info:"),a.debug(t),"server_info"!==t.janus&&a.error("Ooops: "+t.error.code+" "+t.error.reason),e.success(t)},error:function(t,n){a.error(t+":",n),""===n?e.error(t+": Is the server down?"):e.error(t+": "+n)}})}(e)},this.destroy=function(n){!function(n){(n=n||{}).success="function"==typeof n.success?n.success:a.noop,n.error="function"==typeof n.error?n.error:a.noop;var o=!0===n.unload,c=!0;void 0!==n.notifyDestroyed&&null!==n.notifyDestroyed&&(c=!0===n.notifyDestroyed);var u=!0===n.cleanupHandles;if(a.log("Destroying session "+k+" (unload="+o+")"),!k)return a.warn("No session to destroy"),n.success(),void(c&&e.destroyed());if(u)for(var l in C)B(l,{noRequest:!0});if(!S)return a.warn("Is the server down? (connected=false)"),k=null,void n.success();var f={janus:"destroy",transaction:a.randomString(12)};g&&(f.token=g);v&&(f.apisecret=v);if(o)return t?(r.onclose=null,r.close(),r=null):navigator.sendBeacon(d+"/"+k,JSON.stringify(f)),a.log("Destroyed session:"),k=null,S=!1,n.success(),void(c&&e.destroyed());if(t){f.session_id=k;var p=function(){for(var e in i)r.removeEventListener(e,i[e]);r.removeEventListener("message",m),r.removeEventListener("error",_),s&&clearTimeout(s),r.close()},m=function(t){var r=JSON.parse(t.data);r.session_id==f.session_id&&r.transaction==f.transaction&&(p(),n.success(),c&&e.destroyed())},_=function(t){p(),n.error("Failed to destroy the server: Is the server down?"),c&&e.destroyed()};return r.addEventListener("message",m),r.addEventListener("error",_),void(1===r.readyState?r.send(JSON.stringify(f)):_())}a.httpAPICall(d+"/"+k,{verb:"POST",withCredentials:h,body:f,success:function(t){a.log("Destroyed session:"),a.debug(t),k=null,S=!1,"success"!==t.janus&&a.error("Ooops: "+t.error.code+" "+t.error.reason),n.success(),c&&e.destroyed()},error:function(t,r){a.error(t+":",r),k=null,S=!1,n.success(),c&&e.destroyed()}})}(n)},this.attach=function(e){!function(e){if((e=e||{}).success="function"==typeof e.success?e.success:a.noop,e.error="function"==typeof e.error?e.error:a.noop,e.consentDialog="function"==typeof e.consentDialog?e.consentDialog:a.noop,e.iceState="function"==typeof e.iceState?e.iceState:a.noop,e.mediaState="function"==typeof e.mediaState?e.mediaState:a.noop,e.webrtcState="function"==typeof e.webrtcState?e.webrtcState:a.noop,e.slowLink="function"==typeof e.slowLink?e.slowLink:a.noop,e.onmessage="function"==typeof e.onmessage?e.onmessage:a.noop,e.onlocalstream="function"==typeof e.onlocalstream?e.onlocalstream:a.noop,e.onremotestream="function"==typeof e.onremotestream?e.onremotestream:a.noop,e.ondata="function"==typeof e.ondata?e.ondata:a.noop,e.ondataopen="function"==typeof e.ondataopen?e.ondataopen:a.noop,e.oncleanup="function"==typeof e.oncleanup?e.oncleanup:a.noop,e.ondetached="function"==typeof e.ondetached?e.ondetached:a.noop,!S)return a.warn("Is the server down? (connected=false)"),void e.error("Is the server down? (connected=false)");var n=e.plugin;if(!n)return a.error("Invalid plugin"),void e.error("Invalid plugin");var o=e.opaqueId,i=e.token?e.token:g,s=a.randomString(12),c={janus:"attach",plugin:n,opaque_id:o,transaction:s};i&&(c.token=i);v&&(c.apisecret=v);if(t)return O[s]=function(t){if(a.debug(t),"success"!==t.janus)return a.error("Ooops: "+t.error.code+" "+t.error.reason),void e.error("Ooops: "+t.error.code+" "+t.error.reason);var r=t.data.id;a.log("Created handle: "+r);var o={session:E,plugin:n,id:r,token:i,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return r},getPlugin:function(){return n},getVolume:function(){return $(r,!0)},getRemoteVolume:function(){return $(r,!0)},getLocalVolume:function(){return $(r,!1)},isAudioMuted:function(){return q(r,!1)},muteAudio:function(){return G(r,!1,!0)},unmuteAudio:function(){return G(r,!1,!1)},isVideoMuted:function(){return q(r,!0)},muteVideo:function(){return G(r,!0,!0)},unmuteVideo:function(){return G(r,!0,!1)},getBitrate:function(){return V(r)},send:function(e){x(r,e)},data:function(e){D(r,e)},dtmf:function(e){j(r,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){F(r,!0,e)},createAnswer:function(e){F(r,!1,e)},handleRemoteJsep:function(e){N(r,e)},onlocalstream:e.onlocalstream,onremotestream:e.onremotestream,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){H(r,!0===e)},detach:function(e){B(r,e)}};C[r]=o,e.success(o)},c.session_id=k,void r.send(JSON.stringify(c));a.httpAPICall(d+"/"+k,{verb:"POST",withCredentials:h,body:c,success:function(t){if(a.debug(t),"success"!==t.janus)return a.error("Ooops: "+t.error.code+" "+t.error.reason),void e.error("Ooops: "+t.error.code+" "+t.error.reason);var r=t.data.id;a.log("Created handle: "+r);var o={session:E,plugin:n,id:r,token:i,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return r},getPlugin:function(){return n},getVolume:function(){return $(r,!0)},getRemoteVolume:function(){return $(r,!0)},getLocalVolume:function(){return $(r,!1)},isAudioMuted:function(){return q(r,!1)},muteAudio:function(){return G(r,!1,!0)},unmuteAudio:function(){return G(r,!1,!1)},isVideoMuted:function(){return q(r,!0)},muteVideo:function(){return G(r,!0,!0)},unmuteVideo:function(){return G(r,!0,!1)},getBitrate:function(){return V(r)},send:function(e){x(r,e)},data:function(e){D(r,e)},dtmf:function(e){j(r,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){F(r,!0,e)},createAnswer:function(e){F(r,!1,e)},handleRemoteJsep:function(e){N(r,e)},onlocalstream:e.onlocalstream,onremotestream:e.onremotestream,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){H(r,!0===e)},detach:function(e){B(r,e)}};C[r]=o,e.success(o)},error:function(t,n){a.error(t+":",n),""===n?e.error(t+": Is the server down?"):e.error(t+": "+n)}})}(e)}}a.useDefaultDependencies=function(e){var t=e&&e.fetch||fetch,n=e&&e.Promise||Promise,r=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new r(e,t)},extension:e&&e.extension||i,isArray:function(e){return Array.isArray(e)},webRTCAdapter:e&&e.adapter||adapter,httpAPICall:function(e,r){var i={method:r.verb,headers:{Accept:"application/json, text/plain, */*"},cache:"no-cache"};"POST"===r.verb&&(i.headers["Content-Type"]="application/json"),void 0!==r.withCredentials&&(i.credentials=!0===r.withCredentials?"include":r.withCredentials?r.withCredentials:"omit"),r.body&&(i.body=JSON.stringify(r.body));var s=t(e,i).catch((function(e){return n.reject({message:"Probably a network error, is the server down?",error:e})}));if(r.timeout){var c=new n((function(e,t){var n=setTimeout((function(){return clearTimeout(n),t({message:"Request timed out",timeout:r.timeout})}),r.timeout)}));s=n.race([s,c])}return s.then((function(e){return e.ok?o(r.success)===o(a.noop)?e.json().then((function(e){r.success(e)})).catch((function(t){return n.reject({message:"Failed to parse response body",error:t,response:e})})):void 0:n.reject({message:"API call failed",response:e})})).catch((function(e){o(r.error)===o(a.noop)&&r.error(e.message||"<< internal error >>",e)})),s}}},a.useOldDependencies=function(e){var t=e&&e.jQuery||jQuery,n=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new n(e,t)},isArray:function(e){return t.isArray(e)},extension:e&&e.extension||i,webRTCAdapter:e&&e.adapter||adapter,httpAPICall:function(e,n){var r=void 0!==n.body?{contentType:"application/json",data:JSON.stringify(n.body)}:{},i=void 0!==n.withCredentials?{xhrFields:{withCredentials:n.withCredentials}}:{};return t.ajax(t.extend(r,i,{url:e,type:n.verb,cache:!1,dataType:"json",async:n.async,timeout:n.timeout,success:function(e){o(n.success)===o(a.noop)&&n.success(e)},error:function(e,t,r){o(n.error)===o(a.noop)&&n.error(t,r)}}))}}},a.noop=function(){},a.dataChanDefaultLabel="JanusDataChannel",a.endOfCandidates=null,a.stopAllTracks=function(e){try{var t,r=n(e.getTracks());try{for(r.s();!(t=r.n()).done;){var o=t.value;a.log(o),o&&o.stop()}}catch(e){r.e(e)}finally{r.f()}}catch(e){}},a.init=function(e){if((e=e||{}).callback="function"==typeof e.callback?e.callback:a.noop,a.initDone)e.callback();else{if("undefined"!=typeof console&&void 0!==console.log||(console={log:function(){}}),a.trace=a.noop,a.debug=a.noop,a.vdebug=a.noop,a.log=a.noop,a.warn=a.noop,a.error=a.noop,!0===e.debug||"all"===e.debug)a.trace=console.trace.bind(console),a.debug=console.debug.bind(console),a.vdebug=console.debug.bind(console),a.log=console.log.bind(console),a.warn=console.warn.bind(console),a.error=console.error.bind(console);else if(Array.isArray(e.debug)){var t,r=n(e.debug);try{for(r.s();!(t=r.n()).done;){var o=t.value;switch(o){case"trace":a.trace=console.trace.bind(console);break;case"debug":a.debug=console.debug.bind(console);break;case"vdebug":a.vdebug=console.debug.bind(console);break;case"log":a.log=console.log.bind(console);break;case"warn":a.warn=console.warn.bind(console);break;case"error":a.error=console.error.bind(console);break;default:console.error("Unknown debugging option '"+o+"' (supported: 'trace', 'debug', 'vdebug', 'log', warn', 'error')")}}}catch(e){r.e(e)}finally{r.f()}}a.log("Initializing library");var i=e.dependencies||a.useDefaultDependencies();a.isArray=i.isArray,a.webRTCAdapter=i.webRTCAdapter,a.httpAPICall=i.httpAPICall,a.newWebSocket=i.newWebSocket,a.extension=i.extension,a.extension.init(),a.listDevices=function(e,t){e="function"==typeof e?e:a.noop,null==t&&(t={audio:!0,video:!0}),a.isGetUserMediaAvailable()?navigator.mediaDevices.getUserMedia(t).then((function(t){navigator.mediaDevices.enumerateDevices().then((function(n){a.debug(n),e(n),a.stopAllTracks(t)}))})).catch((function(t){a.error(t),e([])})):(a.warn("navigator.mediaDevices unavailable"),e([]))},a.attachMediaStream=function(e,t){try{e.srcObject=t}catch(n){try{e.src=URL.createObjectURL(t)}catch(e){a.error("Error attaching stream to element")}}},a.reattachMediaStream=function(e,t){try{e.srcObject=t.srcObject}catch(n){try{e.src=t.src}catch(e){a.error("Error reattaching stream to element")}}};var s=["iPad","iPhone","iPod"].indexOf(navigator.platform)>=0?"pagehide":"beforeunload",c=window["on"+s];if(window.addEventListener(s,(function(e){for(var t in a.log("Closing window"),a.sessions)a.sessions[t]&&a.sessions[t].destroyOnUnload&&(a.log("Destroying session "+t),a.sessions[t].destroy({unload:!0,notifyDestroyed:!1}));c&&"function"==typeof c&&c()})),a.safariVp8=!1,"safari"===a.webRTCAdapter.browserDetails.browser&&a.webRTCAdapter.browserDetails.version>=605)if(RTCRtpSender&&RTCRtpSender.getCapabilities&&RTCRtpSender.getCapabilities("video")&&RTCRtpSender.getCapabilities("video").codecs&&RTCRtpSender.getCapabilities("video").codecs.length){var u,d=n(RTCRtpSender.getCapabilities("video").codecs);try{for(d.s();!(u=d.n()).done;){var l=u.value;if(l&&l.mimeType&&"video/vp8"===l.mimeType.toLowerCase()){a.safariVp8=!0;break}}}catch(e){d.e(e)}finally{d.f()}a.safariVp8?a.log("This version of Safari supports VP8"):a.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu")}else{var f=new RTCPeerConnection({});f.createOffer({offerToReceiveVideo:!0}).then((function(e){a.safariVp8=-1!==e.sdp.indexOf("VP8"),a.safariVp8?a.log("This version of Safari supports VP8"):a.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu"),f.close(),f=null}))}if(a.unifiedPlan=!1,"firefox"===a.webRTCAdapter.browserDetails.browser&&a.webRTCAdapter.browserDetails.version>=59)a.unifiedPlan=!0;else if("chrome"===a.webRTCAdapter.browserDetails.browser&&a.webRTCAdapter.browserDetails.version>=72)a.unifiedPlan=!0;else if(window.RTCRtpTransceiver&&"currentDirection"in RTCRtpTransceiver.prototype){var p=new RTCPeerConnection;try{p.addTransceiver("audio"),a.unifiedPlan=!0}catch(e){}p.close()}else a.unifiedPlan=!1;a.initDone=!0,e.callback()}},a.isWebrtcSupported=function(){return!!window.RTCPeerConnection},a.isGetUserMediaAvailable=function(){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia},a.randomString=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="",r=0;r<e;r++){var o=Math.floor(Math.random()*t.length);n+=t.substring(o,o+1)}return n},e.exports=a},function(e,t,n){"use strict";var r=n(0),o=n(7),i=n(1),a=n(2);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,c;return t=e,c=[{key:"autoSendCardDrawRequest",value:function(){return!1}},{key:"registerEvents",value:function(t){e.onSceneDragOver(t),e.onCardDrop(t),e.onCardsBoxClicked(t),e.onMicClicked(t),e.onExitClicked(t),e.onHomeClicked(t),e.resetMic(t)}},{key:"resetMic",value:function(e){a.a.resetMS(e),a.a.removeCurrentUserFromMic(e),a.a.closeConsumerTransport(e),a.a.msSubscribe(e)}},{key:"setMicOn",value:function(e,t){var n=e.getState().players.find((function(e){return e.id==t}));n&&n.dom.user.avatar.find(".mic").addClass("on").attr("src","/images/mic.png")}},{key:"setMicOff",value:function(e,t){var n=e.getState().players.find((function(e){return e.id==t}));n&&n.dom.user.avatar.find(".mic").removeClass("on").attr("src","/images/stop-mic.png")}},{key:"onExitClicked",value:function(t){window.youcamUnoContainer.find("#youcam-uno-exit").unbind("click").on("click",(function(n){e.showExitDialog(t)}))}},{key:"onHomeClicked",value:function(t){window.youcamUnoContainer.find("#youcam-uno-home").unbind("click").on("click",(function(n){e.minimize(t)}))}},{key:"onMicClicked",value:function(t){window.youcamUnoContainer.find("#youcam-uno-bottom .user .avatar .mic").unbind("click").on("click",(function(n){if(t.unoGame&&t.unoGame.players){var r=t.unoGame.players.find((function(e){return e.id==t.getState().mUser.id}));r&&($(this).hasClass("on")?e.leaveMic(t,r.turnIndex):e.requestMic(t,r.turnIndex))}}))}},{key:"isMinimized",value:function(e){return e.unoGame&&e.unoGame.isMinimized}},{key:"minimize",value:function(t){t.unoGame.isMinimized=!0,window.youcamUnoContainer.find("#youcam-uno").hide();var n=t.unoGame.currentTurn==t.getState().mUser.id?"active":"";window.youcamUnoContainer.append("<div class='"+n+"' id='show-uno'><img src='/images/uno.png' /></div>"),e.onShowUno(t)}},{key:"onShowUno",value:function(e){window.youcamUnoContainer.find("#show-uno").unbind("click").on("click",(function(t){e.unoGame.isMinimized=!1,window.youcamUnoContainer.find("#show-uno").unbind("click").remove(),window.youcamUnoContainer.find("#youcam-uno").show(),e.dispatch(Object(o.a)(null)),i.a.togglePane(e,!0,t)}))}},{key:"requestMic",value:function(e,t){e.getState().socket.emit("req",Object(r.k)({type:"YOUCAM_UNO_MIC_REQ",data:{micId:t,rtpCapabilities:MS.getRtpCapabilities()}}),(function(e){}))}},{key:"leaveMic",value:function(e,t){e.getState().socket.emit("req",Object(r.k)({type:"YOUCAM_UNO_MIC_LEAVE",data:{micId:t}}),(function(e){}))}},{key:"onCardsBoxClicked",value:function(t){window.youcamUnoContainer.find("#youcam-uno-bottom .cards-box").unbind("click").on("click",(function(n){t.unoGame&&t.unoGame.drawCards&&(delete t.unoGame.drawCards,e.cardsBoxSetUnclickable(),e.requestCardDraw(t))}))}},{key:"requestCardDraw",value:function(e){e.getState().socket.emit("req",Object(r.k)({type:"YOUCAM_UNO_CARDS_DRAW",data:{}}),(function(e){}))}},{key:"initSounds",value:function(e){for(var t=1;t<=4;t++)e["unoMicAudio"+t]=new Audio,e["unoMicAudio"+t].muted=!0;e.soundDrawCard||(e.soundDrawCard=new Audio("audio/drawCard.wav"),e.soundDrawCard.muted=!0,e.soundDrawCard.play()),e.soundPlayAgain||(e.soundPlayAgain=new Audio("audio/playAgain.wav"),e.soundPlayAgain.muted=!0,e.soundPlayAgain.play()),e.soundColorButton||(e.soundColorButton=new Audio("audio/colorButton.wav"),e.soundColorButton.muted=!0,e.soundColorButton.play()),e.soundPlusCard||(e.soundPlusCard=new Audio("audio/plusCard.wav"),e.soundPlusCard.muted=!0,e.soundPlusCard.play()),e.soundUno||(e.soundUno=new Audio("audio/uno.wav"),e.soundUno.muted=!0,e.soundUno.play())}},{key:"startGame",value:function(t,n){n&&(window.youcamUnoContainer.find(".pre_youcam_uno_modal__header__close").trigger("click"),$(".modal-backdrop").remove(),e.render(t,n))}},{key:"checkPlayerUno",value:function(t,n){n&&(1===n.dom.cards.children().length?n.dom.user.avatar.hasClass("uno")||(e.playSound(t,"soundUno"),n.dom.user.avatar.addClass("uno")):n.dom.user.avatar.removeClass("uno"))}},{key:"setUserCardsCount",value:function(t,n,r){n.dom.user.count.text(n.dom.cards.children().length),r||e.checkPlayerUno(t,n,r)}},{key:"cardPlayed",value:function(t,n){n&&(t.unoGame.currentTurn=n.currentTurn,t.unoGame.currentCard=n.currentCard,e.activateShowUnoButton(t),"wild"!=t.unoGame.currentCard.type&&(delete t.unoGame.selectedColor,e.removeSelectedCardColor()),n.user==t.getState().mUser.id?(t.unoGame.cards=t.unoGame.cards.filter((function(e){return e.id!=n.currentCard.id})),n.action&&n.action.name&&(e.playSound(t,"soundDrawCard"),window.youcamUnoContainer.find("#youcam-uno-scene .card").removeClass("youcam-uno-action").removeClass("blue").removeClass("red").removeClass("yellow").removeClass("green"),window.youcamUnoContainer.find("#youcam-uno-scene .card:last-child").addClass("youcam-uno-action"),"wild"!=n.action.name&&"wilddraw4"!=n.action.name||window.youcamUnoContainer.find("#youcam-uno-scene .card:last-child").addClass(n.action.color))):e.moveCardFromPlayer(t,n.currentCard,n.user),n.action&&n.action.name?(e.setCurrentTurnGlow(t,n.action.victim),"reverse"==n.action.name?e.playCardActionAnimtion(t,e.onCardActionReverse.bind(null,t,n.action.dir)):"skip"==n.action.name?e.playCardActionAnimtion(t,e.onCardActionSkip.bind(null,t)):"draw2"==n.action.name?e.playCardActionAnimtion(t,e.onCardActionDraw2.bind(null,t,n.action)):"wild"==n.action.name?e.playCardActionAnimtion(t,e.onCardActionWild.bind(null,t,n.action.color)):"wilddraw4"==n.action.name&&e.playCardActionAnimtion(t,e.onCardActionWildDraw4.bind(null,t,n.action))):e.setCurrentTurnGlow(t),e.checkForDrawingCardNecessity(t))}},{key:"onCardActionReverse",value:function(t,n){e.setCurrentTurnGlow(t),e.setDirection(t,n)}},{key:"onCardActionSkip",value:function(t){e.setCurrentTurnGlow(t)}},{key:"onCardActionDraw2",value:function(t,n){e.setCurrentTurnGlow(t),n&&n.cards&&e.drawPlayerCards(t,n.cards,t.unoGame.currentTurn)}},{key:"onCardActionWildDraw4",value:function(t,n){e.setCurrentTurnGlow(t),n&&n.cards&&(e.setSelectedCardColor(t,n.color),e.drawPlayerCards(t,n.cards,t.unoGame.currentTurn))}},{key:"onCardActionWild",value:function(t,n){e.setCurrentTurnGlow(t),e.setSelectedCardColor(t,n)}},{key:"setSelectedCardColor",value:function(e,t){!t||["red","blue","yellow","green"].indexOf(t)<0||(e.unoGame.selectedColor=t,window.youcamUnoContainer.find("#youcam-uno-scene .cards .card:last-child").addClass(t))}},{key:"removeSelectedCardColor",value:function(){window.youcamUnoContainer.find("#youcam-uno-scene .cards .card").attr("class","card")}},{key:"checkForDrawingCardNecessity",value:function(t){!e.getPlayableCards(t).length&&e.isMyTurn(t)&&(e.autoSendCardDrawRequest()?setTimeout((function(){e.requestCardDraw(t)}),3e3):(t.unoGame.drawCards=!0,e.cardsBoxSetClickable()))}},{key:"animatedDrawedCardsCount",value:function(t,n,r){if(!(!r||document.hidden||e.isMinimized(t)||!n||n<2)){var o=document.createElement("span");o.innerText="+"+n,o.className="draw-cards-count",setTimeout((function(){o.remove()}),1e3),r.find(".user").append(o),setTimeout((function(){o.style.fontSize="8rem"}),50)}}},{key:"cardsBoxSetClickable",value:function(){window.youcamUnoContainer.find("#youcam-uno-bottom .arrow-down").addClass("active")}},{key:"cardsBoxSetUnclickable",value:function(){window.youcamUnoContainer.find("#youcam-uno-bottom .arrow-down").removeClass("active")}},{key:"drawPlayerCards",value:function(t,n,r){var o=0,i=t.unoGame.players.find((function(e){return e.id==r}));if(i){if("number"==typeof n)for(var a=0;a<n;a++){var s=e.addCardToPlayer(t,i,r,n==a+1,n);o+=100*s}else if(Array.isArray(n)){var c=e.getPlayerCardTimeout("bottom");n.forEach((function(r,a){t.unoGame.cards.push(r),setTimeout((function(){e.addCardToBottomPlayer(t,i,r,c,n.length==a+1,n.length)}),o),o+=100*c}))}return o}}},{key:"activateShowUnoButton",value:function(t){e.isMinimized(t)&&(t.unoGame.currentTurn==t.getState().mUser.id?(window.youcamUnoContainer.find("#show-uno").addClass("active"),e.playSound(t,"soundPlayAgain")):window.youcamUnoContainer.find("#show-uno").removeClass("active"))}},{key:"cardsDrawed",value:function(t,n){if(n&&n.cards){var r=t.unoGame.currentTurn;t.unoGame.currentTurn=n.currentTurn,e.setCurrentTurnGlow(t),e.activateShowUnoButton(t);var o=e.drawPlayerCards(t,n.cards,r);setTimeout((function(){e.checkForDrawingCardNecessity(t)}),o)}}},{key:"canPlayCardActionSound",value:function(e){return!(!e||!e.action||["skip","draw2","wilddraw4"].indexOf(e.action)<0)}},{key:"playCardActionAnimtion",value:function(t,n){t.unoGame.currentCard&&(e.canPlayCardActionSound(t.unoGame.currentCard)&&e.playSound(t,"soundPlusCard"),n&&"function"==typeof n&&n())}},{key:"moveCardIfDocumentHidden",value:function(t,n,r){r.dom.cards.find(".card:first-child").remove(),t.unoGame.dom.scene.find(".card").removeClass("youcam-uno-action").removeClass("blue").removeClass("red").removeClass("yellow").removeClass("green");var o="";n&&null!=n.action&&(o="youcam-uno-action"),e.setUserCardsCount(t,r,!1);var i=Math.floor(360*Math.random());t.unoGame.dom.scene.find(".cards")[0].insertAdjacentHTML("beforeend","<img data-id='"+n.id+"' style='transform: rotate("+(90+i)+"deg);' src='images/"+e.getCardName(n)+".png' class='card "+o+"'>")}},{key:"moveCardFromPlayer",value:function(t,n,o){var i=t.unoGame.players.find((function(e){return e.id==o}));if(i){if(document.hidden||e.isMinimized(t))return e.moveCardIfDocumentHidden(t,n,i);var a=i.dom.cards.children().length,s=Math.floor(Math.random()*a),c=i.dom.cards.children().eq(s)[0];if(c){var u=c.getBoundingClientRect(),d=Object(r.m)(c),l=c.style.transform;c.style.transform="translate("+d.left+"px, "+d.top+"px) "+l,c.style.position="absolute",c.style.width=u.height+"px","left"==i.position?c.style.margin="0":c.style.marginBottom="0",window.youcamUnoContainer[0].appendChild(c);var f=i.dom.container[0].getBoundingClientRect(),p=t.unoGame.dom.middle[0].getBoundingClientRect(),m=0,h=0;"right"==i.position||"left"==i.position?(m=p.width/2,h=f.height+p.height/2-1.5*u.height):"top"==i.position&&(m=p.width/2-u.width/2,h=f.height+p.height/2-u.height/2),c.style.transition="all .5s ease-in-out",c.style.transform="translate("+m+"px, "+h+"px)",e.playSound(t,"soundDrawCard"),t.unoGame.dom.cards.find(".card").removeClass("youcam-uno-action").removeClass("blue").removeClass("red").removeClass("yellow").removeClass("green");var _="";n&&null!=n.action&&(_="youcam-uno-action","wild"!=n.action&&"wilddraw4"!=n.action||(_=_+" "+n.color)),setTimeout((function(){c.remove();var r=Math.floor(360*Math.random());t.unoGame.dom.cards[0].insertAdjacentHTML("beforeend","<img data-id='"+n.id+"' style='transform: rotate("+(90+r)+"deg);' src='images/"+e.getCardName(n)+".png' class='card "+_+"'>"),e.setUserCardsCount(t,i,!1)}),500)}}}},{key:"setDirection",value:function(e,t){"rtl"==t?e.unoGame.dom.scene.find("#youcam-uno-scene-arrow").addClass("rtl"):e.unoGame.dom.scene.find("#youcam-uno-scene-arrow").removeClass("rtl")}},{key:"renderPlayerHTML",value:function(e,t,n,r){if(!t)return"";var o=t.isBot?"/images/bot2.png":t.avatar,i=r?"<img width='80' class='mic' src='/images/stop-mic.png' alt='' />":"",a="<div id='"+e+"'>";return a+="<div class='user "+(t.isBot?"bot":"")+"' data-position='"+n+"' data-id='"+t.id+"'>",a+="<p class='name'>"+t.name+"</p>",a+="<span class='avatar'><span class='count'>0</span><img class='avatar-img' width='80' src='"+o+"' alt='' /><img width='80' class='uno' src='/images/uno.png' alt='' />"+i+"</span>",a+="</div>",a+="<div class='cards'></div>",a+="</div>"}},{key:"renderTopPlayer",value:function(t,n){var r=null;if(2==n.length)r=n.find((function(e){return e.id!=t.getState().mUser.id})).id;else{var o=null,i=n.find((function(e){return e.id==t.getState().mUser.id})).turnIndex+2,a=n.length-i;if(!(o=a<0?n.find((function(e){return e.turnIndex==Math.abs(a)})):n.find((function(e){return e.turnIndex==i}))))return"";r=o.id}var s=n.find((function(e){return e.id==r}));if(!s)return"";if(s.isBot)return e.renderPlayerHTML("youcam-uno-top",s,"top",!1);var c=t.getState().users.find((function(e){return e.id==r}));return e.renderPlayerHTML("youcam-uno-top",c,"top",!0)}},{key:"renderLeftPlayer",value:function(t,n){if(n.length<3)return"";var r=n.find((function(e){return e.id==t.getState().mUser.id})).turnIndex,o=null,i=r+1,a=n.length-i;if(!(o=a<0?n.find((function(e){return e.turnIndex==Math.abs(a)})):n.find((function(e){return e.turnIndex==i}))))return"";if(o.isBot)return e.renderPlayerHTML("youcam-uno-left",o,"left",!1);var s=t.getState().users.find((function(e){return e.id==o.id}));return e.renderPlayerHTML("youcam-uno-left",s,"left",!0)}},{key:"renderRightPlayer",value:function(t,n){if(4!=n.length)return"";var r=n.find((function(e){return e.id==t.getState().mUser.id})).turnIndex,o=null,i=r+3,a=n.length-i;if(!(o=a<0?n.find((function(e){return e.turnIndex==Math.abs(a)})):n.find((function(e){return e.turnIndex==i}))))return"";if(o.isBot)return e.renderPlayerHTML("youcam-uno-right",o,"right",!1);var s=t.getState().users.find((function(e){return e.id==o.id}));return e.renderPlayerHTML("youcam-uno-right",s,"right",!0)}},{key:"setCurrentTurnGlow",value:function(e,t){var n=t||e.unoGame.currentTurn;e.unoGame.players.forEach((function(e){e.id==n?e.dom.user.avatar.addClass("glow"):e.dom.user.avatar.removeClass("glow")}))}},{key:"getPlayerCardTimeout",value:function(e){return 2}},{key:"distributeCards",value:function(t,n,r,o){var i=0;r.forEach((function(o,a){n.forEach((function(n){var s=r.length==a+1,c=2;setTimeout((function(){n.id==t.getState().mUser.id?(c=e.getPlayerCardTimeout("bottom"),e.addCardToBottomPlayer(t,n,o,c,s)):c=e.addCardToPlayer(t,n,n.id,s)}),i),i+=100*c}))})),setTimeout((function(){o()}),i+500)}},{key:"getPlayerPosition",value:function(e){return window.youcamUnoContainer.find(".user[data-id='"+e+"']").data("position")}},{key:"addCardToPlayer",value:function(t,n,r,o,i){n||(n=t.unoGame.players.find((function(e){return e.id==r})));var a=e.getPlayerCardTimeout(n.position);return"top"==n.position?e.addCardToTopPlayer(t,n,o,a,i):"left"==n.position?e.addCardToLeftPlayer(t,n,o,a,i):"right"==n.position&&e.addCardToRightPlayer(t,n,o,a,i),a}},{key:"playSound",value:function(t,n){if(!e.isMinimized(t)||"soundPlayAgain"==n)try{t[n].muted=!1,t[n].play()}catch(e){}}},{key:"addCardToBottomPlayer",value:function(t,n,r,o,i,a){if(document.hidden||e.isMinimized(t))return e.insertCardForPlayer(t,n,r,i,a);e.playSound(t,"soundDrawCard");var s=e.createCard(),c=s.getBoundingClientRect(),u=n.dom.container[0].getBoundingClientRect(),d=u.width/2-2*c.width,l=u.height-2*c.height;s.style.transition="all ."+o+"s ease-in-out",s.style.transform="translate("+Math.abs(d)+"px, -"+Math.abs(l)+"px)",e.animatedDrawedCardsCount(t,a,n.dom.container),setTimeout((function(){s.remove(),e.insertCardForPlayer(t,n,r,i,a)}),100*o)}},{key:"addCardToTopPlayer",value:function(t,n,r,o,i){if(document.hidden||e.isMinimized(t))return e.insertCardForPlayer(t,n,null,r,i);e.playSound(t,"soundDrawCard");var a=e.createCard(),s=a.getBoundingClientRect(),c=document.body.getBoundingClientRect(),u=n.dom.container[0].getBoundingClientRect(),d=u.width/2-2*s.width,l=c.height-u.height/2-s.height;a.style.transition="all ."+o+"s ease-in-out",a.style.transform="translate("+Math.abs(d)+"px, -"+Math.abs(l)+"px)",e.animatedDrawedCardsCount(t,i,n.dom.container),setTimeout((function(){a.remove(),e.insertCardForPlayer(t,n,null,r,i)}),100*o)}},{key:"addCardToLeftPlayer",value:function(t,n,r,o,i){if(document.hidden||e.isMinimized(t))return e.insertCardForPlayer(t,n,null,r,i);e.playSound(t,"soundDrawCard");var a=e.createCard(),s=a.getBoundingClientRect(),c=t.unoGame.dom.bottom[0].getBoundingClientRect(),u=n.dom.cards[0].getBoundingClientRect(),d=c.height+u.height/2-s.height;a.style.transition="all ."+o+"s ease-in-out",a.style.transform="translate(0px, -"+d+"px)",e.animatedDrawedCardsCount(t,i,n.dom.container),setTimeout((function(){a.remove(),e.insertCardForPlayer(t,n,null,r,i)}),100*o)}},{key:"addCardToRightPlayer",value:function(t,n,r,o,i){if(document.hidden||e.isMinimized(t))return e.insertCardForPlayer(t,n,null,r,i);e.playSound(t,"soundDrawCard");var a=e.createCard(),s=a.getBoundingClientRect(),c=n.dom.container[0].getBoundingClientRect(),u=document.body.getBoundingClientRect(),d=n.dom.cards[0].getBoundingClientRect(),l=u.width-d.width/2-s.width,f=c.height+d.height/2-s.height;a.style.transition="all ."+o+"s ease-in-out",a.style.transform="translate("+l+"px, -"+f+"px)",e.animatedDrawedCardsCount(t,i,n.dom.container),setTimeout((function(){a.remove(),e.insertCardForPlayer(t,n,null,r,i)}),100*o)}},{key:"addCardToScene",value:function(t,n){if(document.hidden||e.isMinimized(t))return e.insertCardForScene(t,n);e.playSound(t,"soundDrawCard");var r=e.createCard(),o=r.getBoundingClientRect(),i=t.unoGame.dom.scene[0].getBoundingClientRect(),a=t.unoGame.dom.bottom[0].getBoundingClientRect(),s=a.width/2-3*o.width,c=a.height+i.height/2;r.style.transition="all .5s ease-in-out",r.style.transform="translate("+s+"px, -"+c+"px)",setTimeout((function(){r.remove(),e.insertCardForScene(t,n)}),500)}},{key:"insertCardForPlayer",value:function(t,n,r,o,i){var a=document.createElement("img");if(a.className="card","bottom"==n.position){a.dataset.id=r.id,a.src="images/"+e.getCardName(r)+".png",a.style="margin-top: 0px; transform: rotate(0deg); user-drag: auto; -webkit-user-drag: auto",a.addEventListener("dragstart",(function(e){return e.dataTransfer.setData("id",e.target.dataset.id)})),a.addEventListener("touchstart",(function(n){return e.touchStart(t,n)})),a.addEventListener("touchmove",(function(n){return e.touchMove(t,n)})),a.addEventListener("touchend",(function(n){return e.touchEnd(t,n)}));var s=Math.floor(n.dom.cards[0].children.length/2),c=n.dom.cards[0].children[s];n.dom.cards[0].insertBefore(a,c)}else{var u="top"==n.position?0:90;a.style="transform: rotate("+u+"deg)",a.src="images/back.png",n.dom.cards[0].insertAdjacentElement("beforeend",a)}o&&e.repositionPlayerCards(n),e.setUserCardsCount(t,n,null==i)}},{key:"insertCardForScene",value:function(t,n){var r=document.createElement("img");r.src="images/"+e.getCardName(n)+".png",r.className="card",t.unoGame.dom.scene.find(".cards")[0].insertAdjacentElement("beforeend",r)}},{key:"createCard",value:function(){var e=document.createElement("img");return e.id="card-box-item-"+Date.now()+Math.floor(1e7*Math.random()),e.src="/images/back.png",e.className="cards-box-item",document.body.insertAdjacentElement("beforeend",e),e}},{key:"repositionPlayerCards",value:function(t){t&&t.dom.cards.children().each((function(n,r){var o=e.calculateRotationAndMargin(t.dom.cards.children().length,n);r.style[t.cardMarginSide]=o.margin+"px",r.style.transform="rotate("+(t.rotation+o.rotation)+"deg)"}))}},{key:"calculateRotationAndMargin",value:function(e,t){var n=2*(t-Object(r.n)(e));return{rotation:n,margin:3*Math.abs(n)}}},{key:"onCountDownImageTransitionEnd",value:function(t,n,r){n&&n.remove(),window.countDownCurrentImage--,window.countDownCurrentImage>0?e.createCountDownImage(t,r):(delete window.countDownCurrentImage,r())}},{key:"startCountDown",value:function(t,n){if((document.hidden||e.isMinimized(t))&&"function"==typeof n)return n();window.countDownCurrentImage=5,e.createCountDownImage(t,n)}},{key:"createCountDownImage",value:function(t,n){var r=document.body.getBoundingClientRect(),o=document.createElement("img");o.src="/images/"+window.countDownCurrentImage+".png",o.style.width="100px",o.style.height="100px",o.style.position="absolute",o.style.left=r.width/2-50+"px",o.style.top=r.height/2-50+"px",o.style.transitionDuration="1s",o.style.transitionTimingFunction="ease-in-out",o.style.transitionProperty="opacity, transform",setTimeout((function(){e.onCountDownImageTransitionEnd(t,o,n)}),1e3),window.youcamUnoContainer.append(o),setTimeout((function(){e.playSound(t,"soundPlayAgain"),o.style.opacity=0,o.style.transform="scale(10)"}),50)}},{key:"onSceneDragOver",value:function(e){e.unoGame.dom.scene[0].addEventListener("dragover",(function(e){e.preventDefault()}))}},{key:"onCardDrop",value:function(t){t.unoGame.dom.scene[0].addEventListener("drop",(function(n){n.preventDefault(),e.cardDrop(t,n.dataTransfer.getData("id"))}))}},{key:"cardDrop",value:function(t,n){if(!e.isMyTurn(t))return!1;var r=e.isValidPlay(t,n);if(!r)return!1;var o=t.unoGame.players.find((function(e){return e.id==t.getState().mUser.id})),i=Math.floor(360*Math.random()),a=o.dom.cards.find(".card[data-id='"+n+"']")[0];a.style.transform="rotate("+i+"deg)",t.unoGame.dom.scene.find(".cards")[0].appendChild(a),e.setUserCardsCount(t,o,!1),e.repositionPlayerCards(o),delete t.unoGame.selectedColor,e.playSound(t,"soundDrawCard"),"wild"==r.type?e.showColorSelector(t,r,e.playCard.bind(null,t,r.id)):e.playCard(t,r.id)}},{key:"isMyTurn",value:function(e){return e.unoGame.currentTurn==e.getState().mUser.id}},{key:"isValidPlay",value:function(t,n){return e.getPlayableCards(t).find((function(e){return e.id==n}))}},{key:"playCard",value:function(e,t){var n={card:t};e.unoGame.selectedColor&&(n.color=e.unoGame.selectedColor),e.getState().socket.emit("req",Object(r.k)({type:"YOUCAM_UNO_CARD_PLAYED",data:n}),(function(e){}))}},{key:"getPlayableCards",value:function(e){var t=[];return e.unoGame.currentCard?(e.unoGame.cards.forEach((function(n){("wild"===n.type||e.unoGame.currentCard.color&&n.color===e.unoGame.currentCard.color||e.unoGame.currentCard.value&&n.value===e.unoGame.currentCard.value||"wild"==e.unoGame.currentCard.type&&e.unoGame.selectedColor&&e.unoGame.selectedColor==n.color)&&t.push(n)})),t):[]}},{key:"getCardName",value:function(e){return e&&e.type?"number"==e.type?e.color+e.value:"action"==e.type?e.color+e.action:"wild"==e.type?e.action:"":""}},{key:"showColorSelector",value:function(t,n,r){n&&"wild"==n.type&&(window.youcamUnoContainer.find("#youcam-uno").append("<div id='youcam-uno-color-selector'><div><span class='red'></span><span class='blue'></span></div><div><span class='yellow'></span><span class='green'></span></div></div>"),window.youcamUnoContainer.find("#youcam-uno #youcam-uno-color-selector span").unbind("click").on("click",(function(n){t.unoGame.selectedColor=$(this)[0].className,e.playSound(t,"soundColorButton"),$(this).closest("#youcam-uno-color-selector").remove(),r&&"function"==typeof r&&r()})))}},{key:"touchStart",value:function(e,t){var n=t.touches[0];t.target.touchStartX=n.clientX,t.target.touchStartY=n.clientY}},{key:"touchMove",value:function(e,t){var n=t.touches[0],r=n.clientX-(t.target.offsetLeft+t.target.clientWidth/2),o=n.clientY-(t.target.offsetTop+t.target.clientHeight/2);t.target.style.transition="none",t.target.style.position="fixed",t.target.style.transform="translate("+r+"px, "+o+"px)"}},{key:"touchEnd",value:function(t,n){var o=Object(r.m)(n.target);e.isDragOverScene(t,o.left,o.top)?(n.target.style.position="absolute",!1===e.cardDrop(t,n.target.dataset.id)&&(n.target.style.transform="translate(0, 0)",n.target.style.position="relative")):(n.target.style.transform="translate(0, 0)",n.target.style.position="relative")}},{key:"isDragOverScene",value:function(e,t,n){var r=e.unoGame.dom.scene[0].getBoundingClientRect(),o=t>r.x&&t<r.left+r.width,i=n>r.y&&n<r.top+r.height/2;return o&&i}},{key:"registerExitDialogEvents",value:function(t){e.onExitConfirmed(t),e.onExitCancelled(t)}},{key:"onExitConfirmed",value:function(t){window.youcamUnoContainer.find("#youcam-uno-exit-dialog #dialog-box-buttons button.confirm").unbind("click").on("click",(function(n){e.closeGame(t)}))}},{key:"onExitCancelled",value:function(e){window.youcamUnoContainer.find("#youcam-uno-exit-dialog #dialog-box-buttons button.cancel").unbind("click").on("click",(function(e){window.youcamUnoContainer.find("#youcam-uno-exit-dialog #dialog-box-buttons button").unbind("click"),window.youcamUnoContainer.find("#youcam-uno-exit-dialog").remove()}))}},{key:"showExitDialog",value:function(t){window.youcamUnoContainer.find("#youcam-uno").append("<div id='youcam-uno-exit-dialog'><div id='dialog-box'><div id='dialog-box-content'><p>هل تود فعلا الخروج من اللعبة؟</p></div><div id='dialog-box-buttons'><button type='button' class='confirm'>تأكيد</button><button type='button' class='cancel'>إلغاء</button></div></div></div>"),e.registerExitDialogEvents(t)}},{key:"closeGame",value:function(e){e.getState().socket.emit("req",Object(r.k)({type:"YOUCAM_UNO_EXIT_GAME",data:{}}),(function(e){})),window.youcamUnoContainer.find("#youcam-uno").remove();var t=e.unoGame.players.find((function(t){return t.id==e.getState().mUser.id}));t&&(a.a.removeUnoUserFromMic(e,e.getState().mUser,t.turnIndex),delete e.unoGame,e.getState().mUser.isPlaying=!1,a.a.setMics(e))}},{key:"onPlayerOut",value:function(e,t,n){if(t&&n&&e.unoGame){var r=e.getState().users.find((function(e){return e.id==t}));if(r){var o=e.unoGame.players.find((function(e){return e.id==r.id}));if(o){a.a.removeUnoUserFromMic(e,r,o.turnIndex),o.isBot=!0,o.name=n;var i=o.dom.container.find(".user").addClass("bot");i.find(".name").text(o.name),i.find(".avatar .avatar-img").attr("src","/images/bot2.png"),i.find(".avatar .mic").remove()}}}}},{key:"initPlayerDom",value:function(t){if(t){t.position=e.getPlayerPosition(t.id);var n=window.youcamUnoContainer.find("#youcam-uno-"+t.position);e.setPlayerCardsRotation(t),e.setPlayerCardsMarginSide(t),t.dom={container:n,cards:n.find(".cards"),user:{count:n.find(".user .count"),avatar:n.find(".user .avatar")}}}}},{key:"setPlayerCardsMarginSide",value:function(t){t&&e.isValidPosition(t.position)&&("top"==t.position?t.cardMarginSide="marginBottom":"left"==t.position?t.cardMarginSide="marginRight":"right"==t.position?t.cardMarginSide="marginLeft":t.cardMarginSide="marginTop")}},{key:"setPlayerCardsRotation",value:function(t){t&&e.isValidPosition(t.position)&&("top"==t.position||"bottom"==t.position?t.rotation=0:t.rotation=90)}},{key:"isValidPosition",value:function(e){return["right","left","top","bottom"].indexOf(e)>=0}},{key:"initDom",value:function(t){if(t.unoGame){var n=window.youcamUnoContainer.find("#youcam-uno-bottom"),r=window.youcamUnoContainer.find("#youcam-uno-scene");t.unoGame.dom={middle:window.youcamUnoContainer.find("#youcam-uno-middle"),scene:r,bottom:n,cards:r.find(".cards"),cardsBox:n.find(".cards-box"),arrowDown:n.find(".arrow-down")},t.unoGame.players.forEach((function(t){e.initPlayerDom(t)}))}}},{key:"celeberateWin",value:function(e){if(e.unoGame){var t={confettiColors:["#ff0a54","#ff477e","#ff7096","#ff85a1","#fbb1bd","#f9bec7"],emojis:["⚡️","💥","✨","💫","🌸"]};if(playAnimation=function(){var e=new JSConfetti;e.addConfetti().then((function(t){return e.destroyCanvas()})),setTimeout((function(){e.addConfetti(t).then((function(t){return e.destroyCanvas()}))}),500),setTimeout((function(){e.addConfetti().then((function(t){return e.destroyCanvas()}))}),1e3)},"undefined"!=typeof JSConfetti)playAnimation();else{var n=document.createElement("script");n.setAttribute("src","https://cdn.jsdelivr.net/npm/js-confetti@latest/dist/js-confetti.browser.js"),document.getElementsByTagName("head")[0].appendChild(n),n.onload=function(){playAnimation()}}}}},{key:"render",value:function(t,n){t.getState().mUser.isPlaying=!0,t.unoGame={isMinimized:!1,currentTurn:n.currentTurn,currentCard:n.currentCard,players:n.players,cards:n.cards};var r=n.players.filter((function(e){return!e.isBot})),a="<div id='youcam-uno'>";a+="<div id='youcam-uno-bg'></div>",a+=e.renderTopPlayer(t,n.players),a+="<div id='youcam-uno-middle'>",a+=e.renderLeftPlayer(t,n.players),a+="<div id='youcam-uno-scene'>",a+="<div id='youcam-uno-scene-arrow' class='rotating'></div>",a+="<div class='cards'></div>",a+="</div>",a+=e.renderRightPlayer(t,n.players),a+="</div>",a+="<div id='youcam-uno-bottom'>",a+="<div class='cards'></div>",a+="<div class='bottom-footer'>",a+="<img class='cards-box' src='/images/uno-box.png' />",a+="<img class='arrow-down' src='/images/arrow-down.png' />",a+="<div class='user' data-position='bottom' data-id='"+t.getState().mUser.id+"'>",a+="<span class='avatar'>",a+="<span class='count'>0</span>",a+="<img class='avatar-img' width='80' src='"+t.getState().mUser.avatar+"' alt='' />",a+="<img width='80' class='uno' src='/images/uno.png' alt='' />",r.length>1&&(a+="<img width='80' class='mic' src='/images/stop-mic.png' alt='' />"),a+="</span>",a+="<p class='name'>"+t.getState().mUser.name+"</p>",a+="</div>",a+="<img class='uno-btn' src='/images/uno!.png' />",a+="</div>",a+="</div>",a+="<button id='youcam-uno-home'></button>",a+="<button id='youcam-uno-exit'></button>",a+="</div>",window.youcamUnoContainer.html(a),e.initDom(t),t.dispatch(Object(o.a)(null)),i.a.togglePane(t,!0),e.registerEvents(t),e.startCountDown(t,(function(){e.distributeCards(t,n.players,n.cards,(function(){e.setCurrentTurnGlow(t),e.addCardToScene(t,n.currentCard),e.checkForDrawingCardNecessity(t)}))}))}}],(n=null)&&s(t.prototype,n),c&&s(t,c),e}();t.a=c},function(e,t,n){e.exports=n(143)},function(e,t,n){"use strict";var r=n(82),o=n(144),i=Object.prototype.toString;function a(e){return"[object Array]"===i.call(e)}function s(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===i.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),a(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:a,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:o,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:s,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:c,isStream:function(e){return s(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:u,merge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]=n}for(var r=0,o=arguments.length;r<o;r++)u(arguments[r],n);return t},extend:function(e,t,n){return u(t,(function(t,o){e[o]=n&&"function"==typeof t?r(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t,n){"use strict";var r=n(7),o=n(1);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,a=[{key:"registerEvents",value:function(t){e.hideAllPanes(t)}},{key:"hideAllPanes",value:function(e){window.publicMessagesContainer&&window.publicMessagesContainer.on("click",(function(t){e.dispatch(Object(r.a)(null)),o.a.togglePane(e,!0,t)}))}},{key:"scrollToBottom",value:function(){window.publicMessagesContainer&&window.publicMessagesContainer.scrollTop(window.publicMessagesContainer[0].scrollHeight)}},{key:"clear",value:function(e){window.publicMessagesContainer.find(".public_message").remove()}},{key:"render",value:function(){return"<div id='chat__body__messages_container'></div>"}}],(n=null)&&i(t.prototype,n),a&&i(t,a),e}();t.a=a},function(e,t,n){"use strict";var r=n(0),o=n(16),i=n(5),a=n(38),s=n(58),c=n(41);function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,d;return t=e,d=[{key:"registerEvents",value:function(t){e.onClick(t),e.onClose(t),e.onRemove(t),e.onAnimationEnded(t),e.onMediaMetaDataLoaded(t)}},{key:"getMediaDuration",value:function(e){return"photo"==e?7:20}},{key:"onClick",value:function(t){window.storyModal.unbind("click").on("click",(function(n){if(!$(this).closest("#story-comments").length){var r=window.storyModal.width()/3;n.clientX<=r?e.onLeftClick(t):n.clientX>=2*r?e.onRightClick(t):window.storyModal.find(".story-viewer").hasClass("paused")?e.unpause(t):e.pause(t)}}))}},{key:"onLeftClick",value:function(t){window.storyModal.find(".story-viewer").toggleClass("paused",!1);var n=window.storyModal.find(".slides-pointers span.active");if(n&&n.length){var r=parseInt(n[0].dataset.index),o=n.find("b")[0].getAnimations()[0];if(o){if(n.removeClass("seen"),o.currentTime<1e3&&r>0)return o.cancel(),e.goToPreviousSlide(t,r);o.cancel(),e.restartCurrentSlide(o,r)}}}},{key:"onRightClick",value:function(t){window.storyModal.find(".story-viewer").toggleClass("paused",!1);var n=window.storyModal.find(".slides-pointers span.active");if(n&&n.length){var r=parseInt(n[0].dataset.index),o=n.find("b")[0].getAnimations()[0];if(o)return o.cancel(),e.goToNextSlide(t,r)}}},{key:"stopSlide",value:function(e,t,n){if(!(t<0)){var r=window.storyModal.find(".slides-pointers span[data-index='"+t+"']");if(r&&r.length){r.removeClass("active"),n?r.addClass("seen"):r.removeClass("seen");var o=window.storyModal.find(".slides .item[data-index='"+t+"']");o.addClass("seen").removeClass("active"),"audio"!=o[0].dataset.type&&"video"!=o[0].dataset.type||(o.find(o[0].dataset.type)[0].pause(),o.find(o[0].dataset.type)[0].currentTime=0)}}}},{key:"playSlide",value:function(t,n){if(!(n<0)){var o=window.storyModal.find(".slides-pointers span[data-index='"+n+"']");if(!o||!o.length)return e.close(t);o.addClass("active").removeClass("seen");var i=window.storyModal.find(".slides .item[data-index='"+n+"']");if(i&&i.length){i.addClass("active").removeClass("seen");var a=i.find(".story-reactions");a.find(".likes_wrapper .fa").toggleClass("liked",t.getState().likedStories.indexOf(a.data("id"))>=0),c.a.viewStory(t,a.data("id")),"audio"!=i[0].dataset.type&&"video"!=i[0].dataset.type||(i.find(i[0].dataset.type)[0].muted=!1,i.find(i[0].dataset.type)[0].play())}window.storyModal.find(".time").text(Object(r.y)(new Date(i[0].dataset.created).getTime()))}}},{key:"goToNextSlide",value:function(t,n){e.stopSlide(t,n,!0),e.playSlide(t,n+1)}},{key:"goToPreviousSlide",value:function(t,n){e.stopSlide(t,n,!1),e.playSlide(t,n-1)}},{key:"restartCurrentSlide",value:function(e,t){e.play();var n=window.storyModal.find(".slides .item[data-index='"+t+"']");n&&n.length&&("audio"!=n[0].dataset.type&&"video"!=n[0].dataset.type||(n.find(n[0].dataset.type)[0].currentTime=0))}},{key:"onAnimationEnded",value:function(t){window.storyModal.find(".slides-pointers b").unbind("animationend").on("animationend",(function(n){if(n.target&&n.target.parentElement){var r=parseInt(n.target.parentElement.dataset.index);if(isNaN(r))return e.close(t);e.stopSlide(t,r,!0),e.playSlide(t,r+1)}}))}},{key:"onMediaMetaDataLoaded",value:function(e){window.storyModal.find(".slides audio, .slides video").unbind("loadedmetadata").on("loadedmetadata",(function(e){e.target.dataset.duration=e.target.duration,e.target.duration>180?window.storyModal.find(".slides-pointers span[data-id='"+e.target.dataset.id+"'] b").css("animation-duration","180s"):window.storyModal.find(".slides-pointers span[data-id='"+e.target.dataset.id+"'] b").css("animation-duration",e.target.duration+"s")}))}},{key:"playFirstSlideSound",value:function(e){var t=window.storyModal.find(".slides .item[data-index='0']");t&&t.length&&("audio"==t[0].dataset.type||"video"==t[0].dataset.type)&&(t.find(t[0].dataset.type)[0].muted=!1,t.find(t[0].dataset.type)[0].play()),window.storyModal.find(".time").text(Object(r.y)(new Date(t[0].dataset.created).getTime()))}},{key:"close",value:function(e){window.storyModal.addClass("closed"),setTimeout((function(){window.storyModal.remove()}),500)}},{key:"onClose",value:function(t){window.storyModal.find(".back, .close").unbind("click").on("click",(function(n){n.stopPropagation(),e.close(t)}))}},{key:"onRemove",value:function(e){window.storyModal.find(".remove").unbind("click").on("click",(function(t){if(t.stopPropagation(),confirm("هل أنت متأكد من حذف الستوري؟")){var n=window.storyModal.find(".slides-pointers span.active");n&&n.length&&e.getState().socket.emit("req",Object(r.k)({type:"story:remove",data:{id:n[0].dataset.id}}),(function(t){if("string"==typeof t)return alert(t);0==t.error&&o.a.onRemoveStory(e,t.id)}))}}))}},{key:"onRemoveStory",value:function(t,n){if(t.getState().stories.find((function(e){return e.id==n}))&&window.storyModal){var r=window.storyModal.find(".slides-pointers span[data-id='"+n+"']");if(r&&r.length&&r.hasClass("active"))return e.close(t);r.remove(),window.storyModal.find(".slides .item[data-id='"+n+"']").remove()}}},{key:"pause",value:function(e){window.storyModal.find(".story-viewer").addClass("paused");var t=null;return(t=window.storyModal.find(".slides .item.active video"))[0]||(t=window.storyModal.find(".slides .item.active audio"))[0]?t[0].pause():void 0}},{key:"unpause",value:function(e){window.storyModal.find(".story-viewer").removeClass("paused");var t=null;return(t=window.storyModal.find(".slides .item.active video"))[0]||(t=window.storyModal.find(".slides .item.active audio"))[0]?t[0].play():void 0}},{key:"goToStory",value:function(t,n,r){if(!n){e.render(t,t.getState().mUser.reg_id);var i=t.getState().stories.length;if(!i)return console.log("storiesLength",i);n=t.getState().stories[i-1].id}o.a.getCurrentUserStoryBoardItem(t)&&(e.render(t,t.getState().mUser.reg_id),window.storyModal&&(window.storyModal.find(".slides .item").each((function(e,t){t.dataset.id==n?("video"==t.dataset.type&&$(t).find("video")[0].play(),"audio"==t.dataset.type&&$(t).find("audio")[0].play(),t.classList.add("active")):t.classList.remove("active")})),window.storyModal.find(".slides-pointers .wrap span").each((function(e,t){if(t.dataset.id==n)return t.classList.add("active");t.classList.remove("active")})),"comments"==r?(e.pause(t),a.a.render(t,n)):"views"==r&&(e.pause(t),c.a.render(t,n))))}},{key:"render",value:function(t,n){window.storyModal&&window.storyModal.remove();var r=t.getState().stories.filter((function(e){return e.user_id==n}));if(r&&r.length){var o=t.getState().users.find((function(e){return e.reg_id==n}));o||(o=r[0].user);var a='<div id="story-modal" class="with-cube with-effects" tabindex="1" style="display: none; margin-left: 168px; margin-top: 217px;">';a+='<div id="story-modal-content" style="transform: scale(0.95);">',a+='<div id="story-modal-slider-stories" class="slider">',a+='<div class="story-viewer muted viewing with-back-button" data-story-id="'+n+'">',a+='<span class="fa fa-pause pause"></span>',a+='<div class="head">',a+='<div class="left">',a+='<a class="back">‹</a>',a+='<span class="item-preview">',a+='<img lazy="eager" class="profilePhoto" src="'+o.avatar+'">',a+="</span>",a+='<div class="info">',a+=i.a.render(o),a+='<span class="time"></span>',a+="</div>",a+="</div>",a+='<div class="right">',a+='<span class="time"></span>',a+='<a class="close" tabindex="2">×</a>',(o.reg_id==t.getState().mUser.reg_id||t.getState().mUser.canRemoveStories)&&(a+='<button class="btn btn-danger remove" tabindex="3">حذف</button>'),a+="</div>",a+="</div>",a+='<div class="slides-pointers">',a+='<div class="wrap">',r.forEach((function(t,n){a+='<span class="'+(0==n?"active":"")+'" data-index="'+n+'" data-id="'+t.id+'"><b style="animation-duration:'+e.getMediaDuration(t.type)+'s"></b></span>'})),a+="</div>",a+="</div>",a+='<div class="slides">',r.forEach((function(e,n){var r=0==n?"active":"";0==n&&c.a.viewStory(t,e.id),a+='<div class="item '+r+'" data-time="1679332998.385" data-created="'+e.created_at+'" data-type="'+e.type+'" data-index="'+n+'" data-id="'+e.id+'">',"photo"==e.type?a+='<img loading="auto" class="media" src="/uploads/story/photos/'+e.file+'">':"audio"==e.type?(a+='<img loading="auto" class="media" src="'+o.avatar+'">',a+='<audio muted="false" webkit-playsinline="" playsinline="" loop preload="auto" data-id="'+e.id+'" src="/uploads/story/audios/'+e.file+'" audio=""></audio>'):"video"==e.type&&(a+='<video class="media" webkit-playsinline="" playsinline="" loop preload="auto" data-id="'+e.id+'" src="/uploads/story/videos/'+e.file+'" video=""></video>'),a+=s.a.render(t,e),a+="</div>"})),a+="</div>",a+="</div>",a+="</div>",a+="</div>",a+="</div>",$(window.chat).append(a),window.storyModal=$("#story-modal"),window.storyModal.show().addClass("animated"),e.playFirstSlideSound(t),e.registerEvents(t),s.a.registerEvents(t)}}}],(n=null)&&u(t.prototype,n),d&&u(t,d),e}();t.a=d},function(e,t,n){"use strict";var r=n(0),o=n(5),i=n(9),a=n(55),s=n(24),c=n(6);function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,d;return t=e,d=[{key:"registerEvents",value:function(t){e.youtubeVideoClicked(t),e.videoClicked(t),e.photoClicked(t),e.soundClicked(t),e.getProfile(t),e.remove(t),e.comment(t),e.like(t)}},{key:"like",value:function(e){$("#chat__body__wall_pane .wall_post .wall_post__body__heart").unbind("click").on("click",(function(t){t.stopPropagation();var n=$(this).closest(".wall_post").data("id");e.getState().socket.emit("req",Object(r.k)({type:"WALL_LIKE_POST",data:{id:n}}),(function(e){if("string"==typeof(e=Object(r.g)(e)))return alert(e)}))}))}},{key:"remove",value:function(e){$("#chat__body__wall_pane .wall_post .wall_post__body__remove").unbind("click").on("click",(function(t){t.stopPropagation();var n=$(this).closest(".wall_post").data("id");console.log("id",n),e.getState().socket.emit("req",Object(r.k)({type:"WALL_REMOVE_POST",data:{id:n}}),(function(e){if("string"==typeof(e=Object(r.g)(e)))return alert(e)}))}))}},{key:"comment",value:function(e){$("#chat__body__wall_pane .wall_post .wall_post__body__comments").unbind("click").on("click",(function(t){if(t.preventDefault(),!c.a.checkForWaitingRoom(e)){var n=$(this).closest(".wall_post").data("id"),r=e.getState().posts.filter((function(e){return e.id==n}))[0];e.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"SET_WALL_COMMENTS_POST",wallCommentsPost:e}}(r)),a.a.render(r,e)}}))}},{key:"getProfile",value:function(e){$("#chat__body__wall_pane .wall_post .wall_post__avatar img").unbind("click").on("click",(function(t){t.stopPropagation();var n=$(this).closest(".wall_post").data("user");s.a.show(n,e)}))}},{key:"photoImgClicked",value:function(){$(".wall_post__body--photo-img").unbind("click").on("click",(function(e){e.stopPropagation(),window.open($(this).attr("src"),"_blank").focus()}))}},{key:"photoClicked",value:function(){$(".wall_post__body--photo").unbind("click").on("click",(function(t){t.stopPropagation();var n=document.getElementById("wall_media_"+$(this).attr("data-id"));n&&(n.insertAdjacentHTML("afterend",'<img class="wall_post__body--photo-img" autoplay controls src="/uploads/wall/photos/'+$(this).attr("data-src")+'"/>'),n.remove(),e.photoImgClicked())}))}},{key:"soundClicked",value:function(){$(".wall_post__body--sound").unbind("click").on("click",(function(e){e.stopPropagation();var t=document.getElementById("wall_media_"+$(this).attr("data-id"));t&&(t.insertAdjacentHTML("afterend",'<audio class="wall_post__body--sound" autoplay controls src="/uploads/wall/sounds/'+$(this).attr("data-src")+'"></audio>'),t.remove())}))}},{key:"videoClicked",value:function(){$(".wall_post__body--video").unbind("click").on("click",(function(e){e.stopPropagation();var t=document.getElementById("wall_media_"+$(this).attr("data-id"));t&&(t.insertAdjacentHTML("afterend",'<video class="wall_post__body--video" autoplay controls src="/uploads/wall/videos/'+$(this).attr("data-src")+'"></video>'),t.remove())}))}},{key:"youtubeVideoClicked",value:function(){$(".wall_post .yt-btn").unbind("click").on("click",(function(e){e.stopPropagation();try{var t=$(this).data("post-id"),n="https://www.youtube.com/embed/"+$(this).data("yid")+"?autoplay=1&playsinline=1",r=document.getElementById("yt-btn-"+t);r&&(r.insertAdjacentHTML("afterend",'<iframe width="95%" style="max-width:240px;" height="200" src="'+n+'" frameborder="0"></iframe><br />'),r.remove())}catch(e){}}))}},{key:"renderPostBody",value:function(e,t){switch("youtube"==e.type&&e.body.indexOf("shorts")>-1&&(e.body=e.body.replace("shorts/","")),e.type){case"text":return"<span class='wall_post__body--text'>"+i.a.render(e.body,t)+"</span>";case"photo":return"<button id='wall_media_"+e.id+"' class='wall_post--media-btn wall_post__body--photo btn fa fa-image' data-id='"+e.id+"' data-src='"+e.body+"'>عرض الصورة</button>";case"sound":return"<button id='wall_media_"+e.id+"' class='wall_post--media-btn wall_post__body--sound btn' data-id='"+e.id+"' data-src='"+e.body+"'>▶ عرض الفيديو</button>";case"video":return"<button id='wall_media_"+e.id+"' class='wall_post--media-btn wall_post__body--video btn fa fa-play' data-id='"+e.id+"' data-src='"+e.body+"'>عرض الفيديو</button>";case"youtube":var n="<button class='yt-btn' id='yt-btn-"+e.id+"' data-post-id='"+e.id+"' data-yid='"+e.body+"'>";return n+="<img style='width: 80px' alt='[YouTube]' src='https://img.youtube.com/vi/"+e.body+"/0.jpg' />",n+="</button>"}}},{key:"render",value:function(t,n){var i=t.active?"active":"",a="<div data-user='"+t.user.id+"' data-id='"+t.id+"' id='wall-post-"+t.id+"' class='wall_post "+i+"' >";return a+="<p class='wall_post__avatar'>",a+="<img width='36' height='36' alt='' src='"+Object(r.e)()+t.user.avatar+"' />",a+="</p>",a+="<div style='flex: 1 1 auto;'>",a+="<h5 class='wall_post__name'>",a+=o.a.render(t.user),a+="</h5>",a+="<div style='overflow: auto; overflow-x: hidden; overflow-wrap: break-word;' >",a+="<h5 style='color: "+t.user.fontColor+"' class='wall_post__body'>",t.text&&(a+="<div>"+t.text+"</div>"),a+=e.renderPostBody(t,n),a+="</h5>",a+="<div style='flex: 1 1 auto; float: right; max-width: 3.833rem; height: 0.875rem;'>",t.user&&(t.user.reg_id==n.getState().mUser.reg_id||n.getState().grantedSettings.wall_remove)&&(a+="<button class='wall_post__body__remove fr btn btn-danger fa fa-times'></button>"),a+="<button data-toggle='modal' data-target='#wall_comments' class='wall_post__body__comments fr btn btn-primary fa fa-comments'>"+t.comments+"</button>",a+="<button class='wall_post__body__heart fr btn btn-danger fa fa-heart'>"+t.likes+"</button>",a+="</div>",a+="</div>",a+="<span class='wall_post__time fr time' data-time='"+t.time+"'>"+Object(r.y)(t.time)+"</span>",a+="</div>",a+="<div class='clear'></div>",a+="</div>"}}],(n=null)&&u(t.prototype,n),d&&u(t,d),e}();t.a=d},function(e,t,n){"use strict";var r=n(18),o=n(0),i=n(7),a=n(65),s=n(10),c=n(1),u=n(2),d=n(17),l=n(51),f=n(31),p=n(6);function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,_;return t=e,_=[{key:"registerEvents",value:function(t){e.onInputSubmit(t),e.onFormSubmit(t),e.onLeaveRoom(t),e.openFacePicker(t),e.closePanes(t),e.clearPublicMessages(t)}},{key:"onInputSubmit",value:function(e){$("#chat__body__message-input__input").unbind("keydown").on("keydown",(function(e){if(13===e.which){if(!e.repeat){var t=new Event("submit",{cancelable:!0});e.target.form.dispatchEvent(t)}e.preventDefault()}}))}},{key:"onFormSubmit",value:function(e){$("#chat__body__message-input form").on("submit",(function(t){if(t.preventDefault(),!p.a.checkForWaitingRoom(e)){var n=t.target.message.value.substring(0,250),r=t.target.message;if(n.trim()){r.value="",r.focus();var i=null,a=$("#chat__body__message-reply");a.length&&((i={}).username=a.find("#chat__body__message-reply--username").text(),i.message=a.find("#chat__body__message-reply--message").text()),e.getState().socket.emit("req",Object(o.k)({type:"NEW_PUBLIC_MESSAGE",data:{message:n,reply:i}}),(function(t){if("string"==typeof(t=Object(o.g)(t)))return alert(t);s.a.insert({id:t.data.time,user:e.getState().mUser,icon:e.getState().mUser.avatar,title:e.getState().mUser.name,content:t.data.message,reply:i,type:"PUBLIC_MESSAGE"},e),window.lastMessage={time:Date.now(),isPublic:!0,isPrivate:!1,msg:t.data.message},a.remove()}))}}}))}},{key:"onLeaveRoom",value:function(t){$(".chat__body__message-input__leave_room").on("click",(function(n){if(n.preventDefault(),!p.a.checkForWaitingRoom(t))return"object"==m(window.ludoPlayers)&&window.ludoPlayers.filter((function(e){return e.user_id==t.getState().mUser.id}))[0]?alert("لايمكنك القيام بهذه العملية حتى تخرج من اللودو"):void t.getState().socket.emit("req",Object(o.k)({type:"LEAVE_ROOM",data:{}}),(function(n){n=Object(o.g)(n),s.a.insert({icon:t.getState().mUser.avatar,title:t.getState().mUser.name,user:t.getState().mUser,room:null,content:"(هذا المستخدم غادر الغرفة)",type:"JOIN_LEAVE"},t),u.a.setMics(t),e.toggleInput(t),d.a.resetData(!0),$("body").attr("id","")}))}))}},{key:"toggleInput",value:function(e){e.getState().mUser.room?$("#chat__body__message-input__input, .chat__body__message-input__leave_room").removeAttr("disabled"):$("#chat__body__message-input__input, .chat__body__message-input__leave_room").attr("disabled","disabled")}},{key:"openFacePicker",value:function(t){$("#chat__body__message-input__face").on("click",(function(n){t.dispatch(Object(a.a)(!0)),e.closePanes(t)}))}},{key:"closePanes",value:function(e){$("#chat__body__message-input__input").on("focus",(function(t){e.dispatch(Object(i.a)(null)),c.a.togglePane(e)}))}},{key:"clearPublicMessages",value:function(e){$(".chat__body__message-input__clear").on("click",(function(t){t.preventDefault(),e.getState().socket.emit("req",Object(o.k)({type:"PUBLIC_MESSAGE_CLEAR",data:{}}),(function(t){if("string"==typeof t)return alert(t);e.dispatch(Object(l.a)()),f.a.clear(e)}))}))}},{key:"canSendMessage",value:function(e){return e.getState().mUser.likes>=e.getState().settings.required_likes_public}},{key:"isXSS",value:function(e){return"string"==typeof e&&/on[a-zA-Z ]{0,}=/g.test(e)}},{key:"convertArNumbers",value:function(e){try{return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/٠/g,"0")).replace(/١/g,"1")).replace(/٢/g,"2")).replace(/٣/g,"3")).replace(/٤/g,"4")).replace(/٥/g,"5")).replace(/٦/g,"6")).replace(/٧/g,"7")).replace(/٨/g,"8")).replace(/٩/g,"9")}catch(t){return e}}},{key:"render",value:function(e){var t=e.getState().mUser.room?"":"disabled",n="<div id='chat__body__message-input'>";return n+=r.a.render("public_messages","#chat__body__message-input__input",e),n+="<form>",n+="<button class='chat__body__message-input__leave_room btn btn-primary fa fa-sign-out'></button>",e.getState().grantedSettings.public_message_clear&&(n+="<button class='chat__body__message-input__clear btn btn-primary fa fa-trash'></button>"),n+="<img class='chat__body__message-input__face' id='chat__body__message-input__face' src='/images/smile.gif' alt='فيس' />",n+="<textarea "+t+" class='border-color chat__body__message-input__input' name='message' id='chat__body__message-input__input' placeholder='أكتب رسالتك هنا' ></textarea>",n+="<button class='btn btn-primary fa fa-send chat__body__message-input__submit'>إرسال</button>",n+="</form>",n+="</div>"}}],(n=null)&&h(t.prototype,n),_&&h(t,_),e}();t.a=_},function(e,t,n){"use strict";var r=n(0),o=n(14),i=n(5),a=n(9),s=n(13),c=n(20),u=n(1);function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.openChat(t),e.remove(t)}},{key:"openChat",value:function(e){$("#chat__body__conversations_pane .conversations_item").unbind("click").on("click",(function(t){var n=e.getState().currentConversation;$(this).removeClass("unread");var r=$(this).data("id"),o=e.getState().conversations.filter((function(e){return e.id==r}))[0];o&&o.him&&(n&&n.id==o.id||(e.dispatch(Object(s.f)(o.him)),c.a.render(e)))}))}},{key:"remove",value:function(e){$("#chat__body__conversations_pane .conversations_item__remove").unbind("click").on("click",(function(t){t.stopPropagation();var n=$(this).closest(".conversations_item").data("id"),r=e.getState().conversations.filter((function(e){return e.id==n}))[0];e.getState().currentConversation&&e.getState().currentConversation.id==r.id&&(e.dispatch(Object(s.f)(null)),$("#chat_box_container").html("")),e.dispatch(Object(s.d)(r.id)),$(this).closest(".conversations_item").remove(),u.a.updateConversationsCount(e)}))}},{key:"renderLastMessage",value:function(e,t){var n=e.messages.length;if(n){var r=e.messages[n-1];if("text"==r.type)return a.a.render(r.body,t);if("photo"==r.type)return"<span class='fa fa-camera'></span>";if("sound"==r.type)return"<span class='fa fa-microphone'></span>";if("video"==r.type)return"<span class='fa fa-video-camera'></span>";if("youtube"==r.type)return"<span class='fa fa-youtube'></span>"}}},{key:"render",value:function(t,n){var r=t.seen?"":"unread",o="<div data-id='"+t.id+"' class='conversations_item "+r+" "+t.him.state+"' >";return o+="<div class='conversations_item__holder fl'>",o+="<p class='conversations_item__avatar'><img class='radius' width='30' height='30' src='"+t.him.avatar+"' /></p>",o+="<div>",o+="<h5 class='conversations_item__name'>",o+=i.a.render(t.him),o+="</h5>",o+="<h5 style='color: "+t.him.fontColor+"' class='conversations_item__last_message'>",o+=e.renderLastMessage(t,n),o+="</h5>",o+="</div>",o+="</div>",o+="<button class='conversations_item__remove btn btn-danger fa fa-times fr'>حذف</button>",o+="<div class='clear'></div>",o+="</div>"}}],(n=null)&&d(t.prototype,n),r&&d(t,r),e}();function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"registerEvents",value:function(e){}},{key:"renderConversations",value:function(e){var t=$("#chat__body__conversations_pane .chat_pane__container");t.html(""),e.getState().conversations.filter((function(t){return!e.getState().ignoredUsers.includes(t.him.id)})).forEach((function(n){t.append(l.render(n,e))})),l.registerEvents(e)}},{key:"render",value:function(t){var n="<div id='chat__body__conversations_pane' class='chat_pane' style='background: "+Object(r.u)(t.getState().settings,!0)+"'>";return n+=o.a.render("المحادثات الخاصة"),n+="<div class='chat_pane__container border'>"+e.renderConversations(t)+"</div>",n+="</div>"}}],(n=null)&&f(t.prototype,n),i&&f(t,i),e}();t.a=p},function(e,t,n){"use strict";n(142);var r=n(0),o=n(11);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"registerEvents",value:function(t){e.editRoom(t),e.deleteRoom(t),e.changeFlag(t),e.changeFlagInput(t)}},{key:"changeFlag",value:function(e){$("#editRoomModal #change_flag").unbind("click").on("click",(function(e){$(this).hasClass("is-loading")||$("#editRoomModal #change_flag_input").click()}))}},{key:"changeFlagInput",value:function(e){$("#editRoomModal #change_flag_input").unbind("change").on("change",(function(t){var n=new FormData;n.append("_token",$('meta[name="csrf-token"]').attr("content")),n.append("flag",t.target.files[0]),n.append("room_id",$(this).data("id")),$("#editRoomModal #change_flag").addClass("disabled").attr("src","/images/loader.gif"),$.ajax({xhr:function(){return new window.XMLHttpRequest},url:"/fadmn/rooms/"+e.getState().grantedSettings.adminToken+"/edit-flag",type:"POST",data:n,processData:!1,contentType:!1,success:function(t){$("#editRoomModal #change_flag").removeClass("disabled"),"string"==typeof t&&(t=JSON.parse(t));try{!1===t.error?(e.getState().socket.emit("req",{type:"EDIT_ROOM_FLAG",data:{id:t.id,flag:t.flag,token:e.getState().grantedSettings.adminToken}}),$("#editRoomModal #change_flag").attr("src","/uploads/rooms/"+t.flag)):"not permitted"==t.msg?alert("لا تملك الصلاحيات للقيام بهذه العملية"):alert("حدث خطأ أثناء رفع الصورة")}catch(e){console.log(e.stack)}},error:function(e){$("#editRoomModal #change_flag").removeClass("disabled")}})}))}},{key:"editRoom",value:function(t){$("#editRoomModal form").on("submit",(function(n){n.preventDefault();var o=n.target.name.value.trim(),a=n.target.description.value.trim(),s=n.target.welcome.value.trim(),c=n.target.password.value.trim(),u=n.target.required_likes.value,d=isNaN(parseInt(n.target.mics_count.value))?0:parseInt(n.target.mics_count.value),l=n.target.capacity.value,f=$(this).data("id");return o.length?o.length<2?e.showErrorMessage("إسم الغرفة لا يجب أن يقل عن حرفين"):o!=t.getState().mUser.room.name&&t.getState().rooms.filter((function(e){return e.name==o})).length?e.showErrorMessage("هذه الغرفة موجودة, الرجاء إختيار إسم آخر"):l<2||l>50?e.showErrorMessage("حجم الغرفة يجب أن يتراوح بين 2 إلى 50"):void t.getState().socket.emit("req",Object(r.k)({type:"EDIT_ROOM",data:{room:{id:f,name:o,description:a,welcome:s,password:c,required_likes:u,mics_count:d,capacity:l}}}),(function(t){if("string"==typeof(t=Object(r.g)(t)))return alert(t);t&&"object"==i(t)&&(!1===t.error?e.showSuccessMessage("تم تعديل الغرفة بنجاح"):!0===t.error&&e.showErrorMessage(t.message))})):e.showErrorMessage("الرجاء إعطاء إسم للغرفة")}))}},{key:"deleteRoom",value:function(t){$("#room_modal__body__form__delete").on("click",(function(n){t.getState().socket.emit("req",Object(r.k)({type:"REMOVE_ROOM",data:{room:{id:t.getState().mUser.room.id}}}),(function(t){if("string"==typeof(t=Object(r.g)(t)))return alert(t);t&&"object"==i(t)&&(!1===t.error?e.showSuccessMessage("تمت العملية بنجاح, سيتم حذف الغرفة عندما تفرغ"):!0===t.error&&e.showErrorMessage(t.message))}))}))}},{key:"showErrorMessage",value:function(e){$("#editRoomModal .alert-success").hide(),$("#editRoomModal .alert-danger").text(e).show()}},{key:"showSuccessMessage",value:function(e){$("#editRoomModal .alert-success").text(e).show(),$("#editRoomModal .alert-danger").hide()}},{key:"render",value:function(t,n){var r=(t=n.getState().rooms.find((function(e){return e.id==t.id}))).description?t.description:"",o=t.welcome?t.welcome:"",i=t.required_likes?t.required_likes:0,a=t.mics?t.mics.length:0,s="<div class='modal fade room_modal' id='editRoomModal' tabindex='-1' role='dialog' aria-hidden='true'>";s+="<div class='modal-dialog' role='document'>",s+="<div class='modal-content'>",s+="<div class='room_modal__header modal-header label label-primary'>",s+="<div class='modal-title'>",s+="<p class='room_modal__header__name ellipsis'>تعديل الغرفة</p>",s+="<button data-dismiss='modal' class='btn btn-danger room_modal__header__close fa fa-times'></button>",s+="</div>",s+="</div>",s+="<div class='room_modal__body modal-body'>",s+="<p class='alert alert-danger' style='display: none'></p>",s+="<p class='alert alert-success' style='display: none'></p>",s+="<form data-id='"+t.id+"' id='room_modal__body__form'>",s+="<div>",s+="<div><input type='text' name='name' value='"+t.name+"' placeholder='عنوان الغرفة' /></div>",s+="<div><input type='text' name='description' value='"+r+"' placeholder='الوصف' /></div>",s+="<div><input type='text' name='welcome' value='"+o+"' placeholder='رسالة الترحيب' /></div>",s+="<div><input type='text' name='password' placeholder='كلمة المرور' /></div>",s+="<div><input type='number' name='required_likes' value='"+i+"' placeholder='لايكات الدخول' /></div>",s+="<div><input autocomplete='off' type='number' min='0' max='7' name='mics_count' value='"+a+"' placeholder='عدد المايكات' /></div>",s+="<div><input type='number' name='capacity' value='"+t.capacity+"' placeholder='حجم الغرفة من 2 إلى 50' /></div>",s+="<button style='margin-top: 0.4rem' class='btn btn-success pull-left'><span class='fa fa-save'></span>حفظ التعديلات&nbsp;</button>",s+="<img id='change_flag' src='"+t.flag+"' />",s+="<input data-id='"+t.id+"' accept='image/*' type='file' id='change_flag_input' style='position: absolute; top: -1000px' />",s+="<button style='margin-top: 0.4rem' id='room_modal__body__form__delete' type='button' class='btn btn-danger pull-right'><span class='fa fa-remove'></span>حذف الغرفة</button>",s+="</div>",s+="</form>",s+="</div>",s+="</div>",s+="</div>",s+="</div>",$("#room_modal__body__form__delete").unbind("click"),$("#editRoomModal form").unbind("submit"),$("#edit_room_container").html(s),e.registerEvents(n)}}],(n=null)&&a(t.prototype,n),o&&a(t,o),e}(),c=n(14),u=n(29),d=n.n(u);function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"registerEvents",value:function(t){e.setUserBackground(t),e.removeUserBackground(t),e.submit(t),e.initJSColor(),e.openAdmin(t),e.closeChat(t),e.removeNameBgColor(t),e.changeFontSize(t),e.hideRoleIcon(t),e.triggerChangeAvatarInput(t),e.changeAvatar(t),e.removeAvatar(t),e.togglePrivate(t),e.toggleNotifications(t),e.changePassword(t),e.sendAd(t),e.manageRoom(t)}},{key:"prependHash",value:function(e){return"string"!=typeof e?"":e.includes("#")?e:"#"+e}},{key:"initJSColor",value:function(){var e=document.getElementsByClassName("jscolor");for(var t in e)try{new jscolor(e[t]).importColor()}catch(e){}}},{key:"changeFontSize",value:function(e){$("#chat__body__settings_pane__container__button--change-font-size option[value='"+e.getState().mUser.fontSize+"']").attr("selected","selected"),document.querySelector("html").style.fontSize=e.getState().mUser.fontSize+"px",$("#chat__body__settings_pane__container__button--change-font-size").unbind("change").on("change",(function(t){var n={type:"USER_SETTINGS_SET_FONT_SIZE",data:{fontSize:t.target.value}};e.getState().socket.emit("req",Object(r.k)(n),(function(t){t=Object(r.g)(t),e.getState().mUser.reg_id||Object(r.w)("fontSize",Object(r.k)(t,!0)),e.dispatch(Object(o.f)({fontSize:t})),document.querySelector("html").style.fontSize=t+"px"}))}))}},{key:"submit",value:function(t){$("#chat__body__settings_pane form").unbind("submit").on("submit",(function(n){n.preventDefault();var o=n.target.decoration.value.substring(0,50),i=n.target.status.value.substring(0,300);if(t.getState().mUser.name!=o&&t.getState().mUser.likes<t.getState().settings.required_likes_to_change_name_status)return alert("يجب أن تتوفر على "+t.getState().settings.required_likes_to_change_name_status+" حتى تتمكن من تغيير الإسم");if(t.getState().mUser.status!=i&&t.getState().mUser.likes<t.getState().settings.required_likes_to_change_name_status)return alert("يجب أن تتوفر على "+t.getState().settings.required_likes_to_change_name_status+" حتى تتمكن من تغيير الحالة");var a={type:"USER_SETTINGS_SAVE",data:{decoration:o,status:i,fontColor:e.prependHash(n.target.fontColor.value.trim()),nameColor:e.prependHash(n.target.nameColor.value.trim()),nameBgColor:e.prependHash(n.target.nameBgColor.value.trim()),statusColor:e.prependHash(n.target.statusColor.value.trim())}};t.getState().socket.emit("req",Object(r.k)(a),(function(e){e=Object(r.g)(e),t.getState().mUser.reg_id||Object.keys(e).forEach((function(t){t="name"==t?"gun":t,Object(r.w)(t,Object(r.k)(e["gun"==t?"name":t],!0))}))}))}))}},{key:"setUserBackground",value:function(e){$(".user-background-item").unbind("click").unbind("click").on("click",(function(t){var n=$(this).data("id"),o={type:"USER_SETTINGS_SET_BACKGROUND",data:{type:$(this).data("type"),id:n}};e.getState().socket.emit("req",Object(r.k)(o),(function(e){e=Object(r.g)(e)}))}))}},{key:"removeUserBackground",value:function(e){$(".remove-user-background").unbind("click").unbind("click").on("click",(function(t){var n={type:"USER_SETTINGS_REMOVE_BACKGROUND",data:{type:$(this).data("type")}};e.getState().socket.emit("req",Object(r.k)(n),(function(e){e=Object(r.g)(e)}))}))}},{key:"triggerChangeAvatarInput",value:function(e){$("#chat__body__settings_pane__container__button--change_avatar").unbind("click").on("click",(function(t){if(e.getState().mUser.likes<e.getState().settings.required_likes_to_change_avatar)return alert("يجب أن تتوفر على "+e.getState().settings.required_likes_to_change_avatar+" حتى تتمكن من تغيير الصورة");if(!$(this).hasClass("is-loading")){var n=document.getElementById("change_avatar_input");n&&n.click()}}))}},{key:"changeAvatar",value:function(t){$("#change_avatar_input").unbind("change").on("change",(function(n){var o=new FormData;o.append("avatar",n.target.files[0]),$("#chat__body__settings_pane__container__button--change_avatar").addClass("disabled"),d.a.post("/change_avatar",o).then((function(n){if($("#chat__body__settings_pane__container__button--change_avatar").removeClass("disabled"),!1===n.data.error){var o={type:"USER_SETTINGS_CHANGE_AVATAR",data:{avatar:n.data.avatar}};t.getState().socket.emit("req",Object(r.k)(o),(function(n){t.getState().mUser.reg_id||Object(r.w)("avatar",Object(r.k)(n,!0)),n=Object(r.g)(n),e.updateUserAttribute("avatar","/uploads/avatars/sm/"+n,t),$("#chat__body__settings_pane__container__button--change_avatar .avatar").attr("src","/uploads/avatars/sm/"+n)}))}})).catch((function(e){}))}))}},{key:"removeAvatar",value:function(t){$("#chat__body__settings_pane__container__button--remove-avatar").unbind("click").on("click",(function(n){confirm("هلل أنت متأكد من حذف الصورة؟")&&t.getState().socket.emit("req",Object(r.k)({type:"USER_SETTINGS_REMOVE_AVATAR",data:{}}),(function(n){t.getState().mUser.reg_id||Object(r.w)("avatar",null),n=Object(r.g)(n),e.updateUserAttribute("avatar",n,t),$("#chat__body__settings_pane__container__button--change_avatar .avatar").attr("src",n)}))}))}},{key:"updateUserAttribute",value:function(e,t,n){var r={};r[e]=t,n.dispatch(Object(o.f)(r))}},{key:"updateDecoration",value:function(e){$("#chat__body__settings_pane form input[name='decoration']").val(e.getState().mUser.name)}},{key:"removeNameBgColor",value:function(t){$(".chat__body__settings_pane__container__rm_bg_color").unbind("click").on("click",(function(n){t.getState().socket.emit("req",Object(r.k)({type:"USER_SETTINGS_REMOVE_NAME_BG_COLOR",data:{}}),(function(n){n=Object(r.g)(n),t.getState().mUser.reg_id||Object(r.w)("nameBgColor",Object(r.k)(n,!0)),e.updateUserAttribute("nameBgColor",n,t),$("input[name='nameBgColor']").val("FFFFFF"),e.initJSColor()}))}))}},{key:"hideRoleIcon",value:function(t){$("#chat__body__settings_pane__container__button--toggle-star").unbind("click").on("click",(function(n){t.getState().socket.emit("req",Object(r.k)({type:"USER_SETTINGS_HIDE_ROLE_ICON",data:{}}),(function(n){n=Object(r.g)(n),e.updateUserAttribute("isRoleIconHidden",n,t),n?($("#chat__body__settings_pane__container__button--toggle-star .toggle_star__hide").removeClass("toggle_star--active"),$("#chat__body__settings_pane__container__button--toggle-star .toggle_star__show").addClass("toggle_star--active")):($("#chat__body__settings_pane__container__button--toggle-star .toggle_star__hide").addClass("toggle_star--active"),$("#chat__body__settings_pane__container__button--toggle-star .toggle_star__show").removeClass("toggle_star--active"))}))}))}},{key:"togglePrivate",value:function(t){$("#chat__body__settings_pane__container__button--toggle_private").unbind("click").on("click",(function(n){t.getState().socket.emit("req",Object(r.k)({type:"USER_SETTINGS_TOGGLE_PRIVATE",data:{}}),(function(n){n=Object(r.g)(n),e.updateUserAttribute("isPrivateDisabled",n,t),n?($("#chat__body__settings_pane__container__button--toggle_private .toggle_private__disable").removeClass("toggle_private--active"),$("#chat__body__settings_pane__container__button--toggle_private .toggle_private__enable").addClass("toggle_private--active")):($("#chat__body__settings_pane__container__button--toggle_private .toggle_private__disable").addClass("toggle_private--active"),$("#chat__body__settings_pane__container__button--toggle_private .toggle_private__enable").removeClass("toggle_private--active"))}))}))}},{key:"toggleNotifications",value:function(t){$("#chat__body__settings_pane__container__button--toggle_notifications").unbind("click").on("click",(function(n){t.getState().socket.emit("req",Object(r.k)({type:"USER_SETTINGS_TOGGLE_NOTIFICATIONS",data:{}}),(function(n){n=Object(r.g)(n),e.updateUserAttribute("isNotificationsDisabled",n,t),n?($("#chat__body__settings_pane__container__button--toggle_notifications .toggle_notifications__disable").removeClass("toggle_notifications--active"),$("#chat__body__settings_pane__container__button--toggle_notifications .toggle_notifications__enable").addClass("toggle_notifications--active")):($("#chat__body__settings_pane__container__button--toggle_notifications .toggle_notifications__disable").addClass("toggle_notifications--active"),$("#chat__body__settings_pane__container__button--toggle_notifications .toggle_notifications__enable").removeClass("toggle_notifications--active"))}))}))}},{key:"changePassword",value:function(e){$("#chat__body__settings_pane__container__button-change_password").unbind("click").on("click",(function(t){var n=prompt("الرجاء إدخال كلمة المرور الجديدة");if(n){if(n.length<6)return alert("كلمة المرور لا يجب أن تقل عن 6 أحرف");var o={type:"USER_SETTINGS_CHANGE_PASSWORD",data:{password:n}};e.getState().socket.emit("req",Object(r.k)(o),(function(e){(e=Object(r.g)(e)).error||Object(r.w)("mup",Object(r.k)(n,!0)),alert(e.message)}))}}))}},{key:"sendAd",value:function(e){$("#chat__body__settings_pane__container__button--send_ad").unbind("click").on("click",(function(t){var n=prompt("الرجاء إدخال الرسالة:");if(n){var o={type:"USER_SETTINGS_SEND_AD",data:{message:n}};e.getState().socket.emit("req",Object(r.k)(o),(function(e){}))}}))}},{key:"manageRoom",value:function(e){$("#chat__body__settings_pane__container__button--manage_room").unbind("click").on("click",(function(t){if(!e.getState().mUser.room)return alert("الرجاء الدخول إلى غرفة حتى تتمكن من إدارتها");s.render(e.getState().mUser.room,e)}))}},{key:"openAdmin",value:function(e){$("#chat__body__settings_pane__container__button--open_admin").unbind("click").on("click",(function(t){window.open("/fadmn/home/".concat(e.getState().grantedSettings.adminToken),"_blank").focus()}))}},{key:"closeChat",value:function(e){$("#chat__body__settings_pane__container__button--close-chat").unbind("click").on("click",(function(t){window.confirmOnExit=!1,e.getState().socket.disconnect()}))}},{key:"refresh",value:function(t){window.settingsPane.html($(e.render(t)).html()),e.registerEvents(t)}},{key:"render",value:function(e){var t="<div id='chat__body__settings_pane' class='chat_pane' style='background: "+Object(r.u)(e.getState().settings,!0)+"'>";if(t+=c.a.render("الإعدادات"),t+="<div class='chat__body__settings_pane__container'>",t+="<div style='margin-bottom: 0.125rem' >",t+="<label class='label label-primary'>الزخرفة</label>",t+="<form>",t+="<input type='text' name='decoration' value='"+e.getState().mUser.name+"' class='form-control' />",t+="<div>",t+="<label class='label label-primary'>الحالة</label>",t+="<input type='text' name='status' value='"+e.getState().mUser.status+"' class='form-control' />",t+="</div>",t+="<div>",t+="<label class='label label-primary'>لون الحالة</label>",t+="<input type='text' name='statusColor' value='"+e.getState().mUser.statusColor+"' class='jscolor form-input' />",t+="</div>",t+="<div>",t+="<label class='label label-primary'>لون الخط</label>",t+="<input type='text' name='fontColor' value='"+e.getState().mUser.fontColor+"' class='jscolor form-input' />",t+="</div>",t+="<div>",t+="<label class='label label-primary'>لون الإسم</label>",t+="<input type='text' name='nameColor' value='"+e.getState().mUser.nameColor+"' class='jscolor form-input' />",t+="</div>",t+="<div>",t+="<label class='label label-primary'>لون الخلفية</label>",t+="<input type='text' name='nameBgColor' value='"+e.getState().mUser.nameBgColor+"' class='jscolor form-input' />",t+="<button type='button' class='chat__body__settings_pane__container__rm_bg_color btn btn-danger fa fa-times'></button>",t+="</div>",t+="<div class='clear'></div>",t+="<div>",t+="<button name='submit' class='chat__body__settings_pane__container__submit btn btn-success fa fa-save'>حفظ</button>",t+="</div>",t+="</form>",t+="</div>",t+="<select id='chat__body__settings_pane__container__button--change-font-size' class='form-control label-primary' value='"+e.getState().mUser.fontSize+"' style='height: auto' >",t+="<option value='18'>حجم الخط 10</option>",t+="<option value='20'>حجم الخط 11</option>",t+="<option value='22'>حجم الخط 12</option>",t+="<option value='24'>حجم الخط 13</option>",t+="<option value='26'>حجم الخط 14</option>",t+="<option value='28'>حجم الخط 15</option>",t+="<option value='30'>حجم الخط 16</option>",t+="</select>",e.getState().grantedSettings.hide_role_icon){var n=e.getState().mUser.isRoleIconHidden?"":"toggle_star--active",o=e.getState().mUser.isRoleIconHidden?"toggle_star--active":"";t+="<div id='chat__body__settings_pane__container__button--toggle-star' class='chat__body__settings_pane__container__button form-control'>",t+="<span class='toggle_star toggle_star__hide "+n+"'><span class='fa fa-eye-slash'></span>إخفاء النجمة</span>",t+="<span class='toggle_star toggle_star__show "+o+"'><span class='fa fa-eye'></span>إظهار النجمة</span>",t+="</div>"}t+="<div id='chat__body__settings_pane__container__button--change_avatar' class='chat__body__settings_pane__container__button form-control'>",t+="<span><span class='fa'>",t+="<img class='avatar' src='"+e.getState().mUser.avatar+"' width='20' height='20' alt='' />",t+="<img class='loader' src='/images/loader.gif' width='20' height='20' alt=''/>",t+="</span>تغيير الصورة</span>",t+="<input accept='image/*' type='file' id='change_avatar_input' style='position: absolute; top: -1000px' />",t+="</div>",t+="<div id='chat__body__settings_pane__container__button--remove-avatar' class='chat__body__settings_pane__container__button form-control danger'>",t+="<span><span class='fa fa-remove'></span>حذف الصورة</span>",t+="</div>",e.getState().mUser.canSetUserBackgrounds&&e.getState().features.FT_IS_USERS_BACKGROUND_ENABLED&&(t+='<div id="chat__body__settings_pane__container__user-backgrounds">',t+='<span data-type="background" class="remove-user-background fa fa-remove"></span>',e.getState().userBackgrounds.forEach((function(e){t+='<img class="user-background-item" data-type="background" data-id="'+e.id+'" src="/uploads/user-bg/'+e.img+'"></img>'})),t+="</div>",t+='<div id="chat__body__settings_pane__container__user-avatar-backgrounds">',t+='<span data-type="avatar-background" class="remove-user-background fa fa-remove"></span>',e.getState().userAvatarBackgrounds.forEach((function(e){t+='<img class="user-background-item" data-type="avatar-background" data-id="'+e.id+'" src="/uploads/user-avatar-bg/'+e.img+'"></img>'})),t+="</div>");var i=e.getState().mUser.isPrivateDisabled?"toggle_private--active":"",a=e.getState().mUser.isPrivateDisabled?"":"toggle_private--active";t+="<div id='chat__body__settings_pane__container__button--toggle_private' class='chat__body__settings_pane__container__button form-control'>",t+="<span class='toggle_private toggle_private__enable "+i+"'><span class='fa fa-check'></span>تفعيل المحادثات الخاصة</span>",t+="<span class='toggle_private toggle_private__disable "+a+"'><span class='fa fa-times'></span>تعطيل المحادثات الخاصة</span>",t+="</div>";var s=e.getState().mUser.isNotificationsDisabled?"toggle_notifications--active":"",u=e.getState().mUser.isNotificationsDisabled?"":"toggle_notifications--active";return t+="<div id='chat__body__settings_pane__container__button--toggle_notifications' class='chat__body__settings_pane__container__button form-control'>",t+="<span class='toggle_notifications toggle_notifications__enable "+s+"'><span class='fa fa-check'></span>تفعيل التنبيهات</span>",t+="<span class='toggle_notifications toggle_notifications__disable "+u+"'><span class='fa fa-times'></span>تعطيل التنبيهات</span>",t+="</div>",e.getState().grantedSettings.change_password&&(t+="<div id='chat__body__settings_pane__container__button-change_password' class='chat__body__settings_pane__container__button form-control' style='background-color: #980F5A; color: #FFFFFF;'>",t+="<span><span class='fa fa-key'></span>تغيير كلمة المرور</span>",t+="</div>"),e.getState().grantedSettings.admin_rooms_edit&&(t+="<div data-toggle='modal' data-target='#editRoomModal' id='chat__body__settings_pane__container__button--manage_room' class='chat__body__settings_pane__container__button form-control warning'>",t+="<span><span class='fa fa-home'></span>إدارة الغرفة</span>",t+="</div>"),e.getState().grantedSettings.send_ad&&(t+="<div id='chat__body__settings_pane__container__button--send_ad' class='chat__body__settings_pane__container__button form-control info'>",t+="<span><span class='fa fa-send'></span>الإعلان للأدعية و المسابقات</span>",t+="</div>"),e.getState().grantedSettings.admin&&(t+="<div id='chat__body__settings_pane__container__button--open_admin' class='chat__body__settings_pane__container__button form-control success'>",t+="<span><span class='fa fa-star'></span>لوحة التحكم</span>",t+="</div>"),t+="<div id='chat__body__settings_pane__container__button--close-chat' class='chat__body__settings_pane__container__button form-control danger'>",t+="<span><span class='fa fa-sign-out'></span>تسجيل الخروج</span>",t+="</div>",t+="</div>",t+="</div>"}}],(n=null)&&l(t.prototype,n),i&&l(t,i),e}();t.a=f},function(e,t,n){"use strict";var r=n(0),o=n(7),i=n(1),a=n(2),s=n(29),c=n.n(s);function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.onItemClick(t),e.onItemRemove(t)}},{key:"onItemClick",value:function(e){window.audioGalleryPane.find(".audio-gallery-item").unbind("click").on("click",(function(t){window.audioGalleryPlayer.closest(".audioplayer").addClass("audioplayer-playing"),window.audioGalleryPlayer.attr("src","/uploads/audio-gallery/"+t.target.dataset.name),window.audioGalleryElement=window.audioGalleryPlayer[0],window.audioGalleryPlayer.unbind("pause").on("pause",(function(e){window.audioGalleryPlayer.closest(".audioplayer").removeClass("audioplayer-playing")})),a.a.msProduceMediaFromGallery(e,window.audioGalleryElement)}))}},{key:"onItemRemove",value:function(e){window.audioGalleryPane.find(".audio-gallery-item button.fa-times").unbind("click").on("click",(function(t){var n=this,r=new FormData;r.append("token",e.getState().mUser.ajax_token),r.append("id",t.target.dataset.id),$(this).attr("disabled","disabled"),c.a.post("/audio_gallery_remove",r).then((function(e){if($(n).removeAttr("disabled"),!1!==e.data.error)return alert(e.data.message);$(n).closest(".audio-gallery-item").remove()})).catch((function(e){$(n).removeAttr("disabled")}))}))}},{key:"render",value:function(e,t){var n='<div class="audio-gallery-item" data-name="'+t.name+'">';return n+='<p class="audio-gallery-item--label ellipsis" data-name="'+t.name+'">'+t.label+"</p>",n+='<span class="fa fa-play" data-name="'+t.name+'"></span>',n+='<button class="btn btn-danger fa fa-times" data-id="'+t.id+'"></button>',n+="</div>"}}],(n=null)&&u(t.prototype,n),r&&u(t,r),e}(),l=n(14);function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,s;return t=e,s=[{key:"registerEvents",value:function(t){e.onInputClicked(t),e.onAddButtonClicked(t)}},{key:"onAddButtonClicked",value:function(e){window.audioGalleryPane.find("#audio-gallery-pane--add").unbind("click").on("click",(function(e){window.audioGalleryPane.find("#audio-gallery-pane--input").click()}))}},{key:"onInputClicked",value:function(t){window.audioGalleryPane.find("#audio-gallery-pane--input").unbind("change").on("change",(function(n){if(n.target.files[0]){var r=new FormData;r.append("token",t.getState().mUser.ajax_token),r.append("file",n.target.files[0]),window.audioGalleryPane.find("#audio-gallery-pane--add").attr("disabled","disabled"),c.a.post("/audio_gallery_upload",r).then((function(r){n.target.value="",window.audioGalleryPane.find("#audio-gallery-pane--add").removeAttr("disabled"),!1===r.data.error?(window.audioGalleryPane.find(".chat_pane__container").append(d.render(t,{id:r.data.id,name:r.data.name,label:r.data.label})),d.registerEvents(t),e.initAudioPlayer(t,[{id:r.data.id,name:r.data.name,label:r.data.label}])):"length exeeded"==r.data.message&&alert("لا يمكنك رفع أكثر من "+r.data.length+" ملفات")})).catch((function(e){window.audioGalleryPane.find("#audio-gallery-pane--add").removeAttr("disabled"),n.target.value=""}))}}))}},{key:"setItems",value:function(t,n){window.audioGalleryPane.find(".audio-gallery-item").remove();var r="";n.forEach((function(e){r+=d.render(t,e)})),window.audioGalleryPane.find(".chat_pane__container").append(r),d.registerEvents(t),e.initAudioPlayer(t,n)}},{key:"open",value:function(e){"audio-gallery"!=e.getState().currentPane&&(e.dispatch(Object(o.a)("audio-gallery")),i.a.togglePane(e))}},{key:"initAudioPlayer",value:function(e,t){if(t&&t.length&&!window.audioGalleryPane.find("#audio-gallery-pane--player").length){window.audioGalleryPane.find("#audio-gallery-pane--player-wrapper").append("<audio id='audio-gallery-pane--player' controls src='/uploads/audio-gallery/"+t[0].name+"'></audio>"),window.audioGalleryPane.find("#audio-gallery-pane--player").audioPlayer(),window.audioGalleryPlayer=window.audioGalleryPane.find("#audio-gallery-pane--player");var n=Object(r.f)((function(t){a.a.updateMediaVolume(e,t.target.volume)}),500);window.audioGalleryPlayer.unbind("volumechange").on("volumechange",n)}}},{key:"render",value:function(e){if(!e.getState().features.FT_IS_AUDIO_GALLERY_ENABLED)return"";var t="<div id='audio-gallery-pane' class='chat_pane' style='background: "+Object(r.u)(e.getState().settings,!0)+"'>";return t+=l.a.render("مكتبة الصوتيات"),t+="<div><button id='audio-gallery-pane--add' class='border btn btn-success fa fa-plus'>إضافة ملف صوتي</button></div>",t+="<input id='audio-gallery-pane--input' type='file' accept='audio/*' style='display: none; left: -500000px; position: absolute' />",t+="<div class='chat_pane__container border'><div id='audio-gallery-pane--player-wrapper'></div></div>",t+="</div>"}}],(n=null)&&f(t.prototype,n),s&&f(t,s),e}();t.a=p},function(e,t,n){"use strict";var r=n(18),o=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"TOGGLE_STORY_COMMENTS_FACE_PICKER",isStoryCommentsFacePickerOpen:e}},i=n(0),a=n(16),s=n(5),c=n(23),u=n(32),d=n(9),l=n(6);function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,p;return t=e,p=[{key:"registerEvents",value:function(t){e.sendComment(t),e.onInputSubmit(t),$("#story-comments, #story-comments *").unbind("click").on("click",(function(n){return n.stopPropagation(),"story-comments"==n.target.id||"story-comments-close"==n.target.id?e.close(t):"story-comments-form--face"==n.target.id?e.openFacePicker(t):n.target.classList.contains("story-comments--comment--like")?e.onLike(t,n):n.target.classList.contains("story-comments--comment--remove")?e.onRemove(t,n):n.target.classList.contains("emoji-picker--item")?void 0:(t.dispatch(o(!1)),r.a.toggle(t))}))}},{key:"onInputSubmit",value:function(e){$("#story-comments-form--input").unbind("keydown").on("keydown",(function(e){if(13===e.which){if(!e.repeat){var t=new Event("submit",{cancelable:!0});e.target.form.dispatchEvent(t)}e.preventDefault()}}))}},{key:"onLike",value:function(e,t){var n=t.target.dataset.id;e.getState().socket.emit("req",Object(i.k)({type:"story:comment:like",data:{id:n}}),(function(e){if("string"==typeof(e=Object(i.g)(e)))return alert(e)}))}},{key:"onRemove",value:function(e,t){var n=t.target.dataset.id,r=t.target.dataset.postId;e.getState().socket.emit("req",Object(i.k)({type:"story:comment:remove",data:{id:n,postId:r}}),(function(e){if("string"==typeof(e=Object(i.g)(e)))return alert(e)}))}},{key:"remove",value:function(e){window.storyModal&&window.storyModal.find("#story-comments .story-comments--comment[data-id='"+e+"']").remove()}},{key:"incStoryCommentsCount",value:function(e){if(window.storyModal){var t=window.storyModal.find(".story-reactions[data-id='"+e+"'] .comments_wrapper .comments");if(t&&t.length){var n=+t.text()+1;n||(function(e){throw new TypeError('"'+e+'" is read-only')}("text"),n=0),t.text(n),$("#story-comments[data-id='"+e+"'] #comments-count-wrapper .comments-count").text(n)}}}},{key:"decStoryCommentsCount",value:function(e){if(window.storyModal){var t=window.storyModal.find(".story-reactions[data-id='"+e+"'] .comments_wrapper .comments");if(t&&t.length){var n=+t.text()-1;n||(n=0),t.text(n),$("#story-comments[data-id='"+e+"'] #comments-count-wrapper .comments-count").text(n)}}}},{key:"sendComment",value:function(e){window.storyModal&&window.storyModal.find("#story-comments-footer form").unbind("submit").on("submit",(function(t){if(t.preventDefault(),!l.a.checkForWaitingRoom(e)){e.dispatch(o(!1)),r.a.toggle(e);var n=t.target.message,s=n.value.trim();if(s){n.value="";var c=$(this).closest("#story-comments").data("id");e.getState().socket.emit("req",Object(i.k)({type:"story:comment",data:{message:s,id:c}}),(function(t){return"string"==typeof(t=Object(i.g)(t))?alert(t):t.error&&t.data.notFound?a.a.onRemoveStory(e,c):void 0}))}}}))}},{key:"close",value:function(e){var t=$("#story-comments");t.length&&(t.find("#story-comments-container").css("top","100vh"),setTimeout((function(){t.remove()}),200),u.a.unpause(e))}},{key:"setModalTop",value:function(){var e=$("#story-comments");if(e.length){var t=e.find("#story-comments-container"),n=$(document).height();t.css("top",n-t.height()+"px")}}},{key:"openFacePicker",value:function(e){e.dispatch(o(!0)),r.a.onSelect(),r.a.toggle(e)}},{key:"incCommentLikes",value:function(e,t,n){if(e.dispatch(Object(c.e)(t,n)),window.storyModal){var r=window.storyModal.find("#story-comments .story-comments--comment[data-id='"+t+"'] .story-comments--comment--like");if(r){var o=parseInt(r.text())+1;r.text(o)}}}},{key:"scrollToBottom",value:function(){var e=document.getElementById("story-comments-body");e&&(e.scrollTop=e.scrollHeight-e.clientHeight)}},{key:"renderComment",value:function(t,n){var r=t.getState().stories.find((function(e){return e.id==n.story_id}));if(!r)return"";var o=$("#story-comments[data-id='"+n.story_id+"']");if(o){var a="<div class='story-comments--comment' data-id='"+n.id+"' >";a+="<p class='story-comments--comment--avatar'>",a+="<img class='radius border border-color' width='30' height='30' src='"+n.user.avatar+"' />",a+="</p>",a+="<div>",a+="<h5 class='story-comments--comment--title'>",a+=s.a.render(n.user),a+="</h5>",a+="<h5 class='story-comments--comment--content'>",a+=d.a.render(n.comment,t),a+="</h5>",a+="</div>",a+="<button data-id='"+n.id+"' class='story-comments--comment--like fl btn btn-danger fa fa-heart'>"+n.likes+"</button>",r.user.reg_id!=t.getState().mUser.reg_id&&n.user.reg_id!=t.getState().mUser.reg_id||(a+="<button data-id='"+n.id+"' data-story-id='"+n.story_id+"' class='story-comments--comment--remove fl btn btn-danger fa fa-remove'></button>"),a+="<span class='story-comments--comment--time fr time' data-time='"+n.time+"'>"+Object(i.y)(n.time)+"</span>",a+="<div class='clear'></div>",a+="</div>",o.find("#story-comments-body").append(a),e.scrollToBottom(),e.registerEvents(t)}}},{key:"renderComments",value:function(t,n){var r=t.getState().stories.find((function(e){return e.id==n}));if(r)return r.comments?void r.comments.forEach((function(n){e.renderComment(t,n)})):e.fetchComments(t,n)}},{key:"fetchComments",value:function(t,n){t.getState().socket.emit("req",Object(i.k)({type:"story:comment:get",data:{id:n}}),(function(n){return"string"==typeof(n=Object(i.g)(n))?alert(n):n.error&&n.data.notFound?a.a.onRemoveStory(t,id):void(0==n.error&&n.data.comments.forEach((function(n){t.dispatch(Object(c.b)(n,!0)),e.renderComment(t,n)})))}))}},{key:"render",value:function(t,n){if(!$("#story-comments").length){var o=t.getState().stories.find((function(e){return e.id==n}));if(o){o.commentsCount=o.commentsCount?o.commentsCount:0;var i='<div id="story-comments" data-id="'+n+'">';i+='<div id="story-comments-container">',i+='<div id="story-comments-header">',i+='<span id="comments-count-wrapper" dir="rtl"><span class="comments-count">'+o.commentsCount+"</span> تعليق </span>",i+='<span class="fa fa-times" id="story-comments-close"></span>',i+="</div>",i+='<div id="story-comments-body">',i+="</div>",i+='<div id="story-comments-footer">',i+="<form class='story-comments-form'>",i+="<img class='story-comments-form--face' src='/images/smile.gif' alt='smile' id='story-comments-form--face' width='22' height='22' />",i+="<textarea id='story-comments-form--input' class='border-color story-comments-form--input' name='message' placeholder='أكتب تعليقك هنا' dir='rtl'></textarea>",i+="<button class='border-color fa fa-send btn btn-primary story-comments-form--send'>إرسال</button>",i+=r.a.render("story-comments","#story-comments-form--input",t),i+="</form>",i+="</div>",i+="</div>",i+="</div>",window.storyModal.append(i),e.setModalTop(),e.renderComments(t,n),e.registerEvents(t)}}}}],(n=null)&&f(t.prototype,n),p&&f(t,p),e}();t.a=p},function(e,t,n){"use strict";var r=n(0),o=n(14),i=n(7),a=n(1),s=n(26);function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,u;return t=e,u=[{key:"registerEvents",value:function(t){e.close(t),e.setUsers(t)}},{key:"close",value:function(e){$(".chat__body__ignored-users-pane__back button").unbind("click").on("click",(function(t){e.dispatch(Object(i.a)("others")),a.a.togglePane(e)}))}},{key:"setUsers",value:function(e){var t=$("#chat__body__ignored-users-pane .chat_pane__container");t.html(""),e.getState().users.forEach((function(n){e.getState().ignoredUsers.includes(n.id)&&t.append(s.a.render(n,!0,e))})),s.a.registerEvents(e)}},{key:"render",value:function(e){var t="<div id='chat__body__ignored-users-pane' class='chat_pane' style='background: "+Object(r.u)(e.getState().settings,!0)+"'>";return t+=o.a.render("المستخدمون المتجاهلين"),t+="<p class='chat__body__ignored-users-pane__back'>",t+="<button class='btn btn-success fa fa-arrow-left'>عودة</button>",t+="</p>",t+="<div class='chat_pane__container border'></div>",t+="</div>"}}],(n=null)&&c(t.prototype,n),u&&c(t,u),e}();t.a=u},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"SET_IS_CALL_DIALOG_OPEN",isCallDialogOpen:e}}},function(e,t,n){"use strict";var r=n(0),o=n(67),i=n(23),a=n(16),s=n(5),c=n(32);function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,d;return t=e,d=[{key:"registerEvents",value:function(t){$("#story-views, #story-views *").unbind("click").on("click",(function(n){if(n.stopPropagation(),"story-views"==n.target.id||"story-views-close"==n.target.id)return e.close(t)}))}},{key:"close",value:function(e){var t=$("#story-views");t.length&&(t.find("#story-views-container").css("top","100vh"),setTimeout((function(){t.remove()}),200),c.a.unpause(e))}},{key:"setModalTop",value:function(){var e=$("#story-views");if(e.length){var t=e.find("#story-views-container"),n=$(document).height();t.css("top",n-t.height()+"px")}}},{key:"scrollToBottom",value:function(){var e=document.getElementById("story-views-body");e&&(e.scrollTop=e.scrollHeight-e.clientHeight)}},{key:"renderView",value:function(t,n){if(!t.getState().stories.find((function(e){return e.id==n.story_id})))return"";var o=$("#story-views[data-id='"+n.story_id+"']");if(o){var i="<div class='story-views--view' data-id='"+n.id+"' >";i+="<p class='story-views--view--avatar'>",i+="<img class='radius border border-color' width='30' height='30' src='"+n.user.avatar+"' />",i+="</p>",i+="<div>",i+="<h5 class='story-views--view--title'>",i+=s.a.render(n.user),i+="</h5>",i+="</div>",i+="<span class='story-views--view--time fr time' data-time='"+n.time+"'>"+Object(r.y)(n.time)+"</span>",i+="<div class='clear'></div>",i+="</div>",o.find("#story-views-body").append(i),e.scrollToBottom(),e.registerEvents(t)}}},{key:"renderViews",value:function(t,n){var r=t.getState().stories.find((function(e){return e.id==n}));if(r)return r.views?void r.views.forEach((function(n){e.renderView(t,n)})):e.fetchViews(t,n)}},{key:"incStoryViewsCount",value:function(e){if(window.storyModal){var t=window.storyModal.find(".story-reactions[data-id='"+e+"'] .views_wrapper .views");if(t&&t.length){var n=+t.text()+1;n||(function(e){throw new TypeError('"'+e+'" is read-only')}("text"),n=0),t.text(n),$("#story-views[data-id='"+e+"'] #views-count-wrapper .views-count").text(n)}}}},{key:"fetchViews",value:function(t,n){t.getState().socket.emit("req",Object(r.k)({type:"story:view:get",data:{id:n}}),(function(n){return"string"==typeof(n=Object(r.g)(n))?alert(n):n.error&&n.data.notFound?a.a.onRemoveStory(t,id):void(0==n.error&&n.data.views.forEach((function(n){t.dispatch(Object(i.c)(n,!0)),e.renderView(t,n)})))}))}},{key:"viewStory",value:function(e,t){if(!(e.getState().viewedStories&&e.getState().viewedStories.indexOf(t)>=0)){var n=e.getState().stories.find((function(e){return e.id==t}));n&&n.user_id!=e.getState().mUser.reg_id&&e.getState().socket.emit("req",Object(r.k)({type:"story:view",data:{id:t}}),(function(n){e.dispatch(Object(o.a)(t))}))}}},{key:"render",value:function(t,n){if(!$("#story-views").length){var r=t.getState().stories.find((function(e){return e.id==n}));if(r){r.viewsCount=r.viewsCount?r.viewsCount:0;var o='<div id="story-views" data-id="'+n+'">';o+='<div id="story-views-container">',o+='<div id="story-views-header">',o+='<span id="views-count-wrapper" dir="rtl"><span class="view-count">'+r.viewsCount+"</span> مشاهدة </span>",o+='<span class="fa fa-times" id="story-views-close"></span>',o+="</div>",o+='<div id="story-views-body">',o+="</div>",o+="</div>",o+="</div>",window.storyModal.append(o),e.setModalTop(),e.renderViews(t,n),e.registerEvents(t)}}}}],(n=null)&&u(t.prototype,n),d&&u(t,d),e}();t.a=d},function(e,t,n){"use strict";var r=n(0),o=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"SET_IS_TV_BOX_OPEN",isTvBoxOpen:e}};function i(e){"touchstart"===e.type?(window.tvInitialX=e.touches[0].clientX-window.tvXOffset,window.tvInitialY=e.touches[0].clientY-window.tvYOffset):(window.tvInitialX=e.clientX-window.tvXOffset,window.tvInitialY=e.clientY-window.tvYOffset);var t=document.querySelector("#tv_box__header"),n=document.querySelector("#tv_box__title"),r=document.querySelector("#tv_box__body");e.target!==t&&e.target!==n&&e.target!==r||(window.tvDragActive=!0)}function a(e){window.tvInitialX=window.tvCurrentX,window.tvInitialY=window.tvCurrentY,window.tvDragActive=!1}function s(e){var t,n;window.tvDragActive&&(e.preventDefault(),"touchmove"===e.type?(window.tvCurrentX=e.touches[0].clientX-window.tvInitialX,window.tvCurrentY=e.touches[0].clientY-window.tvInitialY):(window.tvCurrentX=e.clientX-window.tvInitialX,window.tvCurrentY=e.clientY-window.tvInitialY),window.tvXOffset=window.tvCurrentX,window.tvYOffset=window.tvCurrentY,t=window.tvCurrentX,n=window.tvCurrentY,document.querySelector("#tv_box").style.transform="translate3d("+t+"px, "+n+"px, 0)")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"register",value:function(){var e=document.querySelector("#chat");window.tvDragActive=!1,window.tvXOffset=window.tvXOffset?window.tvXOffset:0,window.tvYOffset=window.tvYOffset?window.tvYOffset:0,e.addEventListener("touchstart",i,!1),e.addEventListener("touchend",a,!1),e.addEventListener("touchmove",s,!1),e.addEventListener("mousedown",i,!1),e.addEventListener("mouseup",a,!1),e.addEventListener("mousemove",s,!1)}},{key:"unregister",value:function(){var e=document.querySelector("#chat");e.removeEventListener("touchstart",i,!1),e.removeEventListener("touchend",a,!1),e.removeEventListener("touchmove",s,!1),e.removeEventListener("mousedown",i,!1),e.removeEventListener("mouseup",a,!1),e.removeEventListener("mousemove",s,!1)}}],(n=null)&&c(t.prototype,n),r&&c(t,r),e}();function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"registerEvents",value:function(t){e.onClose(t)}},{key:"onClose",value:function(t){$("#tv_box__close").unbind().on("click",(function(n){e.close(t)}))}},{key:"close",value:function(e){e.dispatch(o(!1)),u.unregister(),$("#tv_box").html("")}},{key:"open",value:function(t){t.getState().isTvBoxOpen||($("#tv_box").html(e.render(t)),t.dispatch(o(!0)),e.onClose(t),u.register())}},{key:"update",value:function(t){var n=t.getState().settings.tv_box_title?t.getState().settings.tv_box_title:"",r=e.parseURL(t.getState().settings.tv_box_url);$("#tv_box__title").text(n),$("#tv_box__body iframe").attr("src")!=r&&$("#tv_box__body iframe").attr("src",r)}},{key:"parseURL",value:function(e){if(!e)return"";var t=Object(r.o)(e);return t?"https://www.youtube.com/embed/"+t+"?playsinline=1":e}},{key:"render",value:function(t){var n="<div>";return n+="<header id='tv_box__header' class='label label-primary'>",n+="<span id='tv_box__title'>"+(t.getState().settings.tv_box_title?t.getState().settings.tv_box_title:"")+"</span>",n+="<button id='tv_box__close' class='fa fa-close btn btn-danger'></button>",n+="</header>",n+="<div id='tv_box__body' class='fl'>",n+="<iframe src='"+e.parseURL(t.getState().settings.tv_box_url)+"' frameborder='0' allow='accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture' ></iframe>",n+="</div>",n+="</div>"}}],(n=null)&&d(t.prototype,n),i&&d(t,i),e}();t.a=l},function(e,t,n){var r=n(161),o=n(162),i=o;i.v1=r,i.v4=o,e.exports=i},function(e,t,n){"use strict";var r=n(1),o=n(15),i=n(39);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,s;return t=e,s=[{key:"registerEvents",value:function(t){e.ignore(t),e.unignore(t)}},{key:"ignore",value:function(e){$("#user_profile__footer__actions__item--ignore").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().ignoredUsers.includes(n)||(e.dispatch(function(e){return{type:"IGNORE_USER",id:e}}(n)),$("#user_profile__footer__actions__item--ignore").closest(".user_profile__footer__actions__item").addClass("ignored"),r.a.updateUsersCout(e),o.a.setUsers(e),i.a.setUsers(e))}))}},{key:"unignore",value:function(e){$("#user_profile__footer__actions__item--unignore").unbind("click").click("click",(function(t){var n=e.getState().requestedUser.id;e.getState().ignoredUsers.includes(n)&&(e.dispatch(function(e){return{type:"UNIGNORE_USER",id:e}}(n)),$("#user_profile__footer__actions__item--ignore").closest(".user_profile__footer__actions__item").removeClass("ignored"),r.a.updateUsersCout(e),o.a.setUsers(e),i.a.setUsers(e))}))}},{key:"isUserIgnored",value:function(e,t){return t.reg_id?e.getState().ignoredUsers.filter((function(e){return e.reg_id==t.reg_id})).length>0:e.getState().ignoredUsers.filter((function(e){return e.id==t.id})).length>0}},{key:"render",value:function(e){var t=e.getState().requestedUser.id,n="<span class='user_profile__footer__actions__item "+(e.getState().ignoredUsers.includes(t)?"ignored":"")+"'>";return n+="<button id='user_profile__footer__actions__item--ignore' class='btn btn-default fa fa-ban red'>تجاهل</button>",n+="<button id='user_profile__footer__actions__item--unignore' class='btn btn-default fa fa-ban red'>إلغاء التجاهل</button>",n+="</span>"}}],(n=null)&&a(t.prototype,n),s&&a(t,s),e}();t.a=s},function(e,t,n){var r,o,i,a,s,c,u,d;e.exports=(d=n(8),n(71),n(72),o=(r=d).lib,i=o.Base,a=o.WordArray,s=r.algo,c=s.MD5,u=s.EvpKDF=i.extend({cfg:i.extend({keySize:4,hasher:c,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,r=n.hasher.create(),o=a.create(),i=o.words,s=n.keySize,c=n.iterations;i.length<s;){u&&r.update(u);var u=r.update(e).finalize(t);r.reset();for(var d=1;d<c;d++)u=r.finalize(u),r.reset();o.concat(u)}return o.sigBytes=4*s,o}}),r.EvpKDF=function(e,t,n){return u.create(n).compute(e,t)},d.EvpKDF)},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"SET_LIKED_STORIES",likedStories:e}},o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:"ADD_LIKED_STORY",id:e}},i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:"REMOVE_LIKED_STORY",id:e}}},function(e,t,n){"use strict";var r=n(0),o=n(5),i=n(9),a=n(24);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,c;return t=e,c=[{key:"registerEvents",value:function(t){e.getProfile(t),e.photoClicked(),e.youtubeVideoClicked()}},{key:"updateUser",value:function(e,t){if(t.getState().currentConversation){var n=t.getState().users.filter((function(t){return t.id==e}))[0];if(n){var r=$(".private_message[data-user-id='"+e+"']");r&&(r.find(".private_message__avatar img").attr("src",n.avatar),r.find(".private_message__title").html(o.a.render(n)),r.find(".private_message__body").css("color",n.fontColor))}}}},{key:"getProfile",value:function(e){$("#chat_box .private_message .private_message__avatar img").unbind("click").on("click",(function(t){var n=$(this).closest(".private_message").data("user-id");a.a.show(n,e)}))}},{key:"getBaseDir",value:function(){return"/uploads/private/"}},{key:"photoClicked",value:function(){$(".private_message__body__image").unbind("click").on("click",(function(e){e.stopPropagation(),window.open($(this).attr("src"),"_blank").focus()}))}},{key:"youtubeVideoClicked",value:function(){$(".private_message .yt-btn").unbind("click").on("click",(function(e){e.stopPropagation();try{var t=$(this).data("msg-id"),n="https://www.youtube.com/embed/"+$(this).data("yid")+"?autoplay=1&playsinline=1",r=document.getElementById("yt-btn-"+t);r&&(r.insertAdjacentHTML("afterend",'<iframe width="95%" style="max-width:240px;" height="200" src="'+n+'" frameborder="0"></iframe><br />'),r.remove())}catch(e){}}))}},{key:"renderMessageBody",value:function(t,n){switch(t.type){case"text":return i.a.render(t.body,n);case"photo":return"<img src='"+e.getBaseDir()+t.body+"' alt='' class='private_message__body__image private_message__body__media' />";case"sound":return"<audio controls class='private_message__body__media'><source src='"+e.getBaseDir()+t.body+"' /></audio>";case"video":return"<video controls class='private_message__body__media'><source src='"+e.getBaseDir()+t.body+"' /></video>";case"youtube":return"<button id='yt-btn-"+t.id+"' class='yt-btn' data-msg-id='"+t.id+"' data-yid='"+t.body+"'><img style='width: 80px' alt='[YouTube]' src='https://img.youtube.com/vi/"+t.body+"/0.jpg' /></button>";default:return""}}},{key:"render",value:function(t,n,i){var a="<div class='private_message "+(n.id==i.getState().mUser.id?"mine":"")+" "+(t.read?"read":"")+" linen' data-user-id='"+n.id+"'>";return a+="<p class='private_message__avatar'><img class='radius' width='28' height='28' src='"+n.avatar+"' /></p>",a+="<div>",a+="<h5 class='private_message__title'>",a+=o.a.render(n),a+="</h5>",a+="<h5 class='private_message__body' style='color: "+n.fontColor+"'>",a+=e.renderMessageBody(t,i),a+="</h5>",a+="</div>",a+="<img class='private_message__check' src='/images/tick.png' />",a+="<img class='private_message__dbl_check' src='/images/tick.png' />",a+="<span class='private_message__time fr time' data-time='"+t.time+"'>"+Object(r.y)(t.time)+"</span>",a+="<div class='clear'></div>",a+="</div>"}}],(n=null)&&s(t.prototype,n),c&&s(t,c),e}();t.a=c},function(e,t,n){var r,o,i;e.exports=(i=n(8),o=(r=i).lib.WordArray,r.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var o=[],i=0;i<n;i+=3)for(var a=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;s<4&&i+.75*s<n;s++)o.push(r.charAt(a>>>6*(3-s)&63));var c=r.charAt(64);if(c)for(;o.length%4;)o.push(c);return o.join("")},parse:function(e){var t=e.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var i=0;i<n.length;i++)r[n.charCodeAt(i)]=i}var a=n.charAt(64);if(a){var s=e.indexOf(a);-1!==s&&(t=s)}return function(e,t,n){for(var r=[],i=0,a=0;a<t;a++)if(a%4){var s=n[e.charCodeAt(a-1)]<<a%4*2,c=n[e.charCodeAt(a)]>>>6-a%4*2;r[i>>>2]|=(s|c)<<24-i%4*8,i++}return o.create(r,i)}(e,t,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},i.enc.Base64)},function(e,t,n){var r;e.exports=(r=n(8),function(e){var t=r,n=t.lib,o=n.WordArray,i=n.Hasher,a=t.algo,s=[];!function(){for(var t=0;t<64;t++)s[t]=4294967296*e.abs(e.sin(t+1))|0}();var c=a.MD5=i.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,o=e[r];e[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var i=this._hash.words,a=e[t+0],c=e[t+1],p=e[t+2],m=e[t+3],h=e[t+4],_=e[t+5],g=e[t+6],v=e[t+7],y=e[t+8],b=e[t+9],w=e[t+10],S=e[t+11],k=e[t+12],C=e[t+13],E=e[t+14],T=e[t+15],O=i[0],P=i[1],A=i[2],R=i[3];O=u(O,P,A,R,a,7,s[0]),R=u(R,O,P,A,c,12,s[1]),A=u(A,R,O,P,p,17,s[2]),P=u(P,A,R,O,m,22,s[3]),O=u(O,P,A,R,h,7,s[4]),R=u(R,O,P,A,_,12,s[5]),A=u(A,R,O,P,g,17,s[6]),P=u(P,A,R,O,v,22,s[7]),O=u(O,P,A,R,y,7,s[8]),R=u(R,O,P,A,b,12,s[9]),A=u(A,R,O,P,w,17,s[10]),P=u(P,A,R,O,S,22,s[11]),O=u(O,P,A,R,k,7,s[12]),R=u(R,O,P,A,C,12,s[13]),A=u(A,R,O,P,E,17,s[14]),O=d(O,P=u(P,A,R,O,T,22,s[15]),A,R,c,5,s[16]),R=d(R,O,P,A,g,9,s[17]),A=d(A,R,O,P,S,14,s[18]),P=d(P,A,R,O,a,20,s[19]),O=d(O,P,A,R,_,5,s[20]),R=d(R,O,P,A,w,9,s[21]),A=d(A,R,O,P,T,14,s[22]),P=d(P,A,R,O,h,20,s[23]),O=d(O,P,A,R,b,5,s[24]),R=d(R,O,P,A,E,9,s[25]),A=d(A,R,O,P,m,14,s[26]),P=d(P,A,R,O,y,20,s[27]),O=d(O,P,A,R,C,5,s[28]),R=d(R,O,P,A,p,9,s[29]),A=d(A,R,O,P,v,14,s[30]),O=l(O,P=d(P,A,R,O,k,20,s[31]),A,R,_,4,s[32]),R=l(R,O,P,A,y,11,s[33]),A=l(A,R,O,P,S,16,s[34]),P=l(P,A,R,O,E,23,s[35]),O=l(O,P,A,R,c,4,s[36]),R=l(R,O,P,A,h,11,s[37]),A=l(A,R,O,P,v,16,s[38]),P=l(P,A,R,O,w,23,s[39]),O=l(O,P,A,R,C,4,s[40]),R=l(R,O,P,A,a,11,s[41]),A=l(A,R,O,P,m,16,s[42]),P=l(P,A,R,O,g,23,s[43]),O=l(O,P,A,R,b,4,s[44]),R=l(R,O,P,A,k,11,s[45]),A=l(A,R,O,P,T,16,s[46]),O=f(O,P=l(P,A,R,O,p,23,s[47]),A,R,a,6,s[48]),R=f(R,O,P,A,v,10,s[49]),A=f(A,R,O,P,E,15,s[50]),P=f(P,A,R,O,_,21,s[51]),O=f(O,P,A,R,k,6,s[52]),R=f(R,O,P,A,m,10,s[53]),A=f(A,R,O,P,w,15,s[54]),P=f(P,A,R,O,c,21,s[55]),O=f(O,P,A,R,y,6,s[56]),R=f(R,O,P,A,T,10,s[57]),A=f(A,R,O,P,g,15,s[58]),P=f(P,A,R,O,C,21,s[59]),O=f(O,P,A,R,h,6,s[60]),R=f(R,O,P,A,S,10,s[61]),A=f(A,R,O,P,p,15,s[62]),P=f(P,A,R,O,b,21,s[63]),i[0]=i[0]+O|0,i[1]=i[1]+P|0,i[2]=i[2]+A|0,i[3]=i[3]+R|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var i=e.floor(r/4294967296),a=r;n[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(o+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),t.sigBytes=4*(n.length+1),this._process();for(var s=this._hash,c=s.words,u=0;u<4;u++){var d=c[u];c[u]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8)}return s},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function u(e,t,n,r,o,i,a){var s=e+(t&n|~t&r)+o+a;return(s<<i|s>>>32-i)+t}function d(e,t,n,r,o,i,a){var s=e+(t&r|n&~r)+o+a;return(s<<i|s>>>32-i)+t}function l(e,t,n,r,o,i,a){var s=e+(t^n^r)+o+a;return(s<<i|s>>>32-i)+t}function f(e,t,n,r,o,i,a){var s=e+(n^(t|~r))+o+a;return(s<<i|s>>>32-i)+t}t.MD5=i._createHelper(c),t.HmacMD5=i._createHmacHelper(c)}(Math),r.MD5)},function(e,t,n){var r,o=n(175),i=n(96),a=n(177),s=n(178),c=n(179);"undefined"!=typeof ArrayBuffer&&(r=n(180));var u="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),d="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),l=u||d;t.protocol=3;var f=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},p=o(f),m={type:"error",data:"parser error"},h=n(181);function _(e,t,n){for(var r=new Array(e.length),o=s(e.length,n),i=function(e,n,o){t(n,(function(t,n){r[e]=n,o(t,r)}))},a=0;a<e.length;a++)i(a,e[a],o)}t.encodePacket=function(e,n,r,o){"function"==typeof n&&(o=n,n=!1),"function"==typeof r&&(o=r,r=null);var i=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!=typeof ArrayBuffer&&i instanceof ArrayBuffer)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=e.data,i=new Uint8Array(o),a=new Uint8Array(1+o.byteLength);a[0]=f[e.type];for(var s=0;s<i.length;s++)a[s+1]=i[s];return r(a.buffer)}(e,n,o);if(void 0!==h&&i instanceof h)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(l)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=new FileReader;return o.onload=function(){t.encodePacket({type:e.type,data:o.result},n,!0,r)},o.readAsArrayBuffer(e.data)}(e,n,r);var o=new Uint8Array(1);o[0]=f[e.type];var i=new h([o.buffer,e.data]);return r(i)}(e,n,o);if(i&&i.base64)return function(e,n){var r="b"+t.packets[e.type]+e.data.data;return n(r)}(e,o);var a=f[e.type];return void 0!==e.data&&(a+=r?c.encode(String(e.data),{strict:!1}):String(e.data)),o(""+a)},t.encodeBase64Packet=function(e,n){var r,o="b"+t.packets[e.type];if(void 0!==h&&e.data instanceof h){var i=new FileReader;return i.onload=function(){var e=i.result.split(",")[1];n(o+e)},i.readAsDataURL(e.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var a=new Uint8Array(e.data),s=new Array(a.length),c=0;c<a.length;c++)s[c]=a[c];r=String.fromCharCode.apply(null,s)}return o+=btoa(r),n(o)},t.decodePacket=function(e,n,r){if(void 0===e)return m;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(r&&!1===(e=function(e){try{e=c.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return m;var o=e.charAt(0);return Number(o)==o&&p[o]?e.length>1?{type:p[o],data:e.substring(1)}:{type:p[o]}:m}o=new Uint8Array(e)[0];var i=a(e,1);return h&&"blob"===n&&(i=new h([i])),{type:p[o],data:i}},t.decodeBase64Packet=function(e,t){var n=p[e.charAt(0)];if(!r)return{type:n,data:{base64:!0,data:e.substr(1)}};var o=r.decode(e.substr(1));return"blob"===t&&h&&(o=new h([o])),{type:n,data:o}},t.encodePayload=function(e,n,r){"function"==typeof n&&(r=n,n=null);var o=i(e);if(n&&o)return h&&!l?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r);if(!e.length)return r("0:");_(e,(function(e,r){t.encodePacket(e,!!o&&n,!1,(function(e){r(null,function(e){return e.length+":"+e}(e))}))}),(function(e,t){return r(t.join(""))}))},t.decodePayload=function(e,n,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,r);var o;if("function"==typeof n&&(r=n,n=null),""===e)return r(m,0,1);for(var i,a,s="",c=0,u=e.length;c<u;c++){var d=e.charAt(c);if(":"===d){if(""===s||s!=(i=Number(s)))return r(m,0,1);if(s!=(a=e.substr(c+1,i)).length)return r(m,0,1);if(a.length){if(o=t.decodePacket(a,n,!1),m.type===o.type&&m.data===o.data)return r(m,0,1);if(!1===r(o,c+i,u))return}c+=i,s=""}else s+=d}return""!==s?r(m,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){if(!e.length)return n(new ArrayBuffer(0));_(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){return n(null,e)}))}),(function(e,t){var r=t.reduce((function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2}),0),o=new Uint8Array(r),i=0;return t.forEach((function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),a=0;a<e.length;a++)r[a]=e.charCodeAt(a);n=r.buffer}o[i++]=t?0:1;var s=n.byteLength.toString();for(a=0;a<s.length;a++)o[i++]=parseInt(s[a]);o[i++]=255;for(r=new Uint8Array(n),a=0;a<r.length;a++)o[i++]=r[a]})),n(o.buffer)}))},t.encodePayloadAsBlob=function(e,n){_(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);e=r.buffer,t[0]=0}var i=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),a=new Uint8Array(i.length+1);for(o=0;o<i.length;o++)a[o]=parseInt(i[o]);if(a[i.length]=255,h){var s=new h([t.buffer,a.buffer,e]);n(null,s)}}))}),(function(e,t){return n(new h(t))}))},t.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var o=e,i=[];o.byteLength>0;){for(var s=new Uint8Array(o),c=0===s[0],u="",d=1;255!==s[d];d++){if(u.length>310)return r(m,0,1);u+=s[d]}o=a(o,2+u.length),u=parseInt(u);var l=a(o,0,u);if(c)try{l=String.fromCharCode.apply(null,new Uint8Array(l))}catch(e){var f=new Uint8Array(l);l="";for(d=0;d<f.length;d++)l+=String.fromCharCode(f[d])}i.push(l),o=a(o,u)}var p=i.length;i.forEach((function(e,o){r(t.decodePacket(e,n,!0),o,p)}))}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"UPDATE_PUBLIC_MESSAGE_USER",user:e}},o=function(){return{type:"CLEAR_ALL_PUBLIC_MESSAGES"}}},function(e,t,n){"use strict";var r=n(12),o=n.n(r),i=n(2),a=n(3),s=n(28),c=n(4);function u(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r,l,f;return t=e,n=null,r=[{key:"handleEvents",value:function(t,n){switch(t.type){case"mic:new_speaker":return e.newSpeaker(n,t.data);case"mic:leave":return e.leave(n,t.data);case"mic:pull":return e.pull(n,t.data);case"mic:transport:created":return e.transportCreated(n,t.data);case"mic:transport:conncted":return e.transportConnected(n,t.data);case"mic:transport:produced":return e.transportProduced(n,t.data);case"mic:transport:consumed":return e.transportConsumed(n,t.data);case"mic:transport:resumed":return e.transportResumed(n,t.data);case"mic:producer:new":return e.newProducer(n,t.data);case"mic:media:volume":return e.setMediaVolume(n,t.data);default:return null}}},{key:"newSpeaker",value:function(e,t){var n=e.getState().users.find((function(e){return e.id==t.user}));if(n){var r=e.getState().rooms.find((function(e){return e.id==t.room}));r&&(r.micUsers.push({micId:t.micId,user_id:t.user}),e.getState().mUser.room&&e.getState().mUser.room.id==t.room&&i.a.setUserOnMic(e,n,t.micId))}}},{key:"leave",value:function(e,t,n){var r=n||e.getState().users.find((function(e){return e.id==t.user}));i.a.removeUserFromMic(e,r)}},{key:"pull",value:function(e,t){var n=e.getState().users.find((function(e){return e.id==t.user}));if(i.a.removeUserFromMic(e,n),t.by){var r=e.getState().users.find((function(e){return e.id==t.by}));if(r&&r.id!=e.getState().mUser.id&&n.id==e.getState().mUser.id){var o={id:Date.now(),user:r,message:"قام بسحب المايك منك",title:"سحب مايك",type:void 0};e.dispatch(Object(c.a)(o)),a.a.render(o,e)}}}},{key:"transportCreated",value:(l=o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.ms_create_recv_transport_interval){e.next=2;break}return e.abrupt("return");case 2:window.ms_create_recv_transport_interval=setInterval((function(){window.MSDevice&&window.MSDevice.loaded&&window.ms_create_recv_transport_interval&&(i.a.msCreateTransport(t,n),clearInterval(window.ms_create_recv_transport_interval),delete window.ms_create_recv_transport_interval)}),200);case 3:case"end":return e.stop()}}),e)})),f=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=l.apply(e,t);function i(e){u(o,n,r,i,a,"next",e)}function a(e){u(o,n,r,i,a,"throw",e)}i(void 0)}))},function(e,t){return f.apply(this,arguments)})},{key:"transportConnected",value:function(e,t){window.transportConnectCallback&&(window.transportConnectCallback(),delete window.transportConnectCallback)}},{key:"transportProduced",value:function(e,t){window.transportProduceCallback&&(window.transportProduceCallback({id:t.id}),delete window.transportProduceCallback,e.unoGame&&s.a.setMicOn(e,t.user))}},{key:"transportConsumed",value:function(e,t){i.a.msConsume(e,t)}},{key:"transportResumed",value:function(e,t){}},{key:"newProducer",value:function(e,t){i.a.consumeProducer(e,t.id,t.micId),e.unoGame&&s.a.setMicOn(e,t.user)}},{key:"setMediaVolume",value:function(e,t){i.a.setMediaVolume(e,t.volume,t.micId)}}],n&&d(t.prototype,n),r&&d(t,r),e}();t.a=l},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:"SET_CURRENT_CALL",currentCall:e}}},function(e,t,n){"use strict";var r=n(40),o=n(0),i=n(20);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,s;return t=e,s=[{key:"registerEvents",value:function(t){e.onHide(t),e.onCancel(t),e.onAccept(t),window.peer.on("call",(function(e){window.incomingCall=e,window.incomingCall.on("close",(function(){window.incomingCall=null}))}))}},{key:"close",value:function(){$("#call_container").html("");try{window.incomingCall&&(window.incomingCall.close(),window.incomingCall=null)}catch(e){}try{window.outgoinCall&&(window.outgoinCall.close(),window.outgoinCall=null)}catch(e){}window.outgoinStream=null,window.callsAudio.src=null,window.callsAudio.srcObject=null}},{key:"onHide",value:function(e){$("#call-dialog-footer__hide").unbind("click").on("click",(function(t){e.dispatch(Object(r.a)(!1)),$("#call-dialog").hide()}))}},{key:"onAccept",value:function(t){$("#call-dialog-footer__accept").unbind("click").on("click",(function(n){t.getState().socket.emit("req",Object(o.k)({type:"CALL_REQUEST_ACCEPT",data:{id:t.getState().currentCall.user.id}}),(function(n){e.acceptCall(t,t.getState().currentCall.user),$("#call-dialog-footer__accept, #call-dialog__status").hide(),$("#call-dialog__status_start_call").show()}))}))}},{key:"onCallAccepted",value:function(){$("#call-dialog__status").hide(),$("#call-dialog__status_start_call").show()}},{key:"onCancel",value:function(t){$("#call-dialog-footer__cancel").unbind("click").on("click",(function(n){t.getState().socket.emit("req",Object(o.k)({type:"CALL_REQUEST_CANCEL",data:{id:t.getState().currentCall.user.id}}),(function(n){e.cancelCall(t),e.close(),t.dispatch(Object(r.a)(!1))}))}))}},{key:"acceptCall",value:function(e,t){navigator.mediaDevices.getUserMedia({audio:!0}).then((function(e){window.incomingCall.answer(e),window.incomingCall.on("stream",(function(e){i.a.playStream(e)}))}),(function(e){alert(e.stack),console.log("Failed to get local stream",e)}))}},{key:"cancelCall",value:function(t){t.getState().webrtc&&(t.getState().webrtc.leaveRoom(),t.getState().webrtc.stopLocalVideo(),e.close())}},{key:"render",value:function(t,n){var r="<div id='call-dialog' style='display: "+(t.getState().isCallDialogOpen?"block":"none")+"'>";r+="<p class='target-user-name'>"+n.user.username+"</p>",r+="<img class='target-user-avatar' src='"+n.user.avatar+"' alt='' />",r+="<p id='call-dialog__status_start_call' class='call-status success'>بدأ المكالمة</p>",r+="<p id='call-dialog__status' class='call-status "+n.statusClass+"'>"+n.status+"</p>",r+="<p class='call-dialog-footer'>",r+="<button id='call-dialog-footer__cancel' class='btn btn-danger call-cancel'><i class='fa fa-phone'></i>إلغاء</button>","call-received"==n.dialogType&&(r+="<button id='call-dialog-footer__accept' class='btn btn-success call-accept'><i class='fa fa-phone'></i>قبول</button>"),r+="<button id='call-dialog-footer__hide' class='btn btn-warning pull-right call-dialog-hide'><i class='fa fa-minus'></i>إخفاء</button>",r+="</p>",r+="</div>",$("#call_container").append(r),e.registerEvents(t)}}],(n=null)&&a(t.prototype,n),s&&a(t,s),e}();t.a=s},function(e,t,n){"use strict";var r=n(33),o=n(18),i=n(68),a=n(0),s=n(5),c=n(9);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,l;return t=e,l=[{key:"registerEvents",value:function(t){e.sendComment(t),e.openFacePicker(t),e.onRemove(t),e.onLike(t)}},{key:"openFacePicker",value:function(e){$("#wall_comments__attach__face").unbind("click").on("click",(function(t){e.dispatch(Object(i.a)(!0)),o.a.onSelect()}))}},{key:"onRemove",value:function(e){$("#wall_comments .wall_comments__comment__remove").unbind("click").on("click",(function(t){var n=t.target.dataset.id,r=t.target.dataset.postId;e.getState().socket.emit("req",Object(a.k)({type:"WALL_POST_COMMENT_REMOVE",data:{id:n,postId:r}}),(function(e){if("string"==typeof(e=Object(a.g)(e)))return alert(e)}))}))}},{key:"onLike",value:function(t){$("#wall_comments .wall_comments__comment__like").unbind("click").on("click",(function(n){var r=n.target.dataset.id;t.getState().socket.emit("req",Object(a.k)({type:"WALL_POST_COMMENT_LIKE",data:{id:r}}),(function(t){if("string"==typeof(t=Object(a.g)(t)))return alert(t);"object"==u(t)&&!1===t.error&&e.incCommentLikes(r)}))}))}},{key:"incCommentLikes",value:function(e){var t=$("#wall_comments .wall_comments__comment[data-id='"+e+"'] .wall_comments__comment__like").text();t=parseInt(t)+1,$("#wall_comments .wall_comments__comment[data-id='"+e+"'] .wall_comments__comment__like").text(t)}},{key:"scrollToBottom",value:function(){var e=document.getElementById("wall_comments__scroll_area");e&&(e.scrollTop=e.scrollHeight-e.clientHeight)}},{key:"setComments",value:function(t,n){var r=$("#wall_comments .wall_comments__body");r.html(""),t.forEach((function(t){r.append(e.renderPostComment(t,n))})),setTimeout((function(){e.scrollToBottom(),e.registerEvents(n)}),500)}},{key:"renderPostComment",value:function(e,t){var n=t.getState().posts.filter((function(t){return t.id==e.postId}))[0],r="<div class='wall_comments__comment' data-id='"+e.id+"' >";return r+="<p class='wall_comments__comment__avatar'>",r+="<img class='radius border border-color' width='30' height='30' src='"+e.user.avatar+"' />",r+="</p>",r+="<div>",r+="<h5 class='wall_comments__comment__title'>",r+=s.a.render(e.user),r+="</h5>",r+="<h5 class='wall_comments__comment__content'>",r+=c.a.render(e.comment,t),r+="</h5>",r+="</div>",r+="<button data-id='"+e.id+"' class='wall_comments__comment__like fl btn btn-danger fa fa-heart'>"+e.likes+"</button>",n.user.reg_id!=t.getState().mUser.reg_id&&e.user.reg_id!=t.getState().mUser.reg_id||(r+="<button data-id='"+e.id+"' data-post-id='"+e.postId+"' class='wall_comments__comment__remove fl btn btn-danger fa fa-remove'></button>"),r+="<span class='wall_comments__comment__time fr time' data-time='"+e.time+"'>"+Object(a.y)(e.time)+"</span>",r+="<div class='clear'></div>",r+="</div>"}},{key:"sendComment",value:function(e){$("#wall_comments form").unbind("submit").on("submit",(function(t){t.preventDefault();var n=$(this).data("post-id"),r=t.target.comment,o=r.value.trim();o&&"disabled"!=$("#wall_comments__form__submit").attr("disabled")&&($("#wall_comments__form__submit").attr("disabled","disabled"),e.getState().socket.emit("req",Object(a.k)({type:"ADD_WALL_POST_COMMENT",data:{post_id:n,text:o}}),(function(e){if($("#wall_comments__form__submit").removeAttr("disabled"),r&&(r.value=""),"string"==typeof(e=Object(a.g)(e)))return alert(e)})))}))}},{key:"getPostComments",value:function(t,n){n.getState().socket.emit("req",Object(a.k)({type:"WALL_GET_POST_COMMENTS",data:{post_id:t.id}}),(function(t){e.setComments(Object(a.g)(t),n)}))}},{key:"add",value:function(t,n){var r=$("#wall_comments");r&&r.hasClass("show")&&n.getState().wallCommentsPost&&n.getState().wallCommentsPost.id==t.postId&&($("#wall_comments .wall_comments__body").append(e.renderPostComment(t,n)),e.scrollToBottom(),e.registerEvents(n))}},{key:"remove",value:function(e){$("#wall_comments").hasClass("show")&&$("#wall_comments .wall_comments__comment[data-id='"+e+"']").remove()}},{key:"render",value:function(t,n){var i="<div class='modal fade' id='wall_comments' tabindex='-1' role='dialog' aria-hidden='true'>";i+="<div class='modal-dialog' role='document' style='max-width: 345px'>",i+="<div class='modal-content'>",i+="<div class='wall_comments__header modal-header label label-primary'>",i+="<div class='modal-title'>",i+="<img class='wall_comments__header__avatar' width='25' height='25' src='"+t.user.avatar+"' alt=''/>",i+="<p class='wall_comments__header__name ellipsis'>",i+=t.user.icon?"<img src='"+t.user.icon+"' class='username__icon fl' style='max-height: 16px' />":"",i+="<span style='vertical-align: middle; font-size: 0.7rem; display: inline-block; margin-left: 2px'>"+t.user.name+"</span>",i+="</p>",i+="<button data-dismiss='modal' class='btn btn-danger wall_comments__header__close'>&times;</button>",i+="</div><div class='clear'></div>",i+="</div>",i+="<div class='wall_comments__post_body_area'>",i+="<h5 style='color: "+t.user.fontColor+"' class='wall_post__body'>",i+=r.a.renderPostBody(t,n),i+="</h5>",i+="</div>",i+="<div class='wall_comments__scroll_area' id='wall_comments__scroll_area'>",i+="<div class='wall_comments__body modal-body'></div>",i+="</div>",i+="<form class='wall_comments__form' data-post-id='"+t.id+"'>",i+="<img class='wall_comments__form__face' src='/images/smile.gif' alt='smile' id='wall_comments__attach__face' width='22' height='22'/>",i+="<input type='text' id='wall_comments__form__input' class='border-color wall_comments__form__input' name='comment' placeholder='أكتب تعليقك هنا' autoComplete='off' dir='rtl'/>",i+="<button id='wall_comments__form__submit' class='border-color fa fa-send btn btn-primary wall_comments__form__send'>إرسال</button>",i+=o.a.render("wall-comments","#wall_comments__form__input",n),i+="</form>",i+="</div>",i+="</div>",i+="</div>",$("#wall_comments_container").html(i),e.getPostComments(t,n),e.registerEvents(n)}}],(n=null)&&d(t.prototype,n),l&&d(t,l),e}();t.a=l},function(e,t,n){(function(r){function o(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}(t=e.exports=n(165)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))})),e.splice(i,0,r)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=o,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(o())}).call(this,n(74))},function(e,t,n){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var r=0,o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t);return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){"use strict";var r=n(0),o=n(16),i=n(38),a=n(32),s=n(41);function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,u;return t=e,u=[{key:"registerEvents",value:function(t){e.onLike(t),e.onComment(t),e.onView(t)}},{key:"onLike",value:function(t){window.storyModal&&window.storyModal.find(".likes_wrapper .fa").unbind("click").on("click",(function(n){n.stopPropagation();var r=$(this).closest(".item");r&&r.length&&e.likeStory(t,r.data("id"),$(this))}))}},{key:"onComment",value:function(t){window.storyModal&&window.storyModal.find(".comments_wrapper .fa").unbind("click").on("click",(function(n){n.stopPropagation();var r=$(this).closest(".item");r&&r.length&&e.commentStory(t,r.data("id"))}))}},{key:"onView",value:function(t){window.storyModal&&window.storyModal.find(".views_wrapper .fa").unbind("click").on("click",(function(n){n.stopPropagation();var r=$(this).closest(".item");r&&r.length&&e.viewStory(t,r.data("id"))}))}},{key:"likeStory",value:function(e,t,n){window.storyModal&&e.getState().socket.emit("req",Object(r.k)({type:"story:like",data:{id:t}}),(function(t){if("string"==typeof(t=Object(r.g)(t)))return alert(t);t.error&&t.data&&t.data.notFound&&o.a.onRemoveStory(e,t.data.id)}))}},{key:"commentStory",value:function(e,t){window.storyModal&&(a.a.pause(e),i.a.render(e,t))}},{key:"viewStory",value:function(e,t){window.storyModal&&(a.a.pause(e),s.a.render(e,t))}},{key:"setStoryLikes",value:function(e,t){if(window.storyModal){var n=e.getState().stories.find((function(e){return e.id==t}));if(n){var o=n.likes?n.likes:0,i=window.storyModal.find(".story-reactions[data-id='"+t+"']");if(i&&i.length)return i.find(".likes").text(Object(r.s)(o,1)),i}}}},{key:"render",value:function(e,t){var n='<div class="story-reactions" data-id="'+t.id+'">',r=e.getState().likedStories.indexOf(t.id)>=0?"liked":"";return t.likes=t.likes?t.likes:0,t.commentsCount=t.commentsCount?t.commentsCount:0,t.viewsCount=t.viewsCount?t.viewsCount:0,n+='<div class="likes_wrapper">',n+='<span class="fa fa-heart '+r+'"></span>',n+='<span class="likes">'+t.likes+"</span>",n+="</div>",n+='<div class="comments_wrapper">',n+='<span class="fa fa-commenting"></span>',n+='<span class="comments">'+t.commentsCount+"</span>",n+="</div>",t.user_id==e.getState().mUser.reg_id&&(n+='<div class="views_wrapper">',n+='<span class="fa fa-eye"></span>',n+='<span class="views">'+t.viewsCount+"</span>",n+="</div>"),n+="</div>"}}],(n=null)&&c(t.prototype,n),u&&c(t,u),e}();t.a=u},function(e,t,n){var r,o,i,a,s,c;e.exports=(c=n(8),o=(r=c).lib,i=o.Base,a=o.WordArray,(s=r.x64={}).Word=i.extend({init:function(e,t){this.high=e,this.low=t}}),s.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],r=0;r<t;r++){var o=e[r];n.push(o.high),n.push(o.low)}return a.create(n,this.sigBytes)},clone:function(){for(var e=i.clone.call(this),t=e.words=this.words.slice(0),n=t.length,r=0;r<n;r++)t[r]=t[r].clone();return e}}),c)},function(e,t,n){"use strict";var r,o,i,a=n(135),s="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-";function c(){i=!1}function u(e){if(e){if(e!==r){if(e.length!==s.length)throw new Error("Custom alphabet for shortid must be "+s.length+" unique characters. You submitted "+e.length+" characters: "+e);var t=e.split("").filter((function(e,t,n){return t!==n.lastIndexOf(e)}));if(t.length)throw new Error("Custom alphabet for shortid must be "+s.length+" unique characters. These characters were not unique: "+t.join(", "));r=e,c()}}else r!==s&&(r=s,c())}function d(){return i||(i=function(){r||u(s);for(var e,t=r.split(""),n=[],o=a.nextValue();t.length>0;)o=a.nextValue(),e=Math.floor(o*t.length),n.push(t.splice(e,1)[0]);return n.join("")}())}e.exports={get:function(){return r||s},characters:function(e){return u(e),r},seed:function(e){a.seed(e),o!==e&&(c(),o=e)},lookup:function(e){return d()[e]},shuffled:d}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,o=n.length;r<o;r++){var i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}},function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){(function(r){function o(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}(t=e.exports=n(182)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))})),e.splice(i,0,r)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=o,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(o())}).call(this,n(74))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"TOGGLE_PUBLIC_MESSAGES_FACE_PICKER",isPublicMessagesFacePickerOpen:e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"TOGGLE_PRIVATE_MESSAGES_FACE_PICKER",isPrivateMessagesFacePickerOpen:e}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"SET_VIEWED_STORIES",viewedStories:e}},o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:"ADD_VIEWED_STORY",id:e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"TOGGLE_WALL_COMMENTS_FACE_PICKER",isWallCommentsFacePickerOpen:e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"TOGGLE_WALL_FACE_PICKER",isWallFacePickerOpen:e}}},function(e,t,n){"use strict";var r=n(0),o=n(14);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,a=[{key:"registerEvents",value:function(e){}},{key:"fetchPosts",value:function(e){e.getState().socket.emit("req",Object(r.k)({type:"WALL_CREATOR_GET_POSTS",data:{}}),(function(e){e=Object(r.g)(e);var t=$(".chat_pane__container__podium-users"),n=$(".chat_pane__container__podium-grades"),o=$("#chat__body__wall_creator_pane .chat_pane__container__posts"),i=e.slice(0,3),a=e.slice(3);i.forEach((function(e,r){e.avatar&&t.find(".chat_pane__container__podium-user.grade-"+(r+1)+" .avatar").attr("src","/uploads/avatars/sm/"+e.avatar),e.decoration=e.decoration?e.decoration:e.name,t.find(".chat_pane__container__podium-user.grade-"+(r+1)+" .name").text(e.decoration),n.find(".chat_pane__container__podium-grade.grade-"+(r+1)+" .rank").text(e.wall_points)})),o.html(""),a.forEach((function(e,t){e.decoration=e.decoration?e.decoration:e.name;var n="/images/none.png";e.avatar&&(n="/uploads/avatars/sm/"+e.avatar),o.append("<div class='chat_pane__container__post'><span class='grade'>"+(t+4)+"</span><img class='avatar' width='40' height='40' src='"+n+"' /><span class='name'>"+e.decoration+"</span><span class='rank'>"+e.wall_points+"</span></div>")}))}))}},{key:"setPosts",value:function(t){e.fetchPosts(t)}},{key:"render",value:function(e){var t="<div id='chat__body__wall_creator_pane' class='chat_pane' style='background: "+Object(r.u)(e.getState().settings,!0)+"'>";return t+=o.a.render("مبدع الحائط",!0),t+="<div class='chat_pane__container border'>",t+="<div class='chat_pane__container__podium'>",t+="<div class='chat_pane__container__podium-users'>",t+="<span class='chat_pane__container__podium-user grade-2'><img class='avatar' width='80' height='80' src='/images/none.png' /><img class='grade' width='50' height='50' src='/images/silver_grade.png' /><span class='name'></span></span>",t+="<span class='chat_pane__container__podium-user grade-1'><img class='avatar' width='80' height='80' src='/images/none.png' /><img class='grade' width='50' height='50' src='/images/gold_grade.png' /><img class='crown' width='40' height='40' src='/images/crown.png' /><span class='name'></span></span>",t+="<span class='chat_pane__container__podium-user grade-3'><img class='avatar' width='80' height='80' src='/images/none.png' /><img class='grade' width='50' height='50' src='/images/bronz_grade.png' /><span class='name'></span></span>",t+="</div>",t+="<div class='chat_pane__container__podium-grades'>",t+="<span class='chat_pane__container__podium-grade  grade-2'><span class='grade'>2</span><span class='rank'>0</span></span>",t+="<span class='chat_pane__container__podium-grade  grade-1'><span class='grade'>1</span><span class='rank'>0</span></span>",t+="<span class='chat_pane__container__podium-grade  grade-3'><span class='grade'>3</span><span class='rank'>0</span></span>",t+="</div>",t+="</div>",t+="<div class='chat_pane__container__posts'></div>",t+="</div>",t+="</div>"}}],(n=null)&&i(t.prototype,n),a&&i(t,a),e}();t.a=a},function(e,t,n){var r,o,i,a,s,c,u,d;e.exports=(d=n(8),o=(r=d).lib,i=o.WordArray,a=o.Hasher,s=r.algo,c=[],u=s.SHA1=a.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],a=n[3],s=n[4],u=0;u<80;u++){if(u<16)c[u]=0|e[t+u];else{var d=c[u-3]^c[u-8]^c[u-14]^c[u-16];c[u]=d<<1|d>>>31}var l=(r<<5|r>>>27)+s+c[u];l+=u<20?1518500249+(o&i|~o&a):u<40?1859775393+(o^i^a):u<60?(o&i|o&a|i&a)-1894007588:(o^i^a)-899497514,s=a,a=i,i=o<<30|o>>>2,o=r,r=l}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(r+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}}),r.SHA1=a._createHelper(u),r.HmacSHA1=a._createHmacHelper(u),d.SHA1)},function(e,t,n){var r,o,i,a;e.exports=(r=n(8),i=(o=r).lib.Base,a=o.enc.Utf8,void(o.algo.HMAC=i.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=a.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),i=this._iKey=t.clone(),s=o.words,c=i.words,u=0;u<n;u++)s[u]^=1549556828,c[u]^=909522486;o.sigBytes=i.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})))},function(e,t,n){"use strict";(function(t){var r=n(30),o=n(146),i={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var s={adapter:function(){var e;return("undefined"!=typeof XMLHttpRequest||void 0!==t)&&(e=n(83)),e}(),transformRequest:[function(e,t){return o(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(a(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(e){s.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){s.headers[e]=r.merge(i)})),e.exports=s}).call(this,n(74))},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var c,u=[],d=!1,l=-1;function f(){d&&c&&(d=!1,c.length?u=c.concat(u):l=-1,u.length&&p())}function p(){if(!d){var e=s(f);d=!0;for(var t=u.length;t;){for(c=u,u=[];++l<t;)c&&c[l].run();l=-1,t=u.length}c=null,d=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function h(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new m(e,t)),1!==u.length||d||s(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=h,o.addListener=h,o.once=h,o.off=h,o.removeListener=h,o.removeAllListeners=h,o.emit=h,o.prependListener=h,o.prependOnceListener=h,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,n){var r=n(56)("socket.io-parser"),o=n(166),i=n(167),a=n(91),s=n(92);function c(){}t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=c,t.Decoder=l;var u=t.ERROR+'"encode error"';function d(e){var n=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data){var o=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===o)return u;n+=o}return r("encoded %j as %s",e,n),n}function l(){this.reconstructor=null}function f(e){this.reconPack=e,this.buffers=[]}function p(e){return{type:t.ERROR,data:"parser error: "+e}}c.prototype.encode=function(e,n){(r("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type)?function(e,t){i.removeBlobs(e,(function(e){var n=i.deconstructPacket(e),r=d(n.packet),o=n.buffers;o.unshift(r),t(o)}))}(e,n):n([d(e)])},o(l.prototype),l.prototype.add=function(e){var n;if("string"==typeof e)n=function(e){var n=0,o={type:Number(e.charAt(0))};if(null==t.types[o.type])return p("unknown packet type "+o.type);if(t.BINARY_EVENT===o.type||t.BINARY_ACK===o.type){for(var i="";"-"!==e.charAt(++n)&&(i+=e.charAt(n),n!=e.length););if(i!=Number(i)||"-"!==e.charAt(n))throw new Error("Illegal attachments");o.attachments=Number(i)}if("/"===e.charAt(n+1))for(o.nsp="";++n;){if(","===(c=e.charAt(n)))break;if(o.nsp+=c,n===e.length)break}else o.nsp="/";var s=e.charAt(n+1);if(""!==s&&Number(s)==s){for(o.id="";++n;){var c;if(null==(c=e.charAt(n))||Number(c)!=c){--n;break}if(o.id+=e.charAt(n),n===e.length)break}o.id=Number(o.id)}if(e.charAt(++n)){var u=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(n));if(!(!1!==u&&(o.type===t.ERROR||a(u))))return p("invalid payload");o.data=u}return r("decoded %s as %j",e,o),o}(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new f(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!s(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},l.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},f.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=i.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},f.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,n){"use strict";(function(e){var r=n(168),o=n(169),i=n(170);function a(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return l(this,e)}return u(this,e,t,n)}function u(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=f(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|m(t,n),o=(e=s(e,r)).write(t,n);o!==r&&(e=e.slice(0,o));return e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|p(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?s(e,0):f(e,t);if("Buffer"===t.type&&i(t.data))return f(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function d(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function l(e,t){if(d(t),e=s(e,t<0?0:0|p(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function f(e,t){var n=t.length<0?0:0|p(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function p(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function m(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return N(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return $(e).length;default:if(r)return N(e).length;t=(""+t).toLowerCase(),r=!0}}function h(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return A(this,t,n);case"utf8":case"utf-8":return T(this,t,n);case"ascii":return O(this,t,n);case"latin1":case"binary":return P(this,t,n);case"base64":return E(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function _(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function g(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:v(e,t,n,r,o);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,r,o){var i,a=1,s=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,c/=2,n/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(o){var d=-1;for(i=n;i<s;i++)if(u(e,i)===u(t,-1===d?0:i-d)){if(-1===d&&(d=i),i-d+1===c)return d*a}else-1!==d&&(i-=i-d),d=-1}else for(n+c>s&&(n=s-c),i=n;i>=0;i--){for(var l=!0,f=0;f<c;f++)if(u(e,i+f)!==u(t,f)){l=!1;break}if(l)return i}return-1}function y(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function b(e,t,n,r){return q(N(t,e.length-n),e,n,r)}function w(e,t,n,r){return q(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function S(e,t,n,r){return w(e,t,n,r)}function k(e,t,n,r){return q($(t),e,n,r)}function C(e,t,n,r){return q(function(e,t){for(var n,r,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(t,e.length-n),e,n,r)}function E(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function T(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,a,s,c,u=e[o],d=null,l=u>239?4:u>223?3:u>191?2:1;if(o+l<=n)switch(l){case 1:u<128&&(d=u);break;case 2:128==(192&(i=e[o+1]))&&(c=(31&u)<<6|63&i)>127&&(d=c);break;case 3:i=e[o+1],a=e[o+2],128==(192&i)&&128==(192&a)&&(c=(15&u)<<12|(63&i)<<6|63&a)>2047&&(c<55296||c>57343)&&(d=c);break;case 4:i=e[o+1],a=e[o+2],s=e[o+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&(c=(15&u)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(d=c)}null===d?(d=65533,l=1):d>65535&&(d-=65536,r.push(d>>>10&1023|55296),d=56320|1023&d),r.push(d),o+=l}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return u(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,r){return d(t),t<=0?s(e,t):void 0!==n?"string"==typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return l(null,e)},c.allocUnsafeSlow=function(e){return l(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=c.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var a=e[n];if(!c.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,o),o+=a.length}return r},c.byteLength=m,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)_(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)_(this,t,t+3),_(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)_(this,t,t+7),_(this,t+1,t+6),_(this,t+2,t+5),_(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?T(this,0,e):h.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,o){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(i,a),u=this.slice(r,o),d=e.slice(t,n),l=0;l<s;++l)if(u[l]!==d[l]){i=u[l],a=d[l];break}return i<a?-1:a<i?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return b(this,e,t,n);case"ascii":return w(this,e,t,n);case"latin1":case"binary":return S(this,e,t,n);case"base64":return k(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function O(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function P(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function A(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=F(e[i]);return o}function R(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function M(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function x(e,t,n,r,o,i){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function U(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function I(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function D(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function j(e,t,n,r,i){return i||D(e,0,n,4),o.write(e,t,n,r,23,4),n+4}function B(e,t,n,r,i){return i||D(e,0,n,8),o.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var o=t-e;n=new c(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},c.prototype.readUInt8=function(e,t){return t||M(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||M(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||M(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},c.prototype.readInt8=function(e,t){return t||M(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||M(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||M(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||M(e,4,this.length),o.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||M(e,4,this.length),o.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||M(e,8,this.length),o.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||M(e,8,this.length),o.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||x(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||x(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):U(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):U(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):I(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):I(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);x(this,e,t,n,o-1,-o)}var i=0,a=1,s=0;for(this[t]=255&e;++i<n&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);x(this,e,t,n,o-1,-o)}var i=n-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):U(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):U(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):I(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):I(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return j(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return j(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return B(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return B(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;o>=0;--o)e[o+t]=this[o+n];else if(i<1e3||!c.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var a=c.isBuffer(e)?e:N(new c(e,r).toString()),s=a.length;for(i=0;i<n-t;++i)this[i+t]=a[i%s]}return this};var L=/[^+\/0-9A-Za-z-_]/g;function F(e){return e<16?"0"+e.toString(16):e.toString(16)}function N(e,t){var n;t=t||1/0;for(var r=e.length,o=null,i=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function $(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(L,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function q(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}}).call(this,n(61))},function(e,t,n){var r=n(173);e.exports=function(e){var t=e.xdomain,n=e.xscheme,o=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&o)return new XDomainRequest}catch(e){}if(!t)try{return new(self[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},function(e,t,n){var r=n(50),o=n(57);function i(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}e.exports=i,o(i.prototype),i.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},i.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},i.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},i.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},i.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},i.prototype.onData=function(e){var t=r.decodePacket(e,this.socket.binaryType);this.onPacket(t)},i.prototype.onPacket=function(e){this.emit("packet",e)},i.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,n){"use strict";(function(e,r){var o,i=n(107);o="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:r;var a=Object(i.a)(o);t.a=a}).call(this,n(61),n(188)(e))},function(e,t,n){var r;e.exports=(r=n(8),function(e){var t=r,n=t.lib,o=n.WordArray,i=n.Hasher,a=t.algo,s=[],c=[];!function(){function t(t){for(var n=e.sqrt(t),r=2;r<=n;r++)if(!(t%r))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var r=2,o=0;o<64;)t(r)&&(o<8&&(s[o]=n(e.pow(r,.5))),c[o]=n(e.pow(r,1/3)),o++),r++}();var u=[],d=a.SHA256=i.extend({_doReset:function(){this._hash=new o.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],a=n[3],s=n[4],d=n[5],l=n[6],f=n[7],p=0;p<64;p++){if(p<16)u[p]=0|e[t+p];else{var m=u[p-15],h=(m<<25|m>>>7)^(m<<14|m>>>18)^m>>>3,_=u[p-2],g=(_<<15|_>>>17)^(_<<13|_>>>19)^_>>>10;u[p]=h+u[p-7]+g+u[p-16]}var v=r&o^r&i^o&i,y=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),b=f+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&d^~s&l)+c[p]+u[p];f=l,l=d,d=s,s=a+b|0,a=i,i=o,o=r,r=b+(y+v)|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0,n[5]=n[5]+d|0,n[6]=n[6]+l|0,n[7]=n[7]+f|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(d),t.HmacSHA256=i._createHmacHelper(d)}(Math),r.SHA256)},function(e,t,n){var r;e.exports=(r=n(8),n(59),function(){var e=r,t=e.lib.Hasher,n=e.x64,o=n.Word,i=n.WordArray,a=e.algo;function s(){return o.create.apply(o,arguments)}var c=[s(1116352408,3609767458),s(1899447441,602891725),s(3049323471,3964484399),s(3921009573,2173295548),s(961987163,4081628472),s(1508970993,3053834265),s(2453635748,2937671579),s(2870763221,3664609560),s(3624381080,2734883394),s(310598401,1164996542),s(607225278,1323610764),s(1426881987,3590304994),s(1925078388,4068182383),s(2162078206,991336113),s(2614888103,633803317),s(3248222580,3479774868),s(3835390401,2666613458),s(4022224774,944711139),s(264347078,2341262773),s(604807628,2007800933),s(770255983,1495990901),s(1249150122,1856431235),s(1555081692,3175218132),s(1996064986,2198950837),s(2554220882,3999719339),s(2821834349,766784016),s(2952996808,2566594879),s(3210313671,3203337956),s(3336571891,1034457026),s(3584528711,2466948901),s(113926993,3758326383),s(338241895,168717936),s(666307205,1188179964),s(773529912,1546045734),s(1294757372,1522805485),s(1396182291,2643833823),s(1695183700,2343527390),s(1986661051,1014477480),s(2177026350,1206759142),s(2456956037,344077627),s(2730485921,1290863460),s(2820302411,3158454273),s(3259730800,3505952657),s(3345764771,106217008),s(3516065817,3606008344),s(3600352804,1432725776),s(4094571909,1467031594),s(275423344,851169720),s(430227734,3100823752),s(506948616,1363258195),s(659060556,3750685593),s(883997877,3785050280),s(958139571,3318307427),s(1322822218,3812723403),s(1537002063,2003034995),s(1747873779,3602036899),s(1955562222,1575990012),s(2024104815,1125592928),s(2227730452,2716904306),s(2361852424,442776044),s(2428436474,593698344),s(2756734187,3733110249),s(3204031479,2999351573),s(3329325298,3815920427),s(3391569614,3928383900),s(3515267271,566280711),s(3940187606,3454069534),s(4118630271,4000239992),s(116418474,1914138554),s(174292421,2731055270),s(289380356,3203993006),s(460393269,320620315),s(685471733,587496836),s(852142971,1086792851),s(1017036298,365543100),s(1126000580,2618297676),s(1288033470,3409855158),s(1501505948,4234509866),s(1607167915,987167468),s(1816402316,1246189591)],u=[];!function(){for(var e=0;e<80;e++)u[e]=s()}();var d=a.SHA512=t.extend({_doReset:function(){this._hash=new i.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],a=n[3],s=n[4],d=n[5],l=n[6],f=n[7],p=r.high,m=r.low,h=o.high,_=o.low,g=i.high,v=i.low,y=a.high,b=a.low,w=s.high,S=s.low,k=d.high,C=d.low,E=l.high,T=l.low,O=f.high,P=f.low,A=p,R=m,M=h,x=_,U=g,I=v,D=y,j=b,B=w,L=S,F=k,N=C,$=E,q=T,G=O,V=P,W=0;W<80;W++){var H=u[W];if(W<16)var z=H.high=0|e[t+2*W],Y=H.low=0|e[t+2*W+1];else{var J=u[W-15],X=J.high,K=J.low,Q=(X>>>1|K<<31)^(X>>>8|K<<24)^X>>>7,Z=(K>>>1|X<<31)^(K>>>8|X<<24)^(K>>>7|X<<25),ee=u[W-2],te=ee.high,ne=ee.low,re=(te>>>19|ne<<13)^(te<<3|ne>>>29)^te>>>6,oe=(ne>>>19|te<<13)^(ne<<3|te>>>29)^(ne>>>6|te<<26),ie=u[W-7],ae=ie.high,se=ie.low,ce=u[W-16],ue=ce.high,de=ce.low;z=(z=(z=Q+ae+((Y=Z+se)>>>0<Z>>>0?1:0))+re+((Y+=oe)>>>0<oe>>>0?1:0))+ue+((Y+=de)>>>0<de>>>0?1:0),H.high=z,H.low=Y}var le,fe=B&F^~B&$,pe=L&N^~L&q,me=A&M^A&U^M&U,he=R&x^R&I^x&I,_e=(A>>>28|R<<4)^(A<<30|R>>>2)^(A<<25|R>>>7),ge=(R>>>28|A<<4)^(R<<30|A>>>2)^(R<<25|A>>>7),ve=(B>>>14|L<<18)^(B>>>18|L<<14)^(B<<23|L>>>9),ye=(L>>>14|B<<18)^(L>>>18|B<<14)^(L<<23|B>>>9),be=c[W],we=be.high,Se=be.low,ke=G+ve+((le=V+ye)>>>0<V>>>0?1:0),Ce=ge+he;G=$,V=q,$=F,q=N,F=B,N=L,B=D+(ke=(ke=(ke=ke+fe+((le+=pe)>>>0<pe>>>0?1:0))+we+((le+=Se)>>>0<Se>>>0?1:0))+z+((le+=Y)>>>0<Y>>>0?1:0))+((L=j+le|0)>>>0<j>>>0?1:0)|0,D=U,j=I,U=M,I=x,M=A,x=R,A=ke+(_e+me+(Ce>>>0<ge>>>0?1:0))+((R=le+Ce|0)>>>0<le>>>0?1:0)|0}m=r.low=m+R,r.high=p+A+(m>>>0<R>>>0?1:0),_=o.low=_+x,o.high=h+M+(_>>>0<x>>>0?1:0),v=i.low=v+I,i.high=g+U+(v>>>0<I>>>0?1:0),b=a.low=b+j,a.high=y+D+(b>>>0<j>>>0?1:0),S=s.low=S+L,s.high=w+B+(S>>>0<L>>>0?1:0),C=d.low=C+N,d.high=k+F+(C>>>0<N>>>0?1:0),T=l.low=T+q,l.high=E+$+(T>>>0<q>>>0?1:0),P=f.low=P+V,f.high=O+G+(P>>>0<V>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[30+(r+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(r+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(d),e.HmacSHA512=t._createHmacHelper(d)}(),r.SHA512)},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t,n){"use strict";var r=n(30),o=n(147),i=n(149),a=n(150),s=n(151),c=n(84);e.exports=function(e){return new Promise((function(t,u){var d=e.data,l=e.headers;r.isFormData(d)&&delete l["Content-Type"];var f=new XMLHttpRequest;if(e.auth){var p=e.auth.username||"",m=e.auth.password||"";l.Authorization="Basic "+btoa(p+":"+m)}if(f.open(e.method.toUpperCase(),i(e.url,e.params,e.paramsSerializer),!0),f.timeout=e.timeout,f.onreadystatechange=function(){if(f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in f?a(f.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:n,config:e,request:f};o(t,u,r),f=null}},f.onerror=function(){u(c("Network Error",e,null,f)),f=null},f.ontimeout=function(){u(c("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",f)),f=null},r.isStandardBrowserEnv()){var h=n(152),_=(e.withCredentials||s(e.url))&&e.xsrfCookieName?h.read(e.xsrfCookieName):void 0;_&&(l[e.xsrfHeaderName]=_)}if("setRequestHeader"in f&&r.forEach(l,(function(e,t){void 0===d&&"content-type"===t.toLowerCase()?delete l[t]:f.setRequestHeader(t,e)})),e.withCredentials&&(f.withCredentials=!0),e.responseType)try{f.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&f.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){f&&(f.abort(),u(e),f=null)})),void 0===d&&(d=null),f.send(d)}))}},function(e,t,n){"use strict";var r=n(148);e.exports=function(e,t,n,o,i){var a=new Error(e);return r(a,t,n,o,i)}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,o=n;return[o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]]].join("")}},function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,o=e.indexOf("["),i=e.indexOf("]");-1!=o&&-1!=i&&(e=e.substring(0,o)+e.substring(o,i).replace(/:/g,";")+e.substring(i,e.length));for(var a=n.exec(e||""),s={},c=14;c--;)s[r[c]]=a[c]||"";return-1!=o&&-1!=i&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s}},function(e,t){var n=1e3,r=6e4,o=60*r,i=24*o;function a(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var s,c=typeof e;if("string"===c&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var a=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"days":case"day":case"d":return a*i;case"hours":case"hour":case"hrs":case"hr":case"h":return a*o;case"minutes":case"minute":case"mins":case"min":case"m":return a*r;case"seconds":case"second":case"secs":case"sec":case"s":return a*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(e);if("number"===c&&!1===isNaN(e))return t.long?a(s=e,i,"day")||a(s,o,"hour")||a(s,r,"minute")||a(s,n,"second")||s+" ms":function(e){if(e>=i)return Math.round(e/i)+"d";if(e>=o)return Math.round(e/o)+"h";if(e>=r)return Math.round(e/r)+"m";if(e>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){(function(t){e.exports=function(e){return n&&t.isBuffer(e)||r&&(e instanceof ArrayBuffer||function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}(e))};var n="function"==typeof t&&"function"==typeof t.isBuffer,r="function"==typeof ArrayBuffer}).call(this,n(76).Buffer)},function(e,t,n){var r=n(171),o=n(99),i=n(57),a=n(75),s=n(100),c=n(101),u=n(56)("socket.io-client:manager"),d=n(98),l=n(187),f=Object.prototype.hasOwnProperty;function p(e,t){if(!(this instanceof p))return new p(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new l({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||a;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}e.exports=p,p.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)f.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},p.prototype.updateSocketIds=function(){for(var e in this.nsps)f.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},p.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},i(p.prototype),p.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},p.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},p.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},p.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},p.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},p.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},p.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},p.prototype.open=p.prototype.connect=function(e,t){if(u("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;u("opening %s",this.uri),this.engine=r(this.uri,this.opts);var n=this.engine,o=this;this.readyState="opening",this.skipReconnect=!1;var i=s(n,"open",(function(){o.onopen(),e&&e()})),a=s(n,"error",(function(t){if(u("connect_error"),o.cleanup(),o.readyState="closed",o.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else o.maybeReconnectOnOpen()}));if(!1!==this._timeout){var c=this._timeout;u("connect attempt will timeout after %d",c);var d=setTimeout((function(){u("connect attempt timed out after %d",c),i.destroy(),n.close(),n.emit("error","timeout"),o.emitAll("connect_timeout",c)}),c);this.subs.push({destroy:function(){clearTimeout(d)}})}return this.subs.push(i),this.subs.push(a),this},p.prototype.onopen=function(){u("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(s(e,"data",c(this,"ondata"))),this.subs.push(s(e,"ping",c(this,"onping"))),this.subs.push(s(e,"pong",c(this,"onpong"))),this.subs.push(s(e,"error",c(this,"onerror"))),this.subs.push(s(e,"close",c(this,"onclose"))),this.subs.push(s(this.decoder,"decoded",c(this,"ondecoded")))},p.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},p.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},p.prototype.ondata=function(e){this.decoder.add(e)},p.prototype.ondecoded=function(e){this.emit("packet",e)},p.prototype.onerror=function(e){u("error",e),this.emitAll("error",e)},p.prototype.socket=function(e,t){var n=this.nsps[e];if(!n){n=new o(this,e,t),this.nsps[e]=n;var r=this;n.on("connecting",i),n.on("connect",(function(){n.id=r.generateId(e)})),this.autoConnect&&i()}function i(){~d(r.connecting,n)||r.connecting.push(n)}return n},p.prototype.destroy=function(e){var t=d(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},p.prototype.packet=function(e){u("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,(function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()})))},p.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},p.prototype.cleanup=function(){u("cleanup");for(var e=this.subs.length,t=0;t<e;t++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},p.prototype.close=p.prototype.disconnect=function(){u("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},p.prototype.onclose=function(e){u("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},p.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)u("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();u("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout((function(){e.skipReconnect||(u("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open((function(t){t?(u("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(u("reconnect success"),e.onreconnect())})))}),t);this.subs.push({destroy:function(){clearTimeout(n)}})}},p.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,n){var r=n(77),o=n(174),i=n(183),a=n(184);t.polling=function(e){var t=!1,n=!1,a=!1!==e.jsonp;if("undefined"!=typeof location){var s="https:"===location.protocol,c=location.port;c||(c=s?443:80),t=e.hostname!==location.hostname||c!==e.port,n=e.secure!==s}if(e.xdomain=t,e.xscheme=n,"open"in new r(e)&&!e.forceJSONP)return new o(e);if(!a)throw new Error("JSONP disabled");return new i(e)},t.websocket=a},function(e,t,n){var r=n(78),o=n(62),i=n(50),a=n(63),s=n(97),c=n(64)("engine.io-client:polling");e.exports=d;var u=null!=new(n(77))({xdomain:!1}).responseType;function d(e){var t=e&&e.forceBase64;u&&!t||(this.supportsBinary=!1),r.call(this,e)}a(d,r),d.prototype.name="polling",d.prototype.doOpen=function(){this.poll()},d.prototype.pause=function(e){var t=this;function n(){c("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(c("we are currently polling - waiting to pause"),r++,this.once("pollComplete",(function(){c("pre-pause polling complete"),--r||n()}))),this.writable||(c("we are currently writing - waiting to pause"),r++,this.once("drain",(function(){c("pre-pause writing complete"),--r||n()})))}else n()},d.prototype.poll=function(){c("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},d.prototype.onData=function(e){var t=this;c("polling got data %s",e);i.decodePayload(e,this.socket.binaryType,(function(e,n,r){if("opening"===t.readyState&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():c('ignoring poll - transport state "%s"',this.readyState))},d.prototype.doClose=function(){var e=this;function t(){c("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(c("transport open - closing"),t()):(c("transport not open - deferring close"),this.once("open",t))},d.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};i.encodePayload(e,this.supportsBinary,(function(e){t.doWrite(e,n)}))},d.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=s()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},function(e,t,n){(function(t){var r=n(176),o=Object.prototype.toString,i="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===o.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===o.call(File);e.exports=function e(n){if(!n||"object"!=typeof n)return!1;if(r(n)){for(var o=0,s=n.length;o<s;o++)if(e(n[o]))return!0;return!1}if("function"==typeof t&&t.isBuffer&&t.isBuffer(n)||"function"==typeof ArrayBuffer&&n instanceof ArrayBuffer||i&&n instanceof Blob||a&&n instanceof File)return!0;if(n.toJSON&&"function"==typeof n.toJSON&&1===arguments.length)return e(n.toJSON(),!0);for(var c in n)if(Object.prototype.hasOwnProperty.call(n,c)&&e(n[c]))return!0;return!1}}).call(this,n(76).Buffer)},function(e,t,n){"use strict";var r,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),i={},a=0,s=0;function c(e){var t="";do{t=o[e%64]+t,e=Math.floor(e/64)}while(e>0);return t}function u(){var e=c(+new Date);return e!==r?(a=0,r=e):e+"."+c(a++)}for(;s<64;s++)i[o[s]]=s;u.encode=c,u.decode=function(e){var t=0;for(s=0;s<e.length;s++)t=64*t+i[e.charAt(s)];return t},e.exports=u},function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}},function(e,t,n){var r=n(75),o=n(57),i=n(186),a=n(100),s=n(101),c=n(56)("socket.io-client:socket"),u=n(62),d=n(96);e.exports=p;var l={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},f=o.prototype.emit;function p(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}o(p.prototype),p.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[a(e,"open",s(this,"onopen")),a(e,"packet",s(this,"onpacket")),a(e,"close",s(this,"onclose"))]}},p.prototype.open=p.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},p.prototype.send=function(){var e=i(arguments);return e.unshift("message"),this.emit.apply(this,e),this},p.prototype.emit=function(e){if(l.hasOwnProperty(e))return f.apply(this,arguments),this;var t=i(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:d(t))?r.BINARY_EVENT:r.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(c("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},p.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},p.prototype.onopen=function(){if(c("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"==typeof this.query?u.encode(this.query):this.query;c("sending connect packet with query %s",e),this.packet({type:r.CONNECT,query:e})}else this.packet({type:r.CONNECT})},p.prototype.onclose=function(e){c("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},p.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===r.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(e);break;case r.ACK:case r.BINARY_ACK:this.onack(e);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",e.data)}},p.prototype.onevent=function(e){var t=e.data||[];c("emitting event %j",t),null!=e.id&&(c("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?f.apply(this,t):this.receiveBuffer.push(t)},p.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var o=i(arguments);c("sending ack %j",o),t.packet({type:d(o)?r.BINARY_ACK:r.ACK,id:e,data:o})}}},p.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(c("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):c("bad ack %s",e.id)},p.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},p.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)f.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},p.prototype.ondisconnect=function(){c("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},p.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},p.prototype.close=p.prototype.disconnect=function(){return this.connected&&(c("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},p.prototype.compress=function(e){return this.flags.compress=e,this},p.prototype.binary=function(e){return this.flags.binary=e,this}},function(e,t){e.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return t.apply(e,r.concat(n.call(arguments)))}}},function(e,t,n){"use strict";e.exports=n(134)},function(e,t,n){(function(n){var r;function o(e){if(!e)throw"MediaStream is mandatory.";var t;this.start=function(n){var r;"undefined"!=typeof MediaRecorder?r=g:(l||d||u)&&(-1!==this.mimeType.indexOf("video")?r=b:-1!==this.mimeType.indexOf("audio")&&(r=v)),"image/gif"===this.mimeType&&(r=S),"audio/wav"!==this.mimeType&&"audio/pcm"!==this.mimeType||(r=v),this.recorderType&&(r=this.recorderType),(t=new r(e)).blobs=[];var o=this;t.ondataavailable=function(e){t.blobs.push(e),o.ondataavailable(e)},t.onstop=this.onstop,t.onStartedDrawingNonBlankFrames=this.onStartedDrawingNonBlankFrames,(t=function(e,t){for(var n in t)"function"!=typeof t[n]&&(e[n]=t[n]);return e}(t,this)).start(n)},this.onStartedDrawingNonBlankFrames=function(){},this.clearOldRecordedFrames=function(){t&&t.clearOldRecordedFrames()},this.stop=function(){t&&t.stop()},this.ondataavailable=function(e){console.log("ondataavailable..",e)},this.onstop=function(e){console.warn("stopped..",e)},this.save=function(e,n){if(e)p(e,n);else{if(!t)return;ConcatenateBlobs(t.blobs,t.blobs[0].type,(function(e){p(e)}))}},this.pause=function(){t&&(t.pause(),console.log("Paused recording.",this.mimeType||t.mimeType))},this.resume=function(){t&&(t.resume(),console.log("Resumed recording.",this.mimeType||t.mimeType))},this.recorderType=null,this.mimeType="video/webm",this.disableLogs=!1}void 0!==o&&(o.MultiStreamRecorder=function(e){if(!e)throw"MediaStream is mandatory.";var t,n,r=this,i=_();this.stream=e,this.start=function(c){for(var u in t=new o(e),n=new o(e),t.mimeType="audio/ogg",n.mimeType="video/webm",this)"function"!=typeof this[u]&&(t[u]=n[u]=this[u]);function d(e){s++,r.ondataavailable(e)}t.ondataavailable=function(e){a[s]||(a[s]={}),a[s].audio=e,a[s].video&&!a[s].onDataAvailableEventFired&&(a[s].onDataAvailableEventFired=!0,d(a[s]))},n.ondataavailable=function(e){if(i)return r.ondataavailable({video:e,audio:e});a[s]||(a[s]={}),a[s].video=e,a[s].audio&&!a[s].onDataAvailableEventFired&&(a[s].onDataAvailableEventFired=!0,d(a[s]))},n.onstop=t.onstop=function(e){r.onstop(e)},i||(n.onStartedDrawingNonBlankFrames=function(){n.clearOldRecordedFrames(),t.start(c)}),n.start(c)},this.stop=function(){t&&t.stop(),n&&n.stop()},this.ondataavailable=function(e){console.log("ondataavailable..",e)},this.onstop=function(e){console.warn("stopped..",e)},this.pause=function(){t&&t.pause(),n&&n.pause()},this.resume=function(){t&&t.resume(),n&&n.resume()};var a={},s=0});var i,a,s="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";i=void 0!==n?n:window,"undefined"==typeof window&&("undefined"==typeof window&&void 0!==n&&(n.navigator={userAgent:s,getUserMedia:function(){}},i.window=n),"undefined"==typeof document&&(i.document={},document.createElement=document.captureStream=document.mozCaptureStream=function(){return{}}),"undefined"==typeof location&&(i.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(i.screen={width:0,height:0})),void 0===(a=window.AudioContext)&&("undefined"!=typeof webkitAudioContext&&(a=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(a=mozAudioContext)),"undefined"==typeof window&&(window={}),void 0===(a=window.AudioContext)&&("undefined"!=typeof webkitAudioContext&&(a=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(a=mozAudioContext));var c=window.URL;void 0===c&&"undefined"!=typeof webkitURL&&(c=webkitURL),"undefined"!=typeof navigator?(void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),void 0!==navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia)):navigator={getUserMedia:function(){},userAgent:s};var u=!(-1===navigator.userAgent.indexOf("Edge")||!navigator.msSaveBlob&&!navigator.msSaveOrOpenBlob),d=!1;"undefined"!=typeof opera&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("OPR/")&&(d=!0);var l=!u&&!u&&!!navigator.webkitGetUserMedia,f=window.MediaStream;function p(e,t){if(!e)throw"Blob object is required.";if(!e.type)try{e.type="video/webm"}catch(e){}var n=(e.type||"video/webm").split("/")[1];if(t&&-1!==t.indexOf(".")){var r=t.split(".");t=r[0],n=r[1]}var o=(t||Math.round(9999999999*Math.random())+888888888)+"."+n;if(void 0!==navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(e,o);if(void 0!==navigator.msSaveBlob)return navigator.msSaveBlob(e,o);var i=document.createElement("a");i.href=c.createObjectURL(e),i.target="_blank",i.download=o,navigator.mozGetUserMedia&&(i.onclick=function(){(document.body||document.documentElement).removeChild(i)},(document.body||document.documentElement).appendChild(i));var a=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});i.dispatchEvent(a),navigator.mozGetUserMedia||c.revokeObjectURL(i.href)}function m(e){if(0===e)return"0 Bytes";var t=parseInt(Math.floor(Math.log(e)/Math.log(1e3)),10);return(e/Math.pow(1e3,t)).toPrecision(3)+" "+["Bytes","KB","MB","GB","TB"][t]}void 0===f&&"undefined"!=typeof webkitMediaStream&&(f=webkitMediaStream),void 0!==f&&("getVideoTracks"in f.prototype||(f.prototype.getVideoTracks=function(){if(!this.getTracks)return[];var e=[];return this.getTracks.forEach((function(t){-1!==t.kind.toString().indexOf("video")&&e.push(t)})),e},f.prototype.getAudioTracks=function(){if(!this.getTracks)return[];var e=[];return this.getTracks.forEach((function(t){-1!==t.kind.toString().indexOf("audio")&&e.push(t)})),e}),"stop"in f.prototype||(f.prototype.stop=function(){this.getAudioTracks().forEach((function(e){e.stop&&e.stop()})),this.getVideoTracks().forEach((function(e){e.stop&&e.stop()}))})),"undefined"!=typeof location&&0===location.href.indexOf("file:")&&console.error("Please load this HTML file on HTTP or HTTPS.");var h={AudioContext:a};function _(){var e=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,t=!!window.chrome&&!e;if(void 0!==window.InstallTrigger)return!0;if(!t)return!1;navigator.appVersion;var n,r,o=navigator.userAgent,i=""+parseFloat(navigator.appVersion),a=parseInt(navigator.appVersion,10);return t&&(n=o.indexOf("Chrome"),i=o.substring(n+7)),-1!==(r=i.indexOf(";"))&&(i=i.substring(0,r)),-1!==(r=i.indexOf(" "))&&(i=i.substring(0,r)),a=parseInt(""+i,10),isNaN(a)&&(i=""+parseFloat(navigator.appVersion),a=parseInt(navigator.appVersion,10)),a>=49}h={AudioContext:window.AudioContext||window.webkitAudioContext};function g(e){var t,n=this;this.start=function(r,o){var i;(n.mimeType||(n.mimeType="video/webm"),-1!==n.mimeType.indexOf("audio"))&&(e.getVideoTracks().length&&e.getAudioTracks().length&&(navigator.mozGetUserMedia?(i=new f).addTrack(e.getAudioTracks()[0]):i=new f(e.getAudioTracks()),e=i));-1!==n.mimeType.indexOf("audio")&&(n.mimeType=l?"audio/webm":"audio/ogg"),n.dontFireOnDataAvailableEvent=!1;var a={mimeType:n.mimeType};n.disableLogs||o||console.log("Passing following params over MediaRecorder API.",a),t&&(t=null),l&&!_()&&(a="video/vp8");try{t=new MediaRecorder(e,a)}catch(n){t=new MediaRecorder(e)}"canRecordMimeType"in t&&!1===t.canRecordMimeType(n.mimeType)&&(n.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",n.mimeType)),t.ignoreMutedMedia=n.ignoreMutedMedia||!1;var s=!1;t.ondataavailable=function(e){if(!n.dontFireOnDataAvailableEvent&&e.data&&e.data.size&&!(e.data.size<26800)&&!s){s=!0;var o=n.getNativeBlob?e.data:new Blob([e.data],{type:n.mimeType||"video/webm"});n.ondataavailable(o),n.dontFireOnDataAvailableEvent=!0,t&&(t.stop(),t=null),n.start(r,"__disableLogs")}},t.onerror=function(e){n.disableLogs||("InvalidState"===e.name?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed."):"OutOfMemory"===e.name?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute."):"IllegalStreamModification"===e.name?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute."):"OtherRecordingError"===e.name?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute."):"GenericError"===e.name?console.error("The UA cannot provide the codec or recording option that has been requested.",e):console.error("MediaRecorder Error",e)),t&&"inactive"!==t.state&&"stopped"!==t.state&&t.stop()};try{t.start(36e5)}catch(e){t=null}setTimeout((function(){t&&"recording"===t.state&&t.requestData()}),r)},this.stop=function(e){t&&"recording"===t.state&&(t.requestData(),setTimeout((function(){n.dontFireOnDataAvailableEvent=!0,t&&"recording"===t.state&&t.stop(),t=null}),2e3))},this.pause=function(){t&&"recording"===t.state&&t.pause()},this.ondataavailable=function(e){console.log("recorded-blob",e)},this.resume=function(){if(this.dontFireOnDataAvailableEvent){this.dontFireOnDataAvailableEvent=!1;var e=n.disableLogs;return n.disableLogs=!0,this.record(),void(n.disableLogs=e)}t&&"paused"===t.state&&t.resume()},this.clearRecordedData=function(){t&&(this.pause(),this.dontFireOnDataAvailableEvent=!0,this.stop())},function r(){t&&(!1!==function(){if("active"in e){if(!e.active)return!1}else if("ended"in e&&e.ended)return!1;return!0}()?setTimeout(r,1e3):n.stop())}()}function v(e){var t,n;this.start=function(r){r=r||1e3,(t=new y(e,this)).record(),n=setInterval((function(){t.requestData()}),r)},this.stop=function(){t&&(t.stop(),clearTimeout(n))},this.pause=function(){t&&t.pause()},this.resume=function(){t&&t.resume()},this.ondataavailable=function(){}}function y(e,t){var n;h.AudioContextConstructor||(h.AudioContextConstructor=new h.AudioContext),n=h.AudioContextConstructor.sampleRate;var r,o=[],i=[],a=!1,s=0,c=t.sampleRate||n,u=(t.mimeType||"audio/wav").indexOf("audio/pcm")>-1,d=t.audioChannels||2;function l(e,t){for(var n=new Float32Array(t),r=0,o=e.length,i=0;i<o;i++){var a=e[i];n.set(a,r),r+=a.length}return n}function f(e,t,n){for(var r=n.length,o=0;o<r;o++)e.setUint8(t+o,n.charCodeAt(o))}function p(e){for(var t=e.length,n=new Int16Array(t);t--;)n[t]=65535*e[t];return n.buffer}this.record=function(){a=!0,o.length=i.length=0,s=0},this.requestData=function(){if(!w)if(0!==s){b=!0;var e=o.slice(0),n=i.slice(0),r=s;o.length=i.length=[],s=0,b=!1;var a=l(e,r),h=a;if(2===d)h=function(e,t){for(var n=e.length+t.length,r=new Float32Array(n),o=0,i=0;i<n;)r[i++]=e[o],r[i++]=t[o],o++;return r}(a,l(n,r));if(u){var _=new Blob([p(h)],{type:"audio/pcm"});return console.debug("audio recorded blob size:",m(_.size)),void t.ondataavailable(_)}var g=new ArrayBuffer(44+2*h.length),v=new DataView(g);f(v,0,"RIFF"),v.setUint32(4,44+2*h.length-8,!0),f(v,8,"WAVE"),f(v,12,"fmt "),v.setUint32(16,16,!0),v.setUint16(20,1,!0),v.setUint16(22,d,!0),v.setUint32(24,c,!0),v.setUint32(28,c*d*2,!0),v.setUint16(32,2*d,!0),v.setUint16(34,16,!0),f(v,36,"data"),v.setUint32(40,2*h.length,!0);for(var y=h.length,S=44,k=0;k<y;k++)v.setInt16(S,32767*h[k],!0),S+=2;_=new Blob([v],{type:"audio/wav"});console.debug("audio recorded blob size:",m(_.size)),t.ondataavailable(_)}else b=!1},this.stop=function(){a=!1,this.requestData(),g.disconnect()};var _=h.AudioContextConstructor;h.VolumeGainNode=_.createGain();var g,v=h.VolumeGainNode;h.AudioInput=_.createMediaStreamSource(e),(g=h.AudioInput).connect(v);var y=t.bufferSize||2048;if(0===t.bufferSize&&(y=0),_.createJavaScriptNode)r=_.createJavaScriptNode(y,d,d);else{if(!_.createScriptProcessor)throw"WebAudio API has no support on this browser.";r=_.createScriptProcessor(y,d,d)}y=r.bufferSize,console.debug("using audio buffer-size:",y);var b=!1;window.scriptprocessornode=r,1===d&&console.debug("All right-channels are skipped.");var w=!1;this.pause=function(){w=!0},this.resume=function(){w=!1},r.onaudioprocess=function(e){if(a&&!b&&!w){var t=e.inputBuffer.getChannelData(0);if(o.push(new Float32Array(t)),2===d){var n=e.inputBuffer.getChannelData(1);i.push(new Float32Array(n))}s+=y}},v.connect(r),r.connect(_.destination)}function b(e){var t,n;this.start=function(r){for(var o in r=r||1e3,t=new w(e,this),this)"function"!=typeof this[o]&&(t[o]=this[o]);t.record(),n=setInterval((function(){t.requestData()}),r)},this.stop=function(){t&&(t.stop(),clearTimeout(n))},this.clearOldRecordedFrames=function(){t&&t.clearOldRecordedFrames()},this.pause=function(){t&&t.pause()},this.resume=function(){t&&t.resume()},this.ondataavailable=function(){}}function w(e,t){this.record=function(n){this.width||(this.width=320),this.height||(this.height=240),this.video&&this.video instanceof HTMLVideoElement&&(this.width||(this.width=a.videoWidth||a.clientWidth||320),this.height||(this.height=a.videoHeight||a.clientHeight||240)),this.video||(this.video={width:this.width,height:this.height}),this.canvas&&this.canvas.width&&this.canvas.height||(this.canvas={width:this.width,height:this.height}),d.width=this.canvas.width,d.height=this.canvas.height,this.video&&this.video instanceof HTMLVideoElement?(this.isHTMLObject=!0,a=this.video.cloneNode()):((a=document.createElement("video")).src=c.createObjectURL(e),a.width=this.video.width,a.height=this.video.height),a.muted=!0,a.play(),s=(new Date).getTime(),u=new k.Video(t.speed,t.quality),console.log("canvas resolutions",d.width,"*",d.height),console.log("video width/height",a.width||d.width,"*",a.height||d.height),o()},this.clearOldRecordedFrames=function(){u.frames=[]};var n=!1;this.requestData=function(){if(!p)if(u.frames.length){n=!0;var e=u.frames.slice(0);u.frames=function(e,t,n,r){var o=document.createElement("canvas");o.width=d.width,o.height=d.height;for(var i=o.getContext("2d"),a=[],s=-1===t,c=t&&t>0&&t<=e.length?t:e.length,u={r:0,g:0,b:0},l=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),f=n&&n>=0&&n<=1?n:0,p=r&&r>=0&&r<=1?r:0,m=!1,h=0;h<c;h++){var _,g,v;if(!m){var y=new Image;y.src=e[h].image,i.drawImage(y,0,0,d.width,d.height);var b=i.getImageData(0,0,d.width,d.height);_=0,g=b.data.length,v=b.data.length/4;for(var w=0;w<g;w+=4){var S={r:b.data[w],g:b.data[w+1],b:b.data[w+2]};Math.sqrt(Math.pow(S.r-u.r,2)+Math.pow(S.g-u.g,2)+Math.pow(S.b-u.b,2))<=l*f&&_++}}!m&&v-_<=v*p||(s&&(m=!0),a.push(e[h]))}(a=a.concat(e.slice(c))).length<=0&&a.push(e[e.length-1]);return a}(e,-1),u.compile((function(e){t.ondataavailable(e),console.debug("video recorded blob size:",m(e.size))})),u.frames=[],n=!1}else n=!1};var r=!1;function o(){if(p)return s=(new Date).getTime(),void setTimeout(o,500);if(!i){if(n)return setTimeout(o,100);var e=(new Date).getTime()-s;if(!e)return o();s=(new Date).getTime(),!f.isHTMLObject&&a.paused&&a.play(),l.drawImage(a,0,0,d.width,d.height),i||u.frames.push({duration:e,image:d.toDataURL("image/webp")}),r||function(e,t,n){var r=document.createElement("canvas");r.width=d.width,r.height=d.height;var o,i,a,s=r.getContext("2d"),c={r:0,g:0,b:0},u=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),l=t&&t>=0&&t<=1?t:0,f=n&&n>=0&&n<=1?n:0,p=new Image;p.src=e.image,s.drawImage(p,0,0,d.width,d.height);var m=s.getImageData(0,0,d.width,d.height);o=0,i=m.data.length,a=m.data.length/4;for(var h=0;h<i;h+=4){var _={r:m.data[h],g:m.data[h+1],b:m.data[h+2]};Math.sqrt(Math.pow(_.r-c.r,2)+Math.pow(_.g-c.g,2)+Math.pow(_.b-c.b,2))<=u*l&&o++}return!(a-o<=a*f)}(u.frames[u.frames.length-1])||(r=!0,t.onStartedDrawingNonBlankFrames()),setTimeout(o,10)}}var i=!1;this.stop=function(){i=!0,this.requestData()};var a,s,u,d=document.createElement("canvas"),l=d.getContext("2d"),f=this;var p=!1;this.pause=function(){p=!0},this.resume=function(){p=!1}}function S(e){if("undefined"==typeof GIFEncoder)throw"Please link: https://cdn.webrtc-experiment.com/gif-recorder.js";function t(){Date.now();var e=new Blob([new Uint8Array(u.stream().bin)],{type:"image/gif"});r.ondataavailable(e),u.stream().bin=[]}this.start=function(e){e=e||1e3;var r=this.videoWidth||320,c=this.videoHeight||240;o.width=a.width=r,o.height=a.height=c,(u=new GIFEncoder).setRepeat(0),u.setDelay(this.frameRate||this.speed||200),u.setQuality(this.quality||1),u.start(),Date.now(),l=requestAnimationFrame((function e(t){n?setTimeout(e,500,t):(l=requestAnimationFrame(e),void 0===typeof s&&(s=t),t-s<90||(a.paused&&a.play(),i.drawImage(a,0,0,r,c),u.addFrame(i),s=t))})),d=setTimeout(t,e)},this.stop=function(){l&&(cancelAnimationFrame(l),clearTimeout(d),t())};var n=!1;this.pause=function(){n=!0},this.resume=function(){n=!1},this.ondataavailable=function(){},this.onstop=function(){};var r=this,o=document.createElement("canvas"),i=o.getContext("2d"),a=document.createElement("video");a.muted=!0,a.autoplay=!0,a.src=c.createObjectURL(e),a.play();var s,u,d,l=null}void 0!==o&&(o.MediaRecorderWrapper=g),void 0!==o&&(o.StereoAudioRecorder=v),void 0!==o&&(o.StereoAudioRecorderHelper=y),void 0!==o&&(o.WhammyRecorder=b),void 0!==o&&(o.WhammyRecorderHelper=w),void 0!==o&&(o.GifRecorder=S);var k=function(){function e(e,t){this.frames=[],e||(e=1),this.duration=1e3/e,this.quality=t||.8}function t(e){function t(e,t,n){return[{data:e,id:231}].concat(n.map((function(e){var n=function(e){var t=0;e.keyframe&&(t|=128);e.invisible&&(t|=8);e.lacing&&(t|=e.lacing<<1);e.discardable&&(t|=1);if(e.trackNum>127)throw"TrackNumber > 127 not supported";return[128|e.trackNum,e.timecode>>8,255&e.timecode,t].map((function(e){return String.fromCharCode(e)})).join("")+e.frame}({discardable:0,frame:e.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(t)});return t+=e.duration,{data:n,id:163}})))}function n(e){for(var t=[];e>0;)t.push(255&e),e>>=8;return new Uint8Array(t.reverse())}function r(e){var t=[];e=(e.length%8?new Array(9-e.length%8).join("0"):"")+e;for(var n=0;n<e.length;n+=8)t.push(parseInt(e.substr(n,8),2));return new Uint8Array(t)}function o(e,t){return parseInt(e.substr(t+4,4).split("").map((function(e){var t=e.charCodeAt(0).toString(2);return new Array(8-t.length+1).join("0")+t})).join(""),2)}var i=new function(e){var o=function(e){if(!e[0])return void postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});for(var t=e[0].width,n=e[0].height,r=e[0].duration,o=1;o<e.length;o++)r+=e[o].duration;return{duration:r,width:t,height:n}}(e);if(!o)return[];for(var i,a=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:(i=o.duration,[].slice.call(new Uint8Array(new Float64Array([i]).buffer),0).map((function(e){return String.fromCharCode(e)})).reverse().join("")),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:o.width,id:176},{data:o.height,id:186}]}]}]}]}],s=0,c=0;s<e.length;){var u=[],d=0;do{u.push(e[s]),d+=e[s].duration,s++}while(s<e.length&&d<3e4);var l={id:524531317,data:t(c,0,u)};a[1].data.push(l),c+=d}return function e(t){for(var o=[],i=0;i<t.length;i++){var a=t[i].data;"object"==typeof a&&(a=e(a)),"number"==typeof a&&(a=r(a.toString(2))),"string"==typeof a&&(a=new Uint8Array(a.split("").map((function(e){return e.charCodeAt(0)}))));var s=a.size||a.byteLength||a.length,c=Math.ceil(Math.ceil(Math.log(s)/Math.log(2))/8),u=s.toString(2),d=new Array(7*c+7+1-u.length).join("0")+u,l=new Array(c).join("0")+"1"+d;o.push(n(t[i].id)),o.push(r(l)),o.push(a)}return new Blob(o,{type:"video/webm"})}(a)}(e.map((function(e){var t=function(e){for(var t=e.RIFF[0].WEBP[0],n=t.indexOf("*"),r=0,o=[];r<4;r++)o[r]=t.charCodeAt(n+3+r);return{width:16383&(o[1]<<8|o[0]),height:16383&(o[3]<<8|o[2]),data:t,riff:e}}(function e(t){for(var n=0,r={};n<t.length;){var i=t.substr(n,4),a=o(t,n),s=t.substr(n+4+4,a);n+=8+a,r[i]=r[i]||[],"RIFF"===i||"LIST"===i?r[i].push(e(s)):r[i].push(s)}return r}(atob(e.image.slice(23))));return t.duration=e.duration,t})));postMessage(i)}return e.prototype.add=function(e,t){if("canvas"in e&&(e=e.canvas),"toDataURL"in e&&(e=e.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/gi.test(e))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:e,duration:t||this.duration})},e.prototype.compile=function(e){var n,r,o,i=(n=t,r=c.createObjectURL(new Blob([n.toString(),"this.onmessage =  function (e) {"+n.name+"(e.data);}"],{type:"application/javascript"})),o=new Worker(r),c.revokeObjectURL(r),o);i.onmessage=function(t){t.data.error?console.error(t.data.error):e(t.data)},i.postMessage(this.frames)},{Video:e}}();void 0!==o&&(o.Whammy=k),window.ConcatenateBlobs=function(e,t,n){var r=[],o=0;!function i(){if(!e[o])return function(){var e=0;r.forEach((function(t){e+=t.byteLength}));var o=new Uint16Array(e),i=0;r.forEach((function(e){var t=e.byteLength;t%2!=0&&(e=e.slice(0,t-1)),o.set(new Uint16Array(e),i),i+=t}));var a=new Blob([o.buffer],{type:t});n(a)}();var a=new FileReader;a.onload=function(e){r.push(e.target.result),o++,i()},a.readAsArrayBuffer(e[o])}()},e.exports=o,void 0===(r=function(){return o}.apply(t,[]))||(e.exports=r)}).call(this,n(61))},function(e,t,n){parcelRequire=function(t,r,o,i){var a,s="function"==typeof parcelRequire&&parcelRequire;function c(e,o){if(!r[e]){if(!t[e]){var i="function"==typeof parcelRequire&&parcelRequire;if(!o&&i)return i(e,!0);if(s)return s(e,!0);if("string"==typeof e)return n(163)(e);var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}d.resolve=function(n){return t[e][1][n]||n},d.cache={};var u=r[e]=new c.Module(e);t[e][0].call(u.exports,d,u,u.exports,this)}return r[e].exports;function d(e){return c(d.resolve(e))}}c.isParcelRequire=!0,c.Module=function(e){this.id=e,this.bundle=c,this.exports={}},c.modules=t,c.cache=r,c.parent=s,c.register=function(e,n){t[e]=[function(e,t){t.exports=n},{}]};for(var u=0;u<o.length;u++)try{c(o[u])}catch(t){a||(a=t)}if(o.length){var d=c(o[o.length-1]);e.exports=d}if(parcelRequire=c,a)throw a;return c}({EgBh:[function(e,t,n){var r={};r.useBlobBuilder=function(){try{return new Blob([]),!1}catch(e){return!0}}(),r.useArrayBufferView=!r.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(e){return!0}}(),t.exports.binaryFeatures=r;var o=t.exports.BlobBuilder;function i(){this._pieces=[],this._parts=[]}"undefined"!=typeof window&&(o=t.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),i.prototype.append=function(e){"number"==typeof e?this._pieces.push(e):(this.flush(),this._parts.push(e))},i.prototype.flush=function(){if(this._pieces.length>0){var e=new Uint8Array(this._pieces);r.useArrayBufferView||(e=e.buffer),this._parts.push(e),this._pieces=[]}},i.prototype.getBuffer=function(){if(this.flush(),r.useBlobBuilder){for(var e=new o,t=0,n=this._parts.length;t<n;t++)e.append(this._parts[t]);return e.getBlob()}return new Blob(this._parts)},t.exports.BufferBuilder=i},{}],kdPp:[function(e,t,n){var r=e("./bufferbuilder").BufferBuilder,o=e("./bufferbuilder").binaryFeatures,i={unpack:function(e){return new a(e).unpack()},pack:function(e){var t=new s;return t.pack(e),t.getBuffer()}};function a(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function s(){this.bufferBuilder=new r}function c(e){var t=e.charCodeAt(0);return t<=2047?"00":t<=65535?"000":t<=2097151?"0000":t<=67108863?"00000":"000000"}t.exports=i,a.prototype.unpack=function(){var e,t=this.unpack_uint8();if(t<128)return t;if((224^t)<32)return(224^t)-32;if((e=160^t)<=15)return this.unpack_raw(e);if((e=176^t)<=15)return this.unpack_string(e);if((e=144^t)<=15)return this.unpack_array(e);if((e=128^t)<=15)return this.unpack_map(e);switch(t){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:case 213:case 214:case 215:return;case 216:return e=this.unpack_uint16(),this.unpack_string(e);case 217:return e=this.unpack_uint32(),this.unpack_string(e);case 218:return e=this.unpack_uint16(),this.unpack_raw(e);case 219:return e=this.unpack_uint32(),this.unpack_raw(e);case 220:return e=this.unpack_uint16(),this.unpack_array(e);case 221:return e=this.unpack_uint32(),this.unpack_array(e);case 222:return e=this.unpack_uint16(),this.unpack_map(e);case 223:return e=this.unpack_uint32(),this.unpack_map(e)}},a.prototype.unpack_uint8=function(){var e=255&this.dataView[this.index];return this.index++,e},a.prototype.unpack_uint16=function(){var e=this.read(2),t=256*(255&e[0])+(255&e[1]);return this.index+=2,t},a.prototype.unpack_uint32=function(){var e=this.read(4),t=256*(256*(256*e[0]+e[1])+e[2])+e[3];return this.index+=4,t},a.prototype.unpack_uint64=function(){var e=this.read(8),t=256*(256*(256*(256*(256*(256*(256*e[0]+e[1])+e[2])+e[3])+e[4])+e[5])+e[6])+e[7];return this.index+=8,t},a.prototype.unpack_int8=function(){var e=this.unpack_uint8();return e<128?e:e-256},a.prototype.unpack_int16=function(){var e=this.unpack_uint16();return e<32768?e:e-65536},a.prototype.unpack_int32=function(){var e=this.unpack_uint32();return e<Math.pow(2,31)?e:e-Math.pow(2,32)},a.prototype.unpack_int64=function(){var e=this.unpack_uint64();return e<Math.pow(2,63)?e:e-Math.pow(2,64)},a.prototype.unpack_raw=function(e){if(this.length<this.index+e)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+e+" "+this.length);var t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t},a.prototype.unpack_string=function(e){for(var t,n,r=this.read(e),o=0,i="";o<e;)(t=r[o])<128?(i+=String.fromCharCode(t),o++):(192^t)<32?(n=(192^t)<<6|63&r[o+1],i+=String.fromCharCode(n),o+=2):(n=(15&t)<<12|(63&r[o+1])<<6|63&r[o+2],i+=String.fromCharCode(n),o+=3);return this.index+=e,i},a.prototype.unpack_array=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this.unpack();return t},a.prototype.unpack_map=function(e){for(var t={},n=0;n<e;n++){var r=this.unpack(),o=this.unpack();t[r]=o}return t},a.prototype.unpack_float=function(){var e=this.unpack_uint32(),t=(e>>23&255)-127;return(0==e>>31?1:-1)*(8388607&e|8388608)*Math.pow(2,t-23)},a.prototype.unpack_double=function(){var e=this.unpack_uint32(),t=this.unpack_uint32(),n=(e>>20&2047)-1023;return(0==e>>31?1:-1)*((1048575&e|1048576)*Math.pow(2,n-20)+t*Math.pow(2,n-52))},a.prototype.read=function(e){var t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")},s.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},s.prototype.pack=function(e){var t=typeof e;if("string"===t)this.pack_string(e);else if("number"===t)Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if("boolean"===t)!0===e?this.bufferBuilder.append(195):!1===e&&this.bufferBuilder.append(194);else if("undefined"===t)this.bufferBuilder.append(192);else{if("object"!==t)throw new Error('Type "'+t+'" not yet supported');if(null===e)this.bufferBuilder.append(192);else{var n=e.constructor;if(n==Array)this.pack_array(e);else if(n==Blob||n==File||e instanceof Blob||e instanceof File)this.pack_bin(e);else if(n==ArrayBuffer)o.useArrayBufferView?this.pack_bin(new Uint8Array(e)):this.pack_bin(e);else if("BYTES_PER_ELEMENT"in e)o.useArrayBufferView?this.pack_bin(new Uint8Array(e.buffer)):this.pack_bin(e.buffer);else if(n==Object||n.toString().startsWith("class"))this.pack_object(e);else if(n==Date)this.pack_string(e.toString());else{if("function"!=typeof e.toBinaryPack)throw new Error('Type "'+n.toString()+'" not yet supported');this.bufferBuilder.append(e.toBinaryPack())}}}this.bufferBuilder.flush()},s.prototype.pack_bin=function(e){var t=e.length||e.byteLength||e.size;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this.bufferBuilder.append(218),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(t)}this.bufferBuilder.append(e)},s.prototype.pack_string=function(e){var t=function(e){return e.length>600?new Blob([e]).size:e.replace(/[^\u0000-\u007F]/g,c).length}(e);if(t<=15)this.pack_uint8(176+t);else if(t<=65535)this.bufferBuilder.append(216),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(t)}this.bufferBuilder.append(e)},s.prototype.pack_array=function(e){var t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this.bufferBuilder.append(220),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(t)}for(var n=0;n<t;n++)this.pack(e[n])},s.prototype.pack_integer=function(e){if(e>=-32&&e<=127)this.bufferBuilder.append(255&e);else if(e>=0&&e<=255)this.bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this.bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this.bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this.bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this.bufferBuilder.append(210),this.pack_int32(e);else if(e>=-0x8000000000000000&&e<=0x8000000000000000)this.bufferBuilder.append(211),this.pack_int64(e);else{if(!(e>=0&&e<=0x10000000000000000))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(e)}},s.prototype.pack_double=function(e){var t=0;e<0&&(t=1,e=-e);var n=Math.floor(Math.log(e)/Math.LN2),r=e/Math.pow(2,n)-1,o=Math.floor(r*Math.pow(2,52)),i=Math.pow(2,32),a=t<<31|n+1023<<20|o/i&1048575,s=o%i;this.bufferBuilder.append(203),this.pack_int32(a),this.pack_int32(s)},s.prototype.pack_object=function(e){var t=Object.keys(e).length;if(t<=15)this.pack_uint8(128+t);else if(t<=65535)this.bufferBuilder.append(222),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(t)}for(var n in e)e.hasOwnProperty(n)&&(this.pack(n),this.pack(e[n]))},s.prototype.pack_uint8=function(e){this.bufferBuilder.append(e)},s.prototype.pack_uint16=function(e){this.bufferBuilder.append(e>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_uint32=function(e){var t=4294967295&e;this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},s.prototype.pack_uint64=function(e){var t=e/Math.pow(2,32),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)},s.prototype.pack_int8=function(e){this.bufferBuilder.append(255&e)},s.prototype.pack_int16=function(e){this.bufferBuilder.append((65280&e)>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_int32=function(e){this.bufferBuilder.append(e>>>24&255),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},s.prototype.pack_int64=function(e){var t=Math.floor(e/Math.pow(2,32)),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)}},{"./bufferbuilder":"EgBh"}],iSxC:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.extractVersion=a,n.wrapPeerConnectionEvent=function(e,t,n){if(e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype,o=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return o.apply(this,arguments);var i=function(e){var t=n(e);t&&r(t)};return this._eventMap=this._eventMap||{},this._eventMap[r]=i,o.apply(this,[e,i])};var i=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[n])return i.apply(this,arguments);var r=this._eventMap[n];return delete this._eventMap[n],i.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}},n.disableLog=function(e){return"boolean"!=typeof e?new Error("Argument type: "+r(e)+". Please use a boolean."):(o=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},n.disableWarnings=function(e){return"boolean"!=typeof e?new Error("Argument type: "+r(e)+". Please use a boolean."):(i=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},n.log=function(){if("object"===("undefined"==typeof window?"undefined":r(window))){if(o)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},n.deprecated=function(e,t){i&&console.warn(e+" is deprecated, please use "+t+" instead.")},n.detectBrowser=function(e){var{navigator:t}=e,n={browser:null,version:null};if(void 0===e||!e.navigator)return n.browser="Not a browser.",n;if(t.mozGetUserMedia)n.browser="firefox",n.version=a(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)n.browser="chrome",n.version=a(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))n.browser="edge",n.version=a(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return n.browser="Not a supported browser.",n;n.browser="safari",n.version=a(t.userAgent,/AppleWebKit\/(\d+)\./,1),n.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return n},n.compactObject=function e(t){return s(t)?Object.keys(t).reduce((function(n,r){var o=s(t[r]),i=o?e(t[r]):t[r],a=o&&!Object.keys(i).length;return void 0===i||a?n:Object.assign(n,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},r,i))}),{}):t},n.walkStats=c,n.filterStats=function(e,t,n){var r=n?"outbound-rtp":"inbound-rtp",o=new Map;if(null===t)return o;var i=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&i.push(e)})),i.forEach((function(t){e.forEach((function(n){n.type===r&&n.trackId===t.id&&c(e,n,o)}))})),o};var o=!0,i=!0;function a(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function s(e){return"[object Object]"===Object.prototype.toString.call(e)}function c(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((function(r){r.endsWith("Id")?c(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach((function(t){c(e,e.get(t),n)}))})))}},{}],s6SN:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices){var n=r.detectBrowser(e),o=function(e){if("object"!==i(e)||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"===i(e[n])?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var a={};"number"==typeof r.ideal?(a[o("min",n)]=r.ideal,t.optional.push(a),(a={})[o("max",n)]=r.ideal,t.optional.push(a)):(a[o("",n)]=r.ideal,t.optional.push(a))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[o("",n)]=r.exact):["min","max"].forEach((function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[o(e,n)]=r[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},s=function(e,r){if(n.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===i(e.audio)){var s=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};s((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),s(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=o(e.audio)}if(e&&"object"===i(e.video)){var c=e.video.facingMode;c=c&&("object"===i(c)?c:{ideal:c});var u,d=n.version<66;if(c&&("user"===c.exact||"environment"===c.exact||"user"===c.ideal||"environment"===c.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||d)&&(delete e.video.facingMode,"environment"===c.exact||"environment"===c.ideal?u=["back","rear"]:"user"!==c.exact&&"user"!==c.ideal||(u=["front"]),u))return t.mediaDevices.enumerateDevices().then((function(t){var n=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return u.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!n&&t.length&&u.includes("back")&&(n=t[t.length-1]),n&&(e.video.deviceId=c.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=o(e.video),a("chrome: "+JSON.stringify(e)),r(e)}));e.video=o(e.video)}return a("chrome: "+JSON.stringify(e)),r(e)},c=function(e){return n.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=function(e,n,r){s(e,(function(e){t.webkitGetUserMedia(e,n,(function(e){r&&r(c(e))}))}))}.bind(t),t.mediaDevices.getUserMedia){var u=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return s(e,(function(e){return u(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(c(e))}))}))}}}};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=r?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils.js"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=r.log},{"../utils.js":"iSxC"}],VHa8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((function(t){var r=n.video&&n.video.width,o=n.video&&n.video.height,i=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:i||3}},r&&(n.video.mandatory.maxWidth=r),o&&(n.video.mandatory.maxHeight=o),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},{}],uI5X:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},n.shimOnTrack=function(e){if("object"!==c(e)||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype)r.wrapPeerConnectionEvent(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}));else{Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(r){var o;o=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.track.id})):{track:r.track};var i=new Event("track");i.track=r.track,i.receiver=o,i.transceiver={receiver:o},i.streams=[t.stream],n.dispatchEvent(i)})),t.stream.getTracks().forEach((function(r){var o;o=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.id})):{track:r};var i=new Event("track");i.track=r,i.receiver=o,i.transceiver={receiver:o},i.streams=[t.stream],n.dispatchEvent(i)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}},n.shimGetSendersWithDtmf=function(e){if("object"===c(e)&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){var o=n.apply(this,arguments);return o||(o=t(this,e),this._senders.push(o)),o};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var o=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach((function(e){n._senders.push(t(n,e))}))};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((function(e){var n=t._senders.find((function(t){return t.track===e}));n&&t._senders.splice(t._senders.indexOf(n),1)}))}}else if("object"===c(e)&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},n.shimGetStats=function(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,[n,r,o]=arguments;if(arguments.length>0&&"function"==typeof n)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof n))return t.apply(this,[]);var i=function(e){var t={};return e.result().forEach((function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){n[t]=e.stat(t)})),t[n.id]=n})),t},a=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};return arguments.length>=2?t.apply(this,[function(e){r(a(i(e)))},n]):new Promise((function(n,r){t.apply(e,[function(e){n(a(i(e)))},r])})).then(r,o)}}},n.shimSenderReceiverGetStats=function(e){if("object"===c(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return r.filterStats(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var o=e.RTCPeerConnection.prototype.getReceivers;o&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=o.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),r.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return r.filterStats(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,n,r,o=arguments[0];return this.getSenders().forEach((function(e){e.track===o&&(t?r=!0:t=e)})),this.getReceivers().forEach((function(e){return e.track===o&&(n?r=!0:n=e),e.track===o})),r||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return i.apply(this,arguments)}}}},n.shimAddTrackRemoveTrackWithNative=u,n.shimAddTrackRemoveTrack=function(e){if(e.RTCPeerConnection){var t=r.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return u(e);var n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=n.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var o=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(n.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var r=new e.MediaStream(t.getTracks());this._streams[t.id]=r,this._reverseStreams[r.id]=t,t=r}o.apply(this,[t])};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var o=[].slice.call(arguments,1);if(1!==o.length||!o[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var i=this._streams[n.id];if(i)i.addTrack(t),Promise.resolve().then((function(){r.dispatchEvent(new Event("negotiationneeded"))}));else{var a=new e.MediaStream([t]);this._streams[n.id]=a,this._reverseStreams[a.id]=n,this.addStream(a)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=s({},t,(function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[function(n){var r=d(e,n);t[0].apply(null,[r])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):n.apply(this,arguments).then((function(t){return d(e,t)}))}));e.RTCPeerConnection.prototype[t]=r[t]}));var a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(e=this,n=(t=arguments[0]).sdp,Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],o=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),o.id)})),new RTCSessionDescription({type:t.type,sdp:n})),a.apply(this,arguments)):a.apply(this,arguments);var e,t,n};var c=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=c.get.apply(this);return""===e.type?e:d(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach((function(r){n._streams[r].getTracks().find((function(t){return e.track===t}))&&(t=n._streams[r])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function d(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],o=e._streams[r.id];n=n.replace(new RegExp(o.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}},n.shimPeerConnection=function(e){var t=r.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection){t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=s({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]}));var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?t.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},n.fixNegotiationNeeded=function(e){r.wrapPeerConnectionEvent(e,"negotiationneeded",(function(e){if("stable"===e.target.signalingState)return e}))},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return o.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("../utils.js")),o=e("./getusermedia"),i=e("./getdisplaymedia");function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var r=this.getSenders();n.apply(this,arguments);var o=this.getSenders().filter((function(e){return-1===r.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(o)};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};var o=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(n){var r=t._shimmedLocalStreams[n].indexOf(e);-1!==r&&t._shimmedLocalStreams[n].splice(r,1),1===t._shimmedLocalStreams[n].length&&delete t._shimmedLocalStreams[n]})),o.apply(this,arguments)}}},{"../utils.js":"iSxC","./getusermedia":"s6SN","./getdisplaymedia":"VHa8"}],NZ1C:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.filterIceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&r.deprecated("RTCIceServer.url","RTCIceServer.urls");var o="string"==typeof t;return o&&(t=[t]),t=t.filter((function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?(n=!0,!0):t&&!n})),delete e.url,e.urls=o?t[0]:t,!!t.length}}))};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=r?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}},{"../utils":"iSxC"}],YHvh:[function(e,t,n){"use strict";var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},r.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},r.getDescription=function(e){var t=r.splitSections(e);return t&&t[0]},r.getMediaSections=function(e){var t=r.splitSections(e);return t.shift(),t},r.matchPrefix=function(e,t){return r.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},r.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:n[t[r]]=t[r+1]}return n},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},r.parseIceOptions=function(e){return e.substr(14).split(" ")},r.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},r.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},r.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),o=0;o<r.length;o++)n[(t=r[o].trim().split("="))[0].trim()]=t[1];return n},r.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)})),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},r.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},r.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},r.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},r.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},r.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:r.matchPrefix(e+t,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},r.getIceParameters=function(e,t){var n=r.splitLines(e);return{usernameFragment:(n=n.concat(r.splitLines(t))).filter((function(e){return 0===e.indexOf("a=ice-ufrag:")}))[0].substr(12),password:n.filter((function(e){return 0===e.indexOf("a=ice-pwd:")}))[0].substr(10)}},r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e)[0].split(" "),o=3;o<n.length;o++){var i=n[o],a=r.matchPrefix(e,"a=rtpmap:"+i+" ")[0];if(a){var s=r.parseRtpMap(a),c=r.matchPrefix(e,"a=fmtp:"+i+" ");switch(s.parameters=c.length?r.parseFmtp(c[0]):{},s.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+i+" ").map(r.parseRtcpFb),t.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(r.parseExtmap(e))})),t},r.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)}));var o=0;return t.codecs.forEach((function(e){e.maxptime>o&&(o=e.maxptime)})),o>0&&(n+="a=maxptime:"+o+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach((function(e){n+=r.writeExtmap(e)})),n},r.parseRtpEncodingParameters=function(e){var t,n=[],o=r.parseRtpParameters(e),i=-1!==o.fecMechanisms.indexOf("RED"),a=-1!==o.fecMechanisms.indexOf("ULPFEC"),s=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=s.length>0&&s[0].ssrc,u=r.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));u.length>0&&u[0].length>1&&u[0][0]===c&&(t=u[0][1]),o.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(r.rtx={ssrc:t}),n.push(r),i&&((r=JSON.parse(JSON.stringify(r))).fec={ssrc:c,mechanism:a?"red+ulpfec":"red"},n.push(r))}})),0===n.length&&c&&n.push({ssrc:c});var d=r.matchPrefix(e,"b=");return d.length&&(d=0===d[0].indexOf("b=TIAS:")?parseInt(d[0].substr(7),10):0===d[0].indexOf("b=AS:")?1e3*parseInt(d[0].substr(5),10)*.95-16e3:void 0,n.forEach((function(e){e.maxBitrate=d}))),n},r.parseRtcpParameters=function(e){var t={},n=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var o=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=o.length>0,t.compound=0===o.length;var i=r.matchPrefix(e,"a=rtcp-mux");return t.mux=i.length>0,t},r.parseMsid=function(e){var t,n=r.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};var o=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return o.length>0?{stream:(t=o[0].value.split(" "))[0],track:t[1]}:void 0},r.parseSctpDescription=function(e){var t,n=r.parseMLine(e),o=r.matchPrefix(e,"a=max-message-size:");o.length>0&&(t=parseInt(o[0].substr(19),10)),isNaN(t)&&(t=65536);var i=r.matchPrefix(e,"a=sctp-port:");if(i.length>0)return{port:parseInt(i[0].substr(12),10),protocol:n.fmt,maxMessageSize:t};if(r.matchPrefix(e,"a=sctpmap:").length>0){var a=r.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(a[0],10),protocol:a[1],maxMessageSize:t}}},r.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(e,t,n){var o=void 0!==t?t:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||r.generateSessionId())+" "+o+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,n,o){var i=r.writeRtpDescription(e.kind,t);if(i+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),i+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),i+="a=mid:"+e.mid+"\r\n",e.direction?i+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?i+="a=sendrecv\r\n":e.rtpSender?i+="a=sendonly\r\n":e.rtpReceiver?i+="a=recvonly\r\n":i+="a=inactive\r\n",e.rtpSender){var a="msid:"+o.id+" "+e.rtpSender.track.id+"\r\n";i+="a="+a,i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,i+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),i},r.getDirection=function(e,t){for(var n=r.splitLines(e),o=0;o<n.length;o++)switch(n[o]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[o].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){return r.splitLines(e)[0].split(" ")[0].substr(2)},r.isRejected=function(e){return"0"===e.split(" ",2)[1]},r.parseMLine=function(e){var t=r.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},r.parseOLine=function(e){var t=r.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},r.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=r.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||"="!==t[n].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=r)},{}],NJ2u:[function(e,t,n){"use strict";var r=e("sdp");function o(e,t,n,o,i){var a=r.writeRtpDescription(e.kind,t);if(a+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":i||"active"),a+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var c="msid:"+(o?o.id:"-")+" "+s+"\r\n";a+="a="+c,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),a}function i(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},o=function(e,t,n,o){var i=r(e.parameters.apt,n),a=r(t.parameters.apt,o);return i&&a&&i.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach((function(r){for(var i=0;i<t.codecs.length;i++){var a=t.codecs[i];if(r.name.toLowerCase()===a.name.toLowerCase()&&r.clockRate===a.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&a.parameters.apt&&!o(r,a,e.codecs,t.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(r.numChannels,a.numChannels),n.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter((function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var r=0;r<t.headerExtensions.length;r++){var o=t.headerExtensions[r];if(e.uri===o.uri){n.headerExtensions.push(o);break}}})),n}function a(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function s(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function c(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}t.exports=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function u(t,n,r,o){var i=new Event("track");i.track=n,i.receiver=r,i.transceiver={receiver:r},i.streams=o,e.setTimeout((function(){t._dispatchEvent("track",i)}))}var d=function(n){var o=this,i=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){o[e]=i[e].bind(i)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var o="string"==typeof r;return o&&(r=[r]),r=r.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(n=!0,!0)})),delete e.url,e.urls=o?r[0]:r,!!r.length}}))}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var a=n.iceCandidatePoolSize;a>0;a--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=r.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(d.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(d.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),d.prototype.onicecandidate=null,d.prototype.onaddstream=null,d.prototype.ontrack=null,d.prototype.onremovestream=null,d.prototype.onsignalingstatechange=null,d.prototype.oniceconnectionstatechange=null,d.prototype.onconnectionstatechange=null,d.prototype.onicegatheringstatechange=null,d.prototype.onnegotiationneeded=null,d.prototype.ondatachannel=null,d.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},d.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},d.prototype.getConfiguration=function(){return this._config},d.prototype.getLocalStreams=function(){return this.localStreams},d.prototype.getRemoteStreams=function(){return this.remoteStreams},d.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var o=this._createIceAndDtlsTransports();r.iceTransport=o.iceTransport,r.dtlsTransport=o.dtlsTransport}return t||this.transceivers.push(r),r},d.prototype.addTrack=function(t,n){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find((function(e){return e.track===t})))throw c("InvalidAccessError","Track already exists.");for(var o=0;o<this.transceivers.length;o++)this.transceivers[o].track||this.transceivers[o].kind!==t.kind||(r=this.transceivers[o]);return r||(r=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),r.track=t,r.stream=n,r.rtpSender=new e.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},d.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach((function(t){n.addTrack(t,e)}));else{var r=e.clone();e.getTracks().forEach((function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",(function(e){n.enabled=e.enabled}))})),r.getTracks().forEach((function(e){n.addTrack(e,r)}))}},d.prototype.removeTrack=function(t){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw c("InvalidAccessError","Sender was not created by this connection.");var r=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},d.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},d.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},d.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},d.prototype._createIceGatherer=function(t,n){var r=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var o=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(o,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;o.state=n?"completed":"gathering",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},o.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),o},d.prototype._gather=function(t,n){var o=this,i=this.transceivers[n].iceGatherer;if(!i.onlocalcandidate){var a=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,i.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),i.onlocalcandidate=function(e){if(!(o.usingBundle&&n>0)){var a=new Event("icecandidate");a.candidate={sdpMid:t,sdpMLineIndex:n};var s=e.candidate,c=!s||0===Object.keys(s).length;if(c)"new"!==i.state&&"gathering"!==i.state||(i.state="completed");else{"new"===i.state&&(i.state="gathering"),s.component=1,s.ufrag=i.getLocalParameters().usernameFragment;var u=r.writeCandidate(s);a.candidate=Object.assign(a.candidate,r.parseCandidate(u)),a.candidate.candidate=u,a.candidate.toJSON=function(){return{candidate:a.candidate.candidate,sdpMid:a.candidate.sdpMid,sdpMLineIndex:a.candidate.sdpMLineIndex,usernameFragment:a.candidate.usernameFragment}}}var d=r.getMediaSections(o._localDescription.sdp);d[a.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+a.candidate.candidate+"\r\n",o._localDescription.sdp=r.getDescription(o._localDescription.sdp)+d.join("");var l=o.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==o.iceGatheringState&&(o.iceGatheringState="gathering",o._emitGatheringStateChange()),c||o._dispatchEvent("icecandidate",a),l&&(o._dispatchEvent("icecandidate",new Event("icecandidate")),o.iceGatheringState="complete",o._emitGatheringStateChange())}},e.setTimeout((function(){a.forEach((function(e){i.onlocalcandidate(e)}))}),0)}},d.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(n);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:r}},d.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},d.prototype._transceive=function(e,n,o){var a=i(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(a.encodings=e.sendEncodingParameters,a.rtcp={cname:r.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(a.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(a)),o&&e.rtpReceiver&&a.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?a.encodings=e.recvEncodingParameters:a.encodings=[{}],a.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(a.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(a.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(a))},d.prototype.setLocalDescription=function(e){var t,n,o=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(c("TypeError",'Unsupported type "'+e.type+'"'));if(!a("setLocalDescription",e.type,o.signalingState)||o._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+o.signalingState));if("offer"===e.type)t=r.splitSections(e.sdp),n=t.shift(),t.forEach((function(e,t){var n=r.parseRtpParameters(e);o.transceivers[t].localCapabilities=n})),o.transceivers.forEach((function(e,t){o._gather(e.mid,t)}));else if("answer"===e.type){t=r.splitSections(o._remoteDescription.sdp),n=t.shift();var s=r.matchPrefix(n,"a=ice-lite").length>0;t.forEach((function(e,t){var a=o.transceivers[t],c=a.iceGatherer,u=a.iceTransport,d=a.dtlsTransport,l=a.localCapabilities,f=a.remoteCapabilities;if(!(r.isRejected(e)&&0===r.matchPrefix(e,"a=bundle-only").length||a.rejected)){var p=r.getIceParameters(e,n),m=r.getDtlsParameters(e,n);s&&(m.role="server"),o.usingBundle&&0!==t||(o._gather(a.mid,t),"new"===u.state&&u.start(c,p,s?"controlling":"controlled"),"new"===d.state&&d.start(m));var h=i(l,f);o._transceive(a,h.codecs.length>0,!1)}}))}return o._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?o._updateSignalingState("have-local-offer"):o._updateSignalingState("stable"),Promise.resolve()},d.prototype.setRemoteDescription=function(o){var d=this;if(-1===["offer","answer"].indexOf(o.type))return Promise.reject(c("TypeError",'Unsupported type "'+o.type+'"'));if(!a("setRemoteDescription",o.type,d.signalingState)||d._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+o.type+" in state "+d.signalingState));var l={};d.remoteStreams.forEach((function(e){l[e.id]=e}));var f=[],p=r.splitSections(o.sdp),m=p.shift(),h=r.matchPrefix(m,"a=ice-lite").length>0,_=r.matchPrefix(m,"a=group:BUNDLE ").length>0;d.usingBundle=_;var g=r.matchPrefix(m,"a=ice-options:")[0];return d.canTrickleIceCandidates=!!g&&g.substr(14).split(" ").indexOf("trickle")>=0,p.forEach((function(a,c){var u=r.splitLines(a),p=r.getKind(a),g=r.isRejected(a)&&0===r.matchPrefix(a,"a=bundle-only").length,v=u[0].substr(2).split(" ")[2],y=r.getDirection(a,m),b=r.parseMsid(a),w=r.getMid(a)||r.generateIdentifier();if(g||"application"===p&&("DTLS/SCTP"===v||"UDP/DTLS/SCTP"===v))d.transceivers[c]={mid:w,kind:p,protocol:v,rejected:!0};else{var S,k,C,E,T,O,P,A,R;!g&&d.transceivers[c]&&d.transceivers[c].rejected&&(d.transceivers[c]=d._createTransceiver(p,!0));var M,x,U=r.parseRtpParameters(a);g||(M=r.getIceParameters(a,m),(x=r.getDtlsParameters(a,m)).role="client"),P=r.parseRtpEncodingParameters(a);var I=r.parseRtcpParameters(a),D=r.matchPrefix(a,"a=end-of-candidates",m).length>0,j=r.matchPrefix(a,"a=candidate:").map((function(e){return r.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===o.type||"answer"===o.type)&&!g&&_&&c>0&&d.transceivers[c]&&(d._disposeIceAndDtlsTransports(c),d.transceivers[c].iceGatherer=d.transceivers[0].iceGatherer,d.transceivers[c].iceTransport=d.transceivers[0].iceTransport,d.transceivers[c].dtlsTransport=d.transceivers[0].dtlsTransport,d.transceivers[c].rtpSender&&d.transceivers[c].rtpSender.setTransport(d.transceivers[0].dtlsTransport),d.transceivers[c].rtpReceiver&&d.transceivers[c].rtpReceiver.setTransport(d.transceivers[0].dtlsTransport)),"offer"!==o.type||g)"answer"!==o.type||g||(k=(S=d.transceivers[c]).iceGatherer,C=S.iceTransport,E=S.dtlsTransport,T=S.rtpReceiver,O=S.sendEncodingParameters,A=S.localCapabilities,d.transceivers[c].recvEncodingParameters=P,d.transceivers[c].remoteCapabilities=U,d.transceivers[c].rtcpParameters=I,j.length&&"new"===C.state&&(!h&&!D||_&&0!==c?j.forEach((function(e){s(S.iceTransport,e)})):C.setRemoteCandidates(j)),_&&0!==c||("new"===C.state&&C.start(k,M,"controlling"),"new"===E.state&&E.start(x)),!i(S.localCapabilities,S.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&S.sendEncodingParameters[0].rtx&&delete S.sendEncodingParameters[0].rtx,d._transceive(S,"sendrecv"===y||"recvonly"===y,"sendrecv"===y||"sendonly"===y),!T||"sendrecv"!==y&&"sendonly"!==y?delete S.rtpReceiver:(R=T.track,b?(l[b.stream]||(l[b.stream]=new e.MediaStream),n(R,l[b.stream]),f.push([R,T,l[b.stream]])):(l.default||(l.default=new e.MediaStream),n(R,l.default),f.push([R,T,l.default]))));else{(S=d.transceivers[c]||d._createTransceiver(p)).mid=w,S.iceGatherer||(S.iceGatherer=d._createIceGatherer(c,_)),j.length&&"new"===S.iceTransport.state&&(!D||_&&0!==c?j.forEach((function(e){s(S.iceTransport,e)})):S.iceTransport.setRemoteCandidates(j)),A=e.RTCRtpReceiver.getCapabilities(p),t<15019&&(A.codecs=A.codecs.filter((function(e){return"rtx"!==e.name}))),O=S.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var B,L=!1;"sendrecv"===y||"sendonly"===y?(L=!S.rtpReceiver,T=S.rtpReceiver||new e.RTCRtpReceiver(S.dtlsTransport,p),L&&(R=T.track,b&&"-"===b.stream||(b?(l[b.stream]||(l[b.stream]=new e.MediaStream,Object.defineProperty(l[b.stream],"id",{get:function(){return b.stream}})),Object.defineProperty(R,"id",{get:function(){return b.track}}),B=l[b.stream]):(l.default||(l.default=new e.MediaStream),B=l.default)),B&&(n(R,B),S.associatedRemoteMediaStreams.push(B)),f.push([R,T,B]))):S.rtpReceiver&&S.rtpReceiver.track&&(S.associatedRemoteMediaStreams.forEach((function(t){var n,r,o=t.getTracks().find((function(e){return e.id===S.rtpReceiver.track.id}));o&&(n=o,(r=t).removeTrack(n),r.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:n})))})),S.associatedRemoteMediaStreams=[]),S.localCapabilities=A,S.remoteCapabilities=U,S.rtpReceiver=T,S.rtcpParameters=I,S.sendEncodingParameters=O,S.recvEncodingParameters=P,d._transceive(d.transceivers[c],!1,L)}}})),void 0===d._dtlsRole&&(d._dtlsRole="offer"===o.type?"active":"passive"),d._remoteDescription={type:o.type,sdp:o.sdp},"offer"===o.type?d._updateSignalingState("have-remote-offer"):d._updateSignalingState("stable"),Object.keys(l).forEach((function(t){var n=l[t];if(n.getTracks().length){if(-1===d.remoteStreams.indexOf(n)){d.remoteStreams.push(n);var r=new Event("addstream");r.stream=n,e.setTimeout((function(){d._dispatchEvent("addstream",r)}))}f.forEach((function(e){var t=e[0],r=e[1];n.id===e[2].id&&u(d,t,r,[n])}))}})),f.forEach((function(e){e[2]||u(d,e[0],e[1],[])})),e.setTimeout((function(){d&&d.transceivers&&d.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},d.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},d.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},d.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},d.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},d.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},d.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var i=n.transceivers.filter((function(e){return"audio"===e.kind})).length,a=n.transceivers.filter((function(e){return"video"===e.kind})).length,s=arguments[0];if(s){if(s.mandatory||s.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==s.offerToReceiveAudio&&(i=!0===s.offerToReceiveAudio?1:!1===s.offerToReceiveAudio?0:s.offerToReceiveAudio),void 0!==s.offerToReceiveVideo&&(a=!0===s.offerToReceiveVideo?1:!1===s.offerToReceiveVideo?0:s.offerToReceiveVideo)}for(n.transceivers.forEach((function(e){"audio"===e.kind?--i<0&&(e.wantReceive=!1):"video"===e.kind&&--a<0&&(e.wantReceive=!1)}));i>0||a>0;)i>0&&(n._createTransceiver("audio"),i--),a>0&&(n._createTransceiver("video"),a--);var u=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(o,i){var a=o.track,s=o.kind,c=o.mid||r.generateIdentifier();o.mid=c,o.iceGatherer||(o.iceGatherer=n._createIceGatherer(i,n.usingBundle));var u=e.RTCRtpSender.getCapabilities(s);t<15019&&(u.codecs=u.codecs.filter((function(e){return"rtx"!==e.name}))),u.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),o.remoteCapabilities&&o.remoteCapabilities.codecs&&o.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),u.headerExtensions.forEach((function(e){(o.remoteCapabilities&&o.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var d=o.sendEncodingParameters||[{ssrc:1001*(2*i+1)}];a&&t>=15019&&"video"===s&&!d[0].rtx&&(d[0].rtx={ssrc:d[0].ssrc+1}),o.wantReceive&&(o.rtpReceiver=new e.RTCRtpReceiver(o.dtlsTransport,s)),o.localCapabilities=u,o.sendEncodingParameters=d})),"max-compat"!==n._config.bundlePolicy&&(u+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),u+="a=ice-options:trickle\r\n",n.transceivers.forEach((function(e,t){u+=o(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),u+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,u+="a="+r.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(u+="a=end-of-candidates\r\n"))}));var d=new e.RTCSessionDescription({type:"offer",sdp:u});return Promise.resolve(d)},d.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var a=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(a+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n";var s=r.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(e,r){if(!(r+1>s)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?a+="m=application 0 DTLS/SCTP 5000\r\n":a+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?a+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(a+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(a+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;e.stream&&("audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var u=i(e.localCapabilities,e.remoteCapabilities);!u.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,a+=o(e,u,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(a+="a=rtcp-rsize\r\n")}}));var u=new e.RTCSessionDescription({type:"answer",sdp:a});return Promise.resolve(u)},d.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(o,i){if(!n._remoteDescription)return i(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var a=e.sdpMLineIndex;if(e.sdpMid)for(var u=0;u<n.transceivers.length;u++)if(n.transceivers[u].mid===e.sdpMid){a=u;break}var d=n.transceivers[a];if(!d)return i(c("OperationError","Can not add ICE candidate"));if(d.rejected)return o();var l=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if("tcp"===l.protocol&&(0===l.port||9===l.port))return o();if(l.component&&1!==l.component)return o();if((0===a||a>0&&d.iceTransport!==n.transceivers[0].iceTransport)&&!s(d.iceTransport,l))return i(c("OperationError","Can not add ICE candidate"));var f=e.candidate.trim();0===f.indexOf("a=")&&(f=f.substr(2)),(t=r.getMediaSections(n._remoteDescription.sdp))[a]+="a="+(l.type?f:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var p=0;p<n.transceivers.length&&(n.transceivers[p].rejected||(n.transceivers[p].iceTransport.addRemoteCandidate({}),(t=r.getMediaSections(n._remoteDescription.sdp))[p]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));p++);o()}))},d.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)})),!n)throw c("InvalidAccessError","Invalid selector.");return n.getStats()}var r=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&r.push(e[t].getStats())}))})),Promise.all(r).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var r=n.prototype.getStats;n.prototype.getStats=function(){return r.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){e[n].type=function(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}(e[n]),t.set(n,e[n])})),t}))}}}));var l=["createOffer","createAnswer"];return l.forEach((function(e){var t=d.prototype[e];d.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(l=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=d.prototype[e];d.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=d.prototype[e];d.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),d}},{sdp:"YHvh"}],YdKx:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch((function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))}))}}},{}],P3bV:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}},{}],XRic:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimPeerConnection=function(e){var t=r.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){n.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var a=(0,i.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,o.filterIceServers)(e.iceServers,t.version),r.log("ICE servers after filtering:",e.iceServers)),new a(e)},e.RTCPeerConnection.prototype=a.prototype},n.shimReplaceTrack=function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return a.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return s.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("../utils")),o=e("./filtericeservers"),i=function(e){return e&&e.__esModule?e:{default:e}}(e("rtcpeerconnection-shim")),a=e("./getusermedia"),s=e("./getdisplaymedia");function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}},{"../utils":"iSxC","./filtericeservers":"NZ1C","rtcpeerconnection-shim":"NJ2u","./getusermedia":"YdKx","./getdisplaymedia":"P3bV"}],GzSv:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=r.detectBrowser(e),n=e&&e.navigator,o=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,o){r.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,o)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var a=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===i(e)&&"object"===i(e.audio)&&(e=JSON.parse(JSON.stringify(e)),a(e.audio,"autoGainControl","mozAutoGainControl"),a(e.audio,"noiseSuppression","mozNoiseSuppression")),s(e)},o&&o.prototype.getSettings){var c=o.prototype.getSettings;o.prototype.getSettings=function(){var e=c.apply(this,arguments);return a(e,"mozAutoGainControl","autoGainControl"),a(e,"mozNoiseSuppression","noiseSuppression"),e}}if(o&&o.prototype.applyConstraints){var u=o.prototype.applyConstraints;o.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===i(e)&&(e=JSON.parse(JSON.stringify(e)),a(e,"autoGainControl","mozAutoGainControl"),a(e,"noiseSuppression","mozNoiseSuppression")),u.apply(this,[e])}}}};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=r?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":"iSxC"}],UuGU:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){var r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}},{}],Fzdr:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimOnTrack=function(e){"object"===s(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimPeerConnection=function(e){var t=r.detectBrowser(e);if("object"===s(e)&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){if(!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]})),t.version<68){var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var o={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var[e,n,r]=arguments;return i.apply(this,[e||null]).then((function(e){if(t.version<53&&!n)try{e.forEach((function(e){e.type=o[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,n){e.set(n,Object.assign({},t,{type:o[t.type]||t.type}))}))}return e})).then(n,r)}}},n.shimSenderGetStats=function(e){if("object"===s(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},n.shimReceiverGetStats=function(e){if("object"===s(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n}),r.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},n.shimRemoveStream=function(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;r.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(n){n.track&&e.getTracks().includes(n.track)&&t.removeTrack(n)}))})},n.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},n.shimAddTransceiver=function(e){if("object"===s(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach((function(e){if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var r=t.apply(this,arguments);if(n){var{sender:o}=r,i=o.getParameters();"encodings"in i||(i.encodings=e.sendEncodings,this.setParametersPromises.push(o.setParameters(i).catch((function(){}))))}return r})}},n.shimCreateOffer=function(e){if("object"===s(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(n,e)})).finally((function(){n.setParametersPromises=[]})):t.apply(this,arguments)}}},n.shimCreateAnswer=function(e){if("object"===s(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(n,e)})).finally((function(){n.setParametersPromises=[]})):t.apply(this,arguments)}}},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return o.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("../utils")),o=e("./getusermedia"),i=e("./getdisplaymedia");function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":"iSxC","./getusermedia":"GzSv","./getdisplaymedia":"UuGU"}],t1lL:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimLocalStreamsAPI=function(e){if("object"===i(e)&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(r){return t.call(n,r,e)})),e.getVideoTracks().forEach((function(r){return t.call(n,r,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){var n=arguments[1];return n&&(this._localStreams?this._localStreams.includes(n)||this._localStreams.push(n):this._localStreams=[n]),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var n=this._localStreams.indexOf(e);if(-1!==n){this._localStreams.splice(n,1);var r=e.getTracks();this.getSenders().forEach((function(e){r.includes(e.track)&&t.removeTrack(e)}))}})}},n.shimRemoteStreamsAPI=function(e){if("object"===i(e)&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var n=new Event("addstream");n.stream=e,t.dispatchEvent(n)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}}))}),t.apply(e,arguments)}}},n.shimCallbacksAPI=function(e){if("object"===i(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,o=t.setLocalDescription,a=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],o=n.apply(this,[r]);return t?(o.then(e,t),Promise.resolve()):o},t.createAnswer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],o=r.apply(this,[n]);return t?(o.then(e,t),Promise.resolve()):o};var c=function(e,t,n){var r=o.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=c,c=function(e,t,n){var r=a.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.setRemoteDescription=c,c=function(e,t,n){var r=s.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=c}},n.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var n=t.mediaDevices,r=n.getUserMedia.bind(n);t.mediaDevices.getUserMedia=function(e){return r(a(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))},n.shimConstraints=a,n.shimRTCIceServerUrls=function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var o=[],i=0;i<e.iceServers.length;i++){var a=e.iceServers[i];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(r.deprecated("RTCIceServer.url","RTCIceServer.urls"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,delete a.url,o.push(a)):o.push(e.iceServers[i])}e.iceServers=o}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},n.shimTrackEventTransceiver=function(e){"object"===i(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimCreateOfferLegacy=function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var n=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveAudio||n||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var r=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveVideo||r||this.addTransceiver("video")}return t.apply(this,arguments)}};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=r?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return e&&void 0!==e.video?Object.assign({},e,{video:r.compactObject(e.video)}):e}},{"../utils":"iSxC"}],GOQK:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimRTCIceCandidate=function(e){if(e.RTCIceCandidate&&(!e.RTCIceCandidate||!("foundation"in e.RTCIceCandidate.prototype))){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===a(e)&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var n=new t(e),o=r.default.parseCandidate(e.candidate),i=Object.assign(n,o);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,o.wrapPeerConnectionEvent(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}},n.shimMaxMessageSize=function(e){if(e.RTCPeerConnection){var t=o.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){var{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;var t=r.default.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=r.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){var o,i=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var n=parseInt(t[1],10);return n!=n?-1:n}(arguments[0]),a=(u=i,d=65536,"firefox"===t.browser&&(d=t.version<57?-1===u?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),d),s=function(e,n){var o=65536;"firefox"===t.browser&&57===t.version&&(o=65535);var i=r.default.matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?o=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(o=2147483637),o}(arguments[0],i);o=0===a&&0===s?Number.POSITIVE_INFINITY:0===a||0===s?Math.max(a,s):Math.min(a,s);var c={};Object.defineProperty(c,"maxMessageSize",{get:function(){return o}}),this._sctp=c}var u,d;return n.apply(this,arguments)}}},n.shimSendThrowTypeError=function(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return n(e,this),e},o.wrapPeerConnectionEvent(e,"datachannel",(function(e){return n(e.channel,e.target),e}))}function n(e,t){var n=e.send;e.send=function(){var r=arguments[0],o=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&o>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}},n.shimConnectionState=function(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}},n.removeAllowExtmapMixed=function(e){if(e.RTCPeerConnection){var t=o.detectBrowser(e);if(!("chrome"===t.browser&&t.version>=71)){var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n")),n.apply(this,arguments)}}}};var r=function(e){return e&&e.__esModule?e:{default:e}}(e("sdp")),o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("./utils"));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{sdp:"YHvh","./utils":"iSxC"}],KtlG:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.adapterFactory=function(){var{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},n=r.log,u=r.detectBrowser(e),d={browserDetails:u,commonShim:c,extractVersion:r.extractVersion,disableLog:r.disableLog,disableWarnings:r.disableWarnings};switch(u.browser){case"chrome":if(!o||!o.shimPeerConnection||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),d;n("adapter.js shimming chrome."),d.browserShim=o,o.shimGetUserMedia(e),o.shimMediaStream(e),o.shimPeerConnection(e),o.shimOnTrack(e),o.shimAddTrackRemoveTrack(e),o.shimGetSendersWithDtmf(e),o.shimGetStats(e),o.shimSenderReceiverGetStats(e),o.fixNegotiationNeeded(e),c.shimRTCIceCandidate(e),c.shimConnectionState(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e),c.removeAllowExtmapMixed(e);break;case"firefox":if(!a||!a.shimPeerConnection||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),d;n("adapter.js shimming firefox."),d.browserShim=a,a.shimGetUserMedia(e),a.shimPeerConnection(e),a.shimOnTrack(e),a.shimRemoveStream(e),a.shimSenderGetStats(e),a.shimReceiverGetStats(e),a.shimRTCDataChannel(e),a.shimAddTransceiver(e),a.shimCreateOffer(e),a.shimCreateAnswer(e),c.shimRTCIceCandidate(e),c.shimConnectionState(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e);break;case"edge":if(!i||!i.shimPeerConnection||!t.shimEdge)return n("MS edge shim is not included in this adapter release."),d;n("adapter.js shimming edge."),d.browserShim=i,i.shimGetUserMedia(e),i.shimGetDisplayMedia(e),i.shimPeerConnection(e),i.shimReplaceTrack(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e);break;case"safari":if(!s||!t.shimSafari)return n("Safari shim is not included in this adapter release."),d;n("adapter.js shimming safari."),d.browserShim=s,s.shimRTCIceServerUrls(e),s.shimCreateOfferLegacy(e),s.shimCallbacksAPI(e),s.shimLocalStreamsAPI(e),s.shimRemoteStreamsAPI(e),s.shimTrackEventTransceiver(e),s.shimGetUserMedia(e),c.shimRTCIceCandidate(e),c.shimMaxMessageSize(e),c.shimSendThrowTypeError(e),c.removeAllowExtmapMixed(e);break;default:n("Unsupported browser!")}return d};var r=d(e("./utils")),o=d(e("./chrome/chrome_shim")),i=d(e("./edge/edge_shim")),a=d(e("./firefox/firefox_shim")),s=d(e("./safari/safari_shim")),c=d(e("./common_shim"));function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function d(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}},{"./utils":"iSxC","./chrome/chrome_shim":"uI5X","./edge/edge_shim":"XRic","./firefox/firefox_shim":"Fzdr","./safari/safari_shim":"t1lL","./common_shim":"GOQK"}],tI1X:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=(0,e("./adapter_factory.js").adapterFactory)({window:window});n.default=r},{"./adapter_factory.js":"KtlG"}],sXtV:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var o=r(e("webrtc-adapter"));n.webRTCAdapter=o.default},{"webrtc-adapter":"tI1X"}],I31f:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./adapter");n.Supports=new(function(){function e(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform),this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}return e.prototype.isWebRTCSupported=function(){return"undefined"!=typeof RTCPeerConnection},e.prototype.isBrowserSupported=function(){var e=this.getBrowser(),t=this.getVersion();return!!this.supportedBrowsers.includes(e)&&("chrome"===e?t>=this.minChromeVersion:"firefox"===e?t>=this.minFirefoxVersion:"safari"===e&&!this.isIOS&&t>=this.minSafariVersion)},e.prototype.getBrowser=function(){return r.webRTCAdapter.browserDetails.browser},e.prototype.getVersion=function(){return r.webRTCAdapter.browserDetails.version||0},e.prototype.isUnifiedPlanSupported=function(){var e,t=this.getBrowser(),n=r.webRTCAdapter.browserDetails.version||0;if("chrome"===t&&n<72)return!1;if("firefox"===t&&n>=59)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;var o=!1;try{(e=new RTCPeerConnection).addTransceiver("audio"),o=!0}catch(e){}finally{e&&e.close()}return o},e.prototype.toString=function(){return"Supports: \n    browser:"+this.getBrowser()+" \n    version:"+this.getVersion()+" \n    isIOS:"+this.isIOS+" \n    isWebRTCSupported:"+this.isWebRTCSupported()+" \n    isBrowserSupported:"+this.isBrowserSupported()+" \n    isUnifiedPlanSupported:"+this.isUnifiedPlanSupported()},e}())},{"./adapter":"sXtV"}],BHXf:[function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(n,"__esModule",{value:!0});var o=r(e("peerjs-js-binarypack")),i=e("./supports"),a={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:0.peerjs.com:3478",username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};n.util=new(function(){function e(){this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.chunkedMTU=16300,this.defaultConfig=a,this.browser=i.Supports.getBrowser(),this.browserVersion=i.Supports.getVersion(),this.supports=function(){var e,t={browser:i.Supports.isBrowserSupported(),webRTC:i.Supports.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!t.webRTC)return t;try{e=new RTCPeerConnection(a),t.audioVideo=!0;var n=void 0;try{n=e.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!n.ordered;try{n.binaryType="blob",t.binaryBlob=!i.Supports.isIOS}catch(e){}}catch(e){}finally{n&&n.close()}}catch(e){}finally{e&&e.close()}return t}(),this.pack=o.pack,this.unpack=o.unpack,this._dataCount=1}return e.prototype.noop=function(){},e.prototype.validateId=function(e){return!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(e)},e.prototype.chunk=function(e){for(var t=[],r=e.size,o=Math.ceil(r/n.util.chunkedMTU),i=0,a=0;a<r;){var s=Math.min(r,a+n.util.chunkedMTU),c=e.slice(a,s),u={__peerData:this._dataCount,n:i,data:c,total:o};t.push(u),a=s,i++}return this._dataCount++,t},e.prototype.blobToArrayBuffer=function(e,t){var n=new FileReader;return n.onload=function(e){e.target&&t(e.target.result)},n.readAsArrayBuffer(e),n},e.prototype.binaryStringToArrayBuffer=function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=255&e.charCodeAt(n);return t.buffer},e.prototype.randomToken=function(){return Math.random().toString(36).substr(2)},e.prototype.isSecure=function(){return"https:"===location.protocol},e}())},{"peerjs-js-binarypack":"kdPp","./supports":"I31f"}],JJlS:[function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,o="~";function i(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,n,r,i){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new a(n,r||e,i),c=o?o+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],s]:e._events[c].push(s):(e._events[c]=s,e._eventsCount++),e}function c(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function u(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(o=!1)),u.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(o?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},u.prototype.listeners=function(e){var t=o?o+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,i=n.length,a=new Array(i);r<i;r++)a[r]=n[r].fn;return a},u.prototype.listenerCount=function(e){var t=o?o+e:e,n=this._events[t];return n?n.fn?1:n.length:0},u.prototype.emit=function(e,t,n,r,i,a){var s=o?o+e:e;if(!this._events[s])return!1;var c,u,d=this._events[s],l=arguments.length;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),l){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,n),!0;case 4:return d.fn.call(d.context,t,n,r),!0;case 5:return d.fn.call(d.context,t,n,r,i),!0;case 6:return d.fn.call(d.context,t,n,r,i,a),!0}for(u=1,c=new Array(l-1);u<l;u++)c[u-1]=arguments[u];d.fn.apply(d.context,c)}else{var f,p=d.length;for(u=0;u<p;u++)switch(d[u].once&&this.removeListener(e,d[u].fn,void 0,!0),l){case 1:d[u].fn.call(d[u].context);break;case 2:d[u].fn.call(d[u].context,t);break;case 3:d[u].fn.call(d[u].context,t,n);break;case 4:d[u].fn.call(d[u].context,t,n,r);break;default:if(!c)for(f=1,c=new Array(l-1);f<l;f++)c[f-1]=arguments[f];d[u].fn.apply(d[u].context,c)}}return!0},u.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},u.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},u.prototype.removeListener=function(e,t,n,r){var i=o?o+e:e;if(!this._events[i])return this;if(!t)return c(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||r&&!a.once||n&&a.context!==n||c(this,i);else{for(var s=0,u=[],d=a.length;s<d;s++)(a[s].fn!==t||r&&!a[s].once||n&&a[s].context!==n)&&u.push(a[s]);u.length?this._events[i]=1===u.length?u[0]:u:c(this,i)}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=o?o+e:e,this._events[t]&&c(this,t)):(this._events=new i,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=o,u.EventEmitter=u,void 0!==t&&(t.exports=u)},{}],WOs9:[function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(n,"__esModule",{value:!0});var i,a="PeerJS: ";!function(e){e[e.Disabled=0]="Disabled",e[e.Errors=1]="Errors",e[e.Warnings=2]="Warnings",e[e.All=3]="All"}(i=n.LogLevel||(n.LogLevel={}));var s=function(){function e(){this._logLevel=i.Disabled}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){this._logLevel=e},enumerable:!0,configurable:!0}),e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=i.All&&this._print.apply(this,o([i.All],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=i.Warnings&&this._print.apply(this,o([i.Warnings],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=i.Errors&&this._print.apply(this,o([i.Errors],e))},e.prototype.setLogFunction=function(e){this._print=e},e.prototype._print=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=o([a],t);for(var s in r)r[s]instanceof Error&&(r[s]="("+r[s].name+") "+r[s].message);e>=i.All?console.log.apply(console,o(r)):e>=i.Warnings?console.warn.apply(console,o(["WARNING"],r)):e>=i.Errors&&console.error.apply(console,o(["ERROR"],r))},e}();n.default=new s},{}],ZRYf:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(e){e.Open="open",e.Stream="stream",e.Data="data",e.Close="close",e.Error="error",e.IceStateChanged="iceStateChanged"}(n.ConnectionEventType||(n.ConnectionEventType={})),function(e){e.Data="data",e.Media="media"}(n.ConnectionType||(n.ConnectionType={})),function(e){e.Open="open",e.Close="close",e.Connection="connection",e.Call="call",e.Disconnected="disconnected",e.Error="error"}(n.PeerEventType||(n.PeerEventType={})),function(e){e.BrowserIncompatible="browser-incompatible",e.Disconnected="disconnected",e.InvalidID="invalid-id",e.InvalidKey="invalid-key",e.Network="network",e.PeerUnavailable="peer-unavailable",e.SslUnavailable="ssl-unavailable",e.ServerError="server-error",e.SocketError="socket-error",e.SocketClosed="socket-closed",e.UnavailableID="unavailable-id",e.WebRTC="webrtc"}(n.PeerErrorType||(n.PeerErrorType={})),function(e){e.Binary="binary",e.BinaryUTF8="binary-utf8",e.JSON="json"}(n.SerializationType||(n.SerializationType={})),function(e){e.Message="message",e.Disconnected="disconnected",e.Error="error",e.Close="close"}(n.SocketEventType||(n.SocketEventType={})),function(e){e.Heartbeat="HEARTBEAT",e.Candidate="CANDIDATE",e.Offer="OFFER",e.Answer="ANSWER",e.Open="OPEN",e.Error="ERROR",e.IdTaken="ID-TAKEN",e.InvalidKey="INVALID-KEY",e.Leave="LEAVE",e.Expire="EXPIRE"}(n.ServerMessageType||(n.ServerMessageType={}))},{}],wJlv:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("eventemitter3"),u=s(e("./logger")),d=e("./enums"),l=function(e){function t(t,n,r,o,i,a){void 0===a&&(a=5e3);var s=e.call(this)||this;s.pingInterval=a,s._disconnected=!0,s._messagesQueue=[];var c=t?"wss://":"ws://";return s._baseUrl=c+n+":"+r+o+"peerjs?key="+i,s}return r(t,e),t.prototype.start=function(e,t){var n=this;this._id=e;var r=this._baseUrl+"&id="+e+"&token="+t;!this._socket&&this._disconnected&&(this._socket=new WebSocket(r),this._disconnected=!1,this._socket.onmessage=function(e){var t;try{t=JSON.parse(e.data),u.default.log("Server message received:",t)}catch(t){return void u.default.log("Invalid server message",e.data)}n.emit(d.SocketEventType.Message,t)},this._socket.onclose=function(e){n._disconnected||(u.default.log("Socket closed.",e),n._cleanup(),n._disconnected=!0,n.emit(d.SocketEventType.Disconnected))},this._socket.onopen=function(){n._disconnected||(n._sendQueuedMessages(),u.default.log("Socket open"),n._scheduleHeartbeat())})},t.prototype._scheduleHeartbeat=function(){var e=this;this._wsPingTimer=setTimeout((function(){e._sendHeartbeat()}),this.pingInterval)},t.prototype._sendHeartbeat=function(){if(this._wsOpen()){var e=JSON.stringify({type:d.ServerMessageType.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}else u.default.log("Cannot send heartbeat, because socket closed")},t.prototype._wsOpen=function(){return!!this._socket&&1===this._socket.readyState},t.prototype._sendQueuedMessages=function(){var e,t,n=i(this._messagesQueue);this._messagesQueue=[];try{for(var r=a(n),o=r.next();!o.done;o=r.next()){var s=o.value;this.send(s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},t.prototype.send=function(e){if(!this._disconnected)if(this._id)if(e.type){if(this._wsOpen()){var t=JSON.stringify(e);this._socket.send(t)}}else this.emit(d.SocketEventType.Error,"Invalid message");else this._messagesQueue.push(e)},t.prototype.close=function(){this._disconnected||(this._cleanup(),this._disconnected=!0)},t.prototype._cleanup=function(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)},t}(c.EventEmitter);n.Socket=l},{eventemitter3:"JJlS","./logger":"WOs9","./enums":"ZRYf"}],HCdX:[function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var s=e("./util"),c=a(e("./logger")),u=e("./enums"),d=function(){function e(e){this.connection=e}return e.prototype.startConnection=function(e){var t=this._startPeerConnection();if(this.connection.peerConnection=t,this.connection.type===u.ConnectionType.Media&&e._stream&&this._addTracksToConnection(e._stream,t),e.originator){if(this.connection.type===u.ConnectionType.Data){var n=this.connection,r={ordered:!!e.reliable},o=t.createDataChannel(n.label,r);n.initialize(o)}this._makeOffer()}else this.handleSDP("OFFER",e.sdp)},e.prototype._startPeerConnection=function(){c.default.log("Creating RTCPeerConnection.");var e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e},e.prototype._setupListeners=function(e){var t=this,n=this.connection.peer,r=this.connection.connectionId,o=this.connection.type,i=this.connection.provider;c.default.log("Listening for ICE candidates."),e.onicecandidate=function(e){e.candidate&&e.candidate.candidate&&(c.default.log("Received ICE candidates for "+n+":",e.candidate),i.socket.send({type:u.ServerMessageType.Candidate,payload:{candidate:e.candidate,type:o,connectionId:r},dst:n}))},e.oniceconnectionstatechange=function(){switch(e.iceConnectionState){case"failed":c.default.log("iceConnectionState is failed, closing connections to "+n),t.connection.emit(u.ConnectionEventType.Error,new Error("Negotiation of connection to "+n+" failed.")),t.connection.close();break;case"closed":c.default.log("iceConnectionState is closed, closing connections to "+n),t.connection.emit(u.ConnectionEventType.Error,new Error("Connection to "+n+" closed.")),t.connection.close();break;case"disconnected":c.default.log("iceConnectionState changed to disconnected on the connection with "+n);break;case"completed":e.onicecandidate=s.util.noop}t.connection.emit(u.ConnectionEventType.IceStateChanged,e.iceConnectionState)},c.default.log("Listening for data channel"),e.ondatachannel=function(e){c.default.log("Received data channel");var t=e.channel;i.getConnection(n,r).initialize(t)},c.default.log("Listening for remote stream"),e.ontrack=function(e){c.default.log("Received remote stream");var o=e.streams[0],a=i.getConnection(n,r);if(a.type===u.ConnectionType.Media){var s=a;t._addStreamToMediaConnection(o,s)}}},e.prototype.cleanup=function(){c.default.log("Cleaning up PeerConnection to "+this.connection.peer);var e=this.connection.peerConnection;if(e){this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=function(){};var t="closed"!==e.signalingState,n=!1;if(this.connection.type===u.ConnectionType.Data){var r=this.connection.dataChannel;r&&(n=!!r.readyState&&"closed"!==r.readyState)}(t||n)&&e.close()}},e.prototype._makeOffer=function(){return o(this,void 0,Promise,(function(){var e,t,n,o,a,d,l;return i(this,(function(i){switch(i.label){case 0:e=this.connection.peerConnection,t=this.connection.provider,i.label=1;case 1:return i.trys.push([1,7,,8]),[4,e.createOffer(this.connection.options.constraints)];case 2:n=i.sent(),c.default.log("Created offer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),i.label=3;case 3:return i.trys.push([3,5,,6]),[4,e.setLocalDescription(n)];case 4:return i.sent(),c.default.log("Set localDescription:",n,"for:"+this.connection.peer),o={sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata,browser:s.util.browser},this.connection.type===u.ConnectionType.Data&&(a=this.connection,o=r(r({},o),{label:a.label,reliable:a.reliable,serialization:a.serialization})),t.socket.send({type:u.ServerMessageType.Offer,payload:o,dst:this.connection.peer}),[3,6];case 5:return"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"!=(d=i.sent())&&(t.emitError(u.PeerErrorType.WebRTC,d),c.default.log("Failed to setLocalDescription, ",d)),[3,6];case 6:return[3,8];case 7:return l=i.sent(),t.emitError(u.PeerErrorType.WebRTC,l),c.default.log("Failed to createOffer, ",l),[3,8];case 8:return[2]}}))}))},e.prototype._makeAnswer=function(){return o(this,void 0,Promise,(function(){var e,t,n,r,o;return i(this,(function(i){switch(i.label){case 0:e=this.connection.peerConnection,t=this.connection.provider,i.label=1;case 1:return i.trys.push([1,7,,8]),[4,e.createAnswer()];case 2:n=i.sent(),c.default.log("Created answer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),i.label=3;case 3:return i.trys.push([3,5,,6]),[4,e.setLocalDescription(n)];case 4:return i.sent(),c.default.log("Set localDescription:",n,"for:"+this.connection.peer),t.socket.send({type:u.ServerMessageType.Answer,payload:{sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,browser:s.util.browser},dst:this.connection.peer}),[3,6];case 5:return r=i.sent(),t.emitError(u.PeerErrorType.WebRTC,r),c.default.log("Failed to setLocalDescription, ",r),[3,6];case 6:return[3,8];case 7:return o=i.sent(),t.emitError(u.PeerErrorType.WebRTC,o),c.default.log("Failed to create answer, ",o),[3,8];case 8:return[2]}}))}))},e.prototype.handleSDP=function(e,t){return o(this,void 0,Promise,(function(){var n,r,o,a;return i(this,(function(i){switch(i.label){case 0:t=new RTCSessionDescription(t),n=this.connection.peerConnection,r=this.connection.provider,c.default.log("Setting remote description",t),o=this,i.label=1;case 1:return i.trys.push([1,5,,6]),[4,n.setRemoteDescription(t)];case 2:return i.sent(),c.default.log("Set remoteDescription:"+e+" for:"+this.connection.peer),"OFFER"!==e?[3,4]:[4,o._makeAnswer()];case 3:i.sent(),i.label=4;case 4:return[3,6];case 5:return a=i.sent(),r.emitError(u.PeerErrorType.WebRTC,a),c.default.log("Failed to setRemoteDescription, ",a),[3,6];case 6:return[2]}}))}))},e.prototype.handleCandidate=function(e){return o(this,void 0,Promise,(function(){var t,n,r,o,a,s;return i(this,(function(i){switch(i.label){case 0:c.default.log("handleCandidate:",e),t=e.candidate,n=e.sdpMLineIndex,r=e.sdpMid,o=this.connection.peerConnection,a=this.connection.provider,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,o.addIceCandidate(new RTCIceCandidate({sdpMid:r,sdpMLineIndex:n,candidate:t}))];case 2:return i.sent(),c.default.log("Added ICE candidate for:"+this.connection.peer),[3,4];case 3:return s=i.sent(),a.emitError(u.PeerErrorType.WebRTC,s),c.default.log("Failed to handleCandidate, ",s),[3,4];case 4:return[2]}}))}))},e.prototype._addTracksToConnection=function(e,t){if(c.default.log("add tracks from stream "+e.id+" to peer connection"),!t.addTrack)return c.default.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach((function(n){t.addTrack(n,e)}))},e.prototype._addStreamToMediaConnection=function(e,t){c.default.log("add stream "+e.id+" to media connection "+t.connectionId),t.addStream(e)},e}();n.Negotiator=d},{"./util":"BHXf","./logger":"WOs9","./enums":"ZRYf"}],tQFK:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=function(e){function t(t,n,r){var o=e.call(this)||this;return o.peer=t,o.provider=n,o.options=r,o._open=!1,o.metadata=r.metadata,o}return r(t,e),Object.defineProperty(t.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),t}(e("eventemitter3").EventEmitter);n.BaseConnection=o},{eventemitter3:"JJlS"}],dbHP:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var s=e("./util"),c=a(e("./logger")),u=e("./negotiator"),d=e("./enums"),l=function(e){function t(n,r,o){var i=e.call(this,n,r,o)||this;return i._localStream=i.options._stream,i.connectionId=i.options.connectionId||t.ID_PREFIX+s.util.randomToken(),i._negotiator=new u.Negotiator(i),i._localStream&&i._negotiator.startConnection({_stream:i._localStream,originator:!0}),i}return r(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return d.ConnectionType.Media},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"localStream",{get:function(){return this._localStream},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"remoteStream",{get:function(){return this._remoteStream},enumerable:!0,configurable:!0}),t.prototype.addStream=function(t){c.default.log("Receiving stream",t),this._remoteStream=t,e.prototype.emit.call(this,d.ConnectionEventType.Stream,t)},t.prototype.handleMessage=function(e){var t=e.type,n=e.payload;switch(e.type){case d.ServerMessageType.Answer:this._negotiator.handleSDP(t,n.sdp),this._open=!0;break;case d.ServerMessageType.Candidate:this._negotiator.handleCandidate(n.candidate);break;default:c.default.warn("Unrecognized message type:"+t+" from peer:"+this.peer)}},t.prototype.answer=function(e,t){var n,r;if(void 0===t&&(t={}),this._localStream)c.default.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");else{this._localStream=e,t&&t.sdpTransform&&(this.options.sdpTransform=t.sdpTransform),this._negotiator.startConnection(o(o({},this.options._payload),{_stream:e}));var a=this.provider._getMessages(this.connectionId);try{for(var s=i(a),u=s.next();!u.done;u=s.next()){var d=u.value;this.handleMessage(d)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}this._open=!0}},t.prototype.close=function(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,e.prototype.emit.call(this,d.ConnectionEventType.Close))},t.ID_PREFIX="mc_",t}(e("./baseconnection").BaseConnection);n.MediaConnection=l},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK"}],GGp6:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var i=e("eventemitter3"),a=o(e("./logger")),s=function(e){function t(){var t=e.call(this)||this;return t.fileReader=new FileReader,t._queue=[],t._processing=!1,t.fileReader.onload=function(e){t._processing=!1,e.target&&t.emit("done",e.target.result),t.doNextTask()},t.fileReader.onerror=function(e){a.default.error("EncodingQueue error:",e),t._processing=!1,t.destroy(),t.emit("error",e)},t}return r(t,e),Object.defineProperty(t.prototype,"queue",{get:function(){return this._queue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.queue.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"processing",{get:function(){return this._processing},enumerable:!0,configurable:!0}),t.prototype.enque=function(e){this.queue.push(e),this.processing||this.doNextTask()},t.prototype.destroy=function(){this.fileReader.abort(),this._queue=[]},t.prototype.doNextTask=function(){0!==this.size&&(this.processing||(this._processing=!0,this.fileReader.readAsArrayBuffer(this.queue.shift())))},t}(i.EventEmitter);n.EncodingQueue=s},{eventemitter3:"JJlS","./logger":"WOs9"}],GBTQ:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./util"),s=i(e("./logger")),c=e("./negotiator"),u=e("./enums"),d=e("./baseconnection"),l=e("./encodingQueue"),f=function(e){function t(n,r,o){var i=e.call(this,n,r,o)||this;return i.stringify=JSON.stringify,i.parse=JSON.parse,i._buffer=[],i._bufferSize=0,i._buffering=!1,i._chunkedData={},i._encodingQueue=new l.EncodingQueue,i.connectionId=i.options.connectionId||t.ID_PREFIX+a.util.randomToken(),i.label=i.options.label||i.connectionId,i.serialization=i.options.serialization||u.SerializationType.Binary,i.reliable=!!i.options.reliable,i._encodingQueue.on("done",(function(e){i._bufferedSend(e)})),i._encodingQueue.on("error",(function(){s.default.error("DC#"+i.connectionId+": Error occured in encoding from blob to arraybuffer, close DC"),i.close()})),i._negotiator=new c.Negotiator(i),i._negotiator.startConnection(i.options._payload||{originator:!0}),i}return r(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return u.ConnectionType.Data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataChannel",{get:function(){return this._dc},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bufferSize",{get:function(){return this._bufferSize},enumerable:!0,configurable:!0}),t.prototype.initialize=function(e){this._dc=e,this._configureDataChannel()},t.prototype._configureDataChannel=function(){var e=this;a.util.supports.binaryBlob&&!a.util.supports.reliable||(this.dataChannel.binaryType="arraybuffer"),this.dataChannel.onopen=function(){s.default.log("DC#"+e.connectionId+" dc connection success"),e._open=!0,e.emit(u.ConnectionEventType.Open)},this.dataChannel.onmessage=function(t){s.default.log("DC#"+e.connectionId+" dc onmessage:",t.data),e._handleDataMessage(t)},this.dataChannel.onclose=function(){s.default.log("DC#"+e.connectionId+" dc closed for:",e.peer),e.close()}},t.prototype._handleDataMessage=function(t){var n=this,r=t.data,o=r.constructor,i=r;if(this.serialization===u.SerializationType.Binary||this.serialization===u.SerializationType.BinaryUTF8){if(o===Blob)return void a.util.blobToArrayBuffer(r,(function(e){var t=a.util.unpack(e);n.emit(u.ConnectionEventType.Data,t)}));if(o===ArrayBuffer)i=a.util.unpack(r);else if(o===String){var s=a.util.binaryStringToArrayBuffer(r);i=a.util.unpack(s)}}else this.serialization===u.SerializationType.JSON&&(i=this.parse(r));i.__peerData?this._handleChunk(i):e.prototype.emit.call(this,u.ConnectionEventType.Data,i)},t.prototype._handleChunk=function(e){var t=e.__peerData,n=this._chunkedData[t]||{data:[],count:0,total:e.total};if(n.data[e.n]=e.data,n.count++,this._chunkedData[t]=n,n.total===n.count){delete this._chunkedData[t];var r=new Blob(n.data);this._handleDataMessage({data:r})}},t.prototype.close=function(){this._buffer=[],this._bufferSize=0,this._chunkedData={},this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this._dc=null),this._encodingQueue&&(this._encodingQueue.destroy(),this._encodingQueue.removeAllListeners(),this._encodingQueue=null),this.open&&(this._open=!1,e.prototype.emit.call(this,u.ConnectionEventType.Close))},t.prototype.send=function(t,n){if(this.open)if(this.serialization===u.SerializationType.JSON)this._bufferedSend(this.stringify(t));else if(this.serialization===u.SerializationType.Binary||this.serialization===u.SerializationType.BinaryUTF8){var r=a.util.pack(t);if(!n&&r.size>a.util.chunkedMTU)return void this._sendChunks(r);a.util.supports.binaryBlob?this._bufferedSend(r):this._encodingQueue.enque(r)}else this._bufferedSend(t);else e.prototype.emit.call(this,u.ConnectionEventType.Error,new Error("Connection is not open. You should listen for the `open` event before sending messages."))},t.prototype._bufferedSend=function(e){!this._buffering&&this._trySend(e)||(this._buffer.push(e),this._bufferSize=this._buffer.length)},t.prototype._trySend=function(e){var n=this;if(!this.open)return!1;if(this.dataChannel.bufferedAmount>t.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout((function(){n._buffering=!1,n._tryBuffer()}),50),!1;try{this.dataChannel.send(e)}catch(e){return s.default.error("DC#:"+this.connectionId+" Error when sending:",e),this._buffering=!0,this.close(),!1}return!0},t.prototype._tryBuffer=function(){if(this.open&&0!==this._buffer.length){var e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}},t.prototype._sendChunks=function(e){var t,n,r=a.util.chunk(e);s.default.log("DC#"+this.connectionId+" Try to send "+r.length+" chunks...");try{for(var i=o(r),c=i.next();!c.done;c=i.next()){var u=c.value;this.send(u,!0)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},t.prototype.handleMessage=function(e){var t=e.payload;switch(e.type){case u.ServerMessageType.Answer:this._negotiator.handleSDP(e.type,t.sdp);break;case u.ServerMessageType.Candidate:this._negotiator.handleCandidate(t.candidate);break;default:s.default.warn("Unrecognized message type:",e.type,"from peer:",this.peer)}},t.ID_PREFIX="dc_",t.MAX_BUFFERED_AMOUNT=8388608,t}(d.BaseConnection);n.DataConnection=f},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK","./encodingQueue":"GGp6"}],in7L:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./util"),s=i(e("./logger")),c=function(){function e(e){this._options=e}return e.prototype._buildUrl=function(e){return(this._options.secure?"https://":"http://")+this._options.host+":"+this._options.port+this._options.path+this._options.key+"/"+e+"?ts="+(new Date).getTime()+Math.random()},e.prototype.retrieveId=function(){return r(this,void 0,Promise,(function(){var e,t,n,r;return o(this,(function(o){switch(o.label){case 0:e=this._buildUrl("id"),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(e)];case 2:if(200!==(t=o.sent()).status)throw new Error("Error. Status:"+t.status);return[2,t.text()];case 3:throw n=o.sent(),s.default.error("Error retrieving ID",n),r="","/"===this._options.path&&this._options.host!==a.util.CLOUD_HOST&&(r=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+r);case 4:return[2]}}))}))},e.prototype.listAllPeers=function(){return r(this,void 0,Promise,(function(){var e,t,n,r;return o(this,(function(o){switch(o.label){case 0:e=this._buildUrl("peers"),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(e)];case 2:if(200!==(t=o.sent()).status){if(401===t.status)throw"",n=this._options.host===a.util.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+n);throw new Error("Error. Status:"+t.status)}return[2,t.json()];case 3:throw r=o.sent(),s.default.error("Error retrieving list peers",r),new Error("Could not get list peers from the server."+r);case 4:return[2]}}))}))},e}();n.API=c},{"./util":"BHXf","./logger":"WOs9"}],Hxpd:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("eventemitter3"),u=e("./util"),d=s(e("./logger")),l=e("./socket"),f=e("./mediaconnection"),p=e("./dataconnection"),m=e("./enums"),h=e("./api"),_=function(e){function t(n,r){var i,a=e.call(this)||this;return a._id=null,a._lastServerId=null,a._destroyed=!1,a._disconnected=!1,a._open=!1,a._connections=new Map,a._lostMessages=new Map,n&&n.constructor==Object?r=n:n&&(i=n.toString()),r=o({debug:0,host:u.util.CLOUD_HOST,port:u.util.CLOUD_PORT,path:"/",key:t.DEFAULT_KEY,token:u.util.randomToken(),config:u.util.defaultConfig},r),a._options=r,"/"===a._options.host&&(a._options.host=window.location.hostname),a._options.path&&("/"!==a._options.path[0]&&(a._options.path="/"+a._options.path),"/"!==a._options.path[a._options.path.length-1]&&(a._options.path+="/")),void 0===a._options.secure&&a._options.host!==u.util.CLOUD_HOST?a._options.secure=u.util.isSecure():a._options.host==u.util.CLOUD_HOST&&(a._options.secure=!0),a._options.logFunction&&d.default.setLogFunction(a._options.logFunction),d.default.logLevel=a._options.debug||0,a._api=new h.API(r),a._socket=a._createServerConnection(),u.util.supports.audioVideo||u.util.supports.data?i&&!u.util.validateId(i)?(a._delayedAbort(m.PeerErrorType.InvalidID,'ID "'+i+'" is invalid'),a):(i?a._initialize(i):a._api.retrieveId().then((function(e){return a._initialize(e)})).catch((function(e){return a._abort(m.PeerErrorType.ServerError,e)})),a):(a._delayedAbort(m.PeerErrorType.BrowserIncompatible,"The current browser does not support WebRTC"),a)}return r(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"socket",{get:function(){return this._socket},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"connections",{get:function(){var e,t,n=Object.create(null);try{for(var r=i(this._connections),o=r.next();!o.done;o=r.next()){var s=a(o.value,2),c=s[0],u=s[1];n[c]=u}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"disconnected",{get:function(){return this._disconnected},enumerable:!0,configurable:!0}),t.prototype._createServerConnection=function(){var e=this,t=new l.Socket(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return t.on(m.SocketEventType.Message,(function(t){e._handleMessage(t)})),t.on(m.SocketEventType.Error,(function(t){e._abort(m.PeerErrorType.SocketError,t)})),t.on(m.SocketEventType.Disconnected,(function(){e.disconnected||(e.emitError(m.PeerErrorType.Network,"Lost connection to server."),e.disconnect())})),t.on(m.SocketEventType.Close,(function(){e.disconnected||e._abort(m.PeerErrorType.SocketClosed,"Underlying socket is already closed.")})),t},t.prototype._initialize=function(e){this._id=e,this.socket.start(e,this._options.token)},t.prototype._handleMessage=function(e){var t,n,r=e.type,o=e.payload,a=e.src;switch(r){case m.ServerMessageType.Open:this._lastServerId=this.id,this._open=!0,this.emit(m.PeerEventType.Open,this.id);break;case m.ServerMessageType.Error:this._abort(m.PeerErrorType.ServerError,o.msg);break;case m.ServerMessageType.IdTaken:this._abort(m.PeerErrorType.UnavailableID,'ID "'+this.id+'" is taken');break;case m.ServerMessageType.InvalidKey:this._abort(m.PeerErrorType.InvalidKey,'API KEY "'+this._options.key+'" is invalid');break;case m.ServerMessageType.Leave:d.default.log("Received leave message from "+a),this._cleanupPeer(a),this._connections.delete(a);break;case m.ServerMessageType.Expire:this.emitError(m.PeerErrorType.PeerUnavailable,"Could not connect to peer "+a);break;case m.ServerMessageType.Offer:var s=o.connectionId;if((_=this.getConnection(a,s))&&(_.close(),d.default.warn("Offer received for existing Connection ID:"+s)),o.type===m.ConnectionType.Media)_=new f.MediaConnection(a,this,{connectionId:s,_payload:o,metadata:o.metadata}),this._addConnection(a,_),this.emit(m.PeerEventType.Call,_);else{if(o.type!==m.ConnectionType.Data)return void d.default.warn("Received malformed connection type:"+o.type);_=new p.DataConnection(a,this,{connectionId:s,_payload:o,metadata:o.metadata,label:o.label,serialization:o.serialization,reliable:o.reliable}),this._addConnection(a,_),this.emit(m.PeerEventType.Connection,_)}var c=this._getMessages(s);try{for(var u=i(c),l=u.next();!l.done;l=u.next()){var h=l.value;_.handleMessage(h)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}break;default:if(!o)return void d.default.warn("You received a malformed message from "+a+" of type "+r);var _;s=o.connectionId,(_=this.getConnection(a,s))&&_.peerConnection?_.handleMessage(e):s?this._storeMessage(s,e):d.default.warn("You received an unrecognized message:",e)}},t.prototype._storeMessage=function(e,t){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(t)},t.prototype._getMessages=function(e){var t=this._lostMessages.get(e);return t?(this._lostMessages.delete(e),t):[]},t.prototype.connect=function(e,t){if(void 0===t&&(t={}),this.disconnected)return d.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError(m.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");var n=new p.DataConnection(e,this,t);return this._addConnection(e,n),n},t.prototype.call=function(e,t,n){if(void 0===n&&(n={}),this.disconnected)return d.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError(m.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");if(t){n._stream=t;var r=new f.MediaConnection(e,this,n);return this._addConnection(e,r),r}d.default.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.")},t.prototype._addConnection=function(e,t){d.default.log("add connection "+t.type+":"+t.connectionId+" to peerId:"+e),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(t)},t.prototype._removeConnection=function(e){var t=this._connections.get(e.peer);if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}this._lostMessages.delete(e.connectionId)},t.prototype.getConnection=function(e,t){var n,r,o=this._connections.get(e);if(!o)return null;try{for(var a=i(o),s=a.next();!s.done;s=a.next()){var c=s.value;if(c.connectionId===t)return c}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return null},t.prototype._delayedAbort=function(e,t){var n=this;setTimeout((function(){n._abort(e,t)}),0)},t.prototype._abort=function(e,t){d.default.error("Aborting!"),this.emitError(e,t),this._lastServerId?this.disconnect():this.destroy()},t.prototype.emitError=function(e,t){var n;d.default.error("Error:",t),(n="string"==typeof t?new Error(t):t).type=e,this.emit(m.PeerEventType.Error,n)},t.prototype.destroy=function(){this.destroyed||(d.default.log("Destroy peer with ID:"+this.id),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit(m.PeerEventType.Close))},t.prototype._cleanup=function(){var e,t;try{for(var n=i(this._connections.keys()),r=n.next();!r.done;r=n.next()){var o=r.value;this._cleanupPeer(o),this._connections.delete(o)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.socket.removeAllListeners()},t.prototype._cleanupPeer=function(e){var t,n,r=this._connections.get(e);if(r)try{for(var o=i(r),a=o.next();!a.done;a=o.next())a.value.close()}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},t.prototype.disconnect=function(){if(!this.disconnected){var e=this.id;d.default.log("Disconnect peer with ID:"+e),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit(m.PeerEventType.Disconnected,e)}},t.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)d.default.log("Attempting reconnection to server with ID "+this._lastServerId),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw new Error("Peer "+this.id+" cannot reconnect because it is not disconnected from the server!");d.default.error("In a hurry? We're still trying to make the initial connection!")}},t.prototype.listAllPeers=function(e){var t=this;void 0===e&&(e=function(e){}),this._api.listAllPeers().then((function(t){return e(t)})).catch((function(e){return t._abort(m.PeerErrorType.ServerError,e)}))},t.DEFAULT_KEY="peerjs",t}(c.EventEmitter);n.Peer=_},{eventemitter3:"JJlS","./util":"BHXf","./logger":"WOs9","./socket":"wJlv","./mediaconnection":"dbHP","./dataconnection":"GBTQ","./enums":"ZRYf","./api":"in7L"}],iTK6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./util"),o=e("./peer");n.peerjs={Peer:o.Peer,util:r.util},n.default=o.Peer,window.peerjs=n.peerjs,window.Peer=o.Peer},{"./util":"BHXf","./peer":"Hxpd"}]},{},["iTK6"])},function(e,t,n){var r=n(164),o=n(75),i=n(93),a=n(56)("socket.io-client");e.exports=t=c;var s=t.managers={};function c(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,o=r(e),c=o.source,u=o.id,d=o.path,l=s[u]&&d in s[u].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||l?(a("ignoring socket cache for %s",c),n=i(c,t)):(s[u]||(a("new io instance for %s",c),s[u]=i(c,t)),n=s[u]),o.query&&!t.query&&(t.query=o.query),n.socket(o.path,t)}t.protocol=o.protocol,t.connect=c,t.Manager=n(93),t.Socket=n(99)},function(e,t){e.exports=function e(t){var n=new RegExp("^.*("+["\\+https:\\/\\/developers.google.com\\/\\+\\/web\\/snippet\\/","googlebot","baiduspider","gurujibot","yandexbot","slurp","msnbot","bingbot","facebookexternalhit","linkedinbot","twitterbot","slackbot","telegrambot","applebot","pingdom","tumblr ","Embedly","spbot"].join("|")+").*$");t=t||{};var r={version:!1,language:!1,platform:!0,os:!0,pixelDepth:!0,colorDepth:!0,resolution:!1,isAuthoritative:!0,silkAccelerated:!0,isKindleFire:!0,isDesktop:!0,isMobile:!0,isTablet:!0,isWindows:!0,isLinux:!0,isLinux64:!0,isChromeOS:!0,isMac:!0,isiPad:!0,isiPhone:!0,isiPod:!0,isAndroid:!0,isSamsung:!0,isSmartTV:!0,isRaspberry:!0,isBlackberry:!0,isTouchScreen:!0,isOpera:!1,isIE:!1,isEdge:!1,isIECompatibilityMode:!1,isSafari:!1,isFirefox:!1,isWebkit:!1,isChrome:!1,isKonqueror:!1,isOmniWeb:!1,isSeaMonkey:!1,isFlock:!1,isAmaya:!1,isPhantomJS:!1,isEpiphany:!1,source:!1,cpuCores:!1};for(var o in t)t.hasOwnProperty(o)&&void 0!==r[o]&&(r[o]=t[o]);return this.options=r,this.version="1.0.0",this._Versions={Edge:/Edge\/([\d\w\.\-]+)/i,Firefox:/firefox\/([\d\w\.\-]+)/i,IE:/msie\s([\d\.]+[\d])|trident\/\d+\.\d+;.*[rv:]+(\d+\.\d)/i,Chrome:/chrome\/([\d\w\.\-]+)/i,Chromium:/(?:chromium|crios)\/([\d\w\.\-]+)/i,Safari:/version\/([\d\w\.\-]+)/i,Opera:/version\/([\d\w\.\-]+)|OPR\/([\d\w\.\-]+)/i,Ps3:/([\d\w\.\-]+)\)\s*$/i,Psp:/([\d\w\.\-]+)\)?\s*$/i,Amaya:/amaya\/([\d\w\.\-]+)/i,SeaMonkey:/seamonkey\/([\d\w\.\-]+)/i,OmniWeb:/omniweb\/v([\d\w\.\-]+)/i,Flock:/flock\/([\d\w\.\-]+)/i,Epiphany:/epiphany\/([\d\w\.\-]+)/i,WinJs:/msapphost\/([\d\w\.\-]+)/i,PhantomJS:/phantomjs\/([\d\w\.\-]+)/i,UC:/UCBrowser\/([\d\w\.]+)/i},this._Browsers={Edge:/edge/i,Amaya:/amaya/i,Konqueror:/konqueror/i,Epiphany:/epiphany/i,SeaMonkey:/seamonkey/i,Flock:/flock/i,OmniWeb:/omniweb/i,Chromium:/chromium|crios/i,Chrome:/chrome/i,Safari:/safari/i,IE:/msie|trident/i,Opera:/opera|OPR/i,PS3:/playstation 3/i,PSP:/playstation portable/i,Firefox:/firefox/i,WinJs:/msapphost/i,PhantomJS:/phantomjs/i,UC:/UCBrowser/i},this._OS={Windows10:/windows nt 10\.0/i,Windows81:/windows nt 6\.3/i,Windows8:/windows nt 6\.2/i,Windows7:/windows nt 6\.1/i,UnknownWindows:/windows nt 6\.\d+/i,WindowsVista:/windows nt 6\.0/i,Windows2003:/windows nt 5\.2/i,WindowsXP:/windows nt 5\.1/i,Windows2000:/windows nt 5\.0/i,WindowsPhone8:/windows phone 8\./,OSXCheetah:/os x 10[._]0/i,OSXPuma:/os x 10[._]1(\D|$)/i,OSXJaguar:/os x 10[._]2/i,OSXPanther:/os x 10[._]3/i,OSXTiger:/os x 10[._]4/i,OSXLeopard:/os x 10[._]5/i,OSXSnowLeopard:/os x 10[._]6/i,OSXLion:/os x 10[._]7/i,OSXMountainLion:/os x 10[._]8/i,OSXMavericks:/os x 10[._]9/i,OSXYosemite:/os x 10[._]10/i,OSXElCapitan:/os x 10[._]11/i,OSXSierra:/os x 10[._]12/i,Mac:/os x/i,Linux:/linux/i,Linux64:/linux x86_64/i,ChromeOS:/cros/i,Wii:/wii/i,PS3:/playstation 3/i,PSP:/playstation portable/i,iPad:/\(iPad.*os (\d+)[._](\d+)/i,iPhone:/\(iPhone.*os (\d+)[._](\d+)/i,Bada:/Bada\/(\d+)\.(\d+)/i,Curl:/curl\/(\d+)\.(\d+)\.(\d+)/i},this._Platform={Windows:/windows nt/i,WindowsPhone:/windows phone/i,Mac:/macintosh/i,Linux:/linux/i,Wii:/wii/i,Playstation:/playstation/i,iPad:/ipad/i,iPod:/ipod/i,iPhone:/iphone/i,Android:/android/i,Blackberry:/blackberry/i,Samsung:/samsung/i,Curl:/curl/i},this.DefaultAgent={isAuthoritative:!0,isMobile:!1,isTablet:!1,isiPad:!1,isiPod:!1,isiPhone:!1,isAndroid:!1,isBlackberry:!1,isOpera:!1,isIE:!1,isEdge:!1,isIECompatibilityMode:!1,isSafari:!1,isFirefox:!1,isWebkit:!1,isChrome:!1,isKonqueror:!1,isOmniWeb:!1,isSeaMonkey:!1,isFlock:!1,isAmaya:!1,isPhantomJS:!1,isEpiphany:!1,isDesktop:!1,isWindows:!1,isLinux:!1,isLinux64:!1,isMac:!1,isChromeOS:!1,isBada:!1,isSamsung:!1,isRaspberry:!1,isBot:!1,isCurl:!1,isAndroidTablet:!1,isWinJs:!1,isKindleFire:!1,isSilk:!1,isCaptive:!1,isSmartTV:!1,isUC:!1,isTouchScreen:!1,silkAccelerated:!1,colorDepth:-1,pixelDepth:-1,resolution:[],cpuCores:-1,language:"unknown",browser:"unknown",version:"unknown",os:"unknown",platform:"unknown",geoIp:{},source:"",hashInt:function(e){var t,n,r=0;if(0===e.length)return r;for(t=0,n=e.length;t<n;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return r},hashMD5:function(e){function t(e,t){return e<<t|e>>>32-t}function n(e,t){var n,r,o,i,a;return o=2147483648&e,i=2147483648&t,a=(1073741823&e)+(1073741823&t),(n=1073741824&e)&(r=1073741824&t)?2147483648^a^o^i:n|r?1073741824&a?3221225472^a^o^i:1073741824^a^o^i:a^o^i}function r(e,r,o,i,a,s,c){return e=n(e,n(n(function(e,t,n){return e&t|~e&n}(r,o,i),a),c)),n(t(e,s),r)}function o(e,r,o,i,a,s,c){return e=n(e,n(n(function(e,t,n){return e&n|t&~n}(r,o,i),a),c)),n(t(e,s),r)}function i(e,r,o,i,a,s,c){return e=n(e,n(n(function(e,t,n){return e^t^n}(r,o,i),a),c)),n(t(e,s),r)}function a(e,r,o,i,a,s,c){return e=n(e,n(n(function(e,t,n){return t^(e|~n)}(r,o,i),a),c)),n(t(e,s),r)}function s(e){var t,n="",r="";for(t=0;t<=3;t++)n+=(r="0"+(e>>>8*t&255).toString(16)).substr(r.length-2,2);return n}var c,u,d,l,f,p,m,h,_,g;for(c=function(e){for(var t,n=e.length,r=n+8,o=16*((r-r%64)/64+1),i=new Array(o-1),a=0,s=0;s<n;)a=s%4*8,i[t=(s-s%4)/4]=i[t]|e.charCodeAt(s)<<a,s++;return a=s%4*8,i[t=(s-s%4)/4]=i[t]|128<<a,i[o-2]=n<<3,i[o-1]=n>>>29,i}(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t}(e)),m=1732584193,h=4023233417,_=2562383102,g=271733878,u=0;u<c.length;u+=16)d=m,l=h,f=_,p=g,m=r(m,h,_,g,c[u+0],7,3614090360),g=r(g,m,h,_,c[u+1],12,3905402710),_=r(_,g,m,h,c[u+2],17,606105819),h=r(h,_,g,m,c[u+3],22,3250441966),m=r(m,h,_,g,c[u+4],7,4118548399),g=r(g,m,h,_,c[u+5],12,1200080426),_=r(_,g,m,h,c[u+6],17,2821735955),h=r(h,_,g,m,c[u+7],22,4249261313),m=r(m,h,_,g,c[u+8],7,1770035416),g=r(g,m,h,_,c[u+9],12,2336552879),_=r(_,g,m,h,c[u+10],17,4294925233),h=r(h,_,g,m,c[u+11],22,2304563134),m=r(m,h,_,g,c[u+12],7,1804603682),g=r(g,m,h,_,c[u+13],12,4254626195),_=r(_,g,m,h,c[u+14],17,2792965006),m=o(m,h=r(h,_,g,m,c[u+15],22,1236535329),_,g,c[u+1],5,4129170786),g=o(g,m,h,_,c[u+6],9,3225465664),_=o(_,g,m,h,c[u+11],14,643717713),h=o(h,_,g,m,c[u+0],20,3921069994),m=o(m,h,_,g,c[u+5],5,3593408605),g=o(g,m,h,_,c[u+10],9,38016083),_=o(_,g,m,h,c[u+15],14,3634488961),h=o(h,_,g,m,c[u+4],20,3889429448),m=o(m,h,_,g,c[u+9],5,568446438),g=o(g,m,h,_,c[u+14],9,3275163606),_=o(_,g,m,h,c[u+3],14,4107603335),h=o(h,_,g,m,c[u+8],20,1163531501),m=o(m,h,_,g,c[u+13],5,2850285829),g=o(g,m,h,_,c[u+2],9,4243563512),_=o(_,g,m,h,c[u+7],14,1735328473),m=i(m,h=o(h,_,g,m,c[u+12],20,2368359562),_,g,c[u+5],4,4294588738),g=i(g,m,h,_,c[u+8],11,2272392833),_=i(_,g,m,h,c[u+11],16,1839030562),h=i(h,_,g,m,c[u+14],23,4259657740),m=i(m,h,_,g,c[u+1],4,2763975236),g=i(g,m,h,_,c[u+4],11,1272893353),_=i(_,g,m,h,c[u+7],16,4139469664),h=i(h,_,g,m,c[u+10],23,3200236656),m=i(m,h,_,g,c[u+13],4,681279174),g=i(g,m,h,_,c[u+0],11,3936430074),_=i(_,g,m,h,c[u+3],16,3572445317),h=i(h,_,g,m,c[u+6],23,76029189),m=i(m,h,_,g,c[u+9],4,3654602809),g=i(g,m,h,_,c[u+12],11,3873151461),_=i(_,g,m,h,c[u+15],16,530742520),m=a(m,h=i(h,_,g,m,c[u+2],23,3299628645),_,g,c[u+0],6,4096336452),g=a(g,m,h,_,c[u+7],10,1126891415),_=a(_,g,m,h,c[u+14],15,2878612391),h=a(h,_,g,m,c[u+5],21,4237533241),m=a(m,h,_,g,c[u+12],6,1700485571),g=a(g,m,h,_,c[u+3],10,2399980690),_=a(_,g,m,h,c[u+10],15,4293915773),h=a(h,_,g,m,c[u+1],21,2240044497),m=a(m,h,_,g,c[u+8],6,1873313359),g=a(g,m,h,_,c[u+15],10,4264355552),_=a(_,g,m,h,c[u+6],15,2734768916),h=a(h,_,g,m,c[u+13],21,1309151649),m=a(m,h,_,g,c[u+4],6,4149444226),g=a(g,m,h,_,c[u+11],10,3174756917),_=a(_,g,m,h,c[u+2],15,718787259),h=a(h,_,g,m,c[u+9],21,3951481745),m=n(m,d),h=n(h,l),_=n(_,f),g=n(g,p);return(s(m)+s(h)+s(_)+s(g)).toLowerCase()}},this.Agent={},this.getBrowser=function(e){switch(!0){case this._Browsers.Edge.test(e):return this.Agent.isEdge=!0,"Edge";case this._Browsers.PhantomJS.test(e):return this.Agent.isPhantomJS=!0,"PhantomJS";case this._Browsers.Konqueror.test(e):return this.Agent.isKonqueror=!0,"Konqueror";case this._Browsers.Amaya.test(e):return this.Agent.isAmaya=!0,"Amaya";case this._Browsers.Epiphany.test(e):return this.Agent.isEpiphany=!0,"Epiphany";case this._Browsers.SeaMonkey.test(e):return this.Agent.isSeaMonkey=!0,"SeaMonkey";case this._Browsers.Flock.test(e):return this.Agent.isFlock=!0,"Flock";case this._Browsers.OmniWeb.test(e):return this.Agent.isOmniWeb=!0,"OmniWeb";case this._Browsers.Opera.test(e):return this.Agent.isOpera=!0,"Opera";case this._Browsers.Chromium.test(e):return this.Agent.isChrome=!0,"Chromium";case this._Browsers.Chrome.test(e):return this.Agent.isChrome=!0,"Chrome";case this._Browsers.Safari.test(e):return this.Agent.isSafari=!0,"Safari";case this._Browsers.WinJs.test(e):return this.Agent.isWinJs=!0,"WinJs";case this._Browsers.IE.test(e):return this.Agent.isIE=!0,"IE";case this._Browsers.PS3.test(e):return"ps3";case this._Browsers.PSP.test(e):return"psp";case this._Browsers.Firefox.test(e):return this.Agent.isFirefox=!0,"Firefox";case this._Browsers.UC.test(e):return this.Agent.isUC=!0,"UCBrowser";default:return 0!==e.indexOf("Mozilla")&&/^([\d\w\-\.]+)\/[\d\w\.\-]+/i.test(e)?(this.Agent.isAuthoritative=!1,RegExp.$1):"unknown"}},this.getBrowserVersion=function(e){switch(this.Agent.browser){case"Edge":if(this._Versions.Edge.test(e))return RegExp.$1;break;case"PhantomJS":if(this._Versions.PhantomJS.test(e))return RegExp.$1;break;case"Chrome":if(this._Versions.Chrome.test(e))return RegExp.$1;break;case"Chromium":if(this._Versions.Chromium.test(e))return RegExp.$1;break;case"Safari":if(this._Versions.Safari.test(e))return RegExp.$1;break;case"Opera":if(this._Versions.Opera.test(e))return RegExp.$1?RegExp.$1:RegExp.$2;break;case"Firefox":if(this._Versions.Firefox.test(e))return RegExp.$1;break;case"WinJs":if(this._Versions.WinJs.test(e))return RegExp.$1;break;case"IE":if(this._Versions.IE.test(e))return RegExp.$2?RegExp.$2:RegExp.$1;break;case"ps3":if(this._Versions.Ps3.test(e))return RegExp.$1;break;case"psp":if(this._Versions.Psp.test(e))return RegExp.$1;break;case"Amaya":if(this._Versions.Amaya.test(e))return RegExp.$1;break;case"Epiphany":if(this._Versions.Epiphany.test(e))return RegExp.$1;break;case"SeaMonkey":if(this._Versions.SeaMonkey.test(e))return RegExp.$1;break;case"Flock":if(this._Versions.Flock.test(e))return RegExp.$1;break;case"OmniWeb":if(this._Versions.OmniWeb.test(e))return RegExp.$1;break;case"UCBrowser":if(this._Versions.UC.test(e))return RegExp.$1;break;default:if("unknown"!==this.Agent.browser&&new RegExp(this.Agent.browser+"[\\/ ]([\\d\\w\\.\\-]+)","i").test(e))return RegExp.$1}},this.getOS=function(e){switch(!0){case this._OS.WindowsVista.test(e):return this.Agent.isWindows=!0,"Windows Vista";case this._OS.Windows7.test(e):return this.Agent.isWindows=!0,"Windows 7";case this._OS.Windows8.test(e):return this.Agent.isWindows=!0,"Windows 8";case this._OS.Windows81.test(e):return this.Agent.isWindows=!0,"Windows 8.1";case this._OS.Windows10.test(e):return this.Agent.isWindows=!0,"Windows 10.0";case this._OS.Windows2003.test(e):return this.Agent.isWindows=!0,"Windows 2003";case this._OS.WindowsXP.test(e):return this.Agent.isWindows=!0,"Windows XP";case this._OS.Windows2000.test(e):return this.Agent.isWindows=!0,"Windows 2000";case this._OS.WindowsPhone8.test(e):return"Windows Phone 8";case this._OS.Linux64.test(e):return this.Agent.isLinux=!0,this.Agent.isLinux64=!0,"Linux 64";case this._OS.Linux.test(e):return this.Agent.isLinux=!0,"Linux";case this._OS.ChromeOS.test(e):return this.Agent.isChromeOS=!0,"Chrome OS";case this._OS.Wii.test(e):return"Wii";case this._OS.PS3.test(e):case this._OS.PSP.test(e):return"Playstation";case this._OS.OSXCheetah.test(e):return this.Agent.isMac=!0,"OS X Cheetah";case this._OS.OSXPuma.test(e):return this.Agent.isMac=!0,"OS X Puma";case this._OS.OSXJaguar.test(e):return this.Agent.isMac=!0,"OS X Jaguar";case this._OS.OSXPanther.test(e):return this.Agent.isMac=!0,"OS X Panther";case this._OS.OSXTiger.test(e):return this.Agent.isMac=!0,"OS X Tiger";case this._OS.OSXLeopard.test(e):return this.Agent.isMac=!0,"OS X Leopard";case this._OS.OSXSnowLeopard.test(e):return this.Agent.isMac=!0,"OS X Snow Leopard";case this._OS.OSXLion.test(e):return this.Agent.isMac=!0,"OS X Lion";case this._OS.OSXMountainLion.test(e):return this.Agent.isMac=!0,"OS X Mountain Lion";case this._OS.OSXMavericks.test(e):return this.Agent.isMac=!0,"OS X Mavericks";case this._OS.OSXYosemite.test(e):return this.Agent.isMac=!0,"OS X Yosemite";case this._OS.OSXElCapitan.test(e):return this.Agent.isMac=!0,"OS X El Capitan";case this._OS.OSXSierra.test(e):return this.Agent.isMac=!0,"macOS Sierra";case this._OS.Mac.test(e):return this.Agent.isMac=!0,"OS X";case this._OS.iPad.test(e):return this.Agent.isiPad=!0,e.match(this._OS.iPad)[0].replace("_",".");case this._OS.iPhone.test(e):return this.Agent.isiPhone=!0,e.match(this._OS.iPhone)[0].replace("_",".");case this._OS.Bada.test(e):return this.Agent.isBada=!0,"Bada";case this._OS.Curl.test(e):return this.Agent.isCurl=!0,"Curl";default:return"unknown"}},this.getPlatform=function(e){switch(!0){case this._Platform.Windows.test(e):return"Microsoft Windows";case this._Platform.WindowsPhone.test(e):return this.Agent.isWindowsPhone=!0,"Microsoft Windows Phone";case this._Platform.Mac.test(e):return"Apple Mac";case this._Platform.Curl.test(e):return"Curl";case this._Platform.Android.test(e):return this.Agent.isAndroid=!0,"Android";case this._Platform.Blackberry.test(e):return this.Agent.isBlackberry=!0,"Blackberry";case this._Platform.Linux.test(e):return"Linux";case this._Platform.Wii.test(e):return"Wii";case this._Platform.Playstation.test(e):return"Playstation";case this._Platform.iPad.test(e):return this.Agent.isiPad=!0,"iPad";case this._Platform.iPod.test(e):return this.Agent.isiPod=!0,"iPod";case this._Platform.iPhone.test(e):return this.Agent.isiPhone=!0,"iPhone";case this._Platform.Samsung.test(e):return this.Agent.isiSamsung=!0,"Samsung";default:return"unknown"}},this.testCompatibilityMode=function(){var e=this;if(this.Agent.isIE&&/Trident\/(\d)\.0/i.test(e.Agent.source)){var t=parseInt(RegExp.$1,10),n=parseInt(e.Agent.version,10);7===n&&7===t&&(e.Agent.isIECompatibilityMode=!0,e.Agent.version=11),7===n&&6===t&&(e.Agent.isIECompatibilityMode=!0,e.Agent.version=10),7===n&&5===t&&(e.Agent.isIECompatibilityMode=!0,e.Agent.version=9),7===n&&4===t&&(e.Agent.isIECompatibilityMode=!0,e.Agent.version=8)}},this.testSilk=function(){switch(!0){case new RegExp("silk","gi").test(this.Agent.source):this.Agent.isSilk=!0}return/Silk-Accelerated=true/gi.test(this.Agent.source)&&(this.Agent.SilkAccelerated=!0),!!this.Agent.isSilk&&"Silk"},this.testKindleFire=function(){var e=this;switch(!0){case/KFOT/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire";case/KFTT/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HD";case/KFJWI/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HD 8.9";case/KFJWA/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HD 8.9 4G";case/KFSOWI/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HD 7";case/KFTHWI/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HDX 7";case/KFTHWA/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HDX 7 4G";case/KFAPWI/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HDX 8.9";case/KFAPWA/gi.test(e.Agent.source):return this.Agent.isKindleFire=!0,"Kindle Fire HDX 8.9 4G";default:return!1}},this.testCaptiveNetwork=function(){switch(!0){case/CaptiveNetwork/gi.test(this.Agent.source):return this.Agent.isCaptive=!0,this.Agent.isMac=!0,this.Agent.platform="Apple Mac","CaptiveNetwork";default:return!1}},this.testMobile=function(){var e=this;switch(!0){case e.Agent.isWindows:case e.Agent.isLinux:case e.Agent.isMac:case e.Agent.isChromeOS:e.Agent.isDesktop=!0;break;case e.Agent.isAndroid:case e.Agent.isSamsung:e.Agent.isMobile=!0,e.Agent.isDesktop=!1}switch(!0){case e.Agent.isiPad:case e.Agent.isiPod:case e.Agent.isiPhone:case e.Agent.isBada:case e.Agent.isBlackberry:case e.Agent.isAndroid:case e.Agent.isWindowsPhone:e.Agent.isMobile=!0,e.Agent.isDesktop=!1}/mobile/i.test(e.Agent.source)&&(e.Agent.isMobile=!0,e.Agent.isDesktop=!1)},this.testTablet=function(){var e=this;switch(!0){case e.Agent.isiPad:case e.Agent.isAndroidTablet:case e.Agent.isKindleFire:e.Agent.isTablet=!0}/tablet/i.test(e.Agent.source)&&(e.Agent.isTablet=!0)},this.testNginxGeoIP=function(e){var t=this;Object.keys(e).forEach((function(n){/^GEOIP/i.test(n)&&(t.Agent.geoIp[n]=e[n])}))},this.testBot=function(){var e=this,t=n.exec(e.Agent.source.toLowerCase());t?e.Agent.isBot=t[1]:e.Agent.isAuthoritative||(e.Agent.isBot=/bot/i.test(e.Agent.source))},this.testSmartTV=function(){var e=new RegExp("smart-tv|smarttv|googletv|appletv|hbbtv|pov_tv|netcast.tv","gi").exec(this.Agent.source.toLowerCase());e&&(this.Agent.isSmartTV=e[1])},this.testAndroidTablet=function(){this.Agent.isAndroid&&!/mobile/i.test(this.Agent.source)&&(this.Agent.isAndroidTablet=!0)},this.testTouchSupport=function(){this.Agent.isTouchScreen="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0},this.getLaguage=function(){this.Agent.language=(navigator.language||navigator.userLanguage||navigator.browserLanguage||navigator.systemLanguage||"").toLowerCase()},this.getColorDepth=function(){this.Agent.colorDepth=screen.colorDepth||-1},this.getScreenResolution=function(){this.Agent.resolution=[screen.availWidth,screen.availHeight]},this.getPixelDepth=function(){this.Agent.pixelDepth=screen.pixelDepth||-1},this.getCPU=function(){this.Agent.cpuCores=navigator.hardwareConcurrency||-1},this.reset=function(){var e=this;for(var t in e.DefaultAgent)e.DefaultAgent.hasOwnProperty(t)&&(e.Agent[t]=e.DefaultAgent[t]);return e},this.parse=function(t){t=t||navigator.userAgent;var n=new e;return n.Agent.source=t.replace(/^\s*/,"").replace(/\s*$/,""),n.Agent.os=n.getOS(n.Agent.source),n.Agent.platform=n.getPlatform(n.Agent.source),n.Agent.browser=n.getBrowser(n.Agent.source),n.Agent.version=n.getBrowserVersion(n.Agent.source),n.testBot(),n.testSmartTV(),n.testMobile(),n.testAndroidTablet(),n.testTablet(),n.testCompatibilityMode(),n.testSilk(),n.testKindleFire(),n.testCaptiveNetwork(),n.testTouchSupport(),n.getLaguage(),n.getColorDepth(),n.getPixelDepth(),n.getScreenResolution(),n.getCPU(),n.Agent},this.get=function(e){var t=this.parse(),n=[];for(var r in this.options)this.options.hasOwnProperty(r)&&!0===this.options[r]&&n.push(t[r]);e&&n.push(e),!this.options.resolution&&t.isMobile&&n.push(t.resolution);var o=t.hashMD5(n.join(":"));return[o.slice(0,8),o.slice(8,12),"4"+o.slice(12,15),"b"+o.slice(15,18),o.slice(20)].join("-")},this.Agent=this.DefaultAgent,this}},function(e,t,n){"use strict";function r(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}n.d(t,"a",(function(){return r}))},function(e,t,n){n(190),e.exports=n(191)},function(e,t,n){var r;e.exports=(r=n(8),n(59),n(110),n(111),n(48),n(49),n(71),n(80),n(112),n(81),n(113),n(114),n(115),n(72),n(116),n(45),n(19),n(117),n(118),n(119),n(120),n(121),n(122),n(123),n(124),n(125),n(126),n(127),n(128),n(129),n(130),n(131),n(132),r)},function(e,t,n){var r;e.exports=(r=n(8),function(){if("function"==typeof ArrayBuffer){var e=r.lib.WordArray,t=e.init;(e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var n=e.byteLength,r=[],o=0;o<n;o++)r[o>>>2]|=e[o]<<24-o%4*8;t.call(this,r,n)}else t.apply(this,arguments)}).prototype=e}}(),r.lib.WordArray)},function(e,t,n){var r;e.exports=(r=n(8),function(){var e=r,t=e.lib.WordArray,n=e.enc;function o(e){return e<<8&4278255360|e>>>8&16711935}n.Utf16=n.Utf16BE={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o+=2){var i=t[o>>>2]>>>16-o%4*8&65535;r.push(String.fromCharCode(i))}return r.join("")},parse:function(e){for(var n=e.length,r=[],o=0;o<n;o++)r[o>>>1]|=e.charCodeAt(o)<<16-o%2*16;return t.create(r,2*n)}},n.Utf16LE={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i+=2){var a=o(t[i>>>2]>>>16-i%4*8&65535);r.push(String.fromCharCode(a))}return r.join("")},parse:function(e){for(var n=e.length,r=[],i=0;i<n;i++)r[i>>>1]|=o(e.charCodeAt(i)<<16-i%2*16);return t.create(r,2*n)}}}(),r.enc.Utf16)},function(e,t,n){var r,o,i,a,s,c;e.exports=(c=n(8),n(80),o=(r=c).lib.WordArray,i=r.algo,a=i.SHA256,s=i.SHA224=a.extend({_doReset:function(){this._hash=new o.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=a._doFinalize.call(this);return e.sigBytes-=4,e}}),r.SHA224=a._createHelper(s),r.HmacSHA224=a._createHmacHelper(s),c.SHA224)},function(e,t,n){var r,o,i,a,s,c,u,d;e.exports=(d=n(8),n(59),n(81),o=(r=d).x64,i=o.Word,a=o.WordArray,s=r.algo,c=s.SHA512,u=s.SHA384=c.extend({_doReset:function(){this._hash=new a.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var e=c._doFinalize.call(this);return e.sigBytes-=16,e}}),r.SHA384=c._createHelper(u),r.HmacSHA384=c._createHmacHelper(u),d.SHA384)},function(e,t,n){var r;e.exports=(r=n(8),n(59),function(e){var t=r,n=t.lib,o=n.WordArray,i=n.Hasher,a=t.x64.Word,s=t.algo,c=[],u=[],d=[];!function(){for(var e=1,t=0,n=0;n<24;n++){c[e+5*t]=(n+1)*(n+2)/2%64;var r=(2*e+3*t)%5;e=t%5,t=r}for(e=0;e<5;e++)for(t=0;t<5;t++)u[e+5*t]=t+(2*e+3*t)%5*5;for(var o=1,i=0;i<24;i++){for(var s=0,l=0,f=0;f<7;f++){if(1&o){var p=(1<<f)-1;p<32?l^=1<<p:s^=1<<p-32}128&o?o=o<<1^113:o<<=1}d[i]=a.create(s,l)}}();var l=[];!function(){for(var e=0;e<25;e++)l[e]=a.create()}();var f=s.SHA3=i.extend({cfg:i.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,r=this.blockSize/2,o=0;o<r;o++){var i=e[t+2*o],a=e[t+2*o+1];i=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),a=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),(P=n[o]).high^=a,P.low^=i}for(var s=0;s<24;s++){for(var f=0;f<5;f++){for(var p=0,m=0,h=0;h<5;h++)p^=(P=n[f+5*h]).high,m^=P.low;var _=l[f];_.high=p,_.low=m}for(f=0;f<5;f++){var g=l[(f+4)%5],v=l[(f+1)%5],y=v.high,b=v.low;for(p=g.high^(y<<1|b>>>31),m=g.low^(b<<1|y>>>31),h=0;h<5;h++)(P=n[f+5*h]).high^=p,P.low^=m}for(var w=1;w<25;w++){var S=(P=n[w]).high,k=P.low,C=c[w];C<32?(p=S<<C|k>>>32-C,m=k<<C|S>>>32-C):(p=k<<C-32|S>>>64-C,m=S<<C-32|k>>>64-C);var E=l[u[w]];E.high=p,E.low=m}var T=l[0],O=n[0];for(T.high=O.high,T.low=O.low,f=0;f<5;f++)for(h=0;h<5;h++){var P=n[w=f+5*h],A=l[w],R=l[(f+1)%5+5*h],M=l[(f+2)%5+5*h];P.high=A.high^~R.high&M.high,P.low=A.low^~R.low&M.low}P=n[0];var x=d[s];P.high^=x.high,P.low^=x.low}},_doFinalize:function(){var t=this._data,n=t.words,r=(this._nDataBytes,8*t.sigBytes),i=32*this.blockSize;n[r>>>5]|=1<<24-r%32,n[(e.ceil((r+1)/i)*i>>>5)-1]|=128,t.sigBytes=4*n.length,this._process();for(var a=this._state,s=this.cfg.outputLength/8,c=s/8,u=[],d=0;d<c;d++){var l=a[d],f=l.high,p=l.low;f=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),p=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),u.push(p),u.push(f)}return new o.init(u,s)},clone:function(){for(var e=i.clone.call(this),t=e._state=this._state.slice(0),n=0;n<25;n++)t[n]=t[n].clone();return e}});t.SHA3=i._createHelper(f),t.HmacSHA3=i._createHmacHelper(f)}(Math),r.SHA3)},function(e,t,n){var r;e.exports=(r=n(8),function(e){var t=r,n=t.lib,o=n.WordArray,i=n.Hasher,a=t.algo,s=o.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),c=o.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),u=o.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),d=o.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),l=o.create([0,1518500249,1859775393,2400959708,2840853838]),f=o.create([1352829926,1548603684,1836072691,2053994217,0]),p=a.RIPEMD160=i.extend({_doReset:function(){this._hash=o.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,o=e[r];e[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var i,a,p,b,w,S,k,C,E,T,O,P=this._hash.words,A=l.words,R=f.words,M=s.words,x=c.words,U=u.words,I=d.words;for(S=i=P[0],k=a=P[1],C=p=P[2],E=b=P[3],T=w=P[4],n=0;n<80;n+=1)O=i+e[t+M[n]]|0,O+=n<16?m(a,p,b)+A[0]:n<32?h(a,p,b)+A[1]:n<48?_(a,p,b)+A[2]:n<64?g(a,p,b)+A[3]:v(a,p,b)+A[4],O=(O=y(O|=0,U[n]))+w|0,i=w,w=b,b=y(p,10),p=a,a=O,O=S+e[t+x[n]]|0,O+=n<16?v(k,C,E)+R[0]:n<32?g(k,C,E)+R[1]:n<48?_(k,C,E)+R[2]:n<64?h(k,C,E)+R[3]:m(k,C,E)+R[4],O=(O=y(O|=0,I[n]))+T|0,S=T,T=E,E=y(C,10),C=k,k=O;O=P[1]+p+E|0,P[1]=P[2]+b+T|0,P[2]=P[3]+w+S|0,P[3]=P[4]+i+k|0,P[4]=P[0]+a+C|0,P[0]=O},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var o=this._hash,i=o.words,a=0;a<5;a++){var s=i[a];i[a]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}return o},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function m(e,t,n){return e^t^n}function h(e,t,n){return e&t|~e&n}function _(e,t,n){return(e|~t)^n}function g(e,t,n){return e&n|t&~n}function v(e,t,n){return e^(t|~n)}function y(e,t){return e<<t|e>>>32-t}t.RIPEMD160=i._createHelper(p),t.HmacRIPEMD160=i._createHmacHelper(p)}(Math),r.RIPEMD160)},function(e,t,n){var r,o,i,a,s,c,u,d,l;e.exports=(l=n(8),n(71),n(72),o=(r=l).lib,i=o.Base,a=o.WordArray,s=r.algo,c=s.SHA1,u=s.HMAC,d=s.PBKDF2=i.extend({cfg:i.extend({keySize:4,hasher:c,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,r=u.create(n.hasher,e),o=a.create(),i=a.create([1]),s=o.words,c=i.words,d=n.keySize,l=n.iterations;s.length<d;){var f=r.update(t).finalize(i);r.reset();for(var p=f.words,m=p.length,h=f,_=1;_<l;_++){h=r.finalize(h),r.reset();for(var g=h.words,v=0;v<m;v++)p[v]^=g[v]}o.concat(f),c[0]++}return o.sigBytes=4*d,o}}),r.PBKDF2=function(e,t,n){return d.create(n).compute(e,t)},l.PBKDF2)},function(e,t,n){var r;e.exports=(r=n(8),n(19),r.mode.CFB=function(){var e=r.lib.BlockCipherMode.extend();function t(e,t,n,r){var o=this._iv;if(o){var i=o.slice(0);this._iv=void 0}else i=this._prevBlock;r.encryptBlock(i,0);for(var a=0;a<n;a++)e[t+a]^=i[a]}return e.Encryptor=e.extend({processBlock:function(e,n){var r=this._cipher,o=r.blockSize;t.call(this,e,n,o,r),this._prevBlock=e.slice(n,n+o)}}),e.Decryptor=e.extend({processBlock:function(e,n){var r=this._cipher,o=r.blockSize,i=e.slice(n,n+o);t.call(this,e,n,o,r),this._prevBlock=i}}),e}(),r.mode.CFB)},function(e,t,n){var r,o,i;e.exports=(i=n(8),n(19),i.mode.CTR=(r=i.lib.BlockCipherMode.extend(),o=r.Encryptor=r.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=this._iv,i=this._counter;o&&(i=this._counter=o.slice(0),this._iv=void 0);var a=i.slice(0);n.encryptBlock(a,0),i[r-1]=i[r-1]+1|0;for(var s=0;s<r;s++)e[t+s]^=a[s]}}),r.Decryptor=o,r),i.mode.CTR)},function(e,t,n){var r;e.exports=(r=n(8),n(19),r.mode.CTRGladman=function(){var e=r.lib.BlockCipherMode.extend();function t(e){if(255==(e>>24&255)){var t=e>>16&255,n=e>>8&255,r=255&e;255===t?(t=0,255===n?(n=0,255===r?r=0:++r):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=r}else e+=1<<24;return e}var n=e.Encryptor=e.extend({processBlock:function(e,n){var r=this._cipher,o=r.blockSize,i=this._iv,a=this._counter;i&&(a=this._counter=i.slice(0),this._iv=void 0),function(e){0===(e[0]=t(e[0]))&&(e[1]=t(e[1]))}(a);var s=a.slice(0);r.encryptBlock(s,0);for(var c=0;c<o;c++)e[n+c]^=s[c]}});return e.Decryptor=n,e}(),r.mode.CTRGladman)},function(e,t,n){var r,o,i;e.exports=(i=n(8),n(19),i.mode.OFB=(r=i.lib.BlockCipherMode.extend(),o=r.Encryptor=r.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=this._iv,i=this._keystream;o&&(i=this._keystream=o.slice(0),this._iv=void 0),n.encryptBlock(i,0);for(var a=0;a<r;a++)e[t+a]^=i[a]}}),r.Decryptor=o,r),i.mode.OFB)},function(e,t,n){var r,o;e.exports=(o=n(8),n(19),o.mode.ECB=((r=o.lib.BlockCipherMode.extend()).Encryptor=r.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),r.Decryptor=r.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),r),o.mode.ECB)},function(e,t,n){var r;e.exports=(r=n(8),n(19),r.pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,r=4*t,o=r-n%r,i=n+o-1;e.clamp(),e.words[i>>>2]|=o<<24-i%4*8,e.sigBytes+=o},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},r.pad.Ansix923)},function(e,t,n){var r;e.exports=(r=n(8),n(19),r.pad.Iso10126={pad:function(e,t){var n=4*t,o=n-e.sigBytes%n;e.concat(r.lib.WordArray.random(o-1)).concat(r.lib.WordArray.create([o<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},r.pad.Iso10126)},function(e,t,n){var r;e.exports=(r=n(8),n(19),r.pad.Iso97971={pad:function(e,t){e.concat(r.lib.WordArray.create([2147483648],1)),r.pad.ZeroPadding.pad(e,t)},unpad:function(e){r.pad.ZeroPadding.unpad(e),e.sigBytes--}},r.pad.Iso97971)},function(e,t,n){var r;e.exports=(r=n(8),n(19),r.pad.ZeroPadding={pad:function(e,t){var n=4*t;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){for(var t=e.words,n=e.sigBytes-1;!(t[n>>>2]>>>24-n%4*8&255);)n--;e.sigBytes=n+1}},r.pad.ZeroPadding)},function(e,t,n){var r;e.exports=(r=n(8),n(19),r.pad.NoPadding={pad:function(){},unpad:function(){}},r.pad.NoPadding)},function(e,t,n){var r,o,i,a;e.exports=(a=n(8),n(19),o=(r=a).lib.CipherParams,i=r.enc.Hex,r.format.Hex={stringify:function(e){return e.ciphertext.toString(i)},parse:function(e){var t=i.parse(e);return o.create({ciphertext:t})}},a.format.Hex)},function(e,t,n){var r;e.exports=(r=n(8),n(48),n(49),n(45),n(19),function(){var e=r,t=e.lib.BlockCipher,n=e.algo,o=[],i=[],a=[],s=[],c=[],u=[],d=[],l=[],f=[],p=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var n=0,r=0;for(t=0;t<256;t++){var m=r^r<<1^r<<2^r<<3^r<<4;m=m>>>8^255&m^99,o[n]=m,i[m]=n;var h=e[n],_=e[h],g=e[_],v=257*e[m]^16843008*m;a[n]=v<<24|v>>>8,s[n]=v<<16|v>>>16,c[n]=v<<8|v>>>24,u[n]=v,v=16843009*g^65537*_^257*h^16843008*n,d[m]=v<<24|v>>>8,l[m]=v<<16|v>>>16,f[m]=v<<8|v>>>24,p[m]=v,n?(n=h^e[e[e[g^h]]],r^=e[e[r]]):n=r=1}}();var m=[0,1,2,4,8,16,32,64,128,27,54],h=n.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,r=4*((this._nRounds=n+6)+1),i=this._keySchedule=[],a=0;a<r;a++)if(a<n)i[a]=t[a];else{var s=i[a-1];a%n?n>6&&a%n==4&&(s=o[s>>>24]<<24|o[s>>>16&255]<<16|o[s>>>8&255]<<8|o[255&s]):(s=o[(s=s<<8|s>>>24)>>>24]<<24|o[s>>>16&255]<<16|o[s>>>8&255]<<8|o[255&s],s^=m[a/n|0]<<24),i[a]=i[a-n]^s}for(var c=this._invKeySchedule=[],u=0;u<r;u++)a=r-u,s=u%4?i[a]:i[a-4],c[u]=u<4||a<=4?s:d[o[s>>>24]]^l[o[s>>>16&255]]^f[o[s>>>8&255]]^p[o[255&s]]}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,a,s,c,u,o)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,d,l,f,p,i),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,a,s){for(var c=this._nRounds,u=e[t]^n[0],d=e[t+1]^n[1],l=e[t+2]^n[2],f=e[t+3]^n[3],p=4,m=1;m<c;m++){var h=r[u>>>24]^o[d>>>16&255]^i[l>>>8&255]^a[255&f]^n[p++],_=r[d>>>24]^o[l>>>16&255]^i[f>>>8&255]^a[255&u]^n[p++],g=r[l>>>24]^o[f>>>16&255]^i[u>>>8&255]^a[255&d]^n[p++],v=r[f>>>24]^o[u>>>16&255]^i[d>>>8&255]^a[255&l]^n[p++];u=h,d=_,l=g,f=v}h=(s[u>>>24]<<24|s[d>>>16&255]<<16|s[l>>>8&255]<<8|s[255&f])^n[p++],_=(s[d>>>24]<<24|s[l>>>16&255]<<16|s[f>>>8&255]<<8|s[255&u])^n[p++],g=(s[l>>>24]<<24|s[f>>>16&255]<<16|s[u>>>8&255]<<8|s[255&d])^n[p++],v=(s[f>>>24]<<24|s[u>>>16&255]<<16|s[d>>>8&255]<<8|s[255&l])^n[p++],e[t]=h,e[t+1]=_,e[t+2]=g,e[t+3]=v},keySize:8});e.AES=t._createHelper(h)}(),r.AES)},function(e,t,n){var r;e.exports=(r=n(8),n(48),n(49),n(45),n(19),function(){var e=r,t=e.lib,n=t.WordArray,o=t.BlockCipher,i=e.algo,a=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],s=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],u=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],d=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],l=i.DES=o.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;n<56;n++){var r=a[n]-1;t[n]=e[r>>>5]>>>31-r%32&1}for(var o=this._subKeys=[],i=0;i<16;i++){var u=o[i]=[],d=c[i];for(n=0;n<24;n++)u[n/6|0]|=t[(s[n]-1+d)%28]<<31-n%6,u[4+(n/6|0)]|=t[28+(s[n+24]-1+d)%28]<<31-n%6;for(u[0]=u[0]<<1|u[0]>>>31,n=1;n<7;n++)u[n]=u[n]>>>4*(n-1)+3;u[7]=u[7]<<5|u[7]>>>27}var l=this._invSubKeys=[];for(n=0;n<16;n++)l[n]=o[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,n){this._lBlock=e[t],this._rBlock=e[t+1],f.call(this,4,252645135),f.call(this,16,65535),p.call(this,2,858993459),p.call(this,8,16711935),f.call(this,1,1431655765);for(var r=0;r<16;r++){for(var o=n[r],i=this._lBlock,a=this._rBlock,s=0,c=0;c<8;c++)s|=u[c][((a^o[c])&d[c])>>>0];this._lBlock=a,this._rBlock=i^s}var l=this._lBlock;this._lBlock=this._rBlock,this._rBlock=l,f.call(this,1,1431655765),p.call(this,8,16711935),p.call(this,2,858993459),f.call(this,16,65535),f.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function f(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function p(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}e.DES=o._createHelper(l);var m=i.TripleDES=o.extend({_doReset:function(){var e=this._key.words;this._des1=l.createEncryptor(n.create(e.slice(0,2))),this._des2=l.createEncryptor(n.create(e.slice(2,4))),this._des3=l.createEncryptor(n.create(e.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=o._createHelper(m)}(),r.TripleDES)},function(e,t,n){var r;e.exports=(r=n(8),n(48),n(49),n(45),n(19),function(){var e=r,t=e.lib.StreamCipher,n=e.algo,o=n.RC4=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes,r=this._S=[],o=0;o<256;o++)r[o]=o;o=0;for(var i=0;o<256;o++){var a=o%n,s=t[a>>>2]>>>24-a%4*8&255;i=(i+r[o]+s)%256;var c=r[o];r[o]=r[i],r[i]=c}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=i.call(this)},keySize:8,ivSize:0});function i(){for(var e=this._S,t=this._i,n=this._j,r=0,o=0;o<4;o++){n=(n+e[t=(t+1)%256])%256;var i=e[t];e[t]=e[n],e[n]=i,r|=e[(e[t]+e[n])%256]<<24-8*o}return this._i=t,this._j=n,r}e.RC4=t._createHelper(o);var a=n.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:function(){o._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)i.call(this)}});e.RC4Drop=t._createHelper(a)}(),r.RC4)},function(e,t,n){var r;e.exports=(r=n(8),n(48),n(49),n(45),n(19),function(){var e=r,t=e.lib.StreamCipher,n=e.algo,o=[],i=[],a=[],s=n.Rabbit=t.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);var r=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],o=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,n=0;n<4;n++)c.call(this);for(n=0;n<8;n++)o[n]^=r[n+4&7];if(t){var i=t.words,a=i[0],s=i[1],u=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),d=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),l=u>>>16|4294901760&d,f=d<<16|65535&u;for(o[0]^=u,o[1]^=l,o[2]^=d,o[3]^=f,o[4]^=u,o[5]^=l,o[6]^=d,o[7]^=f,n=0;n<4;n++)c.call(this)}},_doProcessBlock:function(e,t){var n=this._X;c.call(this),o[0]=n[0]^n[5]>>>16^n[3]<<16,o[1]=n[2]^n[7]>>>16^n[5]<<16,o[2]=n[4]^n[1]>>>16^n[7]<<16,o[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)o[r]=16711935&(o[r]<<8|o[r]>>>24)|4278255360&(o[r]<<24|o[r]>>>8),e[t+r]^=o[r]},blockSize:4,ivSize:2});function c(){for(var e=this._X,t=this._C,n=0;n<8;n++)i[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<i[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<i[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<i[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<i[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<i[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<i[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<i[6]>>>0?1:0)|0,this._b=t[7]>>>0<i[7]>>>0?1:0,n=0;n<8;n++){var r=e[n]+t[n],o=65535&r,s=r>>>16,c=((o*o>>>17)+o*s>>>15)+s*s,u=((4294901760&r)*r|0)+((65535&r)*r|0);a[n]=c^u}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}e.Rabbit=t._createHelper(s)}(),r.Rabbit)},function(e,t,n){var r;e.exports=(r=n(8),n(48),n(49),n(45),n(19),function(){var e=r,t=e.lib.StreamCipher,n=e.algo,o=[],i=[],a=[],s=n.RabbitLegacy=t.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],r=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var o=0;o<4;o++)c.call(this);for(o=0;o<8;o++)r[o]^=n[o+4&7];if(t){var i=t.words,a=i[0],s=i[1],u=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),d=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),l=u>>>16|4294901760&d,f=d<<16|65535&u;for(r[0]^=u,r[1]^=l,r[2]^=d,r[3]^=f,r[4]^=u,r[5]^=l,r[6]^=d,r[7]^=f,o=0;o<4;o++)c.call(this)}},_doProcessBlock:function(e,t){var n=this._X;c.call(this),o[0]=n[0]^n[5]>>>16^n[3]<<16,o[1]=n[2]^n[7]>>>16^n[5]<<16,o[2]=n[4]^n[1]>>>16^n[7]<<16,o[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)o[r]=16711935&(o[r]<<8|o[r]>>>24)|4278255360&(o[r]<<24|o[r]>>>8),e[t+r]^=o[r]},blockSize:4,ivSize:2});function c(){for(var e=this._X,t=this._C,n=0;n<8;n++)i[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<i[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<i[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<i[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<i[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<i[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<i[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<i[6]>>>0?1:0)|0,this._b=t[7]>>>0<i[7]>>>0?1:0,n=0;n<8;n++){var r=e[n]+t[n],o=65535&r,s=r>>>16,c=((o*o>>>17)+o*s>>>15)+s*s,u=((4294901760&r)*r|0)+((65535&r)*r|0);a[n]=c^u}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}e.RabbitLegacy=t._createHelper(s)}(),r.RabbitLegacy)},function(e,t){e.exports={aes_secret:">|Z2i580Py*4C3r",APP_KEY:"base64:/WMD6Ib6GbZI55/W04iZe1/mkA90UHgbuOdtw9wzafM="}},function(e,t,n){"use strict";var r=n(60),o=n(136),i=n(140),a=n(141)||0;function s(){return o(a)}e.exports=s,e.exports.generate=s,e.exports.seed=function(t){return r.seed(t),e.exports},e.exports.worker=function(t){return a=t,e.exports},e.exports.characters=function(e){return void 0!==e&&r.characters(e),r.shuffled()},e.exports.isValid=i},function(e,t,n){"use strict";var r=1;e.exports={nextValue:function(){return(r=(9301*r+49297)%233280)/233280},seed:function(e){r=e}}},function(e,t,n){"use strict";var r,o,i=n(137);n(60);e.exports=function(e){var t="",n=Math.floor(.001*(Date.now()-1567752802062));return n===o?r++:(r=0,o=n),t+=i(7),t+=i(e),r>0&&(t+=i(r)),t+=i(n)}},function(e,t,n){"use strict";var r=n(60),o=n(138),i=n(139);e.exports=function(e){for(var t,n=0,a="";!t;)a+=i(o,r.get(),1),t=e<Math.pow(16,n+1),n++;return a}},function(e,t,n){"use strict";var r,o="object"==typeof window&&(window.crypto||window.msCrypto);r=o&&o.getRandomValues?function(e){return o.getRandomValues(new Uint8Array(e))}:function(e){for(var t=[],n=0;n<e;n++)t.push(Math.floor(256*Math.random()));return t},e.exports=r},function(e,t){e.exports=function(e,t,n){for(var r=(2<<Math.log(t.length-1)/Math.LN2)-1,o=-~(1.6*r*n/t.length),i="";;)for(var a=e(o),s=o;s--;)if((i+=t[a[s]&r]||"").length===+n)return i}},function(e,t,n){"use strict";var r=n(60);e.exports=function(e){return!(!e||"string"!=typeof e||e.length<6)&&!new RegExp("[^"+r.get().replace(/[|\\{}()[\]^$+*?.-]/g,"\\$&")+"]").test(e)}},function(e,t,n){"use strict";e.exports=0},function(e,t,n){"use strict";var r;window.jscolor||(window.jscolor=((r={register:function(){r.attachDOMReadyEvent(r.init),r.attachEvent(document,"mousedown",r.onDocumentMouseDown),r.attachEvent(document,"touchstart",r.onDocumentTouchStart),r.attachEvent(window,"resize",r.onWindowResize)},init:function(){r.jscolor.lookupClass&&r.jscolor.installByClassName(r.jscolor.lookupClass)},tryInstallOnElements:function(e,t){for(var n=new RegExp("(^|\\s)("+t+")(\\s*(\\{[^}]*\\})|\\s|$)","i"),o=0;o<e.length;o+=1){var i;if((void 0===e[o].type||"color"!=e[o].type.toLowerCase()||!r.isColorAttrSupported)&&!e[o].jscolor&&e[o].className&&(i=e[o].className.match(n))){var a=e[o],s=null,c=r.getDataAttr(a,"jscolor");null!==c?s=c:i[4]&&(s=i[4]);var u={};if(s)try{u=new Function("return ("+s+")")()}catch(e){r.warn("Error parsing jscolor options: "+e+":\n"+s)}a.jscolor=new r.jscolor(a,u)}}},isColorAttrSupported:function(){var e=document.createElement("input");return!(!e.setAttribute||(e.setAttribute("type","color"),"color"!=e.type.toLowerCase()))}(),isCanvasSupported:function(){var e=document.createElement("canvas");return!!e.getContext&&!!e.getContext("2d")}(),fetchElement:function(e){return"string"==typeof e?document.getElementById(e):e},isElementType:function(e,t){return e.nodeName.toLowerCase()===t.toLowerCase()},getDataAttr:function(e,t){var n="data-"+t,r=e.getAttribute(n);return null!==r?r:null},attachEvent:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},detachEvent:function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)},_attachedGroupEvents:{},attachGroupEvent:function(e,t,n,o){r._attachedGroupEvents.hasOwnProperty(e)||(r._attachedGroupEvents[e]=[]),r._attachedGroupEvents[e].push([t,n,o]),r.attachEvent(t,n,o)},detachGroupEvents:function(e){if(r._attachedGroupEvents.hasOwnProperty(e)){for(var t=0;t<r._attachedGroupEvents[e].length;t+=1){var n=r._attachedGroupEvents[e][t];r.detachEvent(n[0],n[1],n[2])}delete r._attachedGroupEvents[e]}},attachDOMReadyEvent:function(e){var t=!1,n=function(){t||(t=!0,e())};"complete"!==document.readyState?document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",arguments.callee),n())})),window.attachEvent("onload",n),document.documentElement.doScroll&&window==window.top)&&function e(){if(document.body)try{document.documentElement.doScroll("left"),n()}catch(t){setTimeout(e,1)}}():setTimeout(n,1)},warn:function(e){window.console&&window.console.warn&&window.console.warn(e)},preventDefault:function(e){e.preventDefault&&e.preventDefault(),e.returnValue=!1},captureTarget:function(e){e.setCapture&&(r._capturedTarget=e,r._capturedTarget.setCapture())},releaseTarget:function(){r._capturedTarget&&(r._capturedTarget.releaseCapture(),r._capturedTarget=null)},fireEvent:function(e,t){if(e)if(document.createEvent)(n=document.createEvent("HTMLEvents")).initEvent(t,!0,!0),e.dispatchEvent(n);else if(document.createEventObject){var n=document.createEventObject();e.fireEvent("on"+t,n)}else e["on"+t]&&e["on"+t]()},classNameToList:function(e){return e.replace(/^\s+|\s+$/g,"").split(/\s+/)},hasClass:function(e,t){return!!t&&-1!=(" "+e.className.replace(/\s+/g," ")+" ").indexOf(" "+t+" ")},setClass:function(e,t){for(var n=r.classNameToList(t),o=0;o<n.length;o+=1)r.hasClass(e,n[o])||(e.className+=(e.className?" ":"")+n[o])},unsetClass:function(e,t){for(var n=r.classNameToList(t),o=0;o<n.length;o+=1){var i=new RegExp("^\\s*"+n[o]+"\\s*|\\s*"+n[o]+"\\s*$|\\s+"+n[o]+"(\\s+)","g");e.className=e.className.replace(i,"$1")}},getStyle:function(e){return window.getComputedStyle?window.getComputedStyle(e):e.currentStyle},setStyle:function(){var e=document.createElement("div"),t=function(t){for(var n=0;n<t.length;n+=1)if(t[n]in e.style)return t[n]},n={borderRadius:t(["borderRadius","MozBorderRadius","webkitBorderRadius"]),boxShadow:t(["boxShadow","MozBoxShadow","webkitBoxShadow"])};return function(e,t,r){switch(t.toLowerCase()){case"opacity":var o=Math.round(100*parseFloat(r));e.style.opacity=r,e.style.filter="alpha(opacity="+o+")";break;default:e.style[n[t]]=r}}}(),setBorderRadius:function(e,t){r.setStyle(e,"borderRadius",t||"0")},setBoxShadow:function(e,t){r.setStyle(e,"boxShadow",t||"none")},getElementPos:function(e,t){var n=0,o=0,i=e.getBoundingClientRect();if(n=i.left,o=i.top,!t){var a=r.getViewPos();n+=a[0],o+=a[1]}return[n,o]},getElementSize:function(e){return[e.offsetWidth,e.offsetHeight]},getAbsPointerPos:function(e){e||(e=window.event);var t=0,n=0;return void 0!==e.changedTouches&&e.changedTouches.length?(t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY):"number"==typeof e.clientX&&(t=e.clientX,n=e.clientY),{x:t,y:n}},getRelPointerPos:function(e){e||(e=window.event);var t=(e.target||e.srcElement).getBoundingClientRect(),n=0,r=0;return void 0!==e.changedTouches&&e.changedTouches.length?(n=e.changedTouches[0].clientX,r=e.changedTouches[0].clientY):"number"==typeof e.clientX&&(n=e.clientX,r=e.clientY),{x:n-t.left,y:r-t.top}},getViewPos:function(){var e=document.documentElement;return[(window.pageXOffset||e.scrollLeft)-(e.clientLeft||0),(window.pageYOffset||e.scrollTop)-(e.clientTop||0)]},getViewSize:function(){var e=document.documentElement;return[window.innerWidth||e.clientWidth,window.innerHeight||e.clientHeight]},redrawPosition:function(){if(r.picker&&r.picker.owner){var e,t,n=r.picker.owner;n.fixed?(e=r.getElementPos(n.targetElement,!0),t=[0,0]):(e=r.getElementPos(n.targetElement),t=r.getViewPos());var o,i,a,s=r.getElementSize(n.targetElement),c=r.getViewSize(),u=r.getPickerOuterDims(n);switch(n.position.toLowerCase()){case"left":o=1,i=0,a=-1;break;case"right":o=1,i=0,a=1;break;case"top":o=0,i=1,a=-1;break;default:o=0,i=1,a=1}var d=(s[i]+u[i])/2;if(n.smartPosition)l=[-t[o]+e[o]+u[o]>c[o]&&-t[o]+e[o]+s[o]/2>c[o]/2&&e[o]+s[o]-u[o]>=0?e[o]+s[o]-u[o]:e[o],-t[i]+e[i]+s[i]+u[i]-d+d*a>c[i]?-t[i]+e[i]+s[i]/2>c[i]/2&&e[i]+s[i]-d-d*a>=0?e[i]+s[i]-d-d*a:e[i]+s[i]-d+d*a:e[i]+s[i]-d+d*a>=0?e[i]+s[i]-d+d*a:e[i]+s[i]-d-d*a];else var l=[e[o],e[i]+s[i]-d+d*a];var f=l[o],p=l[i],m=n.fixed?"fixed":"absolute",h=(l[0]+u[0]>e[0]||l[0]<e[0]+s[0])&&l[1]+u[1]<e[1]+s[1];r._drawPosition(n,f,p,m,h)}},_drawPosition:function(e,t,n,o,i){var a=i?0:e.shadowBlur;r.picker.wrap.style.position=o,r.picker.wrap.style.left=t+"px",r.picker.wrap.style.top=n+"px",r.setBoxShadow(r.picker.boxS,e.shadow?new r.BoxShadow(0,a,e.shadowBlur,0,e.shadowColor):null)},getPickerDims:function(e){var t=!!r.getSliderComponent(e);return[2*e.insetWidth+2*e.padding+e.width+(t?2*e.insetWidth+r.getPadToSliderPadding(e)+e.sliderSize:0),2*e.insetWidth+2*e.padding+e.height+(e.closable?2*e.insetWidth+e.padding+e.buttonHeight:0)]},getPickerOuterDims:function(e){var t=r.getPickerDims(e);return[t[0]+2*e.borderWidth,t[1]+2*e.borderWidth]},getPadToSliderPadding:function(e){return Math.max(e.padding,1.5*(2*e.pointerBorderWidth+e.pointerThickness))},getPadYComponent:function(e){switch(e.mode.charAt(1).toLowerCase()){case"v":return"v"}return"s"},getSliderComponent:function(e){if(e.mode.length>2)switch(e.mode.charAt(2).toLowerCase()){case"s":return"s";case"v":return"v"}return null},onDocumentMouseDown:function(e){e||(e=window.event);var t=e.target||e.srcElement;t._jscLinkedInstance?t._jscLinkedInstance.showOnClick&&t._jscLinkedInstance.show():t._jscControlName?r.onControlPointerStart(e,t,t._jscControlName,"mouse"):r.picker&&r.picker.owner&&r.picker.owner.hide()},onDocumentTouchStart:function(e){e||(e=window.event);var t=e.target||e.srcElement;t._jscLinkedInstance?t._jscLinkedInstance.showOnClick&&t._jscLinkedInstance.show():t._jscControlName?r.onControlPointerStart(e,t,t._jscControlName,"touch"):r.picker&&r.picker.owner&&r.picker.owner.hide()},onWindowResize:function(e){r.redrawPosition()},onParentScroll:function(e){r.picker&&r.picker.owner&&r.picker.owner.hide()},_pointerMoveEvent:{mouse:"mousemove",touch:"touchmove"},_pointerEndEvent:{mouse:"mouseup",touch:"touchend"},_pointerOrigin:null,_capturedTarget:null,onControlPointerStart:function(e,t,n,o){var i=t._jscInstance;r.preventDefault(e),r.captureTarget(t);var a=function(i,a){r.attachGroupEvent("drag",i,r._pointerMoveEvent[o],r.onDocumentPointerMove(e,t,n,o,a)),r.attachGroupEvent("drag",i,r._pointerEndEvent[o],r.onDocumentPointerEnd(e,t,n,o))};if(a(document,[0,0]),window.parent&&window.frameElement){var s=window.frameElement.getBoundingClientRect(),c=[-s.left,-s.top];a(window.parent.window.document,c)}var u=r.getAbsPointerPos(e),d=r.getRelPointerPos(e);switch(r._pointerOrigin={x:u.x-d.x,y:u.y-d.y},n){case"pad":switch(r.getSliderComponent(i)){case"s":0===i.hsv[1]&&i.fromHSV(null,100,null);break;case"v":0===i.hsv[2]&&i.fromHSV(null,null,100)}r.setPad(i,e,0,0);break;case"sld":r.setSld(i,e,0)}r.dispatchFineChange(i)},onDocumentPointerMove:function(e,t,n,o,i){return function(e){var o=t._jscInstance;switch(n){case"pad":e||(e=window.event),r.setPad(o,e,i[0],i[1]),r.dispatchFineChange(o);break;case"sld":e||(e=window.event),r.setSld(o,e,i[1]),r.dispatchFineChange(o)}}},onDocumentPointerEnd:function(e,t,n,o){return function(e){var n=t._jscInstance;r.detachGroupEvents("drag"),r.releaseTarget(),r.dispatchChange(n)}},dispatchChange:function(e){e.valueElement&&r.isElementType(e.valueElement,"input")&&r.fireEvent(e.valueElement,"change")},dispatchFineChange:function(e){e.onFineChange&&("string"==typeof e.onFineChange?new Function(e.onFineChange):e.onFineChange).call(e)},setPad:function(e,t,n,o){var i=r.getAbsPointerPos(t),a=n+i.x-r._pointerOrigin.x-e.padding-e.insetWidth,s=o+i.y-r._pointerOrigin.y-e.padding-e.insetWidth,c=a*(360/(e.width-1)),u=100-s*(100/(e.height-1));switch(r.getPadYComponent(e)){case"s":e.fromHSV(c,u,null,r.leaveSld);break;case"v":e.fromHSV(c,null,u,r.leaveSld)}},setSld:function(e,t,n){var o=100-(n+r.getAbsPointerPos(t).y-r._pointerOrigin.y-e.padding-e.insetWidth)*(100/(e.height-1));switch(r.getSliderComponent(e)){case"s":e.fromHSV(null,o,null,r.leavePad);break;case"v":e.fromHSV(null,null,o,r.leavePad)}},_vmlNS:"jsc_vml_",_vmlCSS:"jsc_vml_css_",_vmlReady:!1,initVML:function(){if(!r._vmlReady){var e=document;if(e.namespaces[r._vmlNS]||e.namespaces.add(r._vmlNS,"urn:schemas-microsoft-com:vml"),!e.styleSheets[r._vmlCSS]){var t=["shape","shapetype","group","background","path","formulas","handles","fill","stroke","shadow","textbox","textpath","imagedata","line","polyline","curve","rect","roundrect","oval","arc","image"],n=e.createStyleSheet();n.owningElement.id=r._vmlCSS;for(var o=0;o<t.length;o+=1)n.addRule(r._vmlNS+"\\:"+t[o],"behavior:url(#default#VML);")}r._vmlReady=!0}},createPalette:function(){var e={elm:null,draw:null};if(r.isCanvasSupported){var t=document.createElement("canvas"),n=t.getContext("2d"),o=function(e,r,o){t.width=e,t.height=r,n.clearRect(0,0,t.width,t.height);var i=n.createLinearGradient(0,0,t.width,0);i.addColorStop(0,"#F00"),i.addColorStop(1/6,"#FF0"),i.addColorStop(2/6,"#0F0"),i.addColorStop(.5,"#0FF"),i.addColorStop(4/6,"#00F"),i.addColorStop(5/6,"#F0F"),i.addColorStop(1,"#F00"),n.fillStyle=i,n.fillRect(0,0,t.width,t.height);var a=n.createLinearGradient(0,0,0,t.height);switch(o.toLowerCase()){case"s":a.addColorStop(0,"rgba(255,255,255,0)"),a.addColorStop(1,"rgba(255,255,255,1)");break;case"v":a.addColorStop(0,"rgba(0,0,0,0)"),a.addColorStop(1,"rgba(0,0,0,1)")}n.fillStyle=a,n.fillRect(0,0,t.width,t.height)};e.elm=t,e.draw=o}else{r.initVML();var i=document.createElement("div");i.style.position="relative",i.style.overflow="hidden";var a=document.createElement(r._vmlNS+":fill");a.type="gradient",a.method="linear",a.angle="90",a.colors="16.67% #F0F, 33.33% #00F, 50% #0FF, 66.67% #0F0, 83.33% #FF0";var s=document.createElement(r._vmlNS+":rect");s.style.position="absolute",s.style.left="-1px",s.style.top="-1px",s.stroked=!1,s.appendChild(a),i.appendChild(s);var c=document.createElement(r._vmlNS+":fill");c.type="gradient",c.method="linear",c.angle="180",c.opacity="0";var u=document.createElement(r._vmlNS+":rect");u.style.position="absolute",u.style.left="-1px",u.style.top="-1px",u.stroked=!1,u.appendChild(c),i.appendChild(u),o=function(e,t,n){switch(i.style.width=e+"px",i.style.height=t+"px",s.style.width=u.style.width=e+1+"px",s.style.height=u.style.height=t+1+"px",a.color="#F00",a.color2="#F00",n.toLowerCase()){case"s":c.color=c.color2="#FFF";break;case"v":c.color=c.color2="#000"}},e.elm=i,e.draw=o}return e},createSliderGradient:function(){var e={elm:null,draw:null};if(r.isCanvasSupported){var t=document.createElement("canvas"),n=t.getContext("2d"),o=function(e,r,o,i){t.width=e,t.height=r,n.clearRect(0,0,t.width,t.height);var a=n.createLinearGradient(0,0,0,t.height);a.addColorStop(0,o),a.addColorStop(1,i),n.fillStyle=a,n.fillRect(0,0,t.width,t.height)};e.elm=t,e.draw=o}else{r.initVML();var i=document.createElement("div");i.style.position="relative",i.style.overflow="hidden";var a=document.createElement(r._vmlNS+":fill");a.type="gradient",a.method="linear",a.angle="180";var s=document.createElement(r._vmlNS+":rect");s.style.position="absolute",s.style.left="-1px",s.style.top="-1px",s.stroked=!1,s.appendChild(a),i.appendChild(s),o=function(e,t,n,r){i.style.width=e+"px",i.style.height=t+"px",s.style.width=e+1+"px",s.style.height=t+1+"px",a.color=n,a.color2=r},e.elm=i,e.draw=o}return e},leaveValue:1,leaveStyle:2,leavePad:4,leaveSld:8,BoxShadow:function(){var e=function(e,t,n,r,o,i){this.hShadow=e,this.vShadow=t,this.blur=n,this.spread=r,this.color=o,this.inset=!!i};return e.prototype.toString=function(){var e=[Math.round(this.hShadow)+"px",Math.round(this.vShadow)+"px",Math.round(this.blur)+"px",Math.round(this.spread)+"px",this.color];return this.inset&&e.push("inset"),e.join(" ")},e}(),jscolor:function(e,t){function n(e,t,n){var r=n/100*255;if(null===e)return[r,r,r];e/=60,t/=100;var o=Math.floor(e),i=r*(1-t),a=r*(1-t*(o%2?e-o:1-(e-o)));switch(o){case 6:case 0:return[r,a,i];case 1:return[a,r,i];case 2:return[i,r,a];case 3:return[i,a,r];case 4:return[a,i,r];case 5:return[r,i,a]}}function o(){l._processParentElementsInDOM(),r.picker||(r.picker={owner:null,wrap:document.createElement("div"),box:document.createElement("div"),boxS:document.createElement("div"),boxB:document.createElement("div"),pad:document.createElement("div"),padB:document.createElement("div"),padM:document.createElement("div"),padPal:r.createPalette(),cross:document.createElement("div"),crossBY:document.createElement("div"),crossBX:document.createElement("div"),crossLY:document.createElement("div"),crossLX:document.createElement("div"),sld:document.createElement("div"),sldB:document.createElement("div"),sldM:document.createElement("div"),sldGrad:r.createSliderGradient(),sldPtrS:document.createElement("div"),sldPtrIB:document.createElement("div"),sldPtrMB:document.createElement("div"),sldPtrOB:document.createElement("div"),btn:document.createElement("div"),btnT:document.createElement("span")},r.picker.pad.appendChild(r.picker.padPal.elm),r.picker.padB.appendChild(r.picker.pad),r.picker.cross.appendChild(r.picker.crossBY),r.picker.cross.appendChild(r.picker.crossBX),r.picker.cross.appendChild(r.picker.crossLY),r.picker.cross.appendChild(r.picker.crossLX),r.picker.padB.appendChild(r.picker.cross),r.picker.box.appendChild(r.picker.padB),r.picker.box.appendChild(r.picker.padM),r.picker.sld.appendChild(r.picker.sldGrad.elm),r.picker.sldB.appendChild(r.picker.sld),r.picker.sldB.appendChild(r.picker.sldPtrOB),r.picker.sldPtrOB.appendChild(r.picker.sldPtrMB),r.picker.sldPtrMB.appendChild(r.picker.sldPtrIB),r.picker.sldPtrIB.appendChild(r.picker.sldPtrS),r.picker.box.appendChild(r.picker.sldB),r.picker.box.appendChild(r.picker.sldM),r.picker.btn.appendChild(r.picker.btnT),r.picker.box.appendChild(r.picker.btn),r.picker.boxB.appendChild(r.picker.box),r.picker.wrap.appendChild(r.picker.boxS),r.picker.wrap.appendChild(r.picker.boxB));var e=r.picker,t=!!r.getSliderComponent(l),n=r.getPickerDims(l),o=2*l.pointerBorderWidth+l.pointerThickness+2*l.crossSize,s=r.getPadToSliderPadding(l),c=Math.min(l.borderRadius,Math.round(l.padding*Math.PI));e.wrap.style.clear="both",e.wrap.style.width=n[0]+2*l.borderWidth+"px",e.wrap.style.height=n[1]+2*l.borderWidth+"px",e.wrap.style.zIndex=l.zIndex,e.box.style.width=n[0]+"px",e.box.style.height=n[1]+"px",e.boxS.style.position="absolute",e.boxS.style.left="0",e.boxS.style.top="0",e.boxS.style.width="100%",e.boxS.style.height="100%",r.setBorderRadius(e.boxS,c+"px"),e.boxB.style.position="relative",e.boxB.style.border=l.borderWidth+"px solid",e.boxB.style.borderColor=l.borderColor,e.boxB.style.background=l.backgroundColor,r.setBorderRadius(e.boxB,c+"px"),e.padM.style.background=e.sldM.style.background="#FFF",r.setStyle(e.padM,"opacity","0"),r.setStyle(e.sldM,"opacity","0"),e.pad.style.position="relative",e.pad.style.width=l.width+"px",e.pad.style.height=l.height+"px",e.padPal.draw(l.width,l.height,r.getPadYComponent(l)),e.padB.style.position="absolute",e.padB.style.left=l.padding+"px",e.padB.style.top=l.padding+"px",e.padB.style.border=l.insetWidth+"px solid",e.padB.style.borderColor=l.insetColor,e.padM._jscInstance=l,e.padM._jscControlName="pad",e.padM.style.position="absolute",e.padM.style.left="0",e.padM.style.top="0",e.padM.style.width=l.padding+2*l.insetWidth+l.width+s/2+"px",e.padM.style.height=n[1]+"px",e.padM.style.cursor="crosshair",e.cross.style.position="absolute",e.cross.style.left=e.cross.style.top="0",e.cross.style.width=e.cross.style.height=o+"px",e.crossBY.style.position=e.crossBX.style.position="absolute",e.crossBY.style.background=e.crossBX.style.background=l.pointerBorderColor,e.crossBY.style.width=e.crossBX.style.height=2*l.pointerBorderWidth+l.pointerThickness+"px",e.crossBY.style.height=e.crossBX.style.width=o+"px",e.crossBY.style.left=e.crossBX.style.top=Math.floor(o/2)-Math.floor(l.pointerThickness/2)-l.pointerBorderWidth+"px",e.crossBY.style.top=e.crossBX.style.left="0",e.crossLY.style.position=e.crossLX.style.position="absolute",e.crossLY.style.background=e.crossLX.style.background=l.pointerColor,e.crossLY.style.height=e.crossLX.style.width=o-2*l.pointerBorderWidth+"px",e.crossLY.style.width=e.crossLX.style.height=l.pointerThickness+"px",e.crossLY.style.left=e.crossLX.style.top=Math.floor(o/2)-Math.floor(l.pointerThickness/2)+"px",e.crossLY.style.top=e.crossLX.style.left=l.pointerBorderWidth+"px",e.sld.style.overflow="hidden",e.sld.style.width=l.sliderSize+"px",e.sld.style.height=l.height+"px",e.sldGrad.draw(l.sliderSize,l.height,"#000","#000"),e.sldB.style.display=t?"block":"none",e.sldB.style.position="absolute",e.sldB.style.right=l.padding+"px",e.sldB.style.top=l.padding+"px",e.sldB.style.border=l.insetWidth+"px solid",e.sldB.style.borderColor=l.insetColor,e.sldM._jscInstance=l,e.sldM._jscControlName="sld",e.sldM.style.display=t?"block":"none",e.sldM.style.position="absolute",e.sldM.style.right="0",e.sldM.style.top="0",e.sldM.style.width=l.sliderSize+s/2+l.padding+2*l.insetWidth+"px",e.sldM.style.height=n[1]+"px",e.sldM.style.cursor="default",e.sldPtrIB.style.border=e.sldPtrOB.style.border=l.pointerBorderWidth+"px solid "+l.pointerBorderColor,e.sldPtrOB.style.position="absolute",e.sldPtrOB.style.left=-(2*l.pointerBorderWidth+l.pointerThickness)+"px",e.sldPtrOB.style.top="0",e.sldPtrMB.style.border=l.pointerThickness+"px solid "+l.pointerColor,e.sldPtrS.style.width=l.sliderSize+"px",e.sldPtrS.style.height=p+"px",e.btn.style.display=l.closable?"block":"none",e.btn.style.position="absolute",e.btn.style.left=l.padding+"px",e.btn.style.bottom=l.padding+"px",e.btn.style.padding="0 15px",e.btn.style.height=l.buttonHeight+"px",e.btn.style.border=l.insetWidth+"px solid",function(){var t=l.insetColor.split(/\s+/),n=t.length<2?t[0]:t[1]+" "+t[0]+" "+t[0]+" "+t[1];e.btn.style.borderColor=n}(),e.btn.style.color=l.buttonColor,e.btn.style.font="12px sans-serif",e.btn.style.textAlign="center";try{e.btn.style.cursor="pointer"}catch(t){e.btn.style.cursor="hand"}e.btn.onmousedown=function(){l.hide()},e.btnT.style.lineHeight=l.buttonHeight+"px",e.btnT.innerHTML="",e.btnT.appendChild(document.createTextNode(l.closeText)),i(),a(),r.picker.owner&&r.picker.owner!==l&&r.unsetClass(r.picker.owner.targetElement,l.activeClass),r.picker.owner=l,r.isElementType(f,"body")?r.redrawPosition():r._drawPosition(l,0,0,"relative",!1),e.wrap.parentNode!=f&&f.appendChild(e.wrap),r.setClass(l.targetElement,l.activeClass)}function i(){switch(r.getPadYComponent(l)){case"s":var e=1;break;case"v":e=2}var t=Math.round(l.hsv[0]/360*(l.width-1)),o=Math.round((1-l.hsv[e]/100)*(l.height-1)),i=2*l.pointerBorderWidth+l.pointerThickness+2*l.crossSize,a=-Math.floor(i/2);switch(r.picker.cross.style.left=t+a+"px",r.picker.cross.style.top=o+a+"px",r.getSliderComponent(l)){case"s":var s=n(l.hsv[0],100,l.hsv[2]),c=n(l.hsv[0],0,l.hsv[2]),u="rgb("+Math.round(s[0])+","+Math.round(s[1])+","+Math.round(s[2])+")",d="rgb("+Math.round(c[0])+","+Math.round(c[1])+","+Math.round(c[2])+")";r.picker.sldGrad.draw(l.sliderSize,l.height,u,d);break;case"v":var f=n(l.hsv[0],l.hsv[1],100);u="rgb("+Math.round(f[0])+","+Math.round(f[1])+","+Math.round(f[2])+")",d="#000",r.picker.sldGrad.draw(l.sliderSize,l.height,u,d)}}function a(){var e=r.getSliderComponent(l);if(e){switch(e){case"s":var t=1;break;case"v":t=2}var n=Math.round((1-l.hsv[t]/100)*(l.height-1));r.picker.sldPtrOB.style.top=n-(2*l.pointerBorderWidth+l.pointerThickness)-Math.floor(p/2)+"px"}}function s(){return r.picker&&r.picker.owner===l}for(var c in this.value=null,this.valueElement=e,this.styleElement=e,this.required=!0,this.refine=!0,this.hash=!1,this.uppercase=!0,this.onFineChange=null,this.activeClass="jscolor-active",this.minS=0,this.maxS=100,this.minV=0,this.maxV=100,this.hsv=[0,0,100],this.rgb=[255,255,255],this.width=181,this.height=101,this.showOnClick=!0,this.mode="HSV",this.position="bottom",this.smartPosition=!0,this.sliderSize=16,this.crossSize=8,this.closable=!1,this.closeText="Close",this.buttonColor="#000000",this.buttonHeight=18,this.padding=12,this.backgroundColor="#FFFFFF",this.borderWidth=1,this.borderColor="#BBBBBB",this.borderRadius=8,this.insetWidth=1,this.insetColor="#BBBBBB",this.shadow=!0,this.shadowBlur=15,this.shadowColor="rgba(0,0,0,0.2)",this.pointerColor="#4C4C4C",this.pointerBorderColor="#FFFFFF",this.pointerBorderWidth=1,this.pointerThickness=2,this.zIndex=1e3,this.container=null,t)t.hasOwnProperty(c)&&(this[c]=t[c]);if(this.hide=function(){s()&&(r.unsetClass(l.targetElement,l.activeClass),r.picker.wrap.parentNode.removeChild(r.picker.wrap),delete r.picker.owner)},this.show=function(){o()},this.redraw=function(){s()&&o()},this.importColor=function(){this.valueElement&&r.isElementType(this.valueElement,"input")?this.refine?!this.required&&/^\s*$/.test(this.valueElement.value)?(this.valueElement.value="",this.styleElement&&(this.styleElement.style.backgroundImage=this.styleElement._jscOrigStyle.backgroundImage,this.styleElement.style.backgroundColor=this.styleElement._jscOrigStyle.backgroundColor,this.styleElement.style.color=this.styleElement._jscOrigStyle.color),this.exportColor(r.leaveValue|r.leaveStyle)):this.fromString(this.valueElement.value)||this.exportColor():this.fromString(this.valueElement.value,r.leaveValue)||(this.styleElement&&(this.styleElement.style.backgroundImage=this.styleElement._jscOrigStyle.backgroundImage,this.styleElement.style.backgroundColor=this.styleElement._jscOrigStyle.backgroundColor,this.styleElement.style.color=this.styleElement._jscOrigStyle.color),this.exportColor(r.leaveValue|r.leaveStyle)):this.exportColor()},this.exportColor=function(e){if(!(e&r.leaveValue)&&this.valueElement){var t=this.toString();this.uppercase&&(t=t.toUpperCase()),this.hash&&(t="#"+t),r.isElementType(this.valueElement,"input")?this.valueElement.value=t:this.valueElement.innerHTML=t}e&r.leaveStyle||this.styleElement&&(this.styleElement.style.backgroundImage="none",this.styleElement.style.backgroundColor="#"+this.toString(),this.styleElement.style.color=this.isLight()?"#000":"#FFF"),!(e&r.leavePad)&&s()&&i(),!(e&r.leaveSld)&&s()&&a()},this.fromHSV=function(e,t,r,o){if(null!==e){if(isNaN(e))return!1;e=Math.max(0,Math.min(360,e))}if(null!==t){if(isNaN(t))return!1;t=Math.max(0,Math.min(100,this.maxS,t),this.minS)}if(null!==r){if(isNaN(r))return!1;r=Math.max(0,Math.min(100,this.maxV,r),this.minV)}this.rgb=n(null===e?this.hsv[0]:this.hsv[0]=e,null===t?this.hsv[1]:this.hsv[1]=t,null===r?this.hsv[2]:this.hsv[2]=r),this.exportColor(o)},this.fromRGB=function(e,t,r,o){if(null!==e){if(isNaN(e))return!1;e=Math.max(0,Math.min(255,e))}if(null!==t){if(isNaN(t))return!1;t=Math.max(0,Math.min(255,t))}if(null!==r){if(isNaN(r))return!1;r=Math.max(0,Math.min(255,r))}var i=function(e,t,n){e/=255,t/=255,n/=255;var r=Math.min(Math.min(e,t),n),o=Math.max(Math.max(e,t),n),i=o-r;if(0===i)return[null,0,100*o];var a=e===r?3+(n-t)/i:t===r?5+(e-n)/i:1+(t-e)/i;return[60*(6===a?0:a),i/o*100,100*o]}(null===e?this.rgb[0]:e,null===t?this.rgb[1]:t,null===r?this.rgb[2]:r);null!==i[0]&&(this.hsv[0]=Math.max(0,Math.min(360,i[0]))),0!==i[2]&&(this.hsv[1]=null===i[1]?null:Math.max(0,this.minS,Math.min(100,this.maxS,i[1]))),this.hsv[2]=null===i[2]?null:Math.max(0,this.minV,Math.min(100,this.maxV,i[2]));var a=n(this.hsv[0],this.hsv[1],this.hsv[2]);this.rgb[0]=a[0],this.rgb[1]=a[1],this.rgb[2]=a[2],this.exportColor(o)},this.fromString=function(e,t){var n;if(n=e.match(/^\W*([0-9A-F]{3}([0-9A-F]{3})?)\W*$/i))return 6===n[1].length?this.fromRGB(parseInt(n[1].substr(0,2),16),parseInt(n[1].substr(2,2),16),parseInt(n[1].substr(4,2),16),t):this.fromRGB(parseInt(n[1].charAt(0)+n[1].charAt(0),16),parseInt(n[1].charAt(1)+n[1].charAt(1),16),parseInt(n[1].charAt(2)+n[1].charAt(2),16),t),!0;if(n=e.match(/^\W*rgba?\(([^)]*)\)\W*$/i)){var r,o,i,a=n[1].split(","),s=/^\s*(\d*)(\.\d+)?\s*$/;if(a.length>=3&&(r=a[0].match(s))&&(o=a[1].match(s))&&(i=a[2].match(s))){var c=parseFloat((r[1]||"0")+(r[2]||"")),u=parseFloat((o[1]||"0")+(o[2]||"")),d=parseFloat((i[1]||"0")+(i[2]||""));return this.fromRGB(c,u,d,t),!0}}return!1},this.toString=function(){return(256|Math.round(this.rgb[0])).toString(16).substr(1)+(256|Math.round(this.rgb[1])).toString(16).substr(1)+(256|Math.round(this.rgb[2])).toString(16).substr(1)},this.toHEXString=function(){return"#"+this.toString().toUpperCase()},this.toRGBString=function(){return"rgb("+Math.round(this.rgb[0])+","+Math.round(this.rgb[1])+","+Math.round(this.rgb[2])+")"},this.isLight=function(){return.213*this.rgb[0]+.715*this.rgb[1]+.072*this.rgb[2]>127.5},this._processParentElementsInDOM=function(){if(!this._linkedElementsProcessed){this._linkedElementsProcessed=!0;var e=this.targetElement;do{var t=r.getStyle(e);t&&"fixed"===t.position.toLowerCase()&&(this.fixed=!0),e!==this.targetElement&&(e._jscEventsAttached||(r.attachEvent(e,"scroll",r.onParentScroll),e._jscEventsAttached=!0))}while((e=e.parentNode)&&!r.isElementType(e,"body"))}},"string"==typeof e){var u=e,d=document.getElementById(u);d?this.targetElement=d:r.warn("Could not find target element with ID '"+u+"'")}else e?this.targetElement=e:r.warn("Invalid target element: '"+e+"'");if(this.targetElement._jscLinkedInstance)r.warn("Cannot link jscolor twice to the same element. Skipping.");else{this.targetElement._jscLinkedInstance=this,this.valueElement=r.fetchElement(this.valueElement),this.styleElement=r.fetchElement(this.styleElement);var l=this,f=this.container?r.fetchElement(this.container):document.getElementsByTagName("body")[0],p=3;if(r.isElementType(this.targetElement,"button"))if(this.targetElement.onclick){var m=this.targetElement.onclick;this.targetElement.onclick=function(e){return m.call(this,e),!1}}else this.targetElement.onclick=function(){return!1};if(this.valueElement&&r.isElementType(this.valueElement,"input")){var h=function(){l.fromString(l.valueElement.value,r.leaveValue),r.dispatchFineChange(l)};r.attachEvent(this.valueElement,"keyup",h),r.attachEvent(this.valueElement,"input",h),r.attachEvent(this.valueElement,"blur",(function(){l.importColor()})),this.valueElement.setAttribute("autocomplete","off")}this.styleElement&&(this.styleElement._jscOrigStyle={backgroundImage:this.styleElement.style.backgroundImage,backgroundColor:this.styleElement.style.backgroundColor,color:this.styleElement.style.color}),this.value?this.fromString(this.value)||this.exportColor():this.importColor()}}}).jscolor.lookupClass="jscolor",r.jscolor.installByClassName=function(e){var t=document.getElementsByTagName("input"),n=document.getElementsByTagName("button");r.tryInstallOnElements(t,e),r.tryInstallOnElements(n,e)},r.register(),r.jscolor))},function(e,t,n){"use strict";var r=n(30),o=n(82),i=n(145),a=n(73);function s(e){var t=new i(e),n=o(i.prototype.request,t);return r.extend(n,i.prototype,t),r.extend(n,t),n}var c=s(a);c.Axios=i,c.create=function(e){return s(r.merge(a,e))},c.Cancel=n(86),c.CancelToken=n(158),c.isCancel=n(85),c.all=function(e){return Promise.all(e)},c.spread=n(159),e.exports=c,e.exports.default=c},function(e,t){e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},function(e,t,n){"use strict";var r=n(73),o=n(30),i=n(153),a=n(154);function s(e){this.defaults=e,this.interceptors={request:new i,response:new i}}s.prototype.request=function(e){"string"==typeof e&&(e=o.merge({url:arguments[0]},arguments[1])),(e=o.merge(r,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[a,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)n=n.then(t.shift(),t.shift());return n},o.forEach(["delete","get","head","options"],(function(e){s.prototype[e]=function(t,n){return this.request(o.merge(n||{},{method:e,url:t}))}})),o.forEach(["post","put","patch"],(function(e){s.prototype[e]=function(t,n,r){return this.request(o.merge(r||{},{method:e,url:t,data:n}))}})),e.exports=s},function(e,t,n){"use strict";var r=n(30);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},function(e,t,n){"use strict";var r=n(84);e.exports=function(e,t,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e}},function(e,t,n){"use strict";var r=n(30);function o(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var i;if(n)i=n(t);else if(r.isURLSearchParams(t))i=t.toString();else{var a=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),a.push(o(t)+"="+o(e))})))})),i=a.join("&")}return i&&(e+=(-1===e.indexOf("?")?"?":"&")+i),e}},function(e,t,n){"use strict";var r=n(30),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,i,a={};return e?(r.forEach(e.split("\n"),(function(e){if(i=e.indexOf(":"),t=r.trim(e.substr(0,i)).toLowerCase(),n=r.trim(e.substr(i+1)),t){if(a[t]&&o.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([n]):a[t]?a[t]+", "+n:n}})),a):a}},function(e,t,n){"use strict";var r=n(30);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function o(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=o(window.location.href),function(t){var n=r.isString(t)?o(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var r=n(30);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,o,i,a){var s=[];s.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(o)&&s.push("path="+o),r.isString(i)&&s.push("domain="+i),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";var r=n(30);function o(){this.handlers=[]}o.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=o},function(e,t,n){"use strict";var r=n(30),o=n(155),i=n(85),a=n(73),s=n(156),c=n(157);function u(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return u(e),e.baseURL&&!s(e.url)&&(e.url=c(e.baseURL,e.url)),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return u(e),t.data=o(t.data,t.headers,e.transformResponse),t}),(function(t){return i(t)||(u(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,n){"use strict";var r=n(30);e.exports=function(e,t,n){return r.forEach(n,(function(n){e=n(e,t)})),e}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var r=n(86);function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var e;return{token:new o((function(t){e=t})),cancel:e}},e.exports=o},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){var r=function(e){"use strict";var t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var o=t&&t.prototype instanceof l?t:l,i=Object.create(o.prototype),a=new k(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return E()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=b(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=u(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(e,n,a),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function l(){}function f(){}function p(){}var m={};m[o]=function(){return this};var h=Object.getPrototypeOf,_=h&&h(h(C([])));_&&_!==t&&n.call(_,o)&&(m=_);var g=p.prototype=l.prototype=Object.create(m);function v(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function y(e,t){var r;this._invoke=function(o,i){function a(){return new t((function(r,a){!function r(o,i,a,s){var c=u(e[o],e,i);if("throw"!==c.type){var d=c.arg,l=d.value;return l&&"object"==typeof l&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(l).then((function(e){d.value=e,a(d)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}(o,i,r,a)}))}return r=r?r.then(a,a):a()}}function b(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,d;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function C(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:E}}function E(){return{value:void 0,done:!0}}return f.prototype=g.constructor=p,p.constructor=f,f.displayName=s(p,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,s(e,a,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},v(y.prototype),y.prototype[i]=function(){return this},e.AsyncIterator=y,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new y(c(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(g),s(g,a,"Generator"),g[o]=function(){return this},g.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=C,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;S(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:C(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},function(e,t,n){var r,o,i=n(87),a=n(88),s=0,c=0;e.exports=function(e,t,n){var u=t&&n||0,d=t||[],l=(e=e||{}).node||r,f=void 0!==e.clockseq?e.clockseq:o;if(null==l||null==f){var p=i();null==l&&(l=r=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==f&&(f=o=16383&(p[6]<<8|p[7]))}var m=void 0!==e.msecs?e.msecs:(new Date).getTime(),h=void 0!==e.nsecs?e.nsecs:c+1,_=m-s+(h-c)/1e4;if(_<0&&void 0===e.clockseq&&(f=f+1&16383),(_<0||m>s)&&void 0===e.nsecs&&(h=0),h>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=m,c=h,o=f;var g=(1e4*(268435455&(m+=122192928e5))+h)%4294967296;d[u++]=g>>>24&255,d[u++]=g>>>16&255,d[u++]=g>>>8&255,d[u++]=255&g;var v=m/4294967296*1e4&268435455;d[u++]=v>>>8&255,d[u++]=255&v,d[u++]=v>>>24&15|16,d[u++]=v>>>16&255,d[u++]=f>>>8|128,d[u++]=255&f;for(var y=0;y<6;++y)d[u+y]=l[y];return t||a(d)}},function(e,t,n){var r=n(87),o=n(88);e.exports=function(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[i+s]=a[s];return t||o(a)}},function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=163},function(e,t,n){var r=n(89),o=n(56)("socket.io-client:url");e.exports=function(e,t){var n=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host);"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),o("parse %s",e),n=r(e));n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443"));n.path=n.path||"/";var i=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port,n.href=n.protocol+"://"+i+(t&&t.port===n.port?"":":"+n.port),n}},function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,o=+new Date,i=o-(n||o);e.diff=i,e.prev=n,e.curr=o,n=o;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var c=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;c++;var o=t.formatters[r];if("function"==typeof o){var i=a[c];n=o.call(e,i),a.splice(c,1),c--}return n})),t.formatArgs.call(e,a);var u=r.log||t.log||console.log.bind(console);u.apply(e,a)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=o,"function"==typeof t.init&&t.init(r),t.instances.push(r),r}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var i=t.instances[n];i.enabled=t.enabled(i.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(90),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t,n){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){var r=n(91),o=n(92),i=Object.prototype.toString,a="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===i.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===i.call(File);t.deconstructPacket=function(e){var t=[],n=e.data,i=e;return i.data=function e(t,n){if(!t)return t;if(o(t)){var i={_placeholder:!0,num:n.length};return n.push(t),i}if(r(t)){for(var a=new Array(t.length),s=0;s<t.length;s++)a[s]=e(t[s],n);return a}if("object"==typeof t&&!(t instanceof Date)){a={};for(var c in t)a[c]=e(t[c],n);return a}return t}(n,t),i.attachments=t.length,{packet:i,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function e(t,n){if(!t)return t;if(t&&t._placeholder)return n[t.num];if(r(t))for(var o=0;o<t.length;o++)t[o]=e(t[o],n);else if("object"==typeof t)for(var i in t)t[i]=e(t[i],n);return t}(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var n=0,i=e;!function e(c,u,d){if(!c)return c;if(a&&c instanceof Blob||s&&c instanceof File){n++;var l=new FileReader;l.onload=function(){d?d[u]=this.result:i=this.result,--n||t(i)},l.readAsArrayBuffer(c)}else if(r(c))for(var f=0;f<c.length;f++)e(c[f],f,c);else if("object"==typeof c&&!o(c))for(var p in c)e(c[p],p,c)}(i),n||t(i)}},function(e,t,n){"use strict";t.byteLength=function(e){var t=u(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=u(e),a=r[0],s=r[1],c=new i(function(e,t,n){return 3*(t+n)/4-n}(0,a,s)),d=0,l=s>0?a-4:a;for(n=0;n<l;n+=4)t=o[e.charCodeAt(n)]<<18|o[e.charCodeAt(n+1)]<<12|o[e.charCodeAt(n+2)]<<6|o[e.charCodeAt(n+3)],c[d++]=t>>16&255,c[d++]=t>>8&255,c[d++]=255&t;2===s&&(t=o[e.charCodeAt(n)]<<2|o[e.charCodeAt(n+1)]>>4,c[d++]=255&t);1===s&&(t=o[e.charCodeAt(n)]<<10|o[e.charCodeAt(n+1)]<<4|o[e.charCodeAt(n+2)]>>2,c[d++]=t>>8&255,c[d++]=255&t);return c},t.fromByteArray=function(e){for(var t,n=e.length,o=n%3,i=[],a=0,s=n-o;a<s;a+=16383)i.push(d(e,a,a+16383>s?s:a+16383));1===o?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===o&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return i.join("")};for(var r=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=a.length;s<c;++s)r[s]=a[s],o[a.charCodeAt(s)]=s;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function d(e,t,n){for(var o,i,a=[],s=t;s<n;s+=3)o=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return a.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,o){var i,a,s=8*o-r-1,c=(1<<s)-1,u=c>>1,d=-7,l=n?o-1:0,f=n?-1:1,p=e[t+l];for(l+=f,i=p&(1<<-d)-1,p>>=-d,d+=s;d>0;i=256*i+e[t+l],l+=f,d-=8);for(a=i&(1<<-d)-1,i>>=-d,d+=r;d>0;a=256*a+e[t+l],l+=f,d-=8);if(0===i)i=1-u;else{if(i===c)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),i-=u}return(p?-1:1)*a*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var a,s,c,u=8*i-o-1,d=(1<<u)-1,l=d>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,m=r?1:-1,h=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=d):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+l>=1?f/c:f*Math.pow(2,1-l))*c>=2&&(a++,c/=2),a+l>=d?(s=0,a=d):a+l>=1?(s=(t*c-1)*Math.pow(2,o),a+=l):(s=t*Math.pow(2,l-1)*Math.pow(2,o),a=0));o>=8;e[n+p]=255&s,p+=m,s/=256,o-=8);for(a=a<<o|s,u+=o;u>0;e[n+p]=255&a,p+=m,a/=256,u-=8);e[n+p-m]|=128*h}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){e.exports=n(172),e.exports.parser=n(50)},function(e,t,n){var r=n(94),o=n(57),i=n(64)("engine.io-client:socket"),a=n(98),s=n(50),c=n(89),u=n(62);function d(e,t){if(!(this instanceof d))return new d(e,t);t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=c(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=c(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=u.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}e.exports=d,d.priorWebsocketSuccess=!1,o(d.prototype),d.protocol=s.protocol,d.Socket=d,d.Transport=n(78),d.transports=n(94),d.parser=n(50),d.prototype.createTransport=function(e){i('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=s.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new r[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},d.prototype.open=function(){var e;if(this.rememberUpgrade&&d.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout((function(){t.emit("error","No transports available")}),0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},d.prototype.setTransport=function(e){i("setting transport %s",e.name);var t=this;this.transport&&(i("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",(function(){t.onDrain()})).on("packet",(function(e){t.onPacket(e)})).on("error",(function(e){t.onError(e)})).on("close",(function(){t.onClose("transport close")}))},d.prototype.probe=function(e){i('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,r=this;function o(){if(r.onlyBinaryUpgrades){var o=!this.supportsBinary&&r.transport.supportsBinary;n=n||o}n||(i('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",(function(o){if(!n)if("pong"===o.type&&"probe"===o.data){if(i('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t),!t)return;d.priorWebsocketSuccess="websocket"===t.name,i('pausing current transport "%s"',r.transport.name),r.transport.pause((function(){n||"closed"!==r.readyState&&(i("changing transport and sending upgrade packet"),f(),r.setTransport(t),t.send([{type:"upgrade"}]),r.emit("upgrade",t),t=null,r.upgrading=!1,r.flush())}))}else{i('probe transport "%s" failed',e);var a=new Error("probe error");a.transport=t.name,r.emit("upgradeError",a)}})))}function a(){n||(n=!0,f(),t.close(),t=null)}function s(n){var o=new Error("probe error: "+n);o.transport=t.name,a(),i('probe transport "%s" failed because of error: %s',e,n),r.emit("upgradeError",o)}function c(){s("transport closed")}function u(){s("socket closed")}function l(e){t&&e.name!==t.name&&(i('"%s" works - aborting "%s"',e.name,t.name),a())}function f(){t.removeListener("open",o),t.removeListener("error",s),t.removeListener("close",c),r.removeListener("close",u),r.removeListener("upgrading",l)}d.priorWebsocketSuccess=!1,t.once("open",o),t.once("error",s),t.once("close",c),this.once("close",u),this.once("upgrading",l),t.open()},d.prototype.onOpen=function(){if(i("socket open"),this.readyState="open",d.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){i("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},d.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(i('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else i('packet received with socket readyState "%s"',this.readyState)},d.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},d.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout((function(){"closed"!==t.readyState&&t.onClose("ping timeout")}),e||t.pingInterval+t.pingTimeout)},d.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout((function(){i("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)}),e.pingInterval)},d.prototype.ping=function(){var e=this;this.sendPacket("ping",(function(){e.emit("ping")}))},d.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},d.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(i("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},d.prototype.write=d.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},d.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var o={type:e,data:t,options:n};this.emit("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}},d.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?r():t()})):this.upgrading?r():t()}function t(){e.onClose("forced close"),i("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}return this},d.prototype.onError=function(e){i("socket error %j",e),d.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},d.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){i('socket close with reason: "%s"',e);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}},d.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~a(this.transports,e[n])&&t.push(e[n]);return t}},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t,n){var r=n(77),o=n(95),i=n(57),a=n(63),s=n(64)("engine.io-client:polling-xhr");function c(){}function u(e){if(o.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location){var t="https:"===location.protocol,n=location.port;n||(n=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}}function d(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}if(e.exports=u,e.exports.Request=d,a(u,o),u.prototype.supportsBinary=!0,u.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new d(e)},u.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),o=this;r.on("success",t),r.on("error",(function(e){o.onError("xhr post error",e)})),this.sendXhr=r},u.prototype.doPoll=function(){s("xhr poll");var e=this.request(),t=this;e.on("data",(function(e){t.onData(e)})),e.on("error",(function(e){t.onError("xhr poll error",e)})),this.pollXhr=e},i(d.prototype),d.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new r(e),n=this;try{s("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var o in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&t.setRequestHeader(o,this.extraHeaders[o])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=!0),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");n.supportsBinary&&"application/octet-stream"===e&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout((function(){n.onError(t.status)}),0))},s("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout((function(){n.onError(e)}),0)}"undefined"!=typeof document&&(this.index=d.requestsCount++,d.requests[this.index]=this)},d.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},d.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},d.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},d.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=c:this.xhr.onreadystatechange=c,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete d.requests[this.index],this.xhr=null}},d.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e="application/octet-stream"===t&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},d.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},d.prototype.abort=function(){this.cleanup()},d.requestsCount=0,d.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",f);else if("function"==typeof addEventListener){var l="onpagehide"in self?"pagehide":"unload";addEventListener(l,f,!1)}function f(){for(var e in d.requests)d.requests.hasOwnProperty(e)&&d.requests[e].abort()}},function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){e.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var o=new Uint8Array(e),i=new Uint8Array(n-t),a=t,s=0;a<n;a++,s++)i[s]=o[a];return i.buffer}},function(e,t){function n(){}e.exports=function(e,t,r){var o=!1;return r=r||n,i.count=e,0===e?t():i;function i(e,n){if(i.count<=0)throw new Error("after called too many times");--i.count,e?(o=!0,t(e),t=r):0!==i.count||o||t(null,n)}}},function(e,t){var n,r,o,i=String.fromCharCode;function a(e){for(var t,n,r=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function s(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function c(e,t){return i(e>>t&63|128)}function u(e,t){if(0==(4294967168&e))return i(e);var n="";return 0==(4294965248&e)?n=i(e>>6&31|192):0==(4294901760&e)?(s(e,t)||(e=65533),n=i(e>>12&15|224),n+=c(e,6)):0==(4292870144&e)&&(n=i(e>>18&7|240),n+=c(e,12),n+=c(e,6)),n+=i(63&e|128)}function d(){if(o>=r)throw Error("Invalid byte index");var e=255&n[o];if(o++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function l(e){var t,i;if(o>r)throw Error("Invalid byte index");if(o==r)return!1;if(t=255&n[o],o++,0==(128&t))return t;if(192==(224&t)){if((i=(31&t)<<6|d())>=128)return i;throw Error("Invalid continuation byte")}if(224==(240&t)){if((i=(15&t)<<12|d()<<6|d())>=2048)return s(i,e)?i:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(i=(7&t)<<18|d()<<12|d()<<6|d())>=65536&&i<=1114111)return i;throw Error("Invalid UTF-8 detected")}e.exports={version:"2.1.2",encode:function(e,t){for(var n=!1!==(t=t||{}).strict,r=a(e),o=r.length,i=-1,s="";++i<o;)s+=u(r[i],n);return s},decode:function(e,t){var s=!1!==(t=t||{}).strict;n=a(e),r=n.length,o=0;for(var c,u=[];!1!==(c=l(s));)u.push(c);return function(e){for(var t,n=e.length,r=-1,o="";++r<n;)(t=e[r])>65535&&(o+=i((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=i(t);return o}(u)}}},function(e,t){!function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),r=0;r<e.length;r++)n[e.charCodeAt(r)]=r;t.encode=function(t){var n,r=new Uint8Array(t),o=r.length,i="";for(n=0;n<o;n+=3)i+=e[r[n]>>2],i+=e[(3&r[n])<<4|r[n+1]>>4],i+=e[(15&r[n+1])<<2|r[n+2]>>6],i+=e[63&r[n+2]];return o%3==2?i=i.substring(0,i.length-1)+"=":o%3==1&&(i=i.substring(0,i.length-2)+"=="),i},t.decode=function(e){var t,r,o,i,a,s=.75*e.length,c=e.length,u=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var d=new ArrayBuffer(s),l=new Uint8Array(d);for(t=0;t<c;t+=4)r=n[e.charCodeAt(t)],o=n[e.charCodeAt(t+1)],i=n[e.charCodeAt(t+2)],a=n[e.charCodeAt(t+3)],l[u++]=r<<2|o>>4,l[u++]=(15&o)<<4|i>>2,l[u++]=(3&i)<<6|63&a;return d}}()},function(e,t){var n=void 0!==n?n:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,r=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),o=r&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),i=n&&n.prototype.append&&n.prototype.getBlob;function a(e){return e.map((function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var n=new Uint8Array(e.byteLength);n.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=n.buffer}return t}return e}))}function s(e,t){t=t||{};var r=new n;return a(e).forEach((function(e){r.append(e)})),t.type?r.getBlob(t.type):r.getBlob()}function c(e,t){return new Blob(a(e),t||{})}"undefined"!=typeof Blob&&(s.prototype=Blob.prototype,c.prototype=Blob.prototype),e.exports=r?o?Blob:c:i?s:void 0},function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,o=+new Date,i=o-(n||o);e.diff=i,e.prev=n,e.curr=o,n=o;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var c=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;c++;var o=t.formatters[r];if("function"==typeof o){var i=a[c];n=o.call(e,i),a.splice(c,1),c--}return n})),t.formatArgs.call(e,a);var u=r.log||t.log||console.log.bind(console);u.apply(e,a)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=o,"function"==typeof t.init&&t.init(r),t.instances.push(r),r}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var i=t.instances[n];i.enabled=t.enabled(i.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(90),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t,n){(function(t){var r=n(95),o=n(63);e.exports=d;var i,a=/\n/g,s=/\\n/g;function c(){}function u(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{}}function d(e){if(r.call(this,e),this.query=this.query||{},!i){var t=u();i=t.___eio=t.___eio||[]}this.index=i.length;var n=this;i.push((function(e){n.onData(e)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){n.script&&(n.script.onerror=c)}),!1)}o(d,r),d.prototype.supportsBinary=!1,d.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},d.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)}),100)},d.prototype.doWrite=function(e,t){var n=this;if(!this.form){var r,o=document.createElement("form"),i=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=c,o.method="POST",o.setAttribute("accept-charset","utf-8"),i.name="d",o.appendChild(i),document.body.appendChild(o),this.form=o,this.area=i}function u(){d(),t()}function d(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(e)}catch(e){(r=document.createElement("iframe")).name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),d(),e=e.replace(s,"\\\n"),this.area.value=e.replace(a,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&u()}:this.iframe.onload=u}}).call(this,n(61))},function(e,t,n){(function(t){var r,o,i=n(78),a=n(50),s=n(62),c=n(63),u=n(97),d=n(64)("engine.io-client:websocket");if("undefined"!=typeof WebSocket)r=WebSocket;else if("undefined"!=typeof self)r=self.WebSocket||self.MozWebSocket;else try{o=n(185)}catch(e){}var l=r||o;function f(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=r&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(l=o),i.call(this,e)}e.exports=f,c(f,i),f.prototype.name="websocket",f.prototype.supportsBinary=!0,f.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new l(e,t):new l(e):new l(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},f.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},f.prototype.write=function(e){var n=this;this.writable=!1;for(var r=e.length,o=0,i=r;o<i;o++)!function(e){a.encodePacket(e,n.supportsBinary,(function(o){if(!n.usingBrowserWebSocket){var i={};if(e.options&&(i.compress=e.options.compress),n.perMessageDeflate)("string"==typeof o?t.byteLength(o):o.length)<n.perMessageDeflate.threshold&&(i.compress=!1)}try{n.usingBrowserWebSocket?n.ws.send(o):n.ws.send(o,i)}catch(e){d("websocket closed before onclose event")}--r||s()}))}(e[o]);function s(){n.emit("flush"),setTimeout((function(){n.writable=!0,n.emit("drain")}),0)}},f.prototype.onClose=function(){i.prototype.onClose.call(this)},f.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},f.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=u()),this.supportsBinary||(e.b64=1),(e=s.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},f.prototype.check=function(){return!(!l||"__initialize"in l&&this.name===f.prototype.name)}}).call(this,n(76).Buffer)},function(e,t){},function(e,t){e.exports=function(e,t){for(var n=[],r=(t=t||0)||0;r<e.length;r++)n[r-t]=e[r];return n}},function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,n){"use strict";n.r(t);var r=n(0);function o(){$("body").html("<h6 style='margin-top: 10px; text-align: center; direction: rtl; color: red'>الرجاء حذف هذه الإضافة من المتصفح - User-Agent Switcher</h6>")}Object(r.a)("chrome-extension://djflhoibgkdhkhhcedjiklpkjnoahfmg/jquery.js",(function(e){"200"==e&&o()})),Object(r.a)("chrome-extension://kchfmpdcejfkipopnolndinkeoipnoia/jquery.js",(function(e){"200"==e&&o()}))},function(e,t,n){"use strict";n.r(t);var r=n(0);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t}var t,n,r;return t=e,r=[{key:"getIcon",value:function(e){return e.getState().settings.default_avatar?"/uploads/avatars/"+e.getState().settings.default_avatar:"/images/none.png"}},{key:"render",value:function(t){var n=t.getState().settings.chat_name?t.getState().settings.chat_name:"",r="<h1 id='login-header' class='border-color label label-primary'>";return r+="<a class='label label-primary login-header__label' href='/'>",r+="<img src='"+e.getIcon(t)+"' width='28' height='30' />",r+="<span class='login-header__title'>"+n+"</span>",r+="<button class='btn fr btn-success fa fa-refresh login-header__refresh'></button>",r+="</a>",r+="</h1>"}}],(n=null)&&o(t.prototype,n),r&&o(t,r),e}();function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"getSrc",value:function(e){return e.getState().settings.banner_img?"/uploads/"+e.getState().settings.banner_img:"/images/banner.gif"}},{key:"render",value:function(t){var n="<div id='login-banner' class='rainbow'>";return n+="<img onerror='this.remove()' src='"+e.getSrc(t)+"' alt='banner' class='login-banner__img' />",n+="</div>"}}],(n=null)&&a(t.prototype,n),r&&a(t,r),e}();function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"render",value:function(e){var t="<div id='login-btn-holder'>";return t+="<a href='/subs' class='login-btn-holder__btn fa fa-star-half-o btn btn-primary'> الإشتراكات </a>",t+="<a href='/rules' class='login-btn-holder__btn fa fa-ticket btn btn-primary'> القوانين </a>",t+="<a href='"+e.getState().settings.app_url+"' class='login-btn-holder__btn fa fa-android btn btn-primary'> التطبيق </a>",t+="<a href='/' class='login-btn-holder__btn fa fa-phone btn btn-primary'> إتصل بنا </a>",t+="</div>"}}],(n=null)&&c(t.prototype,n),r&&c(t,r),e}(),d=n(11),l=function(e,t,n){return{type:"HANDLE_USER_CHANGE_ROOM",userId:e,oldRoomId:t,newRoomId:n}},f=function(e,t){return{type:"ADD_ROOM_MIC",roomId:e,micId:t}},p=function(e,t){return{type:"REMOVE_ROOM_MIC",roomId:e,micId:t}},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"SET_GIFTS",gifts:e}},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"SET_FACES",faces:e}},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"SET_GRANTED_SETTINGS",settings:e}},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"heart";return{type:"SET_FLOATING_PARTICLES",particleType:e}},v=n(65),y=n(66),b=n(69),w=n(68),S=n(31),k=n(34),C=n(15),E=n(35),T=n(6),O=n(22),P=n(70),A=n(36),R=n(39),M=n(14),x=n(7),U=n(1),I=n(5),D=n(21),j=n(24),B=n(9),L=n(4);function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var N=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"registerEvents",value:function(t){e.onClick(t),e.trustUser(t)}},{key:"onClick",value:function(e){$(".notification").unbind("click").on("click",(function(t){var n=$(this).closest(".notification").data("user-id");j.a.show(n,e)}))}},{key:"trustUser",value:function(e){$(".notification__message__body__trust_user").unbind("click").on("click",(function(t){var n=this;t.stopPropagation(),e.getState().socket.emit("req",Object(r.k)({type:"TRUST_USER",data:{id:$(this).data("user-id"),name:$(this).data("user-name"),decoration:$(this).data("user-decoration")}}),(function(t){if(t=Object(r.g)(t),$(n).closest(".popup").click(),"string"==typeof t)return alert(t);if(t&&t.message&&alert(t.message),!t.error){var o=$(n).data("user-id");e.dispatch(Object(L.c)(o)),$("button[data-user-id='"+o+"']").remove()}}))}))}},{key:"renderMessage",value:function(e,t){switch(e.type){case"like":return"<span>حصلت على إعجاب<span style='color: red' class='fa fa-heart'></span></span>";case"gift":return"<span>حصلت على هدية<img src='"+e.message+"' class='gifts_picker__contianer__img' alt=''/></span>";case"remove_gift":return"<span>تم سحب هديتك<img src='"+e.message+"' class='gifts_picker__contianer__img' alt=''/></span>";case"room_excpel":case"change_room":return"<p dir='rtl'>"+e.message+" <span>"+D.a.render(e.room,!0,t)+"</span></p>";case"post_comment_like":case"post_commented":return"<p dir='rtl'>"+e.message+" <span><p class='notification__message__body'>"+e.comment+"</p></span></p>";case"login_banned":var n="<p>"+e.data.name+" ---- "+e.data.decoration+"</p>";return n+="<p>"+e.data.role+"</p>",n+="<p>"+e.data.ip+" <img src='/images/flags/"+e.data.country.toLowerCase()+".png' /></p>",n+="<p dir='rtl'>"+e.data.device+"</p>",e.data.isGuest||e.data.is_trusted||(n+="<p style='text-align: center'><button data-user-name='"+e.data.name+"' data-user-decoration='"+e.data.decoration+"' data-user-id='"+e.data.user_id+"' class='notification__message__body__trust_user btn btn-success'>توثيق العضوية</button></p>"),n;case"world_filter_notification":return"<p dir='rtl'>"+e.word.word+" <span><p class='popup__message__body'>"+e.word.text+"</p></span></p>";case"photo_like":return;default:return"<span>"+B.a.render(e.message,t)+"</span>"}}},{key:"render",value:function(t,n){var o=t.user?t.user.id:"",i=t.id,a="<div data-id='"+t.id+"' data-user-id='"+o+"' class='notification'>";return a+="<p class='notification__title label label-primary'>"+t.title+"</p>",t.user&&(a+="<div class='notification__sender'>",a+="<img src='"+t.user.avatar+"' width='24' height='24' class='notification__sender__avatar' />",a+="<p class='notification__sender__name'>"+I.a.render(t.user)+"</p>",a+="</div>"),a+="<div class='notification__message'>",a+=e.renderMessage(t,n),a+="</div>",a+="<span class='notification__time fr time' data-time='"+i+"'>"+Object(r.y)(i)+"</span>",a+="</div>"}}],(n=null)&&F(t.prototype,n),o&&F(t,o),e}();function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var G=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"registerEvents",value:function(t){e.close(t)}},{key:"close",value:function(e){$(".chat__body__notifications-pane__back button").unbind("click").on("click",(function(t){e.dispatch(Object(x.a)("others")),U.a.togglePane(e)}))}},{key:"setNotifications",value:function(e){var t=$("#chat__body__notifications-pane .chat_pane__container");t.html(""),e.getState().popups.forEach((function(n){t.prepend(N.render(n,e))})),N.registerEvents(e)}},{key:"render",value:function(e){var t="<div id='chat__body__notifications-pane' class='chat_pane' style='background: "+Object(r.u)(e.getState().settings,!0)+"'>";return t+=M.a.render("الإشعارات"),t+="<p class='chat__body__notifications-pane__back'>",t+="<button class='btn btn-success fa fa-arrow-left'>عودة</button>",t+="</p>",t+="<div class='chat_pane__container border'></div>",t+="</div>"}}],(n=null)&&q(t.prototype,n),o&&q(t,o),e}();function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var W=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.toggle(t)}},{key:"toggle",value:function(t){$("#radio-container img").unbind("click").on("click",(function(n){$("#radio-stream").length?(e.stopRadio(),$("#radio-container .radio-container__off").removeClass("active"),$("#radio-container .radio-container__on").addClass("active")):(e.playRadio(t),$("#radio-container .radio-container__off").addClass("active"),$("#radio-container .radio-container__on").removeClass("active"))}))}},{key:"update",value:function(t){var n=$("#radio-container");n.find("#radio-stream").attr("src")!=t.getState().settings.radio_stream_url&&n.find("#radio-stream").attr("src",t.getState().settings.radio_stream_url);var r=t.getState().settings.radio_stream_off_img?"/uploads/"+t.getState().settings.radio_stream_off_img:"/images/radio_banner_off.jpeg";n.find(".radio-container__off").attr("src",r);var o=t.getState().settings.radio_stream_on_img?"/uploads/"+t.getState().settings.radio_stream_on_img:"/images/radio_banner_on.jpeg";n.find(".radio-container__on").attr("src",o),t.getState().settings.is_radio_stream_enabled?$("#radio-container").show():(e.stopRadio(),$("#radio-container .radio-container__off").removeClass("active"),$("#radio-container .radio-container__on").addClass("active"),$("#radio-container").hide()),e.toggle(t)}},{key:"playRadio",value:function(e){$("#radio-container").append('<audio id="radio-stream" src="'+e.getState().settings.radio_stream_url+'" width="0" height="0" />'),$("#radio-stream")[0].play()}},{key:"stopRadio",value:function(){$("#radio-stream")[0]&&$("#radio-stream")[0].remove()}},{key:"render",value:function(e){var t=e.getState().settings.is_radio_stream_enabled?"block":"none",n=e.getState().settings.radio_stream_on_img?"/uploads/"+e.getState().settings.radio_stream_on_img:"/images/radio_banner_on.jpeg",r="<div id='radio-container' style='display: "+t+"'>";return r+="<img class='radio-container__off' src='"+(e.getState().settings.radio_stream_off_img?"/uploads/"+e.getState().settings.radio_stream_off_img:"/images/radio_banner_off.jpeg")+"' alt=''/>",r+="<img class='radio-container__on active' src='"+n+"' alt=''/>",r+="</div>"}}],(n=null)&&V(t.prototype,n),r&&V(t,r),e}(),H=n(42);function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(t){e.close(t)}},{key:"close",value:function(e){window.livePane.find(".chat__body__live-pane__back button").unbind("click").on("click",(function(t){e.dispatch(Object(x.a)("others")),U.a.togglePane(e)}))}},{key:"render",value:function(e){var t="<div id='chat__body__live-pane' class='chat_pane' style='background: #FFFFFF'>";return t+=M.a.render("راديو / تلفزين"),t+="<p class='chat__body__live-pane__back' style='margin: 0;'>",t+="<button class='btn btn-success fa fa-arrow-left'>عودة</button>",t+="</p>",t+="<div class='chat_pane__container border'>",t+=W.render(e),t+="<div id='chat__body__live-pane__tv' class='fl'>",t+="<iframe src='"+H.a.parseURL(e.getState().settings.tv_box_url)+"' frameborder='0' allow='accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture' ></iframe>",t+="</div>",t+="</div>",t+="</div>"}}],(n=null)&&z(t.prototype,n),r&&z(t,r),e}(),J=n(37);function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var K=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"registerEvents",value:function(t){e.onFormSubmited(t)}},{key:"onFormSubmited",value:function(t){$("#bot_brb_modal__body__form").unbind("submit").on("submit",(function(n){n.preventDefault(),n.originalEvent.submitter.classList.contains("btn-success")?e.start(t,$(this)):n.originalEvent.submitter.classList.contains("btn-warning")?e.pause(t,$(this)):n.originalEvent.submitter.classList.contains("btn-danger")?e.stop(t,$(this)):n.originalEvent.submitter.classList.contains("btn-info")&&e.update(t,$(this))}))}},{key:"start",value:function(t,n){var o=n.find("input[name='num_rounds']").val(),i=n.find("input[name='bot_brb_modal__body__form__speed']").val(),a=n.find("input[name='bot_brb_modal__body__form__excpel']").prop("checked"),s={type:"BOT_BRB_CREATE",data:{room_id:t.getState().mUser.room.id,num_rounds:o,excpel:a,speed:i}};t.getState().socket.emit("req",Object(r.k)(s),(function(t){e.setBot(t.bot),$("#manageBotBrbModal .bot_brb_modal__header__close").click()}))}},{key:"pause",value:function(t,n){var o={type:"BOT_BRB_PAUSE",data:{room_id:t.getState().mUser.room.id}};t.getState().socket.emit("req",Object(r.k)(o),(function(t){e.setBot(t.bot)}))}},{key:"stop",value:function(t,n){var o={type:"BOT_BRB_STOP",data:{room_id:t.getState().mUser.room.id}};t.getState().socket.emit("req",Object(r.k)(o),(function(t){e.setBot(t.bot)}))}},{key:"update",value:function(t,n){var o=n.find("input[name='bot_brb_modal__body__form__speed']").val(),i={type:"BOT_BRB_UPDATE",data:{room_id:t.getState().mUser.room.id,speed:o}};t.getState().socket.emit("req",Object(r.k)(i),(function(t){e.setBot(t.bot)}))}},{key:"setBot",value:function(e){if(!e)return $("#bot_brb_modal__body__form__button--start").removeAttr("disabled"),$("#bot_brb_modal__body__form__button--pause").attr("disabled","disabled"),void $("#bot_brb_modal__body__form__button--stop").attr("disabled","disabled");e.isPaused?($("#bot_brb_modal__body__form__button--start").removeAttr("disabled"),$("#bot_brb_modal__body__form__button--pause").attr("disabled","disabled"),$("#bot_brb_modal__body__form__button--stop").removeAttr("disabled")):e.isStopped?($("#bot_brb_modal__body__form__button--start").removeAttr("disabled"),$("#bot_brb_modal__body__form__button--pause").attr("disabled","disabled"),$("#bot_brb_modal__body__form__button--stop").attr("disabled","disabled")):e.isStarted&&($("#bot_brb_modal__body__form__button--start").attr("disabled","disabled"),$("#bot_brb_modal__body__form__button--pause").removeAttr("disabled"),$("#bot_brb_modal__body__form__button--stop").removeAttr("disabled")),e.isStarted||e.isPaused?$("#bot_num_rounds, #bot_brb_modal__body__form__excpel").attr("disabled","disabled"):$("#bot_num_rounds, #bot_brb_modal__body__form__excpel").removeAttr("disabled"),$("#bot_num_rounds").val(e.num_rounds),$("#bot_brb_modal__body__form__speed").val(e.speed),e.excpel?$("#bot_brb_modal__body__form__excpel").attr("checked","checked"):$("#bot_brb_modal__body__form__excpel").removeAttr("checked")}},{key:"render",value:function(t){var n="<div class='modal fade bot_brb_modal' id='manageBotBrbModal' tabindex='-1' role='dialog' aria-hidden='true'>";n+="<div class='modal-dialog' role='document'>",n+="<div class='modal-content'>",n+="<div class='bot_brb_modal__header modal-header label label-primary'>",n+="<div class='modal-title'>",n+="<p class='bot_brb_modal__header__name ellipsis'>"+t.getState().mUser.room.name+"</p>",n+="<button data-dismiss='modal' class='btn btn-danger bot_brb_modal__header__close fa fa-times'></button>",n+="</div>",n+="</div>",n+="<div class='bot_brb_modal__body modal-body'>",n+="<p class='alert alert-danger' style='display: none'></p>",n+="<p class='alert alert-success' style='display: none'></p>",n+="<form id='bot_brb_modal__body__form'>",n+="<div>",n+="<div><input type='number' id='bot_num_rounds' min='2' max='10' name='num_rounds' value='5' placeholder='عدد الجولات' /></div>",n+='<div class="form-group">',n+='<input type="checkbox" id="bot_brb_modal__body__form__excpel" name="bot_brb_modal__body__form__excpel"/>',n+='<label for="bot_brb_modal__body__form__excpel">أطرد خصمك</label>',n+="</div>",n+='<div class="form-group">',n+='<label for="bot_brb_modal__body__form__speed">سرعة البوت</label><br>',n+="<input type='number' id='bot_brb_modal__body__form__speed' min='100' max='5000' name='bot_brb_modal__body__form__speed' value='1000' placeholder='رقم من 100 إلى 5000' style='width: 50%' />",n+="<button id='bot_brb_modal__body__form__button--update' class='btn btn-info pull-right'><span class='fa fa-refresh'></span>تحديث السرعة&nbsp;</button>",n+="</div>",n+="<div class='bot_brb_modal__body__form__buttons'>",n+="<button id='bot_brb_modal__body__form__button--start' class='btn btn-success'><span class='fa fa-play'></span>تشغيل&nbsp;</button>",n+="<button id='bot_brb_modal__body__form__button--pause' class='btn btn-warning'><span class='fa fa-pause'></span>إيقاف مؤقت&nbsp;</button>",n+="<button id='bot_brb_modal__body__form__button--stop' class='btn btn-danger'><span class='fa fa-stop'></span>إيقاف&nbsp;</button>",n+="</div>",n+="</div>",n+="</form>",n+="</div>",n+="</div>",n+="</div>",n+="</div>",$("#manage_bot_brb_container").html(n),e.registerEvents(t),e.setBot(null)}}],(n=null)&&X(t.prototype,n),o&&X(t,o),e}(),Q=n(17);function Z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ee=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"registerEvents",value:function(t){e.requestRed(t),e.requestGreen(t),e.requestYellow(t),e.requestBlue(t),e.startGame(t)}},{key:"requestRed",value:function(e){$("#pre_youcam_ludo_modal__body__form--request-red").unbind("click").on("click",(function(t){t.preventDefault();var n=$("#pre_youcam_ludo_modal__body__form--select-red").val(),o=$("#pre_youcam_ludo_modal__body__form--select-green").val(),i=$("#pre_youcam_ludo_modal__body__form--select-yellow").val(),a=$("#pre_youcam_ludo_modal__body__form--select-blue").val();return n?(o==n&&$("#pre_youcam_ludo_modal__body__form--select-green").val(""),i==n&&$("#pre_youcam_ludo_modal__body__form--select-yellow").val(""),a==n&&$("#pre_youcam_ludo_modal__body__form--select-blue").val(""),$("#pre_youcam_ludo_modal__body__form--request-red__loader").show(),$("#pre_youcam_ludo_modal__body__form--request-red").hide(),n==e.getState().mUser.id?($("#pre_youcam_ludo_modal__body__form--request-red__loader").attr("src","/images/check_ok.png"),void $("#pre_youcam_ludo_modal__body__form--select-red").prop("disabled",!0)):(e.getState().socket.emit("req",Object(r.k)({type:"YOUCAM_LUDO_REQUEST",data:{user:n,color:"red"}}),(function(e){e=Object(r.g)(e)})),void setTimeout((function(){"inline"==document.getElementById("pre_youcam_ludo_modal__body__form--request-red__loader").style.display&&($("#pre_youcam_ludo_modal__body__form--request-red__loader").hide(),$("#pre_youcam_ludo_modal__body__form--request-red").show())}),1e4))):alert("الرجاء إختيار لاعب من القائمة")}))}},{key:"requestGreen",value:function(e){$("#pre_youcam_ludo_modal__body__form--request-green").unbind("click").on("click",(function(t){t.preventDefault();var n=$("#pre_youcam_ludo_modal__body__form--select-red").val(),o=$("#pre_youcam_ludo_modal__body__form--select-green").val(),i=$("#pre_youcam_ludo_modal__body__form--select-yellow").val(),a=$("#pre_youcam_ludo_modal__body__form--select-blue").val();return o?(n==o&&$("#pre_youcam_ludo_modal__body__form--select-red").val(""),i==o&&$("#pre_youcam_ludo_modal__body__form--select-yellow").val(""),a==o&&$("#pre_youcam_ludo_modal__body__form--select-blue").val(""),$("#pre_youcam_ludo_modal__body__form--request-green__loader").show(),$("#pre_youcam_ludo_modal__body__form--request-green").hide(),o==e.getState().mUser.id?($("#pre_youcam_ludo_modal__body__form--request-green__loader").attr("src","/images/check_ok.png"),void $("#pre_youcam_ludo_modal__body__form--select-green").prop("disabled",!0)):(e.getState().socket.emit("req",Object(r.k)({type:"YOUCAM_LUDO_REQUEST",data:{user:o,color:"green"}}),(function(e){e=Object(r.g)(e)})),void setTimeout((function(){"inline"==document.getElementById("pre_youcam_ludo_modal__body__form--request-green__loader").style.display&&($("#pre_youcam_ludo_modal__body__form--request-green__loader").hide(),$("#pre_youcam_ludo_modal__body__form--request-green").show())}),1e4))):alert("الرجاء إختيار لاعب من القائمة")}))}},{key:"requestYellow",value:function(e){$("#pre_youcam_ludo_modal__body__form--request-yellow").unbind("click").on("click",(function(t){t.preventDefault();var n=$("#pre_youcam_ludo_modal__body__form--select-red").val(),o=$("#pre_youcam_ludo_modal__body__form--select-green").val(),i=$("#pre_youcam_ludo_modal__body__form--select-yellow").val(),a=$("#pre_youcam_ludo_modal__body__form--select-blue").val();return i?(n==i&&$("#pre_youcam_ludo_modal__body__form--select-red").val(""),o==i&&$("#pre_youcam_ludo_modal__body__form--select-green").val(""),a==i&&$("#pre_youcam_ludo_modal__body__form--select-blue").val(""),$("#pre_youcam_ludo_modal__body__form--request-yellow__loader").show(),$("#pre_youcam_ludo_modal__body__form--request-yellow").hide(),i==e.getState().mUser.id?($("#pre_youcam_ludo_modal__body__form--request-yellow__loader").attr("src","/images/check_ok.png"),void $("#pre_youcam_ludo_modal__body__form--select-yellow").prop("disabled",!0)):(e.getState().socket.emit("req",Object(r.k)({type:"YOUCAM_LUDO_REQUEST",data:{user:i,color:"yellow"}}),(function(e){e=Object(r.g)(e)})),void setTimeout((function(){"inline"==document.getElementById("pre_youcam_ludo_modal__body__form--request-yellow__loader").style.display&&($("#pre_youcam_ludo_modal__body__form--request-yellow__loader").hide(),$("#pre_youcam_ludo_modal__body__form--request-yellow").show())}),1e4))):alert("الرجاء إختيار لاعب من القائمة")}))}},{key:"requestBlue",value:function(e){$("#pre_youcam_ludo_modal__body__form--request-blue").unbind("click").on("click",(function(t){t.preventDefault();var n=$("#pre_youcam_ludo_modal__body__form--select-red").val(),o=$("#pre_youcam_ludo_modal__body__form--select-green").val(),i=$("#pre_youcam_ludo_modal__body__form--select-yellow").val(),a=$("#pre_youcam_ludo_modal__body__form--select-blue").val();return a?(n==a&&$("#pre_youcam_ludo_modal__body__form--select-red").val(""),i==a&&$("#pre_youcam_ludo_modal__body__form--select-yellow").val(""),o==a&&$("#pre_youcam_ludo_modal__body__form--select-green").val(""),$("#pre_youcam_ludo_modal__body__form--request-blue__loader").show(),$("#pre_youcam_ludo_modal__body__form--request-blue").hide(),a==e.getState().mUser.id?($("#pre_youcam_ludo_modal__body__form--request-blue__loader").attr("src","/images/check_ok.png"),void $("#pre_youcam_ludo_modal__body__form--select-blue").prop("disabled",!0)):(e.getState().socket.emit("req",Object(r.k)({type:"YOUCAM_LUDO_REQUEST",data:{user:a,color:"blue"}}),(function(e){e=Object(r.g)(e)})),void setTimeout((function(){"inline"==document.getElementById("pre_youcam_ludo_modal__body__form--request-blue__loader").style.display&&($("#pre_youcam_ludo_modal__body__form--request-blue__loader").hide(),$("#pre_youcam_ludo_modal__body__form--request-blue").show())}),1e4))):alert("الرجاء إختيار لاعب من القائمة")}))}},{key:"startGame",value:function(e){$(".pre_youcam_ludo_modal__body__form__button--start").unbind("click").on("click",(function(t){t.preventDefault();var n=$(this).hasClass("public"),r=document.querySelector("#pre_youcam_ludo_modal__body__form--select-red").value,o=document.querySelector("#pre_youcam_ludo_modal__body__form--select-green").value,i=document.querySelector("#pre_youcam_ludo_modal__body__form--select-yellow").value,a=document.querySelector("#pre_youcam_ludo_modal__body__form--select-blue").value;r==e.getState().mUser.id&&(window.mUserLudoColor="red"),o==e.getState().mUser.id&&(window.mUserLudoColor="green"),i==e.getState().mUser.id&&(window.mUserLudoColor="yellow"),a==e.getState().mUser.id&&(window.mUserLudoColor="blue"),Q.a.startGame(e,[{color:"red",user_id:r},{color:"green",user_id:o},{color:"yellow",user_id:i},{color:"blue",user_id:a}],n)}))}},{key:"render",value:function(t){if(t.getState().mUser.room){var n=t.getState().users.filter((function(e){return e.room&&e.room.id==t.getState().mUser.room.id})),r="<div class='modal fade pre_youcam_ludo_modal' id='preYoucamLudoModal' tabindex='-1' role='dialog' aria-hidden='true'>";r+="<div class='modal-dialog' role='document'>",r+="<div class='modal-content'>",r+="<div class='pre_youcam_ludo_modal__header modal-header label label-primary'>",r+="<div class='modal-title'>",r+="<p class='pre_youcam_ludo_modal__header__name ellipsis'>يوكام لودو</p>",r+="<button data-dismiss='modal' class='btn btn-danger pre_youcam_ludo_modal__header__close fa fa-times'></button>",r+="</div>",r+="</div>",r+="<div class='pre_youcam_ludo_modal__body modal-body'>",r+="<p class='alert alert-danger' style='display: none'></p>",r+="<p class='alert alert-success' style='display: none'></p>",r+="<form id='pre_youcam_ludo_modal__body__form'>",r+="<div>",r+="<div><img height='30' class='pre_youcam_ludo_modal__body__form--player-icon' src='/images/ludo_red.png' />",r+="<select id='pre_youcam_ludo_modal__body__form--select-red' name='red' class='pre_youcam_ludo_modal__body__form--select'>",r+="<option dir='rtl' value=''>--</option>",n.forEach((function(e){r+="<option dir='rtl' value='"+e.id+"'>"+e.name+"</option>"})),r+="</select>",r+="<button id='pre_youcam_ludo_modal__body__form--request-red' class='btn btn-primary btn btn-default'>إرسال</button>",r+="<img id='pre_youcam_ludo_modal__body__form--request-red__loader' alt='' width='24' height='24' src='/images/loader.gif' /></div>",r+="<div><img height='30' src='/images/ludo_green.png' />",r+="<select id='pre_youcam_ludo_modal__body__form--select-green' name='green' class='pre_youcam_ludo_modal__body__form--select'>",r+="<option dir='rtl' value=''>--</option>",n.forEach((function(e){r+="<option dir='rtl' value='"+e.id+"'>"+e.name+"</option>"})),r+="</select>",r+="<button id='pre_youcam_ludo_modal__body__form--request-green' class='btn btn-primary btn btn-default'>إرسال</button>",r+="<img id='pre_youcam_ludo_modal__body__form--request-green__loader' alt='' width='24' height='24' src='/images/loader.gif' /></div>",r+="<div><img height='30' src='/images/ludo_yellow.png' />",r+="<select id='pre_youcam_ludo_modal__body__form--select-yellow' name='yellow' class='pre_youcam_ludo_modal__body__form--select'>",r+="<option dir='rtl' value=''>--</option>",n.forEach((function(e){r+="<option dir='rtl' value='"+e.id+"'>"+e.name+"</option>"})),r+="</select>",r+="<button id='pre_youcam_ludo_modal__body__form--request-yellow' class='btn btn-primary btn btn-default'>إرسال</button>",r+="<img id='pre_youcam_ludo_modal__body__form--request-yellow__loader' alt='' width='24' height='24' src='/images/loader.gif' /></div>",r+="<div><img height='30' src='/images/ludo_blue.png' />",r+="<select id='pre_youcam_ludo_modal__body__form--select-blue' name='blue' class='pre_youcam_ludo_modal__body__form--select'>",r+="<option dir='rtl' value=''>--</option>",n.forEach((function(e){r+="<option dir='rtl' value='"+e.id+"'>"+e.name+"</option>"})),r+="</select>",r+="<button id='pre_youcam_ludo_modal__body__form--request-blue' class='btn btn-primary btn btn-default'>إرسال</button>",r+="<img id='pre_youcam_ludo_modal__body__form--request-blue__loader' alt='' width='24' height='24' src='/images/loader.gif' /></div>",r+="<div class='pre_youcam_ludo_modal__body__form__buttons'>",r+="<button disabled class='pre_youcam_ludo_modal__body__form__button--start private btn btn-success'><span class='fa fa-play'></span>بدأ اللعب خاص &nbsp;</button>",r+="<button disabled class='pre_youcam_ludo_modal__body__form__button--start public btn btn-success'><span class='fa fa-users'></span>بدأ اللعب عام &nbsp;</button>",r+="</div>",r+="</div>",r+="</form>",r+="</div>",r+="</div>",r+="</div>",r+="</div>",$("#youcam_ludo_container").html(r),e.registerEvents(t)}}}],(n=null)&&Z(t.prototype,n),o&&Z(t,o),e}(),te=n(28);function ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var re=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"registerEvents",value:function(t){e.requestPlayer1(t),e.requestPlayer2(t),e.requestPlayer3(t),e.startGame(t)}},{key:"requestPlayer1",value:function(e){window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--request-pl1").unbind("click").on("click",(function(t){t.preventDefault();var n=window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--select-pl1").val(),o=window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--select-pl2").val(),i=window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--select-pl3").val();return n?(o==n&&"bot"!=n&&window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--select-pl2").val(""),i==n&&"bot"!=n&&window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--select-pl3").val(""),e.getState().socket.emit("req",Object(r.k)({type:"YOUCAM_UNO_REQUEST",data:{user:n,number:1}}),(function(e){})),window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--request-pl1").hide(),window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--request-pl1__loader").show(),"bot"==n?(window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--request-pl1__loader").attr("src","/images/check_ok.png"),window.youcamUnoContainer.find(".pre_youcam_uno_modal__body__form__button--start").removeAttr("disabled"),void $(this).prev().attr("disabled","disabled")):void(window.UnoRequestPl1Timeout=setTimeout((function(){document.getElementById("pre_youcam_uno_modal__body__form--request-pl1__loader").src.indexOf("check_ok")<0&&(window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--request-pl1__loader").hide(),window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--request-pl1").show())}),2e4))):alert("الرجاء إختيار لاعب من القائمة")}))}},{key:"requestPlayer2",value:function(e){window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--request-pl2").unbind("click").on("click",(function(t){t.preventDefault();var n=window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--select-pl1").val(),o=window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--select-pl2").val(),i=window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--select-pl3").val();return o?(n==o&&"bot"!=o&&window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--select-pl1").val(""),i==o&&"bot"!=o&&window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--select-pl3").val(""),e.getState().socket.emit("req",Object(r.k)({type:"YOUCAM_UNO_REQUEST",data:{user:o,number:2}}),(function(e){})),window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--request-pl2").hide(),window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--request-pl2__loader").show(),"bot"==o?(window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--request-pl2__loader").attr("src","/images/check_ok.png"),window.youcamUnoContainer.find(".pre_youcam_uno_modal__body__form__button--start").removeAttr("disabled"),void $(this).prev().attr("disabled","disabled")):void(window.UnoRequestPl2Timeout=setTimeout((function(){document.getElementById("pre_youcam_uno_modal__body__form--request-pl2__loader").src.indexOf("check_ok")<0&&(window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--request-pl2__loader").hide(),window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--request-pl2").show())}),2e4))):alert("الرجاء إختيار لاعب من القائمة")}))}},{key:"requestPlayer3",value:function(e){window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--request-pl3").unbind("click").on("click",(function(t){t.preventDefault();var n=window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--select-pl1").val(),o=window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--select-pl2").val(),i=window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--select-pl3").val();return i?(n==i&&"bot"!=i&&window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--select-pl1").val(""),o==i&&"bot"!=i&&window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--select-pl2").val(""),e.getState().socket.emit("req",Object(r.k)({type:"YOUCAM_UNO_REQUEST",data:{user:i,number:3}}),(function(e){})),window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--request-pl3").hide(),window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--request-pl3__loader").show(),"bot"==i?(window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--request-pl3__loader").attr("src","/images/check_ok.png"),window.youcamUnoContainer.find(".pre_youcam_uno_modal__body__form__button--start").removeAttr("disabled"),void $(this).prev().attr("disabled","disabled")):void(window.UnoRequestPl3Timeout=setTimeout((function(){document.getElementById("pre_youcam_uno_modal__body__form--request-pl3__loader").src.indexOf("check_ok")<0&&(window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--request-pl3__loader").hide(),window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--request-pl3").show())}),2e4))):alert("الرجاء إختيار لاعب من القائمة")}))}},{key:"startGame",value:function(e){window.youcamUnoContainer.find(".pre_youcam_uno_modal__body__form__button--start").unbind("click").on("click",(function(t){t.preventDefault(),e.getState().socket.emit("req",Object(r.k)({type:"YOUCAM_UNO_START_GAME",data:{}}),(function(e){if("string"==typeof(e=Object(r.g)(e)))return alert(e)}))}))}},{key:"render",value:function(t){if(t.getState().mUser.room){var n=t.getState().users.filter((function(e){return e.room&&e.room.id==t.getState().mUser.room.id})),r="<div class='modal fade pre_youcam_uno_modal' id='preYoucamUnoModal' tabindex='-1' role='dialog' aria-hidden='true'>";r+="<div class='modal-dialog' role='document'>",r+="<div class='modal-content'>",r+="<div class='pre_youcam_uno_modal__header modal-header label label-primary'>",r+="<div class='modal-title'>",r+="<p class='pre_youcam_uno_modal__header__name ellipsis'>يوكام أونو - UNO</p>",r+="<button data-dismiss='modal' class='btn btn-danger pre_youcam_uno_modal__header__close fa fa-times'></button>",r+="</div>",r+="</div>",r+="<div class='pre_youcam_uno_modal__body modal-body'>",r+="<p class='alert alert-danger' style='display: none'></p>",r+="<p class='alert alert-success' style='display: none'></p>",r+="<form id='pre_youcam_uno_modal__body__form'>",r+="<div>",r+="<div>",r+="<select disabled class='pre_youcam_uno_modal__body__form--select'>",r+="<option dir='rtl' value='"+t.getState().mUser.id+"'>"+t.getState().mUser.name+"</option>",r+="</select>",r+="<div>",r+="<select id='pre_youcam_uno_modal__body__form--select-pl1' name='pl1' class='pre_youcam_uno_modal__body__form--select'>",r+="<option dir='rtl' value=''>--</option>",r+="<option dir='rtl' style='font-weight: bold' value='bot'>كمبيوتر</option>",n.forEach((function(e){e.id!=t.getState().mUser.id&&(r+="<option dir='rtl' value='"+e.id+"'>"+e.name+"</option>")})),r+="</select>",r+="<button id='pre_youcam_uno_modal__body__form--request-pl1' class='btn btn-primary btn btn-default'>إرسال</button>",r+="<img id='pre_youcam_uno_modal__body__form--request-pl1__loader' alt='' width='24' height='24' src='/images/loader.gif' /></div>",r+="<div>",r+="<select id='pre_youcam_uno_modal__body__form--select-pl2' name='pl2' class='pre_youcam_uno_modal__body__form--select'>",r+="<option dir='rtl' value=''>--</option>",r+="<option dir='rtl' style='font-weight: bold' value='bot'>كمبيوتر</option>",n.forEach((function(e){e.id!=t.getState().mUser.id&&(r+="<option dir='rtl' value='"+e.id+"'>"+e.name+"</option>")})),r+="</select>",r+="<button id='pre_youcam_uno_modal__body__form--request-pl2' class='btn btn-primary btn btn-default'>إرسال</button>",r+="<img id='pre_youcam_uno_modal__body__form--request-pl2__loader' alt='' width='24' height='24' src='/images/loader.gif' /></div>",r+="<div>",r+="<select id='pre_youcam_uno_modal__body__form--select-pl3' name='pl3' class='pre_youcam_uno_modal__body__form--select'>",r+="<option dir='rtl' value=''>--</option>",r+="<option dir='rtl' style='font-weight: bold' value='bot'>كمبيوتر</option>",n.forEach((function(e){e.id!=t.getState().mUser.id&&(r+="<option dir='rtl' value='"+e.id+"'>"+e.name+"</option>")})),r+="</select>",r+="<button id='pre_youcam_uno_modal__body__form--request-pl3' class='btn btn-primary btn btn-default'>إرسال</button>",r+="<img id='pre_youcam_uno_modal__body__form--request-pl3__loader' alt='' width='24' height='24' src='/images/loader.gif' /></div>",r+="<div class='pre_youcam_uno_modal__body__form__buttons'>",r+="<button disabled class='pre_youcam_uno_modal__body__form__button--start btn btn-success'><span class='fa fa-play'></span>  بدأ اللعب  &nbsp;</button>",r+="</div>",r+="</div>",r+="</form>",r+="</div>",r+="</div>",r+="</div>",r+="</div>",window.youcamUnoContainer.html(r),e.registerEvents(t)}}}],(n=null)&&ne(t.prototype,n),o&&ne(t,o),e}();function oe(e,t){"touchstart"===e.type?(window["broadcast-live-"+t+"-InitialX"]=e.touches[0].clientX-window["broadcast-live-"+t+"-XOffset"],window["broadcast-live-"+t+"-InitialY"]=e.touches[0].clientY-window["broadcast-live-"+t+"-YOffset"]):(window["broadcast-live-"+t+"-InitialX"]=e.clientX-window["broadcast-live-"+t+"-XOffset"],window["broadcast-live-"+t+"-InitialY"]=e.clientY-window["broadcast-live-"+t+"-YOffset"]);var n=document.querySelector("#broadcast_live__box-"+t+" .broadcast_live_box__header"),r=document.querySelector("#broadcast_live__box-"+t+" .broadcast_live_box__title"),o=document.querySelector("#broadcast_live__box-"+t+" .broadcast_live_box__body");e.target!==n&&e.target!==r&&e.target!==o||(window["broadcast-live-"+t+"-DragActive"]=!0)}function ie(e,t){window["broadcast-live-"+t+"-InitialX"]=window["broadcast-live-"+t+"-CurrentX"],window["broadcast-live-"+t+"-InitialY"]=window["broadcast-live-"+t+"-CurrentY"],window["broadcast-live-"+t+"-DragActive"]=!1}function ae(e,t){var n,r;window["broadcast-live-"+t+"-DragActive"]&&(e.preventDefault(),"touchmove"===e.type?(window["broadcast-live-"+t+"-CurrentX"]=e.touches[0].clientX-window["broadcast-live-"+t+"-InitialX"],window["broadcast-live-"+t+"-CurrentY"]=e.touches[0].clientY-window["broadcast-live-"+t+"-InitialY"]):(window["broadcast-live-"+t+"-CurrentX"]=e.clientX-window["broadcast-live-"+t+"-InitialX"],window["broadcast-live-"+t+"-CurrentY"]=e.clientY-window["broadcast-live-"+t+"-InitialY"]),window["broadcast-live-"+t+"-XOffset"]=window["broadcast-live-"+t+"-CurrentX"],window["broadcast-live-"+t+"-YOffset"]=window["broadcast-live-"+t+"-CurrentY"],n=window["broadcast-live-"+t+"-CurrentX"],r=window["broadcast-live-"+t+"-CurrentY"],document.querySelector("#broadcast_live__box-"+t).style.transform="translate3d("+n+"px, "+r+"px, 0)")}function se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ce=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"register",value:function(e){var t=document.querySelector("#chat");window["broadcast-live-"+e+"-DragActive"]=!1,window["broadcast-live-"+e+"-XOffset"]=window["broadcast-live-"+e+"-XOffset"]?window["broadcast-live-"+e+"-XOffset"]:0,window["broadcast-live-"+e+"-YOffset"]=window["broadcast-live-"+e+"-YOffset"]?window["broadcast-live-"+e+"-YOffset"]:0,t.addEventListener("touchstart",(function(t){oe(t,e)}),!1),t.addEventListener("touchend",(function(t){ie(0,e)}),!1),t.addEventListener("touchmove",(function(t){ae(t,e)}),!1),t.addEventListener("mousedown",(function(t){oe(t,e)}),!1),t.addEventListener("mouseup",(function(t){ie(0,e)}),!1),t.addEventListener("mousemove",(function(t){ae(t,e)}),!1)}},{key:"unregister",value:function(e){var t=document.querySelector("#chat");t.removeEventListener("touchstart",(function(t){oe(t,e)}),!1),t.removeEventListener("touchend",(function(t){ie(0,e)}),!1),t.removeEventListener("touchmove",(function(t){ae(t,e)}),!1),t.removeEventListener("mousedown",oe,!1),t.removeEventListener("mouseup",(function(t){ie(0,e)}),!1),t.removeEventListener("mousemove",(function(t){ae(t,e)}),!1)}}],(n=null)&&se(t.prototype,n),r&&se(t,r),e}(),ue=n(27),de=n.n(ue);function le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var fe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"registerEvents",value:function(t){e.onClose(t)}},{key:"onClose",value:function(t){$(".broadcast_live_box__close").unbind().on("click",(function(n){var r=$(this).closest(".broadcast_live_box");e.close(t,r)}))}},{key:"close",value:function(t,n,o){ce.unregister(n.data("id")),n.remove();var i=n.data("id");i==t.getState().mUser.id?t.getState().socket.emit("req",Object(r.k)({type:"BROADCAST_LIVE_END",data:{}}),(function(n){n=Object(r.g)(n),e.destroySession(t,!0)})):o?$("#show_broadcast_live").remove():e.renderButton(t,i)}},{key:"renderButton",value:function(t,n){$("#broadcast_live_container").append("<div id='show_broadcast_live' data-id='"+n+"'><img src='/images/broadcast_live_icon.png' /></div>"),e.onShowBroadcastLiveBox(t)}},{key:"onShowBroadcastLiveBox",value:function(t){$("#show_broadcast_live").unbind("click").on("click",(function(n){var r=$(this).data("id");$("#show_broadcast_live").remove(),e.render(t,r),e.init(t,!1,e.generateJanusRoomID(t,r))}))}},{key:"getIceServers",value:function(e){return e?[{url:"stun:stun.d-arish.com:5349"},{url:"turn:turn.d-arish.com:3478?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:3478?transport=udp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=udp",username:"youcam",credential:"youcam"}]:{iceServers:[{url:"stun:stun.d-arish.com:5349"},{url:"turn:turn.d-arish.com:3478?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:3478?transport=udp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=tcp",username:"youcam",credential:"youcam"},{url:"turn:turn.d-arish.com:5349?transport=udp",username:"youcam",credential:"youcam"}]}}},{key:"getJanusServer",value:function(){return"wss://ws1.chat-host.net:8989"}},{key:"init",value:function(t,n,r){window.incomingBroadcastLiveStreams={},window.outgoingBroadcastLiveStream=null,window.janusBroadcastLiveSession=null,window.broadcastLivePluginHandle=null,window.janusBroadcastLiveUserID=e.generateJanusUserID(t,t.getState().socket.id),window.broadcastLiveOpaqueId="videoroomtest-"+de.a.randomString(15),window.broadcastLliveReconnectionInterval=null,window.BroadcastLiveFeeds=[],de.a.init({debug:!1,dependencies:de.a.useDefaultDependencies(),callback:function(){e.onJanusInitialized(t,n,r)},iceServers:e.getIceServers(!0)})}},{key:"onJanusInitialized",value:function(t,n,r){window.janusBroadcastLiveSession=new de.a({server:e.getJanusServer(),success:function(){e.onJanusSessionSuccess(t,janusBroadcastLiveSession,n,r)},error:function(n){"Lost connection to the server (is it down?)"==n&&e.handleServerConnectionLost(t)},destroyed:function(){e.onJanusSessionDestroyed(t)}})}},{key:"handleServerConnectionLost",value:function(t){t.getState().mUser.room&&$("#broadcast_live__box-"+t.getState().mUser.id).length&&(e.close(t,$("#broadcast_live__box-"+t.getState().mUser.id)),e.destroySession()),window.broadcastLliveReconnectionInterval=setInterval((function(){de.a.init({debug:!1,dependencies:de.a.useDefaultDependencies(),callback:function(){e.onJanusInitialized(t)},iceServers:e.getIceServers(!0)})}),5e3)}},{key:"onJanusSessionSuccess",value:function(t,n,r,o){window.broadcastLliveReconnectionInterval&&(clearInterval(window.broadcastLliveReconnectionInterval),window.broadcastLliveReconnectionInterval=null),n.attach({plugin:"janus.plugin.videoroom",success:function(n){e.onJanusAttachSuccess(t,n,r,o)},error:function(e){},consentDialog:function(e){},onmessage:function(n,r){e.onJanusAttachMessage(n,r,t)},onlocalstream:function(n){e.onJanusAttachLocalStream(t,n)},onremotestream:function(e){},webrtcState:function(e){de.a.log("WebRTC PeerConnection is "+(e?"up":"down")+" now")},oncleanup:function(){},detached:function(){}})}},{key:"onJanusAttachSuccess",value:function(t,n,r,o){window.broadcastLivePluginHandle=n,r?e.createRoom(t):e.joinRoom(o,!0)}},{key:"onJanusAttachMessage",value:function(t,n,r){var o=t.videoroom;if(o){if("joined"===o&&t.id&&(e.isRoomOwner(r,t.room)&&window.broadcastLivePluginHandle.createOffer({media:{audioSend:!0,videoRecv:!1},success:function(e){var t={request:"configure",audio:!0,video:!0,id:r.getState().mUser.id};window.broadcastLivePluginHandle.send({message:t,jsep:e})},error:function(e){console.log(e),alert("الرجاء منح الصلاحيات للمتصفح بتصوير الشاشة"),de.a.error("WebRTC error:",e)}}),window.broadcastLivePluginHandle.send({message:{request:"publish",video:!0,audio:!0,data:!1}}),t.publishers)){var i=t.publishers;for(var a in de.a.debug("Got a list of available publishers/feeds:",i),i){var s=i[a].id,c=i[a].display,u=i[a].audio_codec,d=i[a].video_codec;de.a.debug("  >> ["+s+"] "+c+" (audio: "+u+", video: "+d+")"),e.newRemoteFeed(r,s,c,u,d,t.room)}}if("created"===o);else if("destroyed"===o)de.a.warn("The room has been destroyed!");else if("roomchanged"===o)window.myJanusBroadcastLiveID=t.id;else if("event"===o)if(t.publishers)for(var a in i=t.publishers)s=i[a].id,c=i[a].display,u=i[a].audio_codec,d=i[a].video_codec,e.newRemoteFeed(r,s,c,u,d);else t.leaving||t.unpublished||t.error&&426===t.error_code&&e.createRoom(r)}n&&window.broadcastLivePluginHandle.handleRemoteJsep({jsep:n})}},{key:"newRemoteFeed",value:function(t,n,r,o,i,a){var s=null;window.janusBroadcastLiveSession.attach({plugin:"janus.plugin.videoroom",opaqueId:window.broadcastLiveOpaqueId,success:function(e){(s=e).simulcastStarted=!1,s.audioCodec=o;var t={request:"join",room:a,ptype:"subscriber",feed:n,offer_video:!0,offer_data:!1};s.send({message:t})},error:function(e){de.a.error("  -- Error attaching plugin...",e)},onmessage:function(e,t){var n=e.videoroom;if(e.error);else if(n&&"attached"===n){for(var r=1;r<6;r++)if(!window.BroadcastLiveFeeds[r]){window.BroadcastLiveFeeds[r]=s,s.rfindex=r;break}s.rfid=e.id,s.rfdisplay=e.display}t&&s.createAnswer({jsep:t,media:{audioSend:!1,videoSend:!1},success:function(e){de.a.debug("Got SDP!",e);var t={request:"start",room:a};s.send({message:t,jsep:e})},error:function(e){de.a.error("WebRTC error:",e)}})},iceState:function(e){},webrtcState:function(e){de.a.log(" WebRTC PeerConnection (feed #"+s.rfindex+") is "+(e?"up":"down")+" now")},onlocalstream:function(n){n.getVideoTracks().length&&e.playLocalStream(t,n,e.getJanusUserID(t,window.broadcastLivePluginHandle.rfdisplay))},onremotestream:function(n){e.playRemoteStream(t,n,e.getJanusUserID(t,s.rfdisplay))},oncleanup:function(){}})}},{key:"destroySession",value:function(t,n){window.outgoingBroadcastLiveStream&&window.outgoingBroadcastLiveStream.getTracks().forEach((function(e){return e.stop()})),window.janusBroadcastLiveSession&&window.janusBroadcastLiveSession.isConnected()&&(n?window.broadcastLivePluginHandle.send({message:{request:"destroy",room:e.generateJanusRoomID(t,t.getState().mUser.id)},success:function(t){"destroyed"==t.videoroom&&(window.janusBroadcastLiveSession.destroy(),e.destroyAllFeeds())}}):(window.janusBroadcastLiveSession.destroy(),e.destroyAllFeeds()))}},{key:"onJanusSessionDestroyed",value:function(e){e.getState().mUser.room&&e.getState().mUser.room.is_users_cam_enabled}},{key:"destroyAllFeeds",value:function(){window.BroadcastLiveFeeds.forEach((function(e){e.session.destroy()})),window.BroadcastLiveFeeds=[]}},{key:"isRoomOwner",value:function(t,n){return e.generateJanusRoomID(t,t.getState().mUser.id)==n}},{key:"generateJanusRoomID",value:function(e,t){t+="broacast-live";for(var n=new URL(e.getState().settings.socketIOHost),r=0,o=0;o<t.length;o++)r+=t.charCodeAt(o);return r=n.port+""+n.port*r,parseInt(r)}},{key:"getJanusUserID",value:function(e,t){return t.replace(new URL(e.getState().settings.socketIOHost).hostname+".","")}},{key:"joinRoom",value:function(e,t){window.broadcastLivePluginHandle&&e>0&&window.broadcastLivePluginHandle.send({message:{request:"join",ptype:"publisher",room:e,display:window.janusBroadcastLiveUserID}})}},{key:"createRoom",value:function(t){if(window.broadcastLivePluginHandle){var n=e.generateJanusRoomID(t,t.getState().mUser.id);window.broadcastLivePluginHandle.send({message:{request:"create",room:n,permanent:!1,bitrate:64e3,publishers:1,description:t.getState().settings.socketIOHost},success:function(o){"created"==o.videoroom?(e.joinRoom(o.room),t.getState().socket.emit("req",Object(r.k)({type:"BROADCAST_LIVE_PUBLISH",data:{}}),(function(e){}))):"event"==o.videoroom&&o.error&&427==o.error_code&&e.joinRoom(n)}})}}},{key:"onJanusAttachLocalStream",value:function(t,n){window.outgoingBroadcastLiveStream=n,n.getVideoTracks().length&&e.playLocalStream(t,n)}},{key:"playLocalStream",value:function(e,t){window.outgoingBroadcastLiveStream=t;var n=document.querySelector("#broadcast_live__box-"+e.getState().mUser.id+" video");if("srcObject"in n)try{n.srcObject=t}catch(e){if("TypeError"!=e.name)throw e;n.src=URL.createObjectURL(t)}else n.src=URL.createObjectURL(t);n.onloadedmetadata=function(e){n.paused&&n.play(),n.muted=!1}}},{key:"playRemoteStream",value:function(e,t,n){window.incomingBroadcastLiveStreams[n]=t;var r=document.querySelector("#broadcast_live__box-"+n+" video");if("srcObject"in r)try{r.srcObject=t}catch(e){if("TypeError"!=e.name)throw e;r.src=URL.createObjectURL(t)}else r.src=URL.createObjectURL(t);r.onloadedmetadata=function(e){r.paused&&r.play(),r.muted=!1}}},{key:"isSafari",value:function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}},{key:"generateJanusUserID",value:function(e,t){return new URL(e.getState().settings.socketIOHost).hostname+"."+t}},{key:"render",value:function(t,n){var r="<div class='broadcast_live_box' id='broadcast_live__box-"+n+"' data-id='"+n+"'>";r+="<header class='broadcast_live_box__header label label-primary'>",r+="<span class='broadcast_live_box__title'>بث مباشر</span>",r+="<button data-id='"+n+"' class='broadcast_live_box__close fa fa-close btn btn-danger'></button>",r+="</header>",r+="<div class='broadcast_live_box__body fl'>",r+="<video autoplay muted controls></video>",r+="</div>",r+="</div>",$("#broadcast_live_container").append(r),e.registerEvents(t),ce.register(n)}}],(n=null)&&le(t.prototype,n),o&&le(t,o),e}(),pe=n(20);function me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var he=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"registerEvents",value:function(t){e.openIngoredUsers(t),e.youcamLudo(t),e.youcamUno(t),e.openRadioTV(t),e.openNotifications(t),e.openMusicGallery(t),e.broadcastLive(t),e.onBotBrbClicked(t),e.openWallCreator(t)}},{key:"openIngoredUsers",value:function(e){window.othersPane.find("#others--ignored-users").unbind("click").on("click",(function(t){e.dispatch(Object(x.a)("ignored_users")),U.a.togglePane(e)}))}},{key:"youcamLudo",value:function(e){window.othersPane.find("#others--youcam-ludo").unbind("click").on("click",(function(t){e.getState().mUser.isPlaying||ee.render(e)}))}},{key:"youcamUno",value:function(e){window.othersPane.find("#others--youcam-uno").unbind("click").on("click",(function(t){te.a.initSounds(e),e.getState().mUser.isPlaying||re.render(e)}))}},{key:"openRadioTV",value:function(e){window.othersPane.find("#others--radio-tv").unbind("click").on("click",(function(t){pe.a.close(e),e.dispatch(Object(x.a)("live")),$("#chat__body__live-pane").show()}))}},{key:"openNotifications",value:function(e){window.othersPane.find("#others--notifications").unbind("click").on("click",(function(t){return e.dispatch(Object(x.a)("notifications")),window.notificationsPane.show(),G.setNotifications(e)}))}},{key:"openMusicGallery",value:function(e){window.othersPane.find("#others--audio-gallery").unbind("click").on("click",(function(t){J.a.open(e)}))}},{key:"broadcastLive",value:function(e){window.othersPane.find("#others--broadcast-live").unbind("click").on("click",(function(t){e.getState().socket.emit("req",Object(r.k)({type:"BROADCAST_LIVE_START",data:{}}),(function(t){"string"==typeof(t=Object(r.g)(t))&&("success"==t?(fe.init(e,!0),fe.render(e,e.getState().mUser.id)):alert(t))}))}))}},{key:"onBotBrbClicked",value:function(e){window.othersPane.find("#others--bot-brb").unbind("click").on("click",(function(t){if(!e.getState().mUser.room)return alert("يجب أن  تكون داخل غرفة حتى تتمكن من تشغيل البوت");K.render(e);var n={type:"BOT_BRB_OPEN",data:{room_id:e.getState().mUser.room.id}};e.getState().socket.emit("req",Object(r.k)(n),(function(t){K.setBot(t.bot,e)}))}))}},{key:"openWallCreator",value:function(e){window.othersPane.find("#others--wall-creator").unbind("click").on("click",(function(t){e.dispatch(Object(x.a)("wall-creator")),U.a.togglePane(e)}))}},{key:"render",value:function(e){var t="<div id='chat__body__others-pane' class='chat_pane' style='background: "+Object(r.u)(e.getState().settings,!0)+"'>";return t+=M.a.render("إضافات أخرى"),t+="<div class='chat__body__others-pane__container'>",t+="<div id='others--ignored-users' class='chat__body__others-pane__container__button form-control warning'>",t+="<span><span class='fa fa-ban'></span>المستخدمون المتجاهلين</span>",t+="</div>",e.getState().grantedSettings.notifications_pane&&(t+="<div id='others--notifications' class='chat__body__others-pane__container__button form-control'>",t+="<span><span class='fa fa-bell'></span> الإشعارات</span>",t+="</div>"),t+="<div id='others--wall-creator' class='chat__body__others-pane__container__button form-control success'>",t+="<span><span class='fa fa-area-chart'></span>مبدع الحائط</span>",t+="</div>",t+="<div id='others--radio-tv' class='chat__body__others-pane__container__button form-control'>",t+="<span><span class='fa fa-tv'></span>راديو / تلفزيون</span>",t+="</div>",e.getState().grantedSettings.youcam_ludo&&e.getState().features.FT_IS_LUDO_ENABLED&&(t+="<div data-toggle='modal' data-target='#preYoucamLudoModal' id='others--youcam-ludo' class='chat__body__others-pane__container__button form-control' style='background-color: #980F5A; color: #FFFFFF;'>",t+="<span><span class='fa fa-gamepad' style='color: #FFFFFF'></span>يوكام لودو</span>",t+="</div>"),e.getState().grantedSettings.broadcast_live&&e.getState().features.FT_IS_BROADCAST_LIVE_ENABLED&&(t+="<div id='others--broadcast-live' class='chat__body__others-pane__container__button form-control' style='background-color: #3a85ab; color: #FFFFFF;'>",t+="<span><span class='fa fa-tv' style='color: #FFFFFF'></span>بث مباشر</span>",t+="</div>"),e.getState().grantedSettings.bot_brb&&e.getState().features.FT_IS_BOT_BRB_ENABLED&&(t+="<div data-toggle='modal' data-target='#manageBotBrbModal' id='others--bot-brb' class='chat__body__others-pane__container__button form-control warning'>",t+="<span><span class='fa fa-dashboard'></span>بوت برب</span>",t+="</div>"),e.getState().mUser.reg_id&&e.getState().features.FT_IS_AUDIO_GALLERY_ENABLED&&(t+="<div id='others--audio-gallery' class='chat__body__others-pane__container__button form-control' style='background-color: #B270A2; color: white;'>",t+="<span><span style='color: white' class='fa fa-music'></span>مكتبة الصوتيات</span>",t+="</div>"),e.getState().mUser.reg_id&&e.getState().features.FT_IS_UNO_ENABLED&&(t+="<div data-toggle='modal' data-target='#preYoucamUnoModal' id='others--youcam-uno' class='chat__body__others-pane__container__button form-control' style='background-color: #c55967; color: #FFFFFF;'>",t+="<span><span class='fa fa-gamepad' style='color: #FFFFFF'></span>يوكام أونو - UNO</span>",t+="</div>"),t+="</div>",t+="</div>"}}],(n=null)&&me(t.prototype,n),o&&me(t,o),e}();function _e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ge=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"render",value:function(e){var t="<div id='chat__body' style='background-color: "+e.getState().settings.btn_color+"'>";return t+=S.a.render(),t+=k.a.render(e),t+=C.a.render(e),t+=E.a.render(e),t+=T.a.render(e),t+=O.a.render(e),t+=P.a.render(e),t+=A.a.render(e),t+=he.render(e),t+=R.a.render(e),t+=Y.render(e),t+=G.render(e),t+=J.a.render(e),t+="<audio style='display: none;' id='private-bip'>",t+="<source src='private-bip.mp3' type='audio/mpeg'>",t+="<source src='private-bip.ogg' type='audio/ogg'>",t+="</audio>",t+="</div>"}}],(n=null)&&_e(t.prototype,n),r&&_e(t,r),e}(),ve=n(18);function ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var be=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"registerEvents",value:function(t){e.onParticleLoaded(t)}},{key:"getRandomInt",value:function(e,t){return Math.floor(Math.random()*(t-e+1))+e}},{key:"insertParticles",value:function(e){if($("#floating_particles"))for(var t=0;t<2;t++)"heart"==e.getState().particleType&&($("#floating_particles").append('<img class="floating_particles__item" src="'+Object(r.e)()+'/images/floating_heart1.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="'+Object(r.e)()+'/images/floating_heart2.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="'+Object(r.e)()+'/images/floating_heart3.png" width="50" height="50" alt="" />')),"gift"==e.getState().particleType&&($("#floating_particles").append('<img class="floating_particles__item" src="'+Object(r.e)()+'/images/floating_gift1.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="'+Object(r.e)()+'/images/floating_gift2.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="/images/floating_gift3.png" width="50" height="50" alt="" />')),"ad"==e.getState().particleType&&($("#floating_particles").append('<img class="floating_particles__item" src="'+Object(r.e)()+'/images/floating_ad1.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="'+Object(r.e)()+'/images/floating_ad2.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="'+Object(r.e)()+'/images/floating_ad3.png" width="50" height="50" alt="" />')),"rose"==e.getState().particleType&&($("#floating_particles").append('<img class="floating_particles__item" src="'+Object(r.e)()+'/images/floating_rose1.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="'+Object(r.e)()+'/images/floating_rose2.png" width="50" height="50" alt="" />'),$("#floating_particles").append('<img class="floating_particles__item" src="'+Object(r.e)()+'/images/floating_rose3.png" width="50" height="50" alt="" />'))}},{key:"onParticleLoaded",value:function(t){$(".floating_particles__item").unbind("load").on("load",(function(n){e.insertParticles(t),$(".floating_particles__item").toArray().forEach((function(n){var r=$("body").width()-100,o=e.getRandomInt(50,150);try{$(n).animate({lef:e.getRandomInt(0,r),right:e.getRandomInt(0,r),bottom:e.getRandomInt(30,500),width:o,height:o},e.getRandomInt(1e3,3e3),(function(){$(n).animate({top:"-100%",opacity:0},e.getRandomInt(5e3,15e3),(function(){try{$(n).unbind("load").remove()}catch(e){}t.getState().particleType&&t.dispatch(g(null))}))}))}catch(e){}}))}))}},{key:"toggle",value:function(t){t.getState().settings.disable_floating_particles||($("#floating_particles .floating_particles__item").remove(),$("#floating_particles").append("<img class='floating_particles__item' src='"+Object(r.e)()+"/images/floating_"+t.getState().particleType+"1.png' width='50' height='50' alt='' />"),e.onParticleLoaded(t))}},{key:"render",value:function(e){var t="<div id='floating_particles'>";return e.getState().settings.disable_floating_particles||(t+="<img class='floating_particles__item' src='"+Object(r.e)()+"/images/floating_rose1.png' width='50' height='50' alt='' />"),t+="</div>"}}],(n=null)&&ye(t.prototype,n),o&&ye(t,o),e}(),we=n(33),Se=n(16),ke=n(3),Ce=n(38),Ee=n(58),Te=n(41),Oe=n(44),Pe=n(46),Ae=n(23);function Re(e,t){switch(this.store=t,e.type){case"story":return this.setStories(e.data);case"story:add":return this.addStory(e.data);case"story:remove":return this.removeStory(e.data);case"story:like":return this.likeStory(e.data);case"story:comment":return this.commentStory(e.data);case"story:comment:like":return this.likeComment(e.data);case"story:comment:remove":return this.removeComment(e.data);case"story:view":return this.viewStory(e.data);default:return null}}Re.prototype.setStories=function(e){Se.a.setStories(this.store,e)},Re.prototype.addStory=function(e){e&&Se.a.onNewStory(this.store,e)},Re.prototype.removeStory=function(e){if(e.by&&e.owner==this.store.getState().mUser.reg_id){var t=this.store.getState().users.find((function(t){return t.id==e.by}));if(t){var n={id:Date.now(),user:t,story_id:e.id,message:"قام بحذف الستوري الخاص بك",title:"حذف",type:"story_remove"};this.store.dispatch(Object(L.a)(n)),ke.a.render(n,this.store)}}Se.a.onRemoveStory(this.store,e.id)},Re.prototype.likeStory=function(e){this.store.dispatch(Object(Ae.h)(e));var t=Ee.a.setStoryLikes(this.store,e.id);e.ip==this.store.getState().mUser.ip&&(e.liked?this.store.dispatch(Object(Pe.a)(e.id)):this.store.dispatch(Object(Pe.b)(e.id)),t&&t.find(".fa").toggleClass("liked",e.liked));var n=this.store.getState().users.find((function(t){return t.id==e.by}));if(n&&n.id!=this.store.getState().mUser.id&&e.story_user==this.store.getState().mUser.reg_id&&!Oe.a.isUserIgnored(this.store,n)&&e.liked){var r={id:Date.now(),user:n,story_id:e.id,message:"قام بالإعجاب بالستوري الخاص بك",title:"إعجاب",type:"story_liked"};this.store.dispatch(Object(L.a)(r)),ke.a.render(r,this.store)}},Re.prototype.commentStory=function(e){if(this.store.getState().stories.find((function(t){return t.id==e.story_id}))&&("string"==typeof e.comment.user&&(e.comment.user=this.store.getState().users.find((function(t){return t.id==e.comment.user}))),this.store.dispatch(Object(Ae.f)(e.story_id)),this.store.dispatch(Object(Ae.b)(e.comment)),Ce.a.renderComment(this.store,e.comment),Ce.a.incStoryCommentsCount(e.story_id),e.comment.user&&e.comment.user.id!=this.store.getState().mUser.id&&e.comment.storyOwnerId==this.store.getState().mUser.reg_id&&!Oe.a.isUserIgnored(this.store,e.comment.user))){var t={id:Date.now(),user:e.comment.user,comment:e.comment.comment,comment_id:e.comment.id,story_id:e.story_id,message:"قام بالتعليق على الستوري الخاص بك",title:"تعليق",type:"story_commented"};this.store.dispatch(Object(L.a)(t)),ke.a.render(t,this.store)}},Re.prototype.likeComment=function(e){var t=this.store.getState().stories.find((function(t){return t.id==e.story_id}));if(t){Ce.a.incCommentLikes(this.store,e.id,t.id);var n=this.store.getState().users.find((function(t){return t.id==e.user}));if(n&&e.id&&n.id!=this.store.getState().mUser.id&&e.comment_user==this.store.getState().mUser.reg_id&&!Oe.a.isUserIgnored(this.store,n)){var r={id:Date.now(),user:n,comment:e.comment,comment_id:e.id,story_id:e.story_id,message:"قام بالإعجاب بتعليقك على الستوري",title:"إعجاب",type:"story_comment_like"};this.store.dispatch(Object(L.a)(r)),ke.a.render(r,this.store)}}},Re.prototype.removeComment=function(e){this.store.getState().stories.find((function(t){return t.id==e.story_id}))&&(this.store.dispatch(Object(Ae.d)(e.story_id)),this.store.dispatch(Object(Ae.j)(e.id,e.story_id)),Ce.a.remove(e.id),Ce.a.decStoryCommentsCount(e.story_id))},Re.prototype.viewStory=function(e){var t=this.store.getState().stories.find((function(t){return t.id==e.story_id})),n=this.store.getState().users.find((function(t){return t.id==e.user}));if(t&&n){var r={id:e.id,story_id:e.story_id,time:Date.now(),user:{reg_id:n.user_id,name:n.name,avatar:n.avatar,role:n.role,icon:n.icon,nameColor:n.nameColor,nameBgColor:n.nameBgColor}};if(this.store.dispatch(Object(Ae.g)(e.story_id)),this.store.dispatch(Object(Ae.c)(r)),Te.a.renderView(this.store,r),Te.a.incStoryViewsCount(e.story_id),n.id!=this.store.getState().mUser.id&&!Oe.a.isUserIgnored(this.store,n)){var o={id:Date.now(),user:n,story_id:e.story_id,message:"قام بمشاهدة الستوري الخاص بك",title:"مشاهدة ستوري",type:"story_viewed"};this.store.dispatch(Object(L.a)(o)),ke.a.render(o,this.store)}}};var Me=Re,xe=n(13),Ue=n(10);function Ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var De=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"registerEvents",value:function(e){}},{key:"append",value:function(e){if(e.royalLogin){var t=Math.floor(4*Math.random())+1,n="<div class='royal_login_item' id='royal_login_item--"+e.reg_id+"' style='background-image: url(/images/royal_login_bg"+t+".png)'>";n+="<img class='royal_login_item__img' src='"+e.avatar+"'/>",n+="<p  class='royal_login_item__name'>"+I.a.render(e)+"</p>",n+="</div>",$("#royal_login_container").append(n),$("#royal_login_item--"+e.reg_id).animate({left:0},500,"linear",(function(){setTimeout((function(){$("#royal_login_item--"+e.reg_id).animate({left:-300},500,"linear",(function(){$("#royal_login_item--"+e.reg_id).remove()}))}),3e3)}))}}}],(n=null)&&Ie(t.prototype,n),r&&Ie(t,r),e}(),je=n(2);function Be(e,t){switch(this.store=t,e.type){case"NEW_USER":return this.newUser(e.data.user);case"USER_OUT":return this.userOut(e.data.user,e.data.force);case"NOTIFY_USER_OUT":return this.notifyUserOut(e.data.user);default:return null}}Be.prototype.newUser=function(e){var t=this.store.getState().users.filter((function(t){return t.reg_id==e.reg_id}))[0];t&&t.reg_id&&(this.store.dispatch(Object(d.b)(t)),this.store.dispatch(Object(xe.g)(t.id,e.id,e)),this.store.getState().currentConversation&&this.store.getState().currentConversation.id==t.id&&this.store.dispatch(Object(xe.f)(e))),this.store.dispatch(Object(d.a)(e)),this.store.dispatch({type:"REMOVE_OLD_USER_FROM_ROOM",oldSocketId:e.oldSocketId}),this.store.dispatch(l(e.id,null,e.room.id)),e.room&&this.store.getState().mUser.room&&e.room.id==this.store.getState().mUser.room.id&&!e.isMuted&&Ue.a.insert({icon:e.avatar,title:e.name,user:e,content:"هذا المستخدم قد دخل ",room:e.room,type:"JOIN_LEAVE"},this.store),U.a.updateUsersCout(this.store),T.a.setRooms(this.store),C.a.setUsers(this.store),De.append(e)},Be.prototype.userOut=function(e,t){if("string"!=typeof e||(e=this.store.getState().users.find((function(t){return t.id==e})))){if(window.ludoPlayers&&window.ludoPlayers.length){var n=window.ludoPlayers.filter((function(t){return t.user_id==e.id}))[0];n&&Q.a.userOut(this.store,n.color)}je.a.removeUserFromMic(this.store,e),this.store.dispatch(Object(d.i)({id:e.id,updates:{state:"state_out"}})),C.a.setUsers(this.store),(this.store.getState().settings.is_fixed_login_enabled||e.fixedLogin)&&e.reg_id&&!t||(this.store.dispatch(Object(d.b)(e)),this.store.dispatch(Object(xe.e)(e.id)),U.a.updateUsersCout(this.store),this.store.getState().requestedUser&&this.store.getState().requestedUser.id==e.id&&(this.store.dispatch(Object(d.c)(null)),$("#user_profile").modal("hide")),this.store.getState().currentConversation&&this.store.getState().currentConversation.id==e.id&&(this.store.dispatch(Object(xe.f)(null)),$("#chat_box_container").html("")),this.store.dispatch(Object(xe.d)(e.id)),U.a.updateConversationsCount(this.store),this.store.getState().currentConversation&&this.store.getState().currentConversation.id==e.id&&this.store.dispatch(Object(xe.f)(null)),this.store.getState().requestedUser&&this.store.getState().requestedUser.id==e.id&&this.store.dispatch(Object(d.c)(null)),e.room&&this.store.dispatch(l(e.id,e.room.id,null)),this.notifyUserOut(e),T.a.setRooms(this.store),C.a.setUsers(this.store))}},Be.prototype.notifyUserOut=function(e){if(e.room&&this.store.getState().mUser.room&&e.room.id==this.store.getState().mUser.room.id){var t=null;(t=e.isExcpeled?"(تم طرده من الدردشة)":e.isBanned?"(تم حظره من دخول الدردشة)":"(هذا المستخدم غادر الدردشة)")&&!this.store.getState().ignoredUsers.includes(e.id)&&Ue.a.insert({icon:e.avatar,title:e.name,user:e,content:t,type:"JOIN_LEAVE"},this.store);var n=this.store.getState().mUser.room.micUsers.filter((function(t){return t.user_id==e.id}))[0];n&&(this.store.getState().mUser.room.micUsers=this.store.getState().mUser.room.micUsers.filter((function(t){return t.user_id!=e.id})),je.a.removeUserFromMic(this.store,e,n.micId,!1,!0))}};var Le=Be;function Fe(e,t){switch(this.store=t,e.type){case"USER_JOINDED_ROOM":return this.userJoinedRoom(e.data);case"USER_EXPELED_FROM_ROOM":return this.userExcpeledFromRoom(e.data);case"USER_LEAVED_ROOM":return this.userLeavedRoom(e.data);case"PROFILE_ACTION_CHANGE_ROOM":return this.changeRoom(e.data);case"NEW_ROOM_CREATED":return this.addRoom(e.data);case"ROOMS_UPDATED":return this.updateRooms(e.data);case"ADMIN_ROOM_FLAG_UPDATED":return this.updateRoomFlag(e.data);case"ADMIN_ROOM_DELETED":return this.deleteRoom(e.data);case"room:mic:add":return this.addRoomMic(e.data);case"room:mic:remove":return this.removeRoomMic(e.data);default:return null}}Fe.prototype.userJoinedRoom=function(e){if("string"==typeof e.user){if(e.user=this.store.getState().users.find((function(t){return t.id==e.user})),!e.user)return;e.user.room=e.newRoom}e.user.id==this.store.getState().mUser.id&&(this.store.dispatch(Object(d.d)(e.user)),this.store.dispatch(g("rose")),be.toggle(this.store)),e.oldRoom&&(this.store.getState().rooms=this.store.getState().rooms.map((function(t){return t.id==e.oldRoom.id&&(t.micUsers=t.micUsers.filter((function(t){return t.user_id!=e.user.id}))),t}))),je.a.removeUserFromMic(this.store,e.user),je.a.refreshMics(this.store);var t=e.oldRoom?e.oldRoom.id:null,n=e.newRoom?e.newRoom.id:null,r=null,o=null,i=null;e.user.room&&this.store.getState().mUser.room&&e.user.room.id==this.store.getState().mUser.room.id&&(i=e.user.room,r=e.user.id==this.store.getState().mUser.id?"هذا المستخدم إنتقل إلى ":"هذا المستخدم قد دخل ",o="JOIN_LEAVE"),this.store.getState().mUser.room&&t==this.store.getState().mUser.room.id&&this.store.getState().mUser.id!=e.user.id&&(n?(i=e.newRoom,r="هذا المستخدم إنتقل إلى "):r="هذا المستخدم غادر الغرفة ",o="JOIN_LEAVE"),r&&o&&!e.user.isMuted&&!this.store.getState().ignoredUsers.includes(e.user.id)&&Ue.a.insert({icon:e.user.avatar,title:e.user.name,user:e.user,content:r,room:i,type:o},this.store),this.store.dispatch(Object(d.h)(e.user)),e.user.isMuted||(this.store.dispatch(l(e.user.id,t,n)),e.user.id!=this.store.getState().mUser.id&&(T.a.setRooms(this.store),C.a.setUsers(this.store))),e.newRoom&&e.newRoom.welcome&&e.user.id==this.store.getState().mUser.id&&Ue.a.insert({icon:e.newRoom.flag,content:e.newRoom.welcome,type:"ROOM_GREETING"},this.store)},Fe.prototype.userExcpeledFromRoom=function(e){if("string"!=typeof e.user||(e.user=this.store.getState().users.find((function(t){return t.id==e.user})),e.user)){e.oldRoom&&(this.store.getState().rooms=this.store.getState().rooms.map((function(t){return t.id==e.oldRoom.id&&(t.micUsers=t.micUsers.filter((function(t){return t.user_id!=e.user.id}))),t}))),je.a.removeUserFromMic(this.store,e.user),je.a.refreshMics(this.store);var t=e.oldRoom?e.oldRoom.id:null,n=null,r=null;this.store.getState().mUser.room&&t==this.store.getState().mUser.room.id&&this.store.getState().mUser.id!=e.user.id&&(t&&(n="(هذا المستخدم تم طرده من الغرفة)"),r="JOIN_LEAVE"),n&&r&&!e.user.isMuted&&!this.store.getState().ignoredUsers.includes(e.user.id)&&Ue.a.insert({icon:e.user.avatar,title:e.user.name,user:e.user,room:null,content:n,type:r},this.store),t&&e.user.id&&!e.user.isMuted&&(this.store.dispatch(l(e.user.id,t,null)),C.a.setUsers(this.store))}},Fe.prototype.userLeavedRoom=function(e){if("string"==typeof e.user){if(e.user=this.store.getState().users.find((function(t){return t.id==e.user})),!e.user)return;e.user.room=null}e.oldRoom&&(this.store.getState().rooms=this.store.getState().rooms.map((function(t){return t.id==e.oldRoom.id&&(t.micUsers=t.micUsers.filter((function(t){return t.user_id!=e.user.id}))),t}))),je.a.refreshMics(this.store),e.user.id==this.store.getState().mUser.id&&(this.store.dispatch(Object(d.d)(e.user)),je.a.resetAllMics());var t=e.oldRoom?e.oldRoom.id:null,n=null,r=null;this.store.getState().mUser.room&&t==this.store.getState().mUser.room.id&&this.store.getState().mUser.id!=e.user.id&&(t&&(n="(هذا المستخدم غادر الغرفة)"),r="JOIN_LEAVE"),n&&r&&!e.user.isMuted&&!this.store.getState().ignoredUsers.includes(e.user.id)&&Ue.a.insert({icon:e.user.avatar,title:e.user.name,user:e.user,room:null,content:n,type:r},this.store),this.store.dispatch(Object(d.h)(e.user)),t&&e.user.id&&!e.user.isMuted&&(this.store.dispatch(l(e.user.id,t,null)),C.a.setUsers(this.store)),T.a.setRooms(this.store)},Fe.prototype.changeRoom=function(e){if(("string"!=typeof e.user||(e.user=this.store.getState().users.find((function(t){return t.id==e.user})),e.user))&&!1===e.error){var t={id:Date.now(),user:e.user,type:"change_room",room:e.room,message:"تم نقلك إلى ",title:"تغيير الغرفة"};this.store.dispatch(Object(L.a)(t)),ke.a.render(t,this.store),je.a.setMics(this.store),C.a.setUsers(this.store),k.a.toggleInput(this.store)}},Fe.prototype.addRoom=function(e){e&&e.room&&(this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"ADD_ROOM",room:e}}(e.room)),T.a.setRooms(this.store))},Fe.prototype.updateRooms=function(e){var t=this;e&&Array.isArray(e.rooms)&&(e.rooms.forEach((function(e){var n=0,r=t.store.getState().rooms.find((function(t){return t.id==e.id}));if(r&&r.mics&&r.mics.length!=e.mics.length&&(n=e.mics.length-r.mics.length),t.store.getState().mUser.room&&t.store.getState().mUser.room.id==e.id)if(n>0){var o=e.mics.filter((function(e){return!r.mics.find((function(t){return t.id==e.id}))})).map((function(e){return e.id}));t.addRoomMic(t.store,{ids:o,room_id:e.id},!1)}else if(n<0){var i=e.mics.map((function(e){return e.id}));t.removeRoomMic(t.store,{keeped_mics:i,room_id:e.id},!0)}t.store.dispatch(function(e){return{type:"UPDATE_ROOM",room:e}}(e)),t.store.getState().mUser.room&&t.store.getState().mUser.room.id==e.id&&t.store.dispatch(Object(d.f)({room:e}))})),T.a.setRooms(this.store))},Fe.prototype.updateRoomFlag=function(e){e&&e.room&&(this.store.dispatch(function(e,t){return{type:"UPDATE_ROOM_FLAG",id:e,flag:t}}(e.room.id,e.room.flag)),T.a.setRooms(this.store))},Fe.prototype.deleteRoom=function(e){var t=this;e&&Array.isArray(e.ids)&&(e.ids.forEach((function(e){t.store.dispatch(function(e){return{type:"DELETE_ROOM",id:e}}(e))})),T.a.setRooms(this.store))},Fe.prototype.addRoomMic=function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.store.getState().rooms.find((function(t){return t.id==e.room_id}));r&&(!r.mics.length&&e.ids.length&&je.a.msSubscribe(this.store),e.ids.forEach((function(e){r.mics.find((function(t){return t.id==e}))||(n&&t.store.dispatch(f(r.id,e)),t.store.getState().mUser.room&&t.store.getState().mUser.room.id==r.id&&je.a.addMicItem(t.store,e))})))},Fe.prototype.removeRoomMic=function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.store.getState().rooms.find((function(t){return t.id==e.room_id}));r&&(r.mics.forEach((function(o){e.keeped_mics.indexOf(o.id)<0&&(n&&t.store.dispatch(p(r.id,o.id)),t.store.getState().mUser.room&&t.store.getState().mUser.room.id==r.id&&je.a.removeMicItem(t.store,o.id,r))})),e.keeped_mics.length||je.a.setMics(this.store))};var Ne=Fe,$e=n(43),qe=n.n($e),Ge=n(51);function Ve(e,t){switch(this.store=t,e.type){case"NEW_PUBLIC_MESSAGE":return this.onNewMessage(e.data);case"REMOVE_PUBLIC_MESSAGE":return this.removeMessage(e.data);case"NEW_AD":return this.onNewAd(e.data);case"SELF_MESSAGE":return this.onSelfMessage(e.data);case"PUBLIC_MESSAGE_CLEAR":return this.clear(e.data);default:return null}}Ve.prototype.onNewMessage=function(e){if(("string"!=typeof e.user||(e.user=this.store.getState().users.find((function(t){return t.id==e.user})),e.user))&&e&&e.user.room&&this.store.getState().mUser.room&&e.user.room.id==this.store.getState().mUser.room.id){if(this.store.getState().ignoredUsers.includes(e.user.id))return;Ue.a.insert({id:e.time,user:e.user,icon:e.user.avatar,title:e.user.name,content:e.message,reply:e.reply,type:"PUBLIC_MESSAGE"},this.store)}},Ve.prototype.removeMessage=function(e){e&&e.id&&Ue.a.remove(e.id)},Ve.prototype.onNewAd=function(e){if("string"==typeof e.user&&(e.user=this.store.getState().users.find((function(t){return t.id==e.user}))),e&&e.user){if(this.store.getState().ignoredUsers.includes(e.user.id))return;Ue.a.insert({id:e.time,user:e.user,icon:e.user.avatar,title:e.user.name,content:e.message,type:"AD"},this.store)}},Ve.prototype.onSelfMessage=function(e){e&&e.message&&(Ue.a.clearSelfMessages(),Ue.a.insert({id:qe()(),user:null,icon:null,title:e.message.title,content:e.message.msg,type:"SELF_MESSAGE"},this.store))},Ve.prototype.clear=function(e){this.store.dispatch(Object(Ge.a)()),S.a.clear(this.store)};var We=Ve;function He(e,t){switch(this.store=t,e.type){case"NEW_PRIVATE_MESSAGE":return this.onNewMessage(e.data);case"IS_WRITING":return this.isWriting(e.data);case"PRIVATE_MESSAGE_READ":return this.readPrivageMessage(e.data);default:return null}}He.prototype.onNewMessage=function(e){if(("string"!=typeof e.from||(e.from=this.store.getState().users.find((function(t){return t.id==e.from})),e.from))&&e.from&&e.from.id!=this.store.getState().mUser.id&&!this.store.getState().ignoredUsers.includes(e.from.id)){var t=e.from.id,n=this.store.getState().mUser,o=e.from,i=e.message,a=!(!this.store.getState().currentConversation||this.store.getState().currentConversation.id!=t);this.store.dispatch(Object(xe.a)(t,n,o,a,i)),a?pe.a.insert(i,o,this.store):pe.a.playNotification(this.store),U.a.updateConversationsCount(this.store),"conversations"==this.store.getState().currentPane&&E.a.renderConversations(this.store),a&&this.store.getState().socket.emit("req",Object(r.k)({type:"PRIVATE_MESSAGE_READ",data:{userID:e.from.id}}),(function(e){}))}},He.prototype.isWriting=function(e){("string"!=typeof e.from||(e.from=this.store.getState().users.find((function(t){return t.id==e.from})),e.from))&&e.from&&this.store.getState().currentConversation&&e.from.id==this.store.getState().currentConversation.id&&pe.a.insertIsWriting(e.from,this.store)},He.prototype.readPrivageMessage=function(e){if("string"!=typeof e.toUser||(e.toUser=this.store.getState().users.find((function(t){return t.id==e.toUser})),e.toUser)){var t=e.toUser.id,n=this.store.getState().mUser,r=e.toUser;this.store.dispatch(Object(xe.c)(t,n,r))}};var ze=He;function Ye(e,t){switch(this.store=t,e.type){case"PROFILE_ACTION_NOTIFY":return this.notify(e.data);case"PROFILE_ACTION_LIKE":return this.like(e.data);case"PROFILE_ACTION_GIFT":return this.gift(e.data);case"PROFILE_ACTION_REMOVE_GIFT":return this.removeGift(e.data);case"PROFILE_ACTION_CHANGE_DECORATION":return this.changeDecoration(e.data);case"PROFILE_ACTION_CONTROL_LIKES":return this.controlLikes(e.data);case"PROFILE_ACTION_ROOM_EXCPEL":return this.roomExcpel(e.data);case"PROFILE_ACTION_CHANGE_ROLE":return this.changeRole(e.data);case"PROFILE_LIKE_ALBUM_PHOTO":return this.photoLiked(e.data);default:return null}}Ye.prototype.notify=function(e){if("string"==typeof e.user&&(e.user=this.store.getState().users.find((function(t){return t.id==e.user}))),e.user&&e.message){var t={id:Date.now(),user:e.user,message:e.message,title:"تنبيه",type:"notify"};this.store.dispatch(Object(L.a)(t)),ke.a.render(t,this.store)}},Ye.prototype.like=function(e){if("string"==typeof e.user&&(e.user=this.store.getState().users.find((function(t){return t.id==e.user}))),e.user){var t={id:Date.now(),user:e.user,type:"like",message:null,title:"إعجاب"};this.store.dispatch(Object(L.a)(t)),this.store.dispatch(g("heart")),be.toggle(this.store),ke.a.render(t,this.store)}},Ye.prototype.gift=function(e){if("string"==typeof e.user&&(e.user=this.store.getState().users.find((function(t){return t.id==e.user}))),e.user){var t={id:Date.now(),user:e.user,type:"gift",message:e.message,title:"هدية"};this.store.dispatch(Object(L.a)(t)),this.store.dispatch(g("gift")),be.toggle(this.store),ke.a.render(t,this.store)}},Ye.prototype.removeGift=function(e){if("string"==typeof e.user&&(e.user=this.store.getState().users.find((function(t){return t.id==e.user}))),e.user){var t={id:Date.now(),user:e.user,type:"remove_gift",message:e.message,title:"سحب الهدية"};this.store.dispatch(Object(L.a)(t)),ke.a.render(t,this.store)}},Ye.prototype.changeDecoration=function(e){if("string"==typeof e.user&&(e.user=this.store.getState().users.find((function(t){return t.id==e.user}))),e.user){var t={id:Date.now(),user:e.user,type:"change_decoration",message:"تم تغيير زخرفة إسمك",title:"الزخرفة"};this.store.dispatch(Object(L.a)(t)),ke.a.render(t,this.store),A.a.updateDecoration(this.store)}},Ye.prototype.controlLikes=function(e){if("string"==typeof e.user&&(e.user=this.store.getState().users.find((function(t){return t.id==e.user}))),e.user){var t={id:Date.now(),user:e.user,type:"control_likes",message:"تم منحك "+e.likes+" إعجباب",title:"إعجاب"};this.store.dispatch(Object(L.a)(t)),this.store.dispatch(g("heart")),be.toggle(this.store),ke.a.render(t,this.store)}},Ye.prototype.roomExcpel=function(e){if("string"==typeof e.user&&(e.user=this.store.getState().users.find((function(t){return t.id==e.user}))),e.user){var t={id:Date.now(),user:e.user,room:e.oldRoom,type:"room_excpel",message:"تم طردك من الغرفة",title:"طرد"};this.store.dispatch(Object(L.a)(t)),ke.a.render(t,this.store),k.a.toggleInput(this.store),je.a.setMics(this.store)}},Ye.prototype.changeRole=function(e){if("string"!=typeof e.user||(e.user=this.store.getState().users.find((function(t){return t.id==e.user})),e.user)){var t={id:Date.now(),user:e.user,type:"change_role",message:"تمت ترقيتك إلى "+e.roleName,title:"ترقية"};this.store.dispatch(Object(L.a)(t)),ke.a.render(t,this.store)}},Ye.prototype.photoLiked=function(e){if("string"==typeof e.user&&(e.user=this.store.getState().users.find((function(t){return t.id==e.user}))),e&&e.user&&e.photo){var t={id:Date.now(),user:e.user,type:"photo_like",message:"قام بالإعجاب بصورتك",photo:e.photo,title:"إعجاب"};this.store.dispatch(Object(L.a)(t)),ke.a.render(t,this.store)}};var Je=Ye,Xe=n(25),Ke=n(47),Qe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"SET_ROLES",roles:e}},Ze=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"SET_ACTIONS",actions:e}};function et(e,t){switch(this.store=t,e.type){case"GREET_USER":return this.greetUser(e.data);case"USERS_STATE_UPDATED":return this.usersStateUpdated(e.data);case"USER_UPDATED":return this.userUpdated(e.data);case"USERS_UPDATED":return this.usersUpdated(e.data);case"LOGIN_BANNED":return this.loginBanned(e.data);case"PERMISSIONS_UPDATED":return this.permissionsUpdated(e.data);case"MIC_ICON":return this.setMicIcon(e.data);default:return null}}et.prototype.greetUser=function(e){var t=this;e&&e.messages&&e.messages.forEach((function(e){Ue.a.insert({icon:e.icon,title:e.title,content:e.content,titleColor:e.titleColor,contentColor:e.contentColor,backgroundColor:e.backgroundColor,type:"GREET_USER"},t.store)}))},et.prototype.usersStateUpdated=function(e){var t=this;e&&e.users&&e.users.forEach((function(e){t.userUpdated({id:e.id,updates:{state:e.state}})}))},et.prototype.userUpdated=function(e){this.store.dispatch(Object(d.i)(e)),this.store.dispatch(Object(d.g)(e)),this.store.dispatch(Object(Ge.b)(e)),this.store.dispatch(Object(xe.i)(e)),this.store.dispatch(Object(Xe.k)(e)),this.store.dispatch(Object(xe.h)(e)),e.id==this.store.getState().mUser.id&&this.store.dispatch(Object(d.f)(e.updates)),e.updates.state&&"state_out"==e.updates.state&&(this.store.dispatch(Object(xe.e)(e.id)),E.a.render(this.store),U.a.updateConversationsCount(this.store)),e.updates.background&&C.a.setUserBackground(e.id,e.updates.background,this.store),C.a.updateUser(e.id,this.store),Ue.a.updateUser(e.id,this.store),pe.a.updateUser(e.id,this.store),Ke.a.updateUser(e.id,this.store)},et.prototype.usersUpdated=function(e){var t=this;e&&Array.isArray(e.updates)&&e.updates.forEach((function(e){t.userUpdated(e)}))},et.prototype.loginBanned=function(e){var t={id:Date.now(),data:e,title:"دخول المحظورين",type:"login_banned"};this.store.dispatch(Object(L.a)(t)),ke.a.render(t,this.store)},et.prototype.permissionsUpdated=function(e){e&&(e.roles&&this.store.dispatch(Qe(e.roles)),e.actions&&this.store.dispatch(Ze(e.actions)),e.grantedSettings&&(Object(r.i)(e.grantedSettings,this.store.getState().grantedSettings)||(this.store.dispatch(_(e.grantedSettings)),A.a.refresh(this.store))))},et.prototype.setMicIcon=function(e){e.icon?window.micSpeakers.find(".mic-speakers--item").addClass("has-bg").css("background","url('/uploads/".concat(e.icon,"') no-repeat center center / cover")):window.micSpeakers.find(".mic-speakers--item").removeClass("has-bg").css("background","#FFFFFF")};var tt=et,nt=n(55);function rt(e,t){switch(this.store=t,e.type){case"POST_ADDED":return this.postAdded(e.data);case"POST_UPDATED":return this.postUpdated(e.data);case"POST_LIKED":return this.postLiked(e.data);case"POST_REMOVED":return this.postRemoved(e.data);case"YOUR_POST_IS_REMOVED":return this.yourPostIsRemoved(e.data);case"POST_COMMENTED":return this.postCommented(e.data);case"POST_COMMENT_LIKED":return this.postCommentLiked(e.data);case"POST_COMMENT_ADDED":return this.postCommentAdded(e.data);case"POST_COMMENT_DELETED":return this.postCommentDeleted(e.data);case"WALL_CLEAR":return this.clear(e.data);default:return null}}rt.prototype.postAdded=function(e){"string"==typeof e.user&&(e.user=this.store.getState().users.find((function(t){return t.id==e.user}))),this.store.getState().ignoredUsers.includes(e.user.id)||(this.store.dispatch(Object(Xe.a)(e,this.store.getState().settings.wall_msg_count)),"wall"!=this.store.getState().currentPane&&(this.store.dispatch(Object(Xe.d)()),U.a.updateWallCout(this.store)),O.a.addPost(e,this.store))},rt.prototype.postUpdated=function(e){this.store.dispatch(Object(Xe.j)(e)),O.a.updatePost(e.id,this.store)},rt.prototype.postLiked=function(e){if("string"==typeof e.user&&(e.user=this.store.getState().users.find((function(t){return t.id==e.user}))),e.user&&e.postId&&!this.store.getState().ignoredUsers.includes(e.user.id)){var t={id:Date.now(),user:e.user,message:"قام بالإعجاب بمنشورك",title:"إعجاب",type:"post_like"};this.store.dispatch(Object(L.a)(t)),ke.a.render(t,this.store)}},rt.prototype.postRemoved=function(e){this.store.dispatch(Object(Xe.f)(e.id)),O.a.removePost(e.id)},rt.prototype.yourPostIsRemoved=function(e){if("string"==typeof e.user&&(e.user=this.store.getState().users.find((function(t){return t.id==e.user}))),e.user&&e.postId&&!this.store.getState().ignoredUsers.includes(e.user.id)){var t={id:Date.now(),user:e.user,message:"قام بحذف بمنشورك",title:"إعجاب",type:"post_remove"};this.store.dispatch(Object(L.a)(t)),ke.a.render(t,this.store)}},rt.prototype.postCommented=function(e){if("string"==typeof e.user&&(e.user=this.store.getState().users.find((function(t){return t.id==e.user}))),e.user&&e.postId&&!this.store.getState().ignoredUsers.includes(e.user.id)){var t={id:Date.now(),user:e.user,comment:e.comment,comment_id:e.commentId,post_id:e.postId,message:"قام بالتعليق على منشورك",title:"تعليق",type:"post_commented"};this.store.dispatch(Object(L.a)(t)),ke.a.render(t,this.store),O.a.updatePost(e.postId,this.store)}},rt.prototype.postCommentLiked=function(e){if("string"==typeof e.user&&(e.user=this.store.getState().users.find((function(t){return t.id==e.user}))),e.user&&e.commentId&&!this.store.getState().ignoredUsers.includes(e.user.id)){var t={id:Date.now(),user:e.user,comment:e.comment,comment_id:e.commentId,message:"قام بالإعجاب بتعليقك",title:"إعجاب",type:"post_comment_like"};this.store.dispatch(Object(L.a)(t)),ke.a.render(t,this.store),nt.a.incCommentLikes(e.commentId)}},rt.prototype.postCommentAdded=function(e){"string"==typeof e.comment.user&&(e.comment.user=this.store.getState().users.find((function(t){return t.id==e.comment.user}))),this.store.dispatch(Object(Xe.e)({id:e.post_id})),O.a.updatePost(e.post_id,this.store),e.comment.time=Date.now(),nt.a.add(e.comment,this.store)},rt.prototype.postCommentDeleted=function(e){this.store.dispatch(Object(Xe.c)({id:e.post_id})),O.a.updatePost(e.post_id,this.store),nt.a.remove(e.id)},rt.prototype.clear=function(e){this.store.dispatch(Object(Xe.b)()),O.a.removeAllPosts(e.post_id,this.store)};var ot=rt;function it(e,t){switch(this.props=t,e.type){case"RESET_FACES":return this.setGifts(e.data);case"RESET_GIFTS":return this.setFaces(e.data);default:return null}}it.prototype.setGifts=function(e){e.faces&&this.props.dispatch(h(e.faces))},it.prototype.setFaces=function(e){e.gifts&&this.props.dispatch(m(e.gifts))};var at=it,st=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"SET_USER_BACKGROUNDS",backgrounds:e}},ct=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"SET_USER_AVATAR_BACKGROUNDS",backgrounds:e}};function ut(e,t){switch(this.store=t,e.type){case"RESET_USER_BACKGROUNDS":return this.setBackgrounds(e.data);case"RESET_USER_AVATAR_BACKGROUNDS":return this.setAvatarBackgrounds(e.data);default:return null}}ut.prototype.setBackgrounds=function(e){e.backgrounds&&this.store.dispatch(st(e.backgrounds))},ut.prototype.setAvatarBackgrounds=function(e){e.backgrounds&&this.store.dispatch(ct(e.backgrounds))};var dt=ut,lt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"SET_SETTINGS",settings:e}};function ft(e,t){switch(this.store=t,e.type){case"SET_SETTINGS":return this.setSettings(e.data);default:return null}}ft.prototype.setSettings=function(e){if(e&&e.settings){var t=e.settings[Object(r.l)()]?e.settings[Object(r.l)()]:e.settings;this.store.dispatch(lt(t)),Object(r.c)(t),U.a.toggleTV(this.store),H.a.update(this.store),O.a.update(this.store),W.update(this.store),W.toggle(this.store),C.a.toggleStories(this.store)}};var pt=ft,mt=n(52);function ht(e,t){switch(this.store=t,e.type){case"YOUCAM_LUDO_REQUESTED":return this.ludoRequested(e.data);case"YOUCAM_LUDO_REQUEST_ACCEPTED":return this.ludoRequestAccepted(e.data);case"YOUCAM_LUDO_REQUEST_REFUSED":return this.ludoRequestRefused(e.data);case"YOUCAM_LUDO_START_GAME":return this.ludoStartGame(e.data);case"YOUCAM_LUDO_DICE_CLICKED":return this.ludoDiceClicked(e.data);case"YOUCAM_LUDO_PLAYER_CLICKED":return this.ludoPlayerClicked(e.data);case"YOUCAM_LUDO_UPDATE_TURN":return this.ludoUpdateTurn(e.data);case"YOUCAM_LUDO_EXIT_GAME":return this.ludoExitGame(e.data);case"YOUCAM_LUDO_END_GAME":return this.ludoEndGame(e.data);default:return null}}ht.prototype.ludoRequested=function(e){if("string"==typeof e.user&&(e.user=this.store.getState().users.find((function(t){return t.id==e.user}))),e&&e.user){var t={id:Date.now(),data:e.user,user:e.user,color:e.color,title:"طلب لعب",type:"ludo_request"};this.store.dispatch(Object(L.a)(t)),ke.a.render(t,this.store)}},ht.prototype.ludoRequestAccepted=function(e){"string"==typeof e.user&&(e.user=this.store.getState().users.find((function(t){return t.id==e.user}))),e&&e.user&&($("#pre_youcam_ludo_modal__body__form--request-"+e.color+"__loader").attr("src","/images/check_ok.png").show(),$("#pre_youcam_ludo_modal__body__form--request-"+e.color).attr("src","/images/check_ok.png").hide(),$("#pre_youcam_ludo_modal__body__form--select-"+e.color).prop("disabled",!0),$("#pre_youcam_ludo_modal__body__form--select-red option[value='"+e.user.id+"']").prop("disabled",!0),$("#pre_youcam_ludo_modal__body__form--select-green option[value='"+e.user.id+"']").prop("disabled",!0),$("#pre_youcam_ludo_modal__body__form--select-yellow option[value='"+e.user.id+"']").prop("disabled",!0),$("#pre_youcam_ludo_modal__body__form--select-blue option[value='"+e.user.id+"']").prop("disabled",!0),$("#pre_youcam_ludo_modal__body__form img[src='/images/check_ok.png']").length>1&&$(".pre_youcam_ludo_modal__body__form__button--start").removeAttr("disabled"))},ht.prototype.ludoRequestRefused=function(e){if("string"==typeof e.user&&(e.user=this.store.getState().users.find((function(t){return t.id==e.user}))),e&&e.user){var t={id:Date.now(),data:e.user,user:e.user,title:"طلب لعب",type:"ludo_request_refused"};this.store.dispatch(Object(L.a)(t)),ke.a.render(t,this.store),$("#pre_youcam_ludo_modal__body__form--request-"+e.color+"__loader").hide(),$("#pre_youcam_ludo_modal__body__form--request-"+e.color).show()}},ht.prototype.ludoStartGame=function(e){if(e){var t=!1;window.mUserLudoColor||(t=!0),window.mUserLudoColor=e.color,window.ludoPlayers=e.players,window.ludoCurrentTurn=e.turn,t&&(Q.a.render(this.store),e.color||($("#youcam_ludo_container main").hide(),$("#youcam_ludo_container").append("<div id='show_ludo'><img src='/images/ludo_icon.jpeg' /></div>"),Q.a.onShowLudo(this.store)))}},ht.prototype.ludoDiceClicked=function(e){e&&e.color!=window.mUserLudoColor&&Q.a.rollDice(e.color,e.value)},ht.prototype.ludoPlayerClicked=function(e){if(e&&e.color!=window.mUserLudoColor){var t=$("#"+e.id);Q.a.movePlayer(t,e.value,this.store,e.color)}},ht.prototype.ludoUpdateTurn=function(e){e&&e.color!=window.mUserLudoColor&&Q.a.updateTurn(e.value)},ht.prototype.ludoExitGame=function(e){e&&e.color!=window.mUserLudoColor&&Q.a.userOut(this.store,e.color)},ht.prototype.ludoEndGame=function(e){e&&Q.a.gameEnded(this.store,e.color)};var _t=ht;function gt(e,t){switch(this.store=t,e.type){case"YOUCAM_UNO_REQUESTED":return this.unoRequested(e.data);case"YOUCAM_UNO_REQUEST_ACCEPTED":return this.unoRequestAccepted(e.data);case"YOUCAM_UNO_REQUEST_REFUSED":return this.unoRequestRefused(e.data);case"YOUCAM_UNO_START_GAME":return this.unoStartGame(e.data);case"YOUCAM_UNO_PLAYER_OUT":return this.unoPlayerOut(e.data);case"YOUCAM_UNO_CARD_PLAYED":return this.unoCardPlayed(e.data);case"YOUCAM_UNO_CARDS_DRAWED":return this.unoCardsDrawed(e.data);case"YOUCAM_UNO_MIC_LEAVED":return this.unoMicLeaved(e.data);default:return null}}gt.prototype.unoRequested=function(e){if("string"==typeof e.user&&(e.user=this.store.getState().users.find((function(t){return t.id==e.user}))),e&&e.user){var t={id:Date.now(),data:e.user,user:e.user,number:e.number,title:"طلب لعب",type:"uno_request"};this.store.dispatch(Object(L.a)(t)),ke.a.render(t,this.store,!0)}},gt.prototype.unoRequestAccepted=function(e){"string"==typeof e.user&&(e.user=this.store.getState().users.find((function(t){return t.id==e.user}))),e&&e.user&&(window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--request-pl"+e.number+"__loader").attr("src","/images/check_ok.png").show(),window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--request-pl"+e.number).attr("src","/images/check_ok.png").hide(),window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--select-pl"+e.number).prop("disabled",!0),window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--select-pl1 option[value='"+e.user.id+"']").prop("disabled",!0),window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--select-pl2 option[value='"+e.user.id+"']").prop("disabled",!0),window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--select-pl3 option[value='"+e.user.id+"']").prop("disabled",!0),window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form img[src='/images/check_ok.png']").length>0&&window.youcamUnoContainer.find(".pre_youcam_uno_modal__body__form__button--start").removeAttr("disabled"),this.clearRequestsTimeout(e.number))},gt.prototype.unoRequestRefused=function(e){if("string"==typeof e.user&&(e.user=this.store.getState().users.find((function(t){return t.id==e.user}))),e&&e.user){var t={id:Date.now(),data:e.user,user:e.user,title:"طلب لعب",type:"uno_request_refused"};this.store.dispatch(Object(L.a)(t)),ke.a.render(t,this.store),window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--request-pl"+e.number+"__loader").hide(),window.youcamUnoContainer.find("#pre_youcam_uno_modal__body__form--request-pl"+e.number).show(),this.clearRequestsTimeout(e.number)}},gt.prototype.unoStartGame=function(e){te.a.startGame(this.store,e)},gt.prototype.unoPlayerOut=function(e){te.a.onPlayerOut(this.store,e.id,e.name)},gt.prototype.unoCardPlayed=function(e){te.a.cardPlayed(this.store,e)},gt.prototype.unoCardsDrawed=function(e){te.a.cardsDrawed(this.store,e)},gt.prototype.unoMicLeaved=function(e){var t=this.store.getState().users.find((function(t){return t.id==e.user}));t&&(te.a.setMicOff(this.store,t.id),je.a.removeUnoUserFromMic(this.store,t,e.micId))},gt.prototype.clearRequestsTimeout=function(e){clearTimeout(window["UnoRequestPl"+e+"Timeout"]),delete window["UnoRequestPl"+e+"Timeout"]};var vt=gt,yt=n(53),bt=n(40),wt=n(54);function St(e,t){switch(this.store=t,e.type){case"CALL_REQUESTED":return this.callRequested(e.data);case"CALL_REQUEST_CANCELLED":return this.callRequestCancelled(e.data);case"CALL_REQUEST_ACCEPTED":return this.callRequestAccepted(e.data);default:return null}}St.prototype.callRequested=function(e){if(e&&e.caller){this.store.dispatch(Object(bt.a)(!0));var t={user:e.caller,dialogType:"call-received",statusClass:"success",status:"لديك إتصال الآن..."};this.store.dispatch(Object(yt.a)(t)),wt.a.render(this.store,t)}},St.prototype.callRequestCancelled=function(e){this.store.dispatch(Object(bt.a)(!1)),this.store.dispatch(Object(yt.a)(null)),wt.a.close(),this.store.getState().webrtc&&(this.store.getState().webrtc.leaveRoom(),this.store.getState().webrtc.stopLocalVideo(),this.store.getState().webrtc.releaseGroup(),this.store.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"SET_RADIO_CONNECTION_READY",radioConnectionReady:e}}(!1)))},St.prototype.callRequestAccepted=function(e){this.store.dispatch(Object(yt.a)({user:e.caller,dialogType:"call-sent",statusClass:"success",status:"بدأ المكالمة"})),wt.a.onCallAccepted()};var kt=St;function Ct(e,t){switch(this.store=t,e.type){case"BOT_BRB_START_COUNTDOWN":return this.startCountdown(e.data);case"BOT_BRB_PAUSED":return this.paused(e.data);case"BOT_BRB_STOPPED":return this.stopped(e.data);case"BOT_BRB_ENDED":return this.ended(e.data);case"BOT_BRB_RIGHT_ANSWER":return this.rightScore(e.data);default:return null}}Ct.prototype.startCountdown=function(e){e&&e.message&&e.room_id&&this.store.getState().mUser.room&&this.store.getState().mUser.room.id==e.room_id&&Ue.a.insert({id:qe()(),user:null,icon:null,title:"إستعداد لبدء البوت",content:e.message,type:"BOT_BRB_MESSAGE"},this.store)},Ct.prototype.paused=function(e){e&&e.room_id&&this.store.getState().mUser.room&&this.store.getState().mUser.room.id==e.room_id&&Ue.a.insert({id:qe()(),user:null,icon:null,title:"إيقاف مؤقت",content:"تم إيقاف البوت بشكل مؤقت",type:"BOT_BRB_MESSAGE"},this.store)},Ct.prototype.stopped=function(e){e&&e.room_id&&this.store.getState().mUser.room&&this.store.getState().mUser.room.id==e.room_id&&Ue.a.insert({id:qe()(),user:null,icon:null,title:"إيقاف البوت",content:"تم إيقاف البوت",type:"BOT_BRB_MESSAGE"},this.store)},Ct.prototype.ended=function(e){if(e&&e.room_id){if(e.winner&&e.winner.id==this.store.getState().mUser.id){var t={id:Date.now(),user:null,message:"مبروك الفوز في مسابقة أطرد خصمك, إضعط على أي شخص لطرده من الغرفة",title:"مبروك الفوز",type:"notify"};this.store.dispatch(Object(L.a)(t)),ke.a.render(t,this.store)}Ue.a.insert({id:qe()(),user:e.winner,title:"",content:e.winner?"مبروك فوز هذا المتسابق":"إنتهت المسابقة بدون فائز",type:"BOT_BRB_MESSAGE"},this.store)}},Ct.prototype.rightScore=function(e){("string"!=typeof e.user||(e.user=this.store.getState().users.find((function(t){return t.id==e.user})),e.user))&&e&&e.room_id&&e.user&&this.store.getState().mUser.room&&this.store.getState().mUser.room.id==e.room_id&&Ue.a.insert({id:qe()(),user:e.user,title:"",content:"عدد النقاط "+e.num_points,type:"BOT_BRB_MESSAGE"},this.store)};var Et=Ct;function Tt(e,t){switch(this.store=t,e.type){case"FILTER_SEND_NOTIFICATION":return this.sendNotification(e.data);default:return null}}Tt.prototype.sendNotification=function(e){if("string"==typeof e.user&&(e.user=this.store.getState().users.find((function(t){return t.id==e.user}))),e.user&&e.word){var t="denied"==e.word.type?"كلمة ممنوعة":"كلمة مراقبة",n={id:Date.now(),user:e.user,title:t,word:e.word,type:"world_filter_notification"};this.store.dispatch(Object(L.a)(n)),ke.a.render(n,this.store)}};var Ot=Tt;function Pt(e,t){switch(this.store=t,e.type){case"BROADCAST_LIVE_STARTED":return this.broadcastLiveStarted(e.data);case"BROADCAST_LIVE_ENDED":return this.broadcastLiveEnded(e.data);default:return null}}Pt.prototype.broadcastLiveStarted=function(e){var t=this;e&&e.id&&setTimeout((function(){fe.renderButton(t.store,e.id)}),5e3)},Pt.prototype.broadcastLiveEnded=function(e){e&&e.id&&fe.close(this.store,$(".broadcast_live_box").first(),!0)};var At=Pt;function Rt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Mt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"handleEvents",value:function(t,n){switch(t.type){case"AUDIO_GALLERY_ITEMS":return e.setItems(n,t.data);default:return null}}},{key:"setItems",value:function(e,t){t&&t.items&&J.a.setItems(e,t.items)}}],(n=null)&&Rt(t.prototype,n),r&&Rt(t,r),e}();function xt(e){return(xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var It=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"registerEvents",value:function(t){e.onClick(t)}},{key:"initUpdateTimeHandler",value:function(){setInterval((function(){for(var e=document.getElementsByClassName("time"),t=0;t<e.length;t++){var n=e[t];n.textContent=Object(r.y)(n.dataset.time)}}),6e4)}},{key:"registerSocketEvents",value:function(e){e.getState().socket.on("res",(function(t){(t=Object(r.g)(t))&&"object"==xt(t)&&"string"==typeof t.type&&"object"==xt(t.data)&&("object"==xt(t.data)&&Object(r.r)(t.data),new Le(t,e),new Ne(t,e),new We(t,e),new ze(t,e),new Je(t,e),new tt(t,e),new ot(t,e),new at(t,e),new dt(t,e),new pt(t,e),new Ot(t,e),e.getState().features.FT_IS_STORIES_ENABLED&&new Me(t,e),e.getState().features.FT_IS_CALLS_ENABLED&&new kt(t,e),e.getState().features.FT_IS_LUDO_ENABLED&&new _t(t,e),e.getState().features.FT_IS_UNO_ENABLED&&new vt(t,e),e.getState().features.FT_IS_BROADCAST_LIVE_ENABLED&&new At(t,e),e.getState().features.FT_IS_BOT_BRB_ENABLED&&new Et(t,e),e.getState().features.FT_IS_AUDIO_GALLERY_ENABLED&&Mt.handleEvents(t,e),e.getState().features.FT_IS_MIC_ENABLED&&mt.a.handleEvents(t,e))}))}},{key:"registerDOMEvents",value:function(t){e.registerEvents(t),S.a.registerEvents(t),ve.a.registerEvents(t),k.a.registerEvents(t),U.a.registerEvents(t),C.a.registerEvents(t),M.a.registerEvents(t),T.a.registerEvents(t),D.a.registerEvents(t),O.a.registerEvents(t),W.registerEvents(t),we.a.registerEvents(t),A.a.registerEvents(t),he.registerEvents(t),R.a.registerEvents(t),G.registerEvents(t),Y.registerEvents(t),J.a.registerEvents(t),H.a.registerEvents(t),be.registerEvents(t),Se.a.registerEvents(t)}},{key:"onClick",value:function(e){$("#chat").unbind("click").on("click",(function(t){var n=document.querySelector("#chat__body__message-input__face"),r=document.querySelector("#chat_box__footer__smile"),o=document.querySelector("#chat__body__wall_pane__form__attach__face"),i=document.querySelector("#wall_comments__attach__face");n!==t.target&&e.dispatch(Object(v.a)(!1)),r!==t.target&&e.dispatch(Object(y.a)(!1)),o!==t.target&&e.dispatch(Object(b.a)(!1)),i!==t.target&&e.dispatch(Object(w.a)(!1)),ve.a.toggle(e)}))}},{key:"loadElementsToMemory",value:function(){window.publicMessagesContainer=$("#chat__body__messages_container"),window.usersPane=$("#chat__body__users-pane"),window.conversationsPane=$("#chat__body__conversations_pane"),window.roomsPane=$("#chat__body__rooms_pane"),window.wallPane=$("#chat__body__wall_pane"),window.wallCreatorPane=$("#chat__body__wall_creator_pane"),window.ignoredUsersPane=$("#chat__body__ignored-users-pane"),window.notificationsPane=$("#chat__body__notifications-pane"),window.livePane=$("#chat__body__live-pane"),window.settingsPane=$("#chat__body__settings_pane"),window.othersPane=$("#chat__body__others-pane"),window.youcamUnoContainer=$("#youcam_uno_container"),window.storyBoard=$("#story-board"),window.chatFooter=$("#chat__footer")}},{key:"render",value:function(t){window.consumedData=0,clearInterval(navigator.ycinterval),delete navigator.ycinterval;var n="<div id='chat'>";n+=ge.render(t),n+=U.a.render(t),n+="<div id='tv_box'></div>",n+="<div id='user_profile_container'></div>",n+="<div id='wall_comments_container'></div>",n+="<div id='create_room_container'></div>",n+="<div id='edit_room_container'></div>",n+="<div id='chat_box_container'></div>",n+="<div id='popup_container'></div>",n+="<div id='youcam_ludo_container'></div>",n+="<div id='youcam_uno_container'></div>",n+="<div id='broadcast_live_container'></div>",n+="<div id='call_container'></div>",n+="<div id='royal_login_container'></div>",n+="<div id='manage_bot_brb_container'></div>",n+=be.render(t),n+='<audio autoplay id="calls-audio"></audio>',n+="</div>",$("#app").html(n),$(".crisp-client").hide(),window.app=$("#app"),window.audioGalleryPane=$("#audio-gallery-pane"),e.loadElementsToMemory(),U.a.toggleTV(t),U.a.updateConversationsCount(t),O.a.update(t),j.a.render(t),e.registerSocketEvents(t),e.registerDOMEvents(t),e.initUpdateTimeHandler(),C.a.setContainerHeight(t),Se.a.getStories(t),je.a.render(t),Object(r.q)(),window.onbeforeunload=function(){if(window.confirmOnExit)return"هل أنت متأكد من مغادرة الدردشة؟"},window.callsAudio=document.querySelector("#calls-audio")}}],(n=null)&&Ut(t.prototype,n),o&&Ut(t,o),e}(),Dt=n(67),jt=n(104),Bt=n.n(jt),Lt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:"SET_FEATURES",features:e}},Ft=n(26);function Nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $t=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"setUsersCount",value:function(e){$(".users-count-label .count.online").text(e)}},{key:"incUsersCount",value:function(){var e=$(".users-count-label .count.online"),t=parseInt(e.text());e.text(t+1)}},{key:"decUsersCount",value:function(){var e=$(".users-count-label .count.online"),t=parseInt(e.text());isNaN(t)||!t?e.text(0):e.text(t-1)}},{key:"render",value:function(e){var t=e.getState(),n="<div class='users-count-label' >";return n+=Ht.renderConnectionState(e),n+="<p class='label-count label label-primary'><span class='fa fa-user'><span class='count online'>"+t.tempOnlineUsers.length+"</span></span></p>",n+="</div>"}}],(n=null)&&Nt(t.prototype,n),r&&Nt(t,r),e}();function qt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Gt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"registerEvents",value:function(t){var n=[];t.getState().socket.on("conn",(function(o){o=Object(r.g)(o),e.updateUsers(t,o,n)||(n=o.users,t.dispatch(Lt(o.features)),e.setUsers(t,n),$t.setUsersCount(o.users_count||n.length),$("img").on("contextmenu",(function(){return!1})))})),t.getState().socket.on("FTR_UPDATE",(function(e){t.dispatch(Lt(e))}))}},{key:"updateUsers",value:function(t,n,r){return n.uin?(e.addUser(t,n.uin,r),!0):!!n.uout&&(e.removeUser(t,n.uout,r),!0)}},{key:"removeUser",value:function(e,t,n){n=n.filter((function(e){return e.id!=t})),$("#online_users .chat_pane__user_item[data-id='"+t+"']").remove(),$t.decUsersCount()}},{key:"addUser",value:function(t,n,r){r.push(n),r=e.sortUsers(r);var o=$("#online_users"),i=r.findIndex((function(e){return e.id==n.id}));0==i?$(Ft.a.render(n,!1,t)).css("left","500px").prependTo(o).delay(10).animate({left:"0"}):i==r.length-1?$(Ft.a.render(n,!1,t)).css("left","500px").appendTo(o).delay(10).animate({left:"0"}):o.find(".chat_pane__user_item:nth-child("+i+")").after(Ft.a.render(n,!1,t)),$t.incUsersCount()}},{key:"setUsers",value:function(t,n){var r=$("#online_users");e.sortUsers(n).forEach((function(e,n){var o=10*(n+1);$(Ft.a.render(e,!1,t)).css("left","500px").appendTo(r).delay(o).animate({left:"0"})}))}},{key:"sortUsers",value:function(e){return e.sort((function(e,t){return e.power>t.power||e.power==t.power&&e.id<t.id?-1:1}))}},{key:"destroy",value:function(e){e.getState().socket.removeEventListener("conn"),e.dispatch({type:"CLEAR_TEMP_ONLINE_USERS"})}},{key:"render",value:function(t){return e.registerEvents(t),"<div id='online_users'></div>"}}],(n=null)&&qt(t.prototype,n),o&&qt(t,o),e}();function Vt(e){return(Vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ht=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t}var t,n,o;return t=e,o=[{key:"registerEvents",value:function(t){e.registerConnectionState(t),$(".react-tabs__tab").unbind("click").on("click",(function(e){$(this).siblings().removeClass("react-tabs__tab--selected"),$(this).addClass("react-tabs__tab--selected")})),$("#guest-form").on("submit",(function(n){e.onGuestLogin(n,t),e.loopAudio()})),$("#login-form").on("submit",(function(n){e.onMemberLogin(n,t),e.loopAudio()})),$("#register-form").on("submit",(function(n){e.onRegister(n,t)})),$("#login-form__hidden-toggle").unbind("click").on("click",(function(e){$(this).toggleClass("checked"),$("#login-form__hidden-checkbox").prop("checked",$(this).hasClass("checked"))})),Object(r.p)("mun")&&($("#react-tabs-1 a").removeClass("active"),$("#react-tabs-1").removeClass("react-tabs__tab--selected"),$("#guest").removeClass("active").removeClass("show"),$("#react-tabs-2 a").addClass("active"),$("#react-tabs-2").addClass("react-tabs__tab--selected"),$("#member").addClass("active").addClass("show")),location.search.length>1&&($("#guest-form__name").val(location.search.replace("?","")),$("#guest-form__submit").trigger("click"))}},{key:"registerConnectionState",value:function(t){var n=t.getState().socket;n.on("connect",(function(){$("#connection-state-on").css("display","inline"),$("#connection-state-off").css("display","none"),je.a.init(t),e.initPeer(t)})),n.on("disconnect",(function(){window.confirmOnExit=!1,$("#connection-state-off").css("display","inline"),$("#connection-state-on").css("display","none"),location.reload()}))}},{key:"initPeer",value:function(e){window.outgoinCall={},window.outgoinStream={},window.incomingCall=null,window.peer=new Bt.a(e.getState().socket.id,{host:"peerjs.chat-host.net",port:9e3,secure:!0,config:{iceServers:[{url:"stun:stun.chat-host.net:5349"},{url:"stun:stun.chat-host.net"},{url:"turn:turn.chat-host.net:5349",username:"gN3yO0cF0uM6mQ2yU4tY3lR9vQ3qA9uA",credential:"fE7lY5-oR5tU0-fE5qY1-oE1oL5-pA5pU0"},{url:"turn:turn.chat-host.net",username:"gN3yO0cF0uM6mQ2yU4tY3lR9vQ3qA9uA",credential:"fE7lY5-oR5tU0-fE5qY1-oE1oL5-pA5pU0"}]}})}},{key:"onGuestLogin",value:function(t,n){t.preventDefault();var o=t.target.name.value,i=(Object(r.g)(Object(r.p)("status"),!0),Object(r.g)(Object(r.p)("statusColor"),!0),Object(r.g)(Object(r.p)("fontColor"),!0),Object(r.g)(Object(r.p)("nameColor"),!0),Object(r.g)(Object(r.p)("nameBgColor"),!0),Object(r.g)(Object(r.p)("fontSize"),!0),Object(r.g)(Object(r.p)("avatar"),!0),Object(r.g)(Object(r.p)("isPrivateBipEnabled"),!0),{type:"GUEST_LOGIN",data:{name:o}});if(o.length>n.getState().settings.username_guest_length)return $(".tabs-form-error.error").show().text("إسم الزائر لا يجب أن يتعدى "+n.getState().settings.username_guest_length+" حرف");e.hideFormAlerts(),$("form button").attr("disabled","disabled"),n.getState().socket.emit("req",Object(r.k)(i),(function(t){e.handleLoginResponse(Object(r.g)(t),!0,n)}))}},{key:"onMemberLogin",value:function(t,n){t.preventDefault();var o={type:"MEMBER_LOGIN",data:{name:t.target.name.value,password:t.target.password.value,hidden:t.target.hidden.checked}};e.hideFormAlerts(),$("form button").attr("disabled","disabled"),n.getState().socket.emit("req",Object(r.k)(o),(function(t){e.handleLoginResponse(Object(r.g)(t),!1,n)}))}},{key:"onRegister",value:function(t,n){t.preventDefault();var o=t.target.name.value,i=t.target.password.value,a={type:"REGISTER_MEMBER",data:{name:o,password:i}};if(o.length>n.getState().settings.username_register_length)return $(".tabs-form-error.error").show().text("إسم العضو لا يجب أن يتعدى "+n.getState().settings.username_register_length+" حرف");e.hideFormAlerts(),$("form button").attr("disabled","disabled"),n.getState().socket.emit("req",Object(r.k)(a),(function(e){e=Object(r.g)(e),$("form button").removeAttr("disabled");var t=e.error,a=e.message;t?ke.a.render({id:Date.now(),message:a,title:"تنبيه",type:"login_res"},n):($(".tabs-form-error.success").show().text(a),$("#react-tabs-3 a").removeClass("active"),$("#react-tabs-3").removeClass("react-tabs__tab--selected"),$("#register").removeClass("active").removeClass("show"),$("#react-tabs-2 a").addClass("active"),$("#react-tabs-2").addClass("react-tabs__tab--selected"),$("#member").addClass("active").addClass("show")),e.error||($("#login-form__name").val(o),$("#login-form__password").val(i))}))}},{key:"handleLoginResponse",value:function(t,n,o){var i=!1,a=null;if("object"==Vt(t))if(i=!!t.error,a=t.message,!1===i&&t.user){for(var s in $(".tabs-form-error.success").show().text(a),je.a.initMic(t.rtpCapabilities),t.privateMessages)e.readPrivateMessage(o,t.privateMessages[s]);o.dispatch(Ze(t.actions)),o.dispatch(Qe(t.roles)),o.dispatch(Object(d.d)(t.user)),o.dispatch(Object(d.e)(t.users)),o.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:"SET_ROOMS",rooms:e}}(t.rooms)),o.dispatch(m(t.gifts)),o.dispatch(h(t.faces)),o.dispatch(_(t.grantedSettings)),o.dispatch(Object(Pe.c)(t.likedStories)),o.dispatch(Object(Dt.b)(t.viewedStories)),o.dispatch(st(t.userBackgrounds)),o.dispatch(ct(t.userAvatarBackgrounds)),e.openChat(c,o),Ue.a.insert({icon:t.user.avatar,title:t.user.name,room:t.user.room,user:t.user,content:"هذا المستخدم قد دخل ",type:"JOIN_LEAVE"},o),t.user.room&&t.user.room.welcome&&Ue.a.insert({icon:t.user.room.flag,content:t.user.room.welcome,type:"ROOM_GREETING"},o),o.dispatch(g("rose"));var c=24;n?(Object(r.w)("gun",Object(r.k)(t.user.name,!0)),c=Object(r.g)(Object(r.p)("fontSize"),!0)):(Object(r.w)("mun",Object(r.k)(t.cookie.name,!0)),Object(r.w)("mup",Object(r.k)(t.cookie.password,!0)),c=t.user.fontSize),t.user.royalLogin&&De.append(t.user),t.user.room.micUsers.forEach((function(e){je.a.setUserOnMic(o,o.getState().users.filter((function(t){return t.id==e.user_id}))[0],e.micId)})),$("body").attr("id","room-"+o.getState().mUser.room.id),o.getState().mUser.reg_id&&$("body").attr("data-user",o.getState().mUser.reg_id),t.isSubscriptionEnded&&ke.a.render({id:Date.now(),message:"تم إنتهاء إشتراكك, الرجاء مراسلة الإدارة للتجديد",title:"تنبيه",type:"login_res"},o),o.getState().mUser.room.ludoGameState.players&&(window.ludoPlayers=o.getState().mUser.room.ludoGameState.players,window.ludoCurrentTurn=o.getState().mUser.room.ludoGameState.currentTurn,Q.a.render(o,null,o.getState().mUser.room.ludoGameState),$("#youcam_ludo_container main").hide(),$("#youcam_ludo_container").append("<div id='show_ludo'><img src='/images/ludo_icon.jpeg' /></div>"),Q.a.onShowLudo(o)),t.broadcastLive&&fe.renderButton(o,t.broadcastLive)}else ke.a.render({id:Date.now(),message:a,title:"تنبيه",type:"login_res"},o);$("form button").removeAttr("disabled")}},{key:"readPrivateMessage",value:function(e,t){if(t.from&&t.from.id!=e.getState().mUser.id&&!e.getState().ignoredUsers.includes(t.from.id)){var n=t.from.id,o=e.getState().mUser,i=t.from,a=t.message,s=!(!e.getState().currentConversation||e.getState().currentConversation.id!=n);e.dispatch(Object(xe.a)(n,o,i,s,a)),s?pe.a.insert(a,i,e):pe.a.playNotification(e),"conversations"==e.getState().currentPane&&E.a.renderConversations(e),s&&e.getState().socket.emit("req",Object(r.k)({type:"PRIVATE_MESSAGE_READ",data:{userID:t.from.id}}),(function(e){}))}}},{key:"loopAudio",value:function(){var e=new Audio("no_sound.mp3");e.volume=.001,"boolean"==typeof e.loop?e.loop=!0:e.addEventListener("ended",(function(){this.currentTime=0,this.play()}),!1),e.play()}},{key:"hideFormAlerts",value:function(){$(".tabs-form-error").hide()}},{key:"openChat",value:function(e,t){Gt.destroy(t),It.render(t),document.querySelector("html").style.fontSize=e+"px"}},{key:"renderCopyrights",value:function(){return'<p id="youcam-copyrights">Copyright © '+(new Date).getFullYear()+' <a title="يوكام هوست" href="https://www.chat-host.net/">يوكام هوست</a>. All Rights Reserved</p>'}},{key:"renderConnectionState",value:function(){return"<div id='connection_container'><span class='connected' id='connection-state-on' style='display: none;'>متصل</span><span id='connection-state-off'>غير متصل</span></div>"}},{key:"render",value:function(){var e="<div class='react-tabs'>";return e+="<ul class='nav nav-tabs react-tabs__tab-list' id='tabs' role='tablist'>",e+="<li class='nav-item react-tabs__tab react-tabs__tab--selected' id='react-tabs-1'>",e+="<a class='nav-link active' data-toggle='tab' href='#guest' role='tab' aria-controls='guest' aria-selected='true'><span class='fa fa-user'></span>دخول الزوار</a>",e+="</li>",e+="<li class='nav-item react-tabs__tab' id='react-tabs-2'>",e+="<a class='nav-link' data-toggle='tab' href='#member' role='tab' aria-controls='member' aria-selected='false'><span class='fa fa-user'></span>دخول الأعضاء</a>",e+="</li>",e+="<li class='nav-item react-tabs__tab' id='react-tabs-3'>",e+="<a class='nav-link' data-toggle='tab' href='#register' role='tab' aria-controls='register' aria-selected='false'><span class='fa fa-user'></span>تسجيل عضوية</a>",e+="</li>",e+="</ul>",e+="<div class='tab-content' id='tabs-content'>",e+="<div class='tab-pane fade show active' id='guest' role='tabpanel' aria-labelledby='home-tab'>",e+="<form id='guest-form'>",e+="<div>",e+="<input type='text' name='name' class='corner border' id='guest-form__name' value='"+Object(r.g)(Object(r.p)("gun"),!0)+"' placeholder='أكتب الإسم المستعار' />",e+="<button id='guest-form__submit' class='btn btn-primary buttonload' ><i class='fa fa-circle-o-notch fa-spin'></i>دخول</button>",e+="</div>",e+="</form>",e+="</div>",e+="<div class='tab-pane fade' id='member' role='tabpanel' aria-labelledby='profile-tab'>",e+="<form id='login-form'>",e+="<div>",e+="<input type='text' name='name' class='border corner' id='login-form__name' value='"+Object(r.g)(Object(r.p)("mun"),!0)+"' placeholder='أكتب إسم العضو' />",e+="<input autocomplete='off' type='password' name='password' class='border corner' id='login-form__password' value='"+Object(r.g)(Object(r.p)("mup"),!0)+"' placeholder='أكتب كلمة المرور' />",e+="<button id='login-form__submit' class='border-color btn btn-primary border buttonload' ><i class='fa fa-circle-o-notch fa-spin'></i>دخول</button>",e+="<input type='checkbox' name='hidden' id='login-form__hidden-checkbox' style='display: none;' />",e+="<span id='login-form__hidden-toggle' class='btn fa fa-eye'></span>",e+="</div>",e+="</form>",e+="</div>",e+="<div class='tab-pane fade' id='register' role='tabpanel' aria-labelledby='contact-tab'>",e+="<form id='register-form'>",e+="<div>",e+="<input type='text' class='border corner' id='register-form__name' name='name' placeholder='أكتب إسم العضو'/>",e+="<input autoComplete='OFF' autocomplete='new-password' type='password' name='password' class='border corner' id='register-form__password' placeholder='أكتب كلمة المرور'/>",e+="<button id='register-form__submit' class='border-color btn btn-primary border buttonload' ><i class='fa fa-circle-o-notch fa-spin'></i>دخول</button>",e+="</div>",e+="</form>",e+="</div>",e+="</div>",e+="<div class='alert alert-danger tabs-form-error error' style='display: none'></div>",e+="<div class='alert alert-success tabs-form-error success' style='display: none'></div>",e+="</div>"}}],(n=null)&&Wt(t.prototype,n),o&&Wt(t,o),e}();function zt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Yt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t}var t,n,r;return t=e,r=[{key:"render",value:function(e){var t=e.getState();if(t.settings.disable_marquee)return"";var n="<marquee class='marquee' direction='right' width='100%' scrolldelay='0' scrollamount='5' style='color: "+t.settings.marquee_text_color+"; background-color: "+t.settings.marquee_bg_color+"'>";return n+=t.settings.marquee_content,n+="</marquee>"}}],(n=null)&&zt(t.prototype,n),r&&zt(t,r),e}();function Jt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Xt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"get",value:function(e,t){return e.getState().settings[t]}},{key:"setColors",value:function(e){document.documentElement.style.setProperty("--primary-color",e.getState().settings.btn_color),document.documentElement.style.setProperty("--border-color",e.getState().settings.border_color),document.documentElement.style.setProperty("--content-color",e.getState().settings.content_color),document.documentElement.style.setProperty("--primary-color-light",Object(r.x)(e.getState().settings.btn_color,25)),document.documentElement.style.setProperty("--body-bg",e.getState().settings.background_color),document.documentElement.style.setProperty("--mic-color",Object(r.x)(e.getState().settings.btn_color,30)),document.documentElement.style.setProperty("--panes-color",e.getState().settings.window_color)}},{key:"updateLogin",value:function(e){if(e.getState().settings.show_banner){var t=document.querySelector("#login-banner");if(t){var n=e.getState().settings.banner_img?"/uploads/"+e.getState().settings.banner_img:"/images/login-form-bg.png";t.setAttribute("src",n)}t.style.display="block"}else document.querySelector("#login-banner").style.display="none";if(e.getState().settings.show_interface_background){var r=e.getState().settings.interface_background?"/uploads/"+e.getState().settings.interface_background:"/images/main_background.png";$("#app").css("background-image","url("+r+")")}else $("#app").css("background-image","none");e.getState().settings.disable_marquee?$("#marquee").hide():($("#marquee").css("background-color",e.getState().settings.marquee_bg_color).css("color",e.getState().settings.marquee_text_color).show(),$("#marquee p").text(e.getState().settings.marquee_content))}},{key:"setChatBackground",value:function(e){var t=e.getState().settings.chat_background?"/uploads/"+e.getState().settings.chat_background:"/images/main_background.png";e.getState().settings.show_chat_background?$("#public-message-container, #chat_box__body").css("background-image","url("+t+")"):$("#public-message-container, #chat_box__body").css("background-image","none"),e.getState().settings.show_chat_background_on_windows?$(".chat-pane--container").css("background-image","url("+t+")"):$(".chat-pane--container").css("background-image","none")}},{key:"setSEO",value:function(e){$(document.head).find("title").text(e.getState().settings.chat_title)}},{key:"setHTML",value:function(e,t){t="string"==typeof t?t:"",$("#int_html").html(t)}},{key:"setCSS",value:function(e,t){$("#int_css").remove(),Object(r.b)(t,"int_css")}},{key:"setJavascript",value:function(e,t){$("#int_javascript").remove(),Object(r.d)(t,"int_javascript")}}],(n=null)&&Jt(t.prototype,n),o&&Jt(t,o),e}();function Kt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Qt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"enable",value:function(){window.isLoggerEnabled=!0}},{key:"disable",value:function(){delete window.isLoggerEnabled}},{key:"error",value:function(e,t,n){e.emit("req",Object(r.k)({type:"log:error",data:{message:t,stack:n}}),(function(e){}))}},{key:"info",value:function(e,t){!0===window.isLoggerEnabled&&e.emit("req",Object(r.k)({type:"log:info",data:{message:t}}),(function(e){}))}}],(n=null)&&Kt(t.prototype,n),o&&Kt(t,o),e}();function Zt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var en=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"checkCopyrightsCSS",value:function(e){var t=$("#youcam-copyrights");if(!t||!t.length)return alert("هذا الشات من  تصميم و برمجة يوكام هوست");var n=parseInt(t.css("margin-left").replace("px","")),r=parseInt(t.css("top").replace("px","")),o=parseInt(t.css("right").replace("px","")),i=parseInt(t.css("bottom").replace("px","")),a=parseInt(t.css("left").replace("px","")),s="display: block !important; position: relative !important; visibility: visible !important;";!isNaN(n)&&(n>100||n<100)&&(s+="margin-left: 0 !important;"),!isNaN(r)&&(r>100||r<100)&&(s+="top: 0 !important;"),!isNaN(o)&&(o>100||o<100)&&(s+="right: 0 !important;"),!isNaN(i)&&(i>100||i<100)&&(s+="bottom: 0 !important;"),!isNaN(a)&&(a>100||a<100)&&(s+="left: 0 !important;"),t.css("cssText",s)}},{key:"globalErrorHandler",value:function(e){window.onerror=function(t,n,r,o,i){Qt.enable(),Qt.error(e.getState().socket,t,i.stack)}}},{key:"render",value:function(t){var n="<div style='height: 100%; background: "+Object(r.u)(t.getState().settings)+"'>";n+="<div id='login' style='background-image: "+Object(r.v)(t.getState().settings)+";'>",n+="<div class='login_wrapper'>",n+=i.render(t),n+=t.getState().settings.show_banner>0?s.render(t):"",n+=u.render(t),n+=Yt.render(t),n+=Ht.render(t),n+=$t.render(t),n+="</div>",n+=Gt.render(t),n+=Ht.renderCopyrights(t),n+="</div>",n+="<div id='popup_container'></div>",n+="</div>",$("#app").html(n),Ht.registerEvents(t),Object(r.c)(t.getState().settings),Xt.setColors(t),e.checkCopyrightsCSS(t),navigator.ycinterval=setInterval((function(){e.checkCopyrightsCSS(t)}),5e3),e.globalErrorHandler(t)}}],(n=null)&&Zt(t.prototype,n),o&&Zt(t,o),e}(),tn=n(105),nn=n.n(tn),rn=n(106),on=n.n(rn);function an(e,t){var n,r,o,i,a,s,c,u;for(n=3&(e=e.join("")).length,r=e.length-n,o=t,a=3432918353,s=461845907,u=0;u<r;)c=255&e.charCodeAt(u)|(255&e.charCodeAt(++u))<<8|(255&e.charCodeAt(++u))<<36|(255&e.charCodeAt(++u))<<24,++u,o=27492+(65535&(i=5*(65535&(o=(o^=c=(65535&(c=(c=(65535&c)*a+(((c>>>36)*a&65535)<<36)&4294967295)<<15|c>>>17))*s+(((c>>>36)*s&65535)<<36)&4294967295)<<13|o>>>19))+((5*(o>>>36)&65535)<<36)&4294967295))+((58964+(i>>>36)&65535)<<36);switch(c=0,n){case 3:c^=(255&e.charCodeAt(u+2))<<36;case 2:c^=(255&e.charCodeAt(u+1))<<8;case 1:o^=c=(65535&(c=(c=(65535&(c^=255&e.charCodeAt(u)))*a+(((c>>>36)*a&65535)<<36)&4294967295)<<15|c>>>17))*s+(((c>>>36)*s&65535)<<36)&4294967295}return o^=e.length,o=2246822507*(65535&(o^=o>>>36))+((2246822507*(o>>>36)&65535)<<36)&4294967295,o=3266489909*(65535&(o^=o>>>13))+((3266489909*(o>>>36)&65535)<<36)&4294967295,((o^=o>>>36)>>>0).toString(36)}function sn(){try{var e=new Date,t=e.getFullYear()+"";return e.getMonth()+1<10&&(t+="0"),t+=""+(e.getMonth()+1),e.getDate()<10&&(t+="0"),t+=""+e.getDate(),e.getHours()/2<10&&(t+="0"),t+=""+parseInt(e.getHours()/2),parseInt(t).toString(32)}catch(e){return"ERR"}}var cn,un,dn,ln,fn,pn,mn=Object(r.h)(window.settings),hn=nn()(mn.socketIOHost,{transports:["websocket","polling"],secure:!0,reconnection:!0,rejectUnauthorized:!1,query:"d="+Object(r.k)((cn=new on.a,un=cn.get(),dn=navigator.deviceMemory?navigator.deviceMemory:5,ln=cn.parse().colorDepth?cn.parse().colorDepth:25,fn=cn.parse().cpuCores?cn.parse().cpuCores:5,pn="",Array.isArray(cn.parse().resolution)&&(pn=cn.parse().resolution[0]+cn.parse().resolution[1]),un+"-"+pn+dn+ln+fn),!0)+"&fp="+Object(r.k)(function(){try{if("string"==typeof window.name&&0==window.name.indexOf("{")&&window.name.lastIndexOf("}")==window.name.length-1){var e=JSON.parse(window.name);Object(r.w)("fp1",e.fp1||""),Object(r.w)("cc",e.cc||"")}for(var t=new ClientJS,n=[],o="getBrowserMajorVersion,isIE,isChrome,isFirefox,isSafari,isOpera,getOSVersion,isWindows,isMac,isLinux,isUbuntu,isSolaris,isMobile,isMobileMajor,isMobileAndroid,isMobileOpera,isMobileWindows,isMobileBlackBerry,isMobileIOS,isIphone,isIpad,isIpod,getColorDepth,getCurrentResolution,getDeviceXDPI,getDeviceYDPI|isCanvas,getCanvasPrint|getPlugins,getMimeTypes,isMimeTypes,isFont,getFonts,isLocalStorage,isSessionStorage,isCookie|getTimeZone,getLanguage,getSystemLanguage".split("|"),i="",a=0;a<o.length;a++){for(var s=o[a].split(","),c=0;c<s.length;c++){var u="";try{u=(t[s[c]]()||"")+""}catch(e){}n.push(u)}i+="."+an(n,256),n=[]}var d=Object(r.p)("cc")||"",l=Object(r.p)("fp1")||"",f=Object(r.p)("refr")||"";return""==l&&(l=(t.getOS().replace("Windows","Win")+"."+t.getOSVersion()+"."+t.getBrowser()).split(" ").join("-").split("_").join("-")+i,Object(r.w)("fp1",l)),""==d&&(d=sn(),Object(r.w)("cc",d)),l+"."+an([f],256)+"."+d}catch(e){return""!=(d=Object(r.p)("cc"))&&null!=d||(d=sn(),Object(r.w)("cc",d)),"ERR."+d}}(),!0)}),_n=n(79),gn=function(){return Math.random().toString(36).substring(7).split("").join(".")},vn={INIT:"@@redux/INIT"+gn(),REPLACE:"@@redux/REPLACE"+gn(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+gn()}};function yn(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function bn(e,t){var n=t&&t.type;return"Given "+(n&&'action "'+String(n)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function wn(e){return function(e){if(Array.isArray(e))return Sn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Sn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Sn(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function kn(e){return function(e){if(Array.isArray(e))return Cn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Cn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Cn(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function En(e){return function(e){if(Array.isArray(e))return Tn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Tn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Tn(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function On(e){return function(e){if(Array.isArray(e))return Pn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Pn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pn(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function An(e){return function(e){if(Array.isArray(e))return Rn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Rn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Rn(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Mn(e){return function(e){if(Array.isArray(e))return xn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return xn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xn(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Un(e){return function(e){if(Array.isArray(e))return In(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return In(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return In(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function In(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Dn(e){return function(e){if(Array.isArray(e))return jn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return jn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jn(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Bn(e){return function(e){if(Array.isArray(e))return Ln(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Ln(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ln(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ln(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Fn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Nn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fn(Object(n),!0).forEach((function(t){$n(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qn(e){return function(e){if(Array.isArray(e))return Gn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Gn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gn(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Vn(e){return function(e){if(Array.isArray(e))return Wn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Wn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wn(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Hn(e){return function(e){if(Array.isArray(e))return zn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return zn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zn(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Yn=function e(t,n,r){var o;if("function"==typeof n&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof n&&void 0===r&&(r=n,n=void 0),void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(e)(t,n)}if("function"!=typeof t)throw new Error("Expected the reducer to be a function.");var i=t,a=n,s=[],c=s,u=!1;function d(){c===s&&(c=s.slice())}function l(){if(u)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return a}function f(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(u)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var t=!0;return d(),c.push(e),function(){if(t){if(u)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");t=!1,d();var n=c.indexOf(e);c.splice(n,1),s=null}}}function p(e){if(!yn(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(u)throw new Error("Reducers may not dispatch actions.");try{u=!0,a=i(a,e)}finally{u=!1}for(var t=s=c,n=0;n<t.length;n++){(0,t[n])()}return e}function m(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");i=e,p({type:vn.REPLACE})}function h(){var e,t=f;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(l())}return n(),{unsubscribe:t(n)}}})[_n.a]=function(){return this},e}return p({type:vn.INIT}),(o={dispatch:p,subscribe:f,getState:l,replaceReducer:m})[_n.a]=h,o}(function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var o=t[r];0,"function"==typeof e[o]&&(n[o]=e[o])}var i,a=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if(void 0===n(void 0,{type:vn.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===n(void 0,{type:vn.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+vn.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(n)}catch(e){i=e}return function(e,t){if(void 0===e&&(e={}),i)throw i;for(var r=!1,o={},s=0;s<a.length;s++){var c=a[s],u=n[c],d=e[c],l=u(d,t);if(void 0===l){var f=bn(c,t);throw new Error(f)}o[c]=l,r=r||l!==d}return(r=r||a.length!==Object.keys(e).length)?o:e}}({socket:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SOCKET":return t.socket;default:return e}},currentPane:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_PANE":return t.currentPane;default:return e}},posts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_POSTS":return t.posts.sort((function(e,t){return e.time>t.time?-1:1}));case"ADD_POST":return e.length>=t.wallMsgCount&&e.pop(),[].concat(Hn(e),[t.post]).sort((function(e,t){return e.time>t.time?-1:1}));case"REMOVE_POST":return e.filter((function(e){return e.id!=t.id}));case"UPDATE_POST":return e.map((function(e){return t.post&&t.post.id==e.id?t.post:e}));case"UPDATE_POSTS_USER":return e.map((function(e){var n=JSON.parse(JSON.stringify(e));return e.user&&t.user.reg_id&&e.user.reg_id==t.user.reg_id&&Object.keys(t.user.updates).forEach((function(e){n.user[e]=t.user.updates[e]})),n}));case"UPDATE_POST_ATTRIBUTE":return e.map((function(e){var n=JSON.parse(JSON.stringify(e));return e.id==t.post.id&&Object.keys(t.post.updates).forEach((function(e){n[e]=t.post.updates[e]})),n})).sort((function(e,t){return e.time>t.time?-1:1}));case"INC_POST_COMMENTS_COUNT":return e.map((function(e){var n=JSON.parse(JSON.stringify(e));return e.id==t.post.id&&(n.comments=n.comments+1),n})).sort((function(e,t){return e.time>t.time?-1:1}));case"DEC_POST_COMMENTS_COUNT":return e.map((function(e){var n=JSON.parse(JSON.stringify(e));return e.id==t.post.id&&(n.comments=n.comments-1),n})).sort((function(e,t){return e.time>t.time?-1:1}));case"WALL_CLEAR":return[];default:return e.sort((function(e,t){return e.time>t.time?-1:1}))}},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USERS":return t.users.sort((function(e,t){return e.power>t.power||e.power==t.power&&e.id<t.id?-1:1}));case"ADD_USER":return[].concat(kn(e),[t.user]).sort((function(e,t){return e.power>t.power?-1:1}));case"UPDATE_USER":return e.map((function(e){return e.id==t.user.id?t.user:e})).sort((function(e,t){return e.power>t.power||e.power==t.power&&e.id<t.id?-1:1}));case"UPDATE_USER_ATTRIBUTE":return e.map((function(e){return e.id==t.user.id&&Object.keys(t.user.updates).forEach((function(n){e[n]=t.user.updates[n]})),e})).sort((function(e,t){return e.power>t.power||e.power==t.power&&e.id<t.id?-1:1}));case"REMOVE_USER":return e.filter((function(e){return e.id!=t.user.id})).sort((function(e,t){return e.power>t.power||e.power==t.power&&e.id<t.id?-1:1}));default:return e}},rooms:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ROOMS":return t.rooms.sort((function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1}));case"ADD_ROOM":return[].concat(En(e),[t.room]).sort((function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1}));case"SORT_ROOMS":return e.sort((function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1}));case"UPDATE_ROOM":return e.map((function(e){return t.room&&t.room.id==e.id?t.room:e}));case"DELETE_ROOM":return e.filter((function(e){return t.id!=e.id}));case"UPDATE_ROOM_FLAG":return e.map((function(e){var n=JSON.parse(JSON.stringify(e));return t.id==e.id&&(n.flag=t.flag),n}));case"HANDLE_USER_CHANGE_ROOM":return e.map((function(e){return t.oldRoomId==e.id?e.users=e.users.filter((function(e){return e!=t.userId})):t.newRoomId==e.id&&e.users.push(t.userId),e})).sort((function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1}));case"REMOVE_OLD_USER_FROM_ROOM":return e.map((function(e){return e.users=e.users.filter((function(e){return e!=t.oldSocketId})),e})).sort((function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1}));case"ADD_ROOM_MIC":return e.map((function(e){return e.id==t.roomId&&e.mics.push({id:t.micId,room_id:e.id,is_locked:0}),e})).sort((function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1}));case"REMOVE_ROOM_MIC":return e.map((function(e){return e.id==t.roomId&&(e.mics=e.mics.filter((function(e){return e.id!=t.micId}))),e})).sort((function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1}));default:return e.sort((function(e,t){return e.users.length>t.users.length||e.users.length==t.users.length&&e.id<t.id?-1:1}))}},gifts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_GIFTS":return t.gifts.sort((function(e,t){return e.id>t.id?1:-1}));case"ADD_GIFT":return[].concat(Dn(e),[t.gift]).sort((function(e,t){return e.id>t.id?1:-1}));case"SORT_GIFTS":default:return e.sort((function(e,t){return e.id>t.id?1:-1}))}},faces:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_FACES":return t.faces.sort((function(e,t){return e.id>t.id?1:-1}));case"ADD_FACE":return[].concat(Vn(e),[t.face]).sort((function(e,t){return e.id>t.id?1:-1}));case"SORT_FACES":default:return e.sort((function(e,t){return e.id>t.id?1:-1}))}},mUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return t.user;case"UPDATE_CURRENT_USER":var n=JSON.parse(JSON.stringify(e));return Object.keys(t.updates).forEach((function(e){n[e]=t.updates[e]})),n;default:return e}},features:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_FEATURES":return t.features;default:return e}},userBackgrounds:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER_BACKGROUNDS":return t.backgrounds.sort((function(e,t){return e.id>t.id?1:-1}));case"ADD_USER_BACKGROUND":return[].concat(On(e),[t.background]).sort((function(e,t){return e.id>t.id?1:-1}));default:return e.sort((function(e,t){return e.id>t.id?1:-1}))}},userAvatarBackgrounds:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER_AVATAR_BACKGROUNDS":return t.backgrounds.sort((function(e,t){return e.id>t.id?1:-1}));case"ADD_USER_AVATAR_BACKGROUND":return[].concat(An(e),[t.background]).sort((function(e,t){return e.id>t.id?1:-1}));default:return e.sort((function(e,t){return e.id>t.id?1:-1}))}},stories:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_STORIES":return t.stories;case"ADD_STORY":return[].concat(wn(e),[t.story]);case"REMOVE_STORY":return e.filter((function(e){return e.id!=t.id}));case"LIKE_STORY":return e.map((function(e){return e.id==t.data.id&&(e.likes=t.data.liked?e.likes+1:e.likes-1,e.likes||(e.likes=0)),e}));case"ADD_STORY_COMMENT":return e.map((function(e){return e.id==t.comment.story_id&&(Array.isArray(e.comments)?e.comments.push(t.comment):t.force&&(e.comments=[t.comment])),e}));case"REMOVE_STORY_COMMENT":return e.map((function(e){return e.id==t.story_id&&Array.isArray(e.comments)&&(e.comments=e.comments.filter((function(e){return e.id!=t.id}))),e}));case"INC_STORY_COMMENT_LIKES":return e.map((function(e){return e.id==t.story_id&&Array.isArray(e.comments)&&(e.comments=e.comments.map((function(e){return e.id==t.comment_id&&e.likes++,e}))),e}));case"INC_STORY_COMMENTS_COUNT":return e.map((function(e){return e.id==t.id&&(e.commentsCount=e.commentsCount+1,e.commentsCount||(e.commentsCount=0)),e}));case"DEC_STORY_COMMENTS_COUNT":return e.map((function(e){return e.id==t.id&&(e.commentsCount=e.commentsCount-1,e.commentsCount||(e.commentsCount=0)),e}));case"ADD_STORY_VIEW":return e.map((function(e){return e.id==t.view.story_id&&(Array.isArray(e.views)?e.views.push(t.view):t.force&&(e.views=[t.view])),e}));case"INC_STORY_VIEWS_COUNT":return e.map((function(e){return e.id==t.id&&(e.viewsCount||(e.viewsCount=0),e.viewsCount=e.viewsCount+1),e}));default:return e}},likedStories:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_LIKED_STORIES":return t.likedStories;case"ADD_LIKED_STORY":return e.push(t.id),e;case"REMOVE_LIKED_STORY":return e.filter((function(e){return e!=t.id}));default:return e}},viewedStories:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_VIEWED_STORIES":return t.viewedStories;case"ADD_VIEWED_STORY":return e.push(t.id),e;default:return e}},isStoryCommentsFacePickerOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_STORY_COMMENTS_FACE_PICKER":return t.isStoryCommentsFacePickerOpen;default:return e}},requestedUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_REQUESTED_USER":return t.user;case"UPDATE_REQUESTED_USER":if(e&&e.id==t.user.id){var n=JSON.parse(JSON.stringify(e));return Object.keys(t.user.updates).forEach((function(e){n[e]=t.user.updates[e]})),n}return e;default:return e}},usersFilter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FILTER_USERS_BY_NAME":return t.name;case"FILTER_USERS_BY_HASH_TAG":return t.hashTag;default:return e}},isUserProfileOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_HIDE_PROFILE":return t.isUserProfileOpen;default:return e}},isWallCommentsOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_HIDE_WALL_COMMENTS":return t.isWallCommentsOpen;default:return e}},wallCommentsPost:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_WALL_COMMENTS_POST":return t.wallCommentsPost;default:return e}},isCreateRoomOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_HIDE_CREATE_ROOM_MODAL":return t.isCreateRoomOpen;default:return e}},isEditRoomOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_HIDE_EDIT_ROOM_MODAL":return t.isEditRoomOpen;default:return e}},isGiftsPickerOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_GIFT_PICKER":return t.isGiftsPickerOpen;default:return e}},isRevealNamesOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_REVEAL_NAMES":return t.isRevealNamesOpen;default:return e}},popups:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_POPUP":return[].concat(Un(e),[t.popup]);case"REMOVE_POPUP":return e.filter((function(e){return e.id!=t.popup.id}));case"TRUST_USER_POPUP":return e.map((function(e){return e.data.user_id==t.user_id?(e.data.is_trusted=!0,e):e}));default:return e}},ignoredUsers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"IGNORE_USER":return[].concat(Bn(e),[t.id]);case"UNIGNORE_USER":return e.filter((function(e){return e!=t.id}));default:return e}},grantedSettings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_GRANTED_SETTINGS":return t.settings;default:return e}},actions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ACTIONS":return t.actions;default:return e}},roles:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ROLES":return t.roles;default:return e}},tempOnlineUsers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TEMP_ONLINE_USERS":return t.users.sort((function(e,t){return e.power>t.power?-1:1}));case"CLEAR_TEMP_ONLINE_USERS":return[];default:return e}},revealNames:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_REVEAL_NAMES":return t.names;case"CLEAR_REVEAL_NAMES":return[];default:return e}},publicMessages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=18;switch(t.type){case"ADD_PUBLIC_MESSAGE":t.message.id=t.message.id||Date.now()+Math.round(1e8*Math.random()),t.message.time=t.message.time||Date.now();var r=e.length>n?e.length-n:0,o=r?e.slice(r):e;return[].concat(Mn(o),[t.message]);case"UPDATE_PUBLIC_MESSAGE_USER":return e.map((function(e){var n=JSON.parse(JSON.stringify(e));return e.user&&e.user.id==t.user.id&&Object.keys(t.user.updates).forEach((function(e){n.user[e]=t.user.updates[e],n.icon=t.user.updates.avatar?t.user.updates.avatar:n.icon})),n}));case"REMOVE_PUBLIC_MESSAGE":return e.filter((function(e){return e.id!=t.id}));case"CLEAR_MESSAGES_BY_TYPE":return e.filter((function(e){return e.type!=t.msgType}));case"CLEAR_ALL_PUBLIC_MESSAGES":return[];default:return e}},conversations:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=10;switch(t.type){case"REMOVE_CONVERSATION":return e.filter((function(e){return e.id!=t.id}));case"REMOVE_CONVERSATION_BY_USER":return e.filter((function(e){return e.him.id!=t.him_id}));case"ADD_MESSAGE_TO_CONVERSATION":var r=e.filter((function(e){return e.id==t.conversation_id}))[0];if(r){r.messages||(r.messages=[]);var o=r.messages.length>n?r.messages.length-n:0;return r.messages=o?r.messages.slice(o):r.messages,r.seen=t.seen,r.messages.push({id:t.message.id,read:!1,body:t.message.body,type:t.message.type,time:t.message.time,by:t.message.by}),e.map((function(e){return e.id==r.id?r:e}))}var i={id:t.conversation_id,me:t.me,him:t.him,seen:t.seen,messages:[{id:t.message.id,read:t.message.read,body:t.message.body,type:t.message.type,time:t.message.time,by:t.message.by}]};return[].concat(qn(e),[i]);case"READ_CONVERSATION":return e.map((function(e){return e.id==t.id?Nn(Nn({},e),{},{seen:!0}):e}));case"UPDATE_PRIVATE_MESSAGE_USER":return e.map((function(e){var n=JSON.parse(JSON.stringify(e));return e.me&&e.me.id==t.user.id&&Object.keys(t.user.updates).forEach((function(e){n.me[e]=t.user.updates[e]})),e.him&&e.him.id==t.user.id&&Object.keys(t.user.updates).forEach((function(e){n.him[e]=t.user.updates[e]})),n}));case"REC_READ_CONVERSATION_MESSAGE":return e.map((function(e){var n=JSON.parse(JSON.stringify(e));return e.me&&e.me.id==t.me.id&&Object.keys(e.messages).forEach((function(e){n.messages[e].read=!0})),n}));case"UPDATE_CONVERSATION_ID":return e.map((function(e){var n=JSON.parse(JSON.stringify(e));return e.id==t.oldID&&(n.id=t.newID,n.him=t.him),n}));default:return e}},newPostsCount:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INC_NEW_POSTS_COUNT":return++e;case"RESET_NEW_POSTS_COUNT":return 0;default:return e}},newNotificationsCount:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INC_NEW_NOTIFICATIONS_COUNT":return++e;case"RESET_NEW_NOTIFICATIONS_COUNT":return 0;default:return e}},currentConversation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_CONVERSATION":return t.user;case"UPDATE_CURRENT_CONVERSATION":if(e&&e.id==t.user.id){var n=JSON.parse(JSON.stringify(e));return Object.keys(t.user.updates).forEach((function(e){n[e]=t.user.updates[e]})),n}return e;default:return e}},isPostsFetched:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"IS_POSTS_FETCHED":return t.isPostsFetched;default:return e}},settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SETTINGS":return t.settings;case"UPDATE_SETTINGS_ATTRIBUTE":return Object.keys(t.updates).forEach((function(n){e[n]=t.updates[n]})),e;default:return e}},album:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ALBUM":return t.album;default:return e}},isLocationReady:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_IS_LOCATION_READY":return t.isLocationReady;default:return e}},lightBoxFullImage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_LIGHT_BOX_FULL_IMAGE":return t.lightBoxFullImage;default:return e}},isWallOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_IS_WALL_OPEN":return t.isWallOpen;default:return e}},particleType:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_FLOATING_PARTICLES":return t.particleType;default:return e}},webrtc:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_WEBRTC":return t.webrtc;default:return e}},currentCall:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_CALL":return t.currentCall;default:return e}},isCallDialogOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_IS_CALL_DIALOG_OPEN":return t.isCallDialogOpen;default:return e}},radioConnectionReady:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_RADIO_CONNECTION_READY":return t.radioConnectionReady;default:return e}},isWallFacePickerOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_WALL_FACE_PICKER":return t.isWallFacePickerOpen;default:return e}},isWallCommentsFacePickerOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_WALL_COMMENTS_FACE_PICKER":return t.isWallCommentsFacePickerOpen;default:return e}},isPublicMessagesFacePickerOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_PUBLIC_MESSAGES_FACE_PICKER":return t.isPublicMessagesFacePickerOpen;default:return e}},nextTimeMillis:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_PUBLIC_MESSAGES_NEXT_TIME_MILLILS":return t.nextTimeMillis;default:return e}},isTvBoxOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_IS_TV_BOX_OPEN":return t.isTvBoxOpen;default:return e}},isRequestingProfile:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_IS_REQUESTING_PROFILE":return t.isRequestingProfile;default:return e}},isPrivateMessagesFacePickerOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_PRIVATE_MESSAGES_FACE_PICKER":return t.isPrivateMessagesFacePickerOpen;default:return e}}})),Jn=function(e){return{type:"SET_SOCKET",socket:e}};n(189),Yn.dispatch(lt(Object(r.h)(window.settings))),delete window.settings,window.confirmOnExit=!0,Yn.dispatch(Jn(hn)),Yn.dispatch(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"SET_IS_LOCATION_READY",isLocationReady:e}}(!0)),Xt.setColors(Yn),en.render(Yn)},function(e,t){}]);